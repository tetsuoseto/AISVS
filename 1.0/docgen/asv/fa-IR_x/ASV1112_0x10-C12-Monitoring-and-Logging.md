# نظارت، ثبت لاگ و تشخیص ناهنجاری در C12

## هدف کنترل

این بخش الزامات ارائه دید در زمان واقعی و بررسی‌های قضایی در مورد آنچه مدل و سایر مؤلفه‌های هوش مصنوعی می‌بینند، انجام می‌دهند و بازمی‌گردانند را فراهم می‌کند، تا تهدیدات قابل شناسایی، دسته‌بندی و یادگیری باشند.

## C12.1 ثبت درخواست و پاسخ

|   #    | توضیحات                                                                                                                                                                                                | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 12.1.1 | اطمینان حاصل کنید که تمامی پیام‌های کاربران و پاسخ‌های مدل با متادیتای مناسب (مانند زمان‌بندی، شناسه کاربر، شناسه جلسه، نسخه مدل) ثبت شده‌اند.                                                         |  1  | D/V |
| 12.1.2 | تأیید کنید که لاگ‌ها در مخازن امن و کنترل‌شده بر اساس دسترسی با سیاست‌های نگهداری مناسب و رویه‌های پشتیبان‌گیری ذخیره می‌شوند.                                                                         |  1  | D/V |
| 12.1.3 | اطمینان حاصل کنید که سیستم‌های ذخیره‌سازی لاگ، رمزنگاری در حالت سکون و در حین انتقال را برای محافظت از اطلاعات حساس موجود در لاگ‌ها اجرا می‌کنند.                                                      |  1  | D/V |
| 12.1.4 | اطمینان حاصل کنید که داده‌های حساس در درخواست‌ها و خروجی‌ها به طور خودکار قبل از ثبت لاگ، حذف یا مخفی شده‌اند، با قوانین قابل تنظیم برای حذف اطلاعات شناسایی شخصی (PII)، مدارک ورود و اطلاعات مالکیتی. |  1  | D/V |
| 12.1.5 | اطمینان حاصل کنید که تصمیمات سیاستی و اقدامات فیلتر ایمنی با جزئیات کافی ثبت می‌شوند تا امکان بررسی و عیب‌یابی سیستم‌های مدیریت محتوا فراهم گردد.                                                      |  2  | D/V |
| 12.1.6 | اطمینان حاصل کنید که یکپارچگی لاگ‌ها از طریق امضاهای رمزنگاری شده یا ذخیره‌سازی فقط-نوشتنی محافظت می‌شود.                                                                                              |  2  | D/V |

---

## C12.2 شناسایی سوء استفاده و هشداردهی

|   #    | توضیحات                                                                                                                                                                  | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 12.2.1 | اطمینان حاصل کنید که سیستم با استفاده از تشخیص مبتنی بر امضا، الگوهای شناخته شده دستکاری سیستم، تلاش‌های تزریق فرمان و ورودی‌های مخرب را شناسایی و هشدار می‌دهد.         |  1  | D/V |
| 12.2.2 | اطمینان حاصل کنید که سیستم با پلتفرم‌های موجود مدیریت اطلاعات و رویدادهای امنیتی (SIEM) با استفاده از فرمت‌ها و پروتکل‌های استاندارد لاگ‌گیری یکپارچه می‌شود.            |  1  | D/V |
| 12.2.3 | تأیید کنید که رویدادهای امنیتی غنی شده شامل زمینه‌های خاص هوش مصنوعی مانند شناسه‌های مدل، امتیازات اطمینان و تصمیمات فیلتر ایمنی باشند.                                  |  2  | D/V |
| 12.2.4 | تأیید کنید که تشخیص ناهنجاری رفتاری الگوهای مکالمه غیرمعمول، تلاش‌های مکرر بیش از حد، یا رفتارهای اکتشافی سیستماتیک را شناسایی می‌کند.                                   |  2  | D/V |
| 12.2.5 | اطمینان حاصل کنید که مکانیزم‌های هشداردهی در زمان واقعی تیم‌های امنیتی را هنگام شناسایی تخلفات احتمالی سیاست‌ها یا تلاش‌های حمله مطلع می‌کنند.                           |  2  | D/V |
| 12.2.6 | تأیید کنید که قوانین سفارشی برای شناسایی الگوهای تهدید مخصوص هوش مصنوعی شامل تلاش‌های هماهنگ برای دور زدن، کمپین‌های تزریق درخواست، و حملات استخراج مدل گنجانده شده‌اند. |  2  | D/V |
| 12.2.7 | تأیید کنید که فرآیندهای پاسخ خودکار به حوادث می‌توانند مدل‌های به خطر افتاده را منزوی کنند، کاربران مخرب را مسدود کنند و رویدادهای امنیتی حیاتی را تشدید کنند.           |  3  | D/V |

---

## C12.3 شناسایی تغییر مدل

|   #    | توضیحات                                                                                                                                              | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | تأیید کنید که سیستم معیارهای عملکرد پایه‌ای مانند دقت، نمرات اطمینان، تأخیر، و نرخ خطا را در نسخه‌های مدل و بازه‌های زمانی مختلف پیگیری می‌کند.      |  1  | D/V |
| 12.3.2 | اطمینان حاصل کنید که هشدار خودکار هنگام عبور معیارهای عملکرد از آستانه‌های تعریف‌شده کاهش کیفیت یا انحراف قابل توجه از معیارهای پایه فعال می‌شود.    |  2  | D/V |
| 12.3.3 | اطمینان حاصل کنید که سامانه‌های تشخیص هذیان مواردی را که خروجی‌های مدل حاوی اطلاعات نادرست، ناسازگار یا ساختگی هستند، شناسایی و علامت‌گذاری می‌کنند. |  2  | D/V |

---

## C12.4 داده‌های تله‌متری عملکرد و رفتار

|   #    | توضیحات                                                                                                                                              | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.4.1 | تأیید کنید که معیارهای عملیاتی شامل تأخیر درخواست، مصرف توکن، استفاده از حافظه و توان عملیاتی به صورت مداوم جمع‌آوری و پایش می‌شوند.                 |  1  | D/V |
| 12.4.2 | تأیید کنید که نرخ‌های موفقیت و شکست با دسته‌بندی نوع خطاها و علل ریشه‌ای آنها پیگیری می‌شوند.                                                        |  1  | D/V |
| 12.4.3 | اطمینان حاصل کنید که پایش استفاده از منابع شامل استفاده از GPU/CPU، مصرف حافظه و نیازهای ذخیره‌سازی باشد و در صورت عبور از آستانه‌ها هشدار داده شود. |  2  | D/V |

---

## C12.5 برنامه‌ریزی و اجرای واکنش به حادثه هوش مصنوعی

|   #    | توضیحات                                                                                                                                                      | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 12.5.1 | اطمینان حاصل کنید که برنامه‌های پاسخ به حادثه به‌طور خاص به رویدادهای امنیتی مرتبط با هوش مصنوعی از جمله نقض مدل، مسمومیت داده‌ها و حملات خصمانه می‌پردازند. |  1  | D/V |
| 12.5.2 | اطمینان حاصل کنید که تیم‌های پاسخ به حوادث به ابزارها و تخصص‌های قضایی خاص هوش مصنوعی برای بررسی رفتار مدل و مسیرهای حمله دسترسی دارند.                      |  2  | D/V |
| 12.5.3 | اطمینان حاصل کنید که تجزیه و تحلیل پس از حادثه شامل ملاحظات بازآموزی مدل، به‌روزرسانی فیلترهای ایمنی و ادغام درس‌های آموخته شده در کنترل‌های امنیتی باشد.    |  3  | D/V |

---

## C12.6 تشخیص کاهش کارایی هوش مصنوعی

نظارت و شناسایی افت در عملکرد و کیفیت مدل هوش مصنوعی در طول زمان.

|   #    | توضیحات                                                                                                                   | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.6.1 | اطمینان حاصل کنید که دقت مدل، صحت، یادآوری و نمرات F1 به طور مداوم مانیتور شده و با آستانه‌های پایه مقایسه می‌شوند.       |  1  | D/V |
| 12.6.2 | تأیید کنید که تشخیص تغییرات داده، تغییرات توزیع ورودی را که ممکن است بر عملکرد مدل تأثیر بگذارد، رصد می‌کند.              |  1  | D/V |
| 12.6.3 | تأیید کنید که تشخیص تغییر مفهوم، تغییرات در رابطه بین ورودی‌ها و خروجی‌های مورد انتظار را شناسایی می‌کند.                 |  2  | D/V |
| 12.6.4 | تأیید کنید که کاهش عملکرد باعث فعال شدن هشدارهای خودکار شده و روندهای بازآموزی یا جایگزینی مدل را شروع می‌کند.            |  2  | D/V |
| 12.6.5 | تأیید کنید که تحلیل ریشه‌ای علت افت کیفیت، کاهش عملکرد را با تغییرات داده‌ها، مشکلات زیرساخت یا عوامل خارجی مرتبط می‌کند. |  3  |  V  |

---

## C12.7 تجسم DAG و امنیت جریان کاری

سیستم‌های تجسم گردش کار را از نشت اطلاعات و حملات دستکاری محافظت کنید.

|   #    | توضیحات                                                                                                                                                   | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | اطمینان حاصل کنید که داده‌های تصویری DAG قبل از ذخیره‌سازی یا انتقال، برای حذف اطلاعات حساس پاک‌سازی شده‌اند.                                             |  1  | D/V |
| 12.7.2 | تایید کنید که کنترل‌های دسترسی به نمایش گردش کار اطمینان می‌دهند تنها کاربران مجاز می‌توانند مسیرهای تصمیم‌گیری عامل و ردگیری‌های استدلال را مشاهده کنند. |  1  | D/V |
| 12.7.3 | اطمینان حاصل کنید که یکپارچگی داده‌های DAG از طریق امضاهای رمزنگاری‌شده و مکانیزم‌های ذخیره‌سازی مقاوم در برابر تغییرات محافظت می‌شود.                    |  2  | D/V |
| 12.7.4 | اطمینان حاصل کنید که سیستم‌های تجسم گردش کار، اعتبارسنجی ورودی را اجرا می‌کنند تا از حملات تزریق از طریق داده‌های ساختگی گره یا یال جلوگیری شود.          |  2  | D/V |
| 12.7.5 | تأیید کنید که به‌روزرسانی‌های DAG در زمان واقعی محدود به نرخ مشخص شده و اعتبارسنجی می‌شوند تا از حملات انکار سرویس بر روی سیستم‌های تجسم جلوگیری شود.     |  3  | D/V |

---

## C12.8 نظارت پیشگیرانه بر رفتار امنیتی

شناسایی و پیشگیری از تهدیدات امنیتی از طریق تحلیل رفتار پیشگیرانه عامل.

|   #    | توضیحات                                                                                                                       | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.8.1 | اطمینان حاصل کنید که رفتارهای پیشگیرانه عامل قبل از اجرا با ادغام ارزیابی ریسک از نظر امنیتی تأیید شده‌اند.                   |  1  | D/V |
| 12.8.2 | تأیید کنید که محرک‌های ابتکار خودکار شامل ارزیابی زمینه امنیتی و ارزیابی چشم‌انداز تهدید می‌شوند.                             |  2  | D/V |
| 12.8.3 | بررسی کنید که الگوهای رفتار پیشگیرانه از نظر پیامدهای احتمالی امنیتی و عواقب ناخواسته تحلیل شده باشند.                        |  2  | D/V |
| 12.8.4 | تأیید کنید که اقدامات پیشگیرانه حساس به امنیت نیازمند زنجیره‌های تایید صریح با سوابق حسابرسی هستند.                           |  3  | D/V |
| 12.8.5 | تأیید کنید که شناسایی ناهنجاری رفتاری انحرافات در الگوهای عامل پیشگیرانه را که ممکن است نشان‌دهنده نفوذ باشد، شناسایی می‌کند. |  3  | D/V |

---

## مراجع

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)


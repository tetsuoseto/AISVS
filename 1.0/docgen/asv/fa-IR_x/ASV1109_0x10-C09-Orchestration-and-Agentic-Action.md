# 9 ارکستراسیون خودکار و امنیت اقدام عاملی

## هدف کنترل

اطمینان حاصل شود که سیستم‌های هوش مصنوعی خودران یا چندعاملی تنها بتوانند اقداماتی را انجام دهند که به‌صراحت مورد نظر هستند، تأیید شده‌اند، قابل حسابرسی هستند و در محدوده هزینه و خطر مشخص شده قرار دارند. این موضوع از تهدیداتی مانند نقض سیستم خودران، سوءاستفاده از ابزار، تشخیص حلقه عامل، ربودن ارتباط، جعل هویت، دستکاری گروهی و دستکاری قصد جلوگیری می‌کند.

---

## 9.1 بودجه‌های برنامه‌ریزی وظایف عامل و بازگشتی

محدود کردن برنامه‌های بازگشتی و اعمال توقف‌های انسانی برای اقدامات با دسترسی ویژه.

|   #   | توضیحات                                                                                                                                                       | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.1.1 | تأیید کنید که حداکثر عمق بازگشت، گستردگی، زمان ساعت دیواری، توکن‌ها و هزینه مالی برای هر اجرای عامل به صورت مرکزی پیکربندی شده و تحت کنترل نسخه باشند.        |  1  | D/V |
| 9.1.2 | اطمینان حاصل کنید که اقدامات ویژه یا غیرقابل بازگشت (مانند ثبت کد، انتقالات مالی) قبل از اجرا، نیازمند تأیید صریح انسانی از طریق یک کانال قابل حسابرسی باشند. |  1  | D/V |
| 9.1.3 | تأیید کنید که مانیتورهای منابع بلادرنگ هنگام عبور هر یک از آستانه‌های بودجه، وقفه مدار شکن را فعال کنند و توسعه بیشتر وظیفه را متوقف کنند.                    |  2  |  D  |
| 9.1.4 | اطمینان حاصل کنید که رویدادهای قطع‌کننده مدار با شناسه عامل، شرط فعال‌سازی و وضعیت برنامه ضبط شده برای بررسی قانونی ثبت می‌شوند.                              |  2  | D/V |
| 9.1.5 | تضمین کنید که تست‌های امنیتی شامل سناریوهای هدررفت بودجه و اجرای برنامه‌های خارج از کنترل باشد و توقف ایمن بدون از دست رفتن داده‌ها را تأیید کند.             |  3  |  V  |
| 9.1.6 | اطمینان حاصل کنید که سیاست‌های بودجه به صورت سیاست به عنوان کد بیان شده‌اند و در CI/CD اجرا می‌شوند تا از انحراف پیکربندی جلوگیری شود.                        |  3  |  D  |

---

## 9.2 جعبه شنی پلاگین ابزار

تعاملات ابزار را ایزوله کنید تا از دسترسی غیرمجاز به سیستم یا اجرای کد جلوگیری شود.

|   #   | توضیحات                                                                                                                                                                                | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.2.1 | اطمینان حاصل کنید که هر ابزار/افزونه در داخل یک سیستم‌عامل، کانتینر، یا محیط ایزوله WASM با حداقل سطح دسترسی به سیستم‌فایل، شبکه و سیاست‌های فراخوانی سیستم اجرا می‌شود.               |  1  | D/V |
| 9.2.2 | اطمینان حاصل کنید که سهمیه‌های منابع محیط آزمایشی (CPU، حافظه، دیسک، خروجی شبکه) و محدودیت‌های زمان اجرای دستور اجرا شده و ثبت می‌شوند.                                                |  1  | D/V |
| 9.2.3 | بررسی کنید که باینری‌ها یا توصیف‌کننده‌های ابزار به صورت دیجیتال امضا شده‌اند؛ امضاها قبل از بارگذاری معتبرسنجی می‌شوند.                                                               |  2  | D/V |
| 9.2.4 | اطمینان حاصل کنید که تلماتری سندباکس به یک سامانه مدیریت اطلاعات و رویداد امنیتی (SIEM) جریان دارد؛ ناهنجاری‌ها (مثلاً تلاش برای برقراری اتصالات خروجی) باعث فعال شدن هشدارها می‌شوند. |  2  |  V  |
| 9.2.5 | تأیید کنید که افزونه‌های با ریسک بالا قبل از استقرار در محیط تولید، زیر نظر بررسی امنیتی و آزمایش نفوذ قرار گیرند.                                                                     |  3  |  V  |
| 9.2.6 | تأیید کنید که تلاش‌های فرار از سندباکس به‌طور خودکار مسدود شده و افزونه متخلف تا زمان بررسی در قرنطینه قرار دارد.                                                                      |  3  | D/V |

---

## 9.3 حلقه خودران و محدود کردن هزینه

شناسایی و متوقف کردن بازگشت غیرکنترلی عامل به عامل و انفجار هزینه‌ها.

|   #   | توضیحات                                                                                                                                    | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 9.3.1 | اطمینان حاصل کنید که تماس‌های بین عامل‌ها شامل یک محدودیت پرش یا TTL هستند که زمان اجرا آن را کاهش داده و اعمال می‌کند.                    |  1  | D/V |
| 9.3.2 | اطمینان حاصل کنید که عامل‌ها یک شناسه منحصر به فرد برای نمودار فراخوانی حفظ می‌کنند تا خودفراخوانی یا الگوهای چرخه‌ای را شناسایی کنند.     |  2  |  D  |
| 9.3.3 | تأیید کنید که شمارنده‌های تجمعی واحد محاسبات و هزینه به ازای هر زنجیره درخواست پیگیری می‌شوند؛ عبور از حد مجاز باعث قطع شدن زنجیره می‌شود. |  2  | D/V |
| 9.3.4 | تأیید کنید که تحلیل رسمی یا بررسی مدل عدم وجود بازگشت نامحدود در پروتکل‌های عامل را نشان می‌دهد.                                           |  3  |  V  |
| 9.3.5 | تأیید کنید که رویدادهای قطع حلقه هشدارها را تولید کرده و معیارهای بهبود مستمر را تأمین می‌کنند.                                            |  3  |  D  |

---

## 9.4 حفاظت از سوءاستفاده در سطح پروتکل

کانال‌های ارتباطی امن بین عامل‌ها و سیستم‌های خارجی برای جلوگیری از ربودن یا دستکاری فراهم کنید.

|   #   | توضیحات                                                                                                                                                       | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.4.1 | اطمینان حاصل کنید که تمام پیام‌های بین عامل و ابزار و بین عامل‌ها به صورت احراز هویت شده (برای مثال، TLS متقابل یا JWT) و رمزگذاری شده از مبدا تا مقصد هستند. |  1  | D/V |
| 9.4.2 | اطمینان حاصل کنید که اسکیماها به طور دقیق بررسی می‌شوند؛ فیلدهای ناشناخته یا پیام‌های ناقص رد شوند.                                                           |  1  |  D  |
| 9.4.3 | تأیید کنید که بررسی‌های تمامیت (MACها یا امضاهای دیجیتال) کل بار پیام شامل پارامترهای ابزار را پوشش می‌دهند.                                                  |  2  | D/V |
| 9.4.4 | اطمینان حاصل کنید که حفاظت در برابر پخش مجدد (nonces یا پنجره‌های زمان‌بندی) در لایه پروتکل اجرا می‌شود.                                                      |  2  |  D  |
| 9.4.5 | اطمینان حاصل کنید که پیاده‌سازی‌های پروتکل تحت فرایندهای فازینگ و تحلیل ایستا برای یافتن نقص‌های تزریق یا فرآیندهای سریال‌زدایی قرار می‌گیرند.                |  3  |  V  |

---

## 9.5 هويت عامل و شواهد تغییرناپذیری

اطمینان حاصل کنید که اقدامات قابل انتساب بوده و تغییرات قابل شناسایی باشند.

|   #   | توضیحات                                                                                                               | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.5.1 | تأیید کنید که هر نمونه عامل دارای یک هویت رمزنگاری منحصر به فرد (جفت کلید یا اعتبار سخت‌افزاری ریشه‌دار) باشد.        |  1  | D/V |
| 9.5.2 | اطمینان حاصل کنید که همه اقدامات عامل امضا شده و دارای مهر زمانی هستند؛ لاگ‌ها شامل امضا برای جلوگیری از انکار هستند. |  2  | D/V |
| 9.5.3 | تأیید کنید که لاگ‌های مقاوم در برابر تغییر در محیطی با قابلیت افزودن فقط یا نوشتن یک‌بار ذخیره شده‌اند.               |  2  |  V  |
| 9.5.4 | اطمینان حاصل کنید که کلیدهای هویت طبق یک برنامه زمان‌بندی مشخص و بر اساس شاخص‌های وقوع نفوذ چرخش می‌کنند.             |  3  |  D  |
| 9.5.5 | تأیید کنید که تلاش‌های جعل یا تداخل کلید باعث قرنطینه فوری عامل آسیب‌دیده می‌شوند.                                    |  3  | D/V |

---

## 9.6 کاهش ریسک ازدحام چندعاملی

خطرات رفتار جمعی را از طریق ایزولاسیون و مدل‌سازی رسمی ایمنی کاهش دهید.

|   #   | توضیحات                                                                                                                        | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 9.6.1 | تأیید کنید که عوامل فعال در حوزه‌های امنیتی مختلف در محیط‌های اجرای جدا شده یا بخش‌های مجزای شبکه اجرا می‌شوند.                |  1  | D/V |
| 9.6.2 | اطمینان حاصل کنید که رفتارهای ازدحامی مدل‌سازی شده و به صورت رسمی برای زنده‌بودن و ایمنی پیش از استقرار تأیید شده‌اند.         |  3  |  V  |
| 9.6.3 | تأیید کنید که نظارت‌های زمان اجرا الگوهای ناامن نوظهور (مثلاً نوسانات، بن‌بست) را شناسایی کرده و اقدام اصلاحی را آغاز می‌کنند. |  3  |  D  |

---

## 9.7 احراز هویت / مجوز کاربران و ابزارها

پیاده‌سازی کنترل‌های دسترسی قوی برای هر عملی که توسط عامل فعال می‌شود.

|   #   | توضیحات                                                                                                                                             | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.7.1 | اطمینان حاصل کنید که عوامل به عنوان اصول اول کلاس به سیستم‌های پایین‌دستی احراز هویت می‌کنند و هرگز از مدارک کاربران نهایی دوباره استفاده نمی‌کنند. |  1  | D/V |
| 9.7.2 | تأیید کنید که سیاست‌های مجوز دقیق محدود می‌کنند که یک عامل کدام ابزارها را می‌تواند فراخوانی کند و چه پارامترهایی را می‌تواند ارائه دهد.            |  2  |  D  |
| 9.7.3 | تأیید کنید که بررسی‌های مجوز در هر فراخوانی مجدداً ارزیابی شوند (مجوزدهی مداوم)، نه فقط در ابتدای جلسه.                                             |  2  |  V  |
| 9.7.4 | تأیید کنید که امتیازات واگذار شده به طور خودکار منقضی می‌شوند و پس از پایان زمان یا تغییر دامنه نیاز به موافقت مجدد دارند.                          |  3  |  D  |

---

## 9.8 امنیت ارتباط عامل به عامل

تمام پیام‌های بین عامل‌ها را رمزگذاری کرده و محافظت از صحت آن‌ها را انجام دهید تا از استراق سمع و دستکاری جلوگیری شود.

|   #   | توضیحات                                                                                                              | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.8.1 | تأیید کنید که احراز هویت دوجانبه و رمزنگاری راز-کاملاً-آینده (مانند TLS 1.3) برای کانال‌های عامل اجباری هستند.       |  1  | D/V |
| 9.8.2 | اعتبارسنجی صحت پیام و منبع آن باید قبل از پردازش انجام شود؛ در صورت عدم موفقیت، هشدارها صادر شده و پیام حذف می‌شود.  |  1  |  D  |
| 9.8.3 | تأیید کنید که فراداده‌های ارتباطی (زمان‌بندی‌ها، شماره‌های توالی) برای پشتیبانی از بازسازی پزشکی قانونی ثبت می‌شوند. |  2  | D/V |
| 9.8.4 | تأیید کنید که تأیید رسمی یا مدل‌سازی بررسی می‌کند که ماشین‌های حالت پروتکل نمی‌توانند به حالت‌های ناامن هدایت شوند.  |  3  |  V  |

---

## 9.9 تایید نیت و اعمال محدودیت‌ها

اعتبارسنجی کنید که اقدامات عامل با نیت اعلام شده کاربر و محدودیت‌های سیستم هم‌راستا باشند.

|   #   | توضیحات                                                                                                                                                                | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.9.1 | تأیید کنید که حل‌کننده‌های محدودیت پیش‌اجرا، اقدامات پیشنهادی را در برابر قوانین سخت‌کد شده ایمنی و سیاست بررسی می‌کنند.                                               |  1  |  D  |
| 9.9.2 | اطمینان حاصل کنید که اقدامات با تأثیر بالا (مالی، مخرب، حساس به حریم خصوصی) نیاز به تأیید صریح قصد از سوی کاربر آغازکننده دارند.                                       |  2  | D/V |
| 9.9.3 | اطمینان حاصل کنید که بررسی‌های پس از شرط تأیید می‌کنند که اقدامات انجام شده اثرات مورد نظر را بدون عوارض جانبی به دست آورده‌اند؛ ناهماهنگی‌ها موجب بازگردانی می‌شوند.  |  2  |  V  |
| 9.9.4 | اطمینان حاصل کنید که روش‌های رسمی (مانند بررسی مدل، اثبات قضیه) یا تست‌های مبتنی بر خصوصیت نشان دهد که برنامه‌های عامل تمامی محدودیت‌های اعلام شده را برآورده می‌کنند. |  3  |  V  |
| 9.9.5 | تأیید کنید که حوادث ناسازگاری قصد یا نقض محدودیت، چرخه‌های بهبود مستمر و اشتراک اطلاعات تهدید را تغذیه می‌کنند.                                                        |  3  |  D  |

---

## 9.10 امنیت استراتژی استدلال عامل

انتخاب و اجرای امن استراتژی‌های استدلال مختلف از جمله روش‌های ReAct، زنجیره‌ای از تفکر (Chain-of-Thought) و درختی از تفکر (Tree-of-Thoughts).

|   #    | توضیحات                                                                                                                                                                                               | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.10.1 | اطمینان حاصل کنید که انتخاب استراتژی استدلال از معیارهای قطعی (پیچیدگی ورودی، نوع کار، زمینه امنیتی) استفاده می‌کند و ورودی‌های یکسان در همان زمینه امنیتی، انتخاب‌های استراتژی یکسانی تولید می‌کنند. |  1  | D/V |
| 9.10.2 | تأیید کنید که هر استراتژی استدلال (ReAct، زنجیره‌ای از تفکر، درخت تفکر) دارای اعتبارسنجی ورودی اختصاصی، تصفیه خروجی و محدودیت‌های زمان اجرا خاص به روش شناختی خود باشد.                               |  1  | D/V |
| 9.10.3 | اطمینان حاصل کنید که تغییرات استراتژی استدلال با زمینه کامل شامل خصوصیات ورودی، مقادیر معیارهای انتخاب و متادیتای اجرا برای بازسازی مسیر حسابرسی ثبت شود.                                             |  2  | D/V |
| 9.10.4 | اطمینان حاصل کنید که استدلال درخت-فکر شامل مکانیزم‌های هرس شاخه است که کاوش را هنگام شناسایی تخلفات سیاست، محدودیت‌های منابع، یا مرزهای ایمنی متوقف می‌کنند.                                          |  2  | D/V |
| 9.10.5 | اطمینان حاصل کنید که چرخه‌های ReAct (استدلال-عمل-مشاهده) شامل نقاط بازرسی اعتبارسنجی در هر مرحله هستند: بررسی گام استدلال، مجوز اقدام، و پاکسازی مشاهده قبل از ادامه.                                 |  2  | D/V |
| 9.10.6 | تأیید کنید که معیارهای عملکرد استراتژی استدلال (زمان اجرا، استفاده از منابع، کیفیت خروجی) با هشدارهای خودکار هنگام انحراف معیارها از آستانه‌های پیکربندی شده، پایش می‌شوند.                           |  3  | D/V |
| 9.10.7 | تأیید کنید که رویکردهای استدلال هیبریدی که چندین استراتژی را ترکیب می‌کنند، اعتبارسنجی ورودی و محدودیت‌های خروجی تمام استراتژی‌های تشکیل‌دهنده را بدون دور زدن هیچ کنترل امنیتی حفظ می‌کنند.          |  3  | D/V |
| 9.10.8 | تأیید کنید که آزمایش امنیت استراتژی استدلال شامل تست فازی با ورودی‌های ناقص، پرسش‌های خصمانه طراحی شده برای مجبور کردن به تغییر استراتژی، و آزمایش شرایط مرزی برای هر رویکرد شناختی باشد.             |  3  | D/V |

---

## 9.11 مدیریت وضعیت چرخه عمر Agent و امنیت

راه‌اندازی ایمن عامل، گذارهای وضعیت، و خاتمه با مسیرهای حسابرسی رمزنگاری‌شده و روش‌های تعریف‌شده بازیابی.

|   #    | توضیحات                                                                                                                                                                                                                                                            | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 9.11.1 | اطمینان حاصل کنید که مقداردهی اولیه عامل شامل ایجاد هویت رمزنگاری شده با گواهی‌نامه‌های پشتیبانی شده توسط سخت‌افزار و لاگ‌های ممیزی راه‌اندازی غیرقابل تغییر است که شامل شناسه عامل، زمان‌بندی، هش پیکربندی و پارامترهای مقداردهی اولیه می‌باشند.                  |  1  | D/V |
| 9.11.2 | اطمینان حاصل کنید که انتقال‌های حالت عامل به صورت رمزنگاری شده امضا شده‌اند، زمان‌بندی شده‌اند و با زمینه کامل شامل رویدادهای محرک، هش حالت قبلی، هش حالت جدید و اعتبارسنجی‌های امنیتی انجام شده، ثبت شده‌اند.                                                     |  2  | D/V |
| 9.11.3 | تأیید کنید که رویه‌های خاموش‌سازی عامل شامل پاک‌سازی امن حافظه با استفاده از پاک‌سازی رمزنگاری شده یا بازنویسی چندباره، لغو اعتبارنامه‌ها همراه با اطلاع‌رسانی به مرجع صدور گواهی و تولید گواهی‌های خاتمه با قابلیت تشخیص دست‌کاری باشند.                          |  2  | D/V |
| 9.11.4 | اطمینان حاصل کنید که مکانیسم‌های بازیابی عامل، یکپارچگی وضعیت را با استفاده از چک‌سام‌های رمزنگاری شده (حداقل SHA-256) اعتبارسنجی می‌کنند و در صورت شناسایی خرابی، به وضعیت‌های سالم شناخته شده بازگردانده می‌شوند، همراه با هشدارهای خودکار و نیاز به تأیید دستی. |  3  | D/V |
| 9.11.5 | تأیید کنید که سازوکارهای پایداری عامل، داده‌های حالت حساس را با کلیدهای AES-256 مختص هر عامل رمزگذاری می‌کنند و چرخش کلید امن را بر اساس برنامه‌های قابل تنظیم (حداکثر 90 روز) با استقرار بدون توقف پیاده‌سازی می‌کنند.                                            |  3  | D/V |

---

## چارچوب امنیتی ادغام ابزار 9.12

کنترل‌های امنیتی برای بارگذاری دینامیک ابزار، اجرا و اعتبارسنجی نتایج با فرآیندهای تعریف‌شده ارزیابی ریسک و تایید.

|   #    | توضیحات                                                                                                                                                                                                                                     | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.12.1 | تأیید کنید که توصیف‌گرهای ابزار شامل متادیتای امنیتی باشند که امتیازات مورد نیاز (خواندن/نوشتن/اجرا)، سطح ریسک (کم/متوسط/زیاد)، محدودیت‌های منابع (پردازنده، حافظه، شبکه) و الزامات اعتبارسنجی ثبت شده در مانیفست‌های ابزار را مشخص می‌کند. |  1  | D/V |
| 9.12.2 | اطمینان حاصل کنید که نتایج اجرای ابزار بر اساس طرحواره‌های مورد انتظار (JSON Schema، XML Schema) و سیاست‌های امنیتی (تصحیح خروجی، طبقه‌بندی داده‌ها) قبل از ادغام، با محدودیت‌های زمان‌بندی و رویه‌های مدیریت خطا تایید می‌شوند.            |  1  | D/V |
| 9.12.3 | تأیید کنید که گزارش‌های تعامل ابزار شامل زمینه امنیتی دقیق از جمله استفاده از امتیازات، الگوهای دسترسی به داده‌ها، زمان اجرا، مصرف منابع و کدهای بازگشتی به همراه لاگ‌برداری ساختاریافته برای یکپارچه‌سازی با سیستم‌های SIEM باشد.          |  2  | D/V |
| 9.12.4 | تأیید کنید که مکانیزم‌های بارگذاری ابزارهای پویا امضاهای دیجیتال را با استفاده از زیرساخت PKI اعتبارسنجی می‌کنند و پروتکل‌های بارگذاری امن با جداسازی سندباکس و تأیید مجوزها قبل از اجرا را پیاده‌سازی می‌نمایند.                           |  2  | D/V |
| 9.12.5 | اطمینان حاصل کنید که ارزیابی‌های امنیت ابزار به‌صورت خودکار برای نسخه‌های جدید با دروازه‌های تایید اجباری شامل تحلیل ایستا، تست دینامیک، و بررسی تیم امنیتی با معیارهای تایید مستند و الزامات SLA فعال می‌شوند.                             |  3  | D/V |

---

## C9.13 پروتکل زمینه مدل (MCP) امنیت

اطمینان از کشف، تأیید هویت، مجوزدهی، انتقال و استفاده امن از ادغام‌های ابزار و منابع مبتنی بر MCP برای جلوگیری از اشتباه در زمینه، فراخوانی غیرمجاز ابزار یا افشای داده‌های بین مستاجران.

### یکپارچگی کامپوننت و بهداشت زنجیره تامین

|   #    | توضیحات                                                                                                                                                                                                                     | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.13.1 | اطمینان حاصل کنید که پیاده‌سازی‌های سرور، کلاینت و ابزار MCP به صورت دستی بررسی شده یا به طور خودکار تحلیل می‌شوند تا افشای عملکرد ناامن، تنظیمات پیش‌فرض ناایمن، عدم وجود احراز هویت یا عدم اعتبارسنجی ورودی شناسایی گردد. |  1  | D/V |
| 9.13.2 | تأیید کنید که سرورها یا بسته‌های MCP خارجی یا متن‌باز قبل از ادغام تحت اسکن خودکار آسیب‌پذیری و زنجیره تأمین (مانند SCA) قرار می‌گیرند و اجزایی که دارای آسیب‌پذیری‌های بحرانی شناخته شده هستند استفاده نمی‌شوند.           |  1  | D/V |
| 9.13.3 | اطمینان حاصل کنید که اجزای سرور و کلاینت MCP فقط از منابع مورد اعتماد دریافت شده و با استفاده از امضاها، چکسام‌ها یا متادیتای بسته امن تایید شوند و نسخه‌های دستکاری شده یا بدون امضا رد شوند.                              |  1  | D/V |

### احراز هویت و مجوزدهی

|   #    | توضیحات                                                                                                                                                                                                                                                | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 9.13.4 | اطمینان حاصل کنید که کلاینت‌ها و سرورهای MCP به صورت متقابل با استفاده از اعتبارنامه‌های قوی و غیر کاربری (مثلاً mTLS، توکن‌های امضا شده، یا شناسه‌های صادر شده توسط پلتفرم) احراز هویت می‌شوند و نقاط انتهایی MCP که احراز هویت نشده‌اند رد می‌گردند. |  2  | D/V |
| 9.13.5 | اطمینان حاصل کنید که سرورهای MCP از طریق یک مکانیزم فنی کنترل‌شده برای ورود به سیستم ثبت می‌شوند که نیازمند تعریف صریح مالک، محیط و منابع است؛ سرورهای ثبت‌نشده یا غیرقابل کشف نباید در محیط تولید قابل فراخوانی باشند.                                |  2  | D/V |
| 9.13.6 | اطمینان حاصل کنید که هر ابزار یا منبع MCP محدوده‌های مجوز صریحی را تعریف می‌کند (مثلاً فقط خواندنی، پرس‌وجوهای محدود، سطوح اثر جانبی) و اینکه نمایندگان نمی‌توانند توابع MCP را خارج از محدوده اختصاص یافته خود فراخوانی کنند.                         |  2  | D/V |

### حفاظت از انتقال ایمن و مرز شبکه

|    #    | توضیحات                                                                                                                                                                                                                                                                | سطح | نقش |
| :-----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.13.7  | اطمینان حاصل کنید که جریان قابل پخش HTTP رمزگذاری شده و تأیید شده به عنوان انتقال اصلی MCP در محیط‌های تولید استفاده می‌شود؛ انتقال‌های جایگزین (stdio، SSE) محدود به محیط‌های محلی یا کاملاً کنترل شده با توجیه صریح باشند.                                           |  2  | D/V |
| 9.13.8  | تأیید کنید که انتقال‌دهنده‌های streamable-HTTP MCP از کانال‌های احراز هویت شده و رمزگذاری‌شده (TLS 1.3 یا بالاتر) با اعتبارسنجی گواهی‌نامه و محرمانگی پیش‌رونده استفاده می‌کنند تا محرمانگی و یکپارچگی پیام‌های استریم شده MCP تضمین شود.                              |  2  | D/V |
| 9.13.9  | تأیید کنید که انتقال‌دهنده‌های MCP مبتنی بر SSE تنها در کانال‌های داخلی خصوصی و احراز هویت شده استفاده می‌شوند و TLS، احراز هویت، اعتبارسنجی ساختار داده، محدودیت اندازه بار داده و محدودیت نرخ اعمال شوند؛ نقطه‌های پایانی SSE نباید در اینترنت عمومی در دسترس باشند. |  2  | D/V |
| 9.13.10 | تأیید کنید که سرورهای MCP اعتبارسنجی می‌کنند`Origin` و`Host` هدرها را در تمامی انتقال‌های مبتنی بر HTTP (شامل SSE و HTTP قابل جریان‌دهی) قرار دهید تا از حملات بازپیوند DNS جلوگیری کنید و درخواست‌ها را از مبداهای غیرقابل اعتماد، ناسازگار یا مفقود رد کنید.         |  2  | D/V |

### طرح‌واره، پیام، و اعتبارسنجی ورودی

|    #    | توضیحات                                                                                                                                                                                                                                              | سطح | نقش |
| :-----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.13.11 | اطمینان حاصل کنید که شمای ابزار و منابع MCP (مانند شمای JSON یا توصیف‌کننده‌های قابلیت) از نظر اصالت و یکپارچگی با استفاده از امضاها، مقدارهای چک یا تاییدیه سرور صحت‌سنجی می‌شوند تا از دستکاری در شمای داده یا تغییرات مخرب پارامترها جلوگیری شود. |  2  | D/V |
| 9.13.12 | تأیید کنید که تمام انتقال‌های MCP یکپارچگی قاب‌بندی پیام، اعتبارسنجی سختگیرانه ساختار، حداکثر اندازه‌های بار مفید و رد قاب‌های ناقص، کوتاه‌شده یا درهم‌تنیده شده را برای جلوگیری از حملات ناهماهنگی یا تزریق اعمال می‌کنند.                          |  2  | D/V |
| 9.13.13 | اطمینان حاصل کنید که سرورهای MCP برای تمام فراخوانی‌های تابع، اعتبارسنجی ورودی سختگیرانه‌ای انجام می‌دهند، از جمله بررسی نوع، بررسی محدوده، اجرای شمارش‌شده و رد پارامترهای ناشناخته یا بیش‌ازحد بزرگ.                                               |  2  | D/V |

### دسترسی خروجی و ایمنی اجرای عامل

|    #    | توضیحات                                                                                                                                                                                                                                        | سطح | نقش |
| :-----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.13.14 | تأیید کنید که سرورهای MCP تنها می‌توانند درخواست‌های خروجی را به مقاصد داخلی یا خارجی تایید شده و مطابق با سیاست‌های خروجی با کمترین سطح دسترسی ارسال کنند، و نمی‌توانند به اهداف شبکه دلخواه یا خدمات متادیتای ابری داخلی دسترسی داشته باشند. |  2  | D/V |
| 9.13.15 | اطمینان حاصل کنید که اقدامات MCP خروجی محدودیت‌های اجرا (مهلت‌ها، محدودیت‌های بازگشتی، سقف‌های همزمانی، قطع‌کننده‌های مدار) را اعمال می‌کنند تا از فراخوانی نامحدود ابزارهای هدایت‌شده توسط عامل یا اثرات جانبی زنجیره‌ای جلوگیری شود.         |  2  | D/V |
| 9.13.16 | تأیید کنید که فراداده‌های درخواست و پاسخ MCP (شناسه سرور، نام منبع، نام ابزار، شناسه جلسه، مستأجر، محیط) با حفاظت از صحت ثبت شده و برای تحلیل حقوقی با فعالیت عامل همبسته باشند.                                                               |  2  | D/V |

### محدودیت‌های حمل‌ونقل و کنترل‌های مرزی با ریسک بالا

|    #    | توضیحات                                                                                                                                                                                                                           | سطح | نقش |
| :-----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.13.17 | تأیید کنید که انتقال‌دهنده‌های MCP مبتنی بر stdio محدود به سناریوهای توسعه هم‌مکان و تک‌فرآیندی باشند، جدا شده از اجرای شل، تزریق ترمینال و قابلیت‌های راه‌اندازی فرآیند؛ stdio نباید هرگز از مرزهای شبکه یا چندمستأجره عبور کند. |  3  | D/V |
| 9.13.18 | اطمینان حاصل کنید که سرورهای MCP تنها توابع و منابع مجاز را در دسترس قرار می‌دهند و اجرای دینامیک، فراخوانی بازتابی، یا اجرای نام توابعی که تحت تأثیر ورودی‌های کاربر یا مدل قرار دارند را ممنوع می‌کنند.                         |  3  | D/V |
| 9.13.19 | تأیید کنید که مرزهای مستاجر، مرزهای محیط (توسعه/آزمایش/تولید) و مرزهای دامنه داده در لایه MCP اعمال می‌شوند، به‌طوری که از کشف سرور یا منابع میان مستاجرها یا محیط‌های مختلف جلوگیری شود.                                         |  3  | D/V |

---

### مراجع

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)
* [Model Context Protocol Specification](https://modelcontextprotocol.io)
* [Model Context Protocol Tools & Resources Specification](https://modelcontextprotocol.io/specification/2025-06-18/basic)
* [Model Context Protocol Transport Documentation](https://modelcontextprotocol.io/specification/2025-06-18/basic/transports)
* [OWASP GenAI Security Project — “A Practical Guide for Securely Using Third-Party MCP Servers 1.0”](https://genai.owasp.org/resource/cheatsheet-a-practical-guide-for-securely-using-third-party-mcp-servers-1-0/)
* [Cloud Security Alliance – Model Context Protocol Security Working Group](https://modelcontextprotocol-security.io)
* [CSA MCP Security: Top 10 Risks](https://modelcontextprotocol-security.io/top10/)
* [CSA MCP Security: TTPs & Hardening Guidance](https://modelcontextprotocol-security.io/ttps/)


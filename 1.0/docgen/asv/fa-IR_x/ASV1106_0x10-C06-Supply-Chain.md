# امنیت زنجیره تأمین C6 برای مدل‌ها، فریم‌ورک‌ها و داده‌ها

## هدف کنترل

حملات زنجیره تأمین هوش مصنوعی از مدل‌ها، چارچوب‌ها یا مجموعه داده‌های شخص ثالث سوءاستفاده می‌کنند تا درها پشتی، تورش یا کد قابل بهره‌برداری را در آنها قرار دهند. این کنترل‌ها امکان ردیابی از ابتدا تا انتها، مدیریت آسیب‌پذیری و نظارت را برای محافظت از کل چرخه عمر مدل فراهم می‌کنند.

---

## C6.1 ارزیابی مدل پیش‌آموزش‌دیده و یکپارچگی منشأ

قبل از هرگونه تنظیم دقیق یا استقرار، منشأ، مجوزها و رفتارهای پنهان مدل‌های شخص ثالث را ارزیابی و تأیید کنید.

|   #   | توضیحات                                                                                                                                    | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 6.1.1 | اطمینان حاصل کنید که هر اثر مدل شخص ثالث شامل یک رکورد مبدا امضا شده باشد که مخزن منبع و هش کامیت را شناسایی می‌کند.                       |  1  | D/V |
| 6.1.2 | اطمینان حاصل کنید که مدل‌ها قبل از وارد کردن، با استفاده از ابزارهای خودکار برای لایه‌های مخرب یا محرک‌های تروجان بررسی شده باشند.         |  1  | D/V |
| 6.1.3 | تأیید کنید که تنظیم دقیق آموزش انتقالی از ارزیابی خصمانه عبور می‌کند تا رفتارهای پنهان را شناسایی کند.                                     |  2  |  D  |
| 6.1.4 | اطمینان حاصل کنید که مجوزهای مدل، برچسب‌های کنترل صادرات و بیانیه‌های منبع داده در یک ورودی ML‑BOM ثبت شده‌اند.                            |  2  |  V  |
| 6.1.5 | اطمینان حاصل کنید که مدل‌های پرخطر (وزن‌های بارگذاری‌شده عمومی، سازندگان تاییدنشده) تا زمان بازبینی و تایید انسانی در قرنطینه باقی بمانند. |  3  | D/V |

---

## C6.2 اسکن چارچوب و کتابخانه

به‌طور مداوم چارچوب‌ها و کتابخانه‌های یادگیری ماشینی را برای یافتن CVEها و کدهای مخرب اسکن کنید تا پشته زمان اجرا ایمن باقی بماند.

|   #   | توضیحات                                                                                                                                      | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.2.1 | تأیید کنید که خط‌های لوله CI اسکنرهای وابستگی را روی چارچوب‌های هوش مصنوعی و کتابخانه‌های حیاتی اجرا می‌کنند.                                |  1  | D/V |
| 6.2.2 | اطمینان حاصل کنید که آسیب‌پذیری‌های بحرانی (CVSS ≥ 7.0) مانع ارتقاء به تصاویر تولید می‌شوند.                                                 |  1  | D/V |
| 6.2.3 | اعتبارسنجی کنید که تحلیل استاتیک کد بر روی کتابخانه‌های ML منشعب شده یا وارد شده اجرا شود.                                                   |  2  |  D  |
| 6.2.4 | اطمینان حاصل کنید که پیشنهادات ارتقاء فریم‌ورک شامل ارزیابی تأثیر امنیتی با ارجاع به منابع عمومی CVE باشند.                                  |  2  |  V  |
| 6.2.5 | اطمینان حاصل کنید که حسگرهای زمان اجرا در مورد بارگذاری‌های غیرمنتظره کتابخانه‌های دینامیکی که از SBOM امضا شده انحراف دارند، هشدار می‌دهند. |  3  |  V  |

---

## C6.3 پین کردن و تأیید وابستگی‌ها

هر وابستگی را به هش‌های غیرقابل تغییر قفل کنید و ساخت‌ها را بازتولید کنید تا تضمین شود که مصنوعات دقیقاً مشابه و بدون تغییر باقی می‌مانند.

|   #   | توضیحات                                                                                                                       | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.3.1 | تأیید کنید که همه مدیران بسته نسخه‌ها را از طریق فایل‌های قفل شده محدود می‌کنند.                                              |  1  | D/V |
| 6.3.2 | اطمینان حاصل کنید که در ارجاعات کانتینر از هش‌های غیرقابل تغییر به جای برچسب‌های قابل تغییر استفاده شده است.                  |  1  | D/V |
| 6.3.3 | تأیید کنید که بررسی‌های ساخت قابل تکرار، هش‌ها را در اجرای CI مقایسه می‌کنند تا خروجی‌های یکسان تضمین شود.                    |  2  |  D  |
| 6.3.4 | اطمینان حاصل کنید که تأییدیه‌های ساخت به مدت 18 ماه برای ردیابی حسابرسی ذخیره می‌شوند.                                        |  2  |  V  |
| 6.3.5 | اطمینان حاصل کنید که وابستگی‌های منقضی شده، درخواست‌های کشش خودکار برای به‌روزرسانی یا فورک نسخه‌های پین شده را فعال می‌کنند. |  3  |  D  |

---

## C6.4 اجرای منبع مورد اعتماد

دانلود آثار فقط از منابع سازمانی تایید شده با گواهی‌های رمزنگاری شده را مجاز کنید و همه موارد دیگر را مسدود نمایید.

|   #   | توضیحات                                                                                                               | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.4.1 | تأیید کنید که وزن‌های مدل، مجموعه‌های داده، و کانتینرها تنها از دامنه‌های تأیید شده یا رجیستری‌های داخلی دانلود شوند. |  1  | D/V |
| 6.4.2 | اطمینان حاصل کنید که امضاهای Sigstore/Cosign هویت ناشر را قبل از ذخیره محلی آثار تایید می‌کنند.                       |  1  | D/V |
| 6.4.3 | تأیید کنید که پراکسی‌های خروجی دانلودهای غیرمجاز مصنوعات را مسدود می‌کنند تا سیاست منبع مورد اعتماد را اجرا کنند.     |  2  |  D  |
| 6.4.4 | تأیید کنید که فهرست‌های مجاز مخزن به صورت فصلی بررسی می‌شوند و شواهدی از توجیه کسب‌وکار برای هر ورودی موجود است.      |  2  |  V  |
| 6.4.5 | تأیید کنید که نقض سیاست‌ها باعث قرنطینه شدن مصنوعات و بازگردانی اجرای خطوط لوله وابسته می‌شود.                        |  3  |  V  |

---

## C6.5 ارزیابی ریسک داده‌های شخص ثالث

داده‌های خارجی را از نظر آلودگی، تعصب و تطابق قانونی ارزیابی کرده و در طول چرخه عمر آنها را نظارت کنید.

|   #   | توضیحات                                                                                                                           | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.5.1 | اطمینان حاصل کنید که داده‌های خارجی تحت ارزیابی ریسک مسمومیت قرار می‌گیرند (مثلاً انگشت‌نگاری داده‌ها، شناسایی داده‌های ناهنجار). |  1  | D/V |
| 6.5.2 | اطمینان حاصل کنید که معیارهای تعصب (برابری جمعیتی، فرصت برابر) قبل از تایید داده‌ها محاسبه می‌شوند.                               |  1  |  D  |
| 6.5.3 | اطمینان حاصل کنید که منبع، سیر تکامل و شرایط مجوز برای مجموعه داده‌ها در ورودی‌های ML‑BOM ثبت شده‌اند.                            |  2  |  V  |
| 6.5.4 | اطمینان حاصل کنید که پایش دوره‌ای تغییر یا فساد در داده‌های میزبانی شده را شناسایی می‌کند.                                        |  2  |  V  |
| 6.5.5 | تأیید کنید که محتوای غیرمجاز (حق تألیف، اطلاعات شخصی شناسایی‌شده) از طریق پاک‌سازی خودکار قبل از آموزش حذف شده باشد.              |  3  |  D  |

---

## نظارت بر حملات زنجیره تامین C6.6

تهدیدات زنجیره تامین را از طریق خوراک‌های CVE، تحلیل‌های گزارش حسابرسی، و شبیه‌سازی‌های تیم قرمز به‌صورت زودهنگام شناسایی کنید.

|   #   | توضیحات                                                                                                                                                      | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 6.6.1 | تأیید کنید که گزارش‌های ممیزی CI/CD به سیستم‌های SIEM جریان می‌یابند تا شناسایی‌های مربوط به برداشت‌های غیرعادی بسته‌ها یا مراحل ساخت تغییر یافته انجام شود. |  1  |  V  |
| 6.6.2 | تأیید کنید که کتابچه‌های پاسخ به حادثه شامل رویه‌های بازگردانی برای مدل‌ها یا کتابخانه‌های به خطر افتاده باشد.                                               |  2  |  D  |
| 6.6.3 | اطمینان حاصل کنید که برچسب‌های غنی‌سازی اطلاعات تهدید، شاخص‌های خاص ML (مانند IoCهای مربوط به مسموم‌سازی مدل) را در دسته‌بندی هشدارها اضافه می‌کنند.         |  3  |  V  |

---

## C6.7 فهرست مواد یادگیری ماشین (ML-BOM) برای مصنوعات مدل

تولید و امضای SBOMهای خاص یادگیری ماشین با جزئیات کامل (ML‑BOMها) به طوری که مصرف‌کنندگان بعدی بتوانند صحت اجزا را در زمان استقرار تأیید کنند.

|   #   | توضیحات                                                                                                                                            | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.7.1 | اطمینان حاصل کنید که هر مدل آرتیفکت یک ML‑BOM منتشر می‌کند که شامل لیست داده‌ها، وزن‌ها، هایپرپارامترها و مجوزها است.                              |  1  | D/V |
| 6.7.2 | تأیید کنید که تولید ML‑BOM و امضای Cosign به صورت خودکار در CI انجام می‌شود و این موارد برای ادغام ضروری هستند.                                    |  1  | D/V |
| 6.7.3 | تأیید کنید که بررسی‌های کامل بودن ML‑BOM در صورتی که هر قطعه‌ای از فراداده مؤلفه‌ها (هش، مجوز) ناقص باشد، ساخت را با شکست مواجه می‌کند.            |  2  |  D  |
| 6.7.4 | اطمینان حاصل کنید که مصرف‌کنندگان پایین‌دست می‌توانند از طریق API پرس‌وجوی ML-BOMها را برای اعتبارسنجی مدل‌های واردشده در زمان استقرار انجام دهند. |  2  |  V  |
| 6.7.5 | اطمینان حاصل کنید که لیست مواد یادگیری ماشین (ML-BOMs) کنترل نسخه شده و برای شناسایی تغییرات غیرمجاز مورد بررسی قرار می‌گیرند.                     |  3  |  V  |

---

## مراجع

* [OWASP LLM03:2025 Supply Chain](https://genai.owasp.org/llmrisk/llm032025-supply-chain/)
* [MITRE ATLAS : Supply Chain Compromise](https://atlas.mitre.org/techniques/AML.T0010)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)


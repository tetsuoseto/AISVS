# C3 モデルライフサイクル管理と変更管理

## 制御目標

AIシステムは、許可されていないまたは安全でないモデルの変更が本番環境に到達するのを防ぐ変更管理プロセスを実装しなければなりません。この制御により、開発から展開、廃止までの全ライフサイクルを通じてモデルの整合性が確保され、迅速なインシデント対応が可能となり、すべての変更に対する責任が維持されます。

コアセキュリティ目標：整合性、追跡可能性、および回復可能性を維持する管理されたプロセスを採用することで、認可され検証されたモデルのみが本番環境に到達すること。

---

## C3.1 モデル認証と整合性

検証済みの完全性を持つ認可モデルのみが本番環境に到達します。

|   #   | 説明                                                                                                                                                                      | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 3.1.1 | すべてのモデルアーティファクト（重み、設定、トークナイザー、ベースモデル、ファインチューン、LoRAなどのアダプター、安全性・ポリシーモデル）が、認可された関係者によって暗号的に署名されており、デプロイメント時（およびロード時）に検証され、署名がないか改ざんされたアーティファクトをブロックすることを確認してください。         |  1  | D/V |
| 3.1.2 | 依存関係の追跡がモデルレジストリおよび系統・依存関係グラフを通じてリアルタイムのインベントリを維持し、環境ごと（例：開発、ステージング、本番、リージョン）にすべての利用サービスやエージェントの識別を可能にする機械可読なモデル/AI部品表（MBOM/AIBOM）（例：SPDXまたはCycloneDX）を生成することを検証してください。 |  2  |  V  |
| 3.1.3 | モデル起源の完全性と追跡記録に、権限を持つ組織の識別情報、トレーニングデータのチェックサム、合否判定付きの検証テスト結果、署名のフィンガープリント／証明書チェーンID、作成タイムスタンプ、および承認された展開環境が含まれていることを確認してください。                                           |  3  | D/V |

---

## C3.2 モデル検証およびテスト

モデルは展開前に定義されたセキュリティおよび安全性の検証をクリアしなければなりません。

|   #   | 説明                                                                                                                                                                                          | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 3.2.1 | モデルが展開前に、エージェントのワークフロー（計画、ツールまたはMCP呼び出し、RAG/メモリ、マルチモーダル）およびガードレール（ポリシー/安全モデルまたは検出サービス）を対象とし、バージョン管理された評価ハーネスを用いて、入力検証、出力サニタイズ、安全性評価を含む自動化されたセキュリティテストを受け、組織で事前に合意された合否基準を満たしていることを確認してください。 |  1  | D/V |
| 3.2.2 | すべてのモデル変更（展開、構成、廃止）が、タイムスタンプ、認証された実行者の識別、変更タイプ、および変更前後の状態を含む不変の監査記録を生成し、トレースメタデータ（環境および利用サービス/エージェント）およびモデル識別子（バージョン/ダイジェスト/署名）を含むことを検証してください。                                              |  1  |  V  |
| 3.2.3 | 検証失敗が、文書化されたビジネス上の正当な理由を持つ事前指定された権限者からの明示的な上書き承認なしに、自動的にモデルの展開をブロックすることを確認してください。                                                                                                           |  2  | D/V |

---

## C3.3 制御された展開とロールバック

モデルのデプロイメントは管理され、監視され、元に戻せるものでなければなりません。

|   #   | 説明                                                                                                                                                     | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 3.3.1 | 展開プロセスがモデルの起動または読み込み前に暗号署名を検証し、整合性チェックサムを計算することを確認し、不一致があった場合は展開を失敗させること。                                                                              |  1  | D/V |
| 3.3.2 | 本番環境へのデプロイメントが、事前合意されたエラー率、レイテンシ閾値、ガードレール／ジェイルブレイクアラート、またはツール／MCPの障害率に基づく自動ロールバックトリガーを備えた段階的ロールアウトメカニズム（カナリアデプロイメント、ブルーグリーンデプロイメント）を実装していることを確認してください。 |  1  |  D  |
| 3.3.3 | ロールバック機能がモデルの完全な状態（重み、設定、アダプターやセーフティ/ポリシーモデルを含む依存関係）を原子的に復元することを検証してください。                                                                              |  2  | D/V |
| 3.3.4 | 緊急モデルシャットダウン機能が、モデルエンドポイントを無効化し、エージェントツールまたはMCPアクセス、RAG/コネクター、およびデータベース/API認証情報、メモリーストアのバインディングをあらかじめ定められた応答時間内に非アクティブ化できることを検証してください。                 |  3  | D/V |

---

## C3.4 セキュア開発プラクティス

モデルの開発およびトレーニングプロセスは、侵害を防ぐために安全な手順に従う必要があります。

|   #   | 説明                                                                                                                                                                   | レベル | 役割  |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 3.4.1 | モデル開発、テスト、本番環境が物理的または論理的に分離されていることを確認してください。これらの環境は共有インフラストラクチャを持たず、アクセス制御が異なり、データストアが分離されていること、さらにエージェントのオーケストレーションやツールおよび MCP サーバーも分離されていることを確認してください。             |  1  | D/V |
| 3.4.2 | モデル開発の成果物（ハイパーパラメータ、トレーニングスクリプト、構成ファイル、プロンプトテンプレート、エージェントポリシー／ルーティンググラフ、ツールまたはMCP契約／スキーマ、およびアクションカタログや能力許可リスト）がバージョン管理に保存され、トレーニングで使用する前にピアレビューの承認が必要であることを確認してください。 |  1  |  D  |
| 3.4.3 | モデルのトレーニングおよびファインチューニングが、送信許可リストを使用した制御されたネットワークアクセスのある隔離環境で行われ、本番ツールやMCPリソースへのアクセスがないことを確認してください。                                                                   |  2  | D/V |
| 3.4.4 | トレーニングデータソースが、モデル開発に使用される前に、整合性チェックによって検証され、信頼できるソースを通じて認証されていることを確認してください。これには、RAGインデックス、ツールログ、ファインチューニングに使用されるエージェント生成データが含まれ、すべて文書化された管理履歴を伴う必要があります。             |  2  |  D  |

---

## C3.5モデルの引退と廃止

モデルは、もはや必要でなくなった場合やセキュリティ問題が特定された場合に、安全に廃止されなければなりません。

|   #   | 説明                                                                                                                                                                                                | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 3.5.1 | 退役したモデルのアーティファクト（アダプターやセーフティ／ポリシーモデルを含む）が、安全な暗号消去を用いて確実に消去されていることを検証してください。                                                                                                                       |  1  | D/V |
| 3.5.2 | モデルの廃止イベントがタイムスタンプとアクターの識別情報、モデル識別子（バージョン/ダイジェスト/署名）、およびトレースメタデータ（環境および利用サービス/エージェント）とともにログ記録されていることを検証してください。モデル署名は取り消され、レジストリ/サービングの拒否リストおよびローダーキャッシュの無効化により、エージェントが廃止されたアーティファクトをロードするのを防止します。 |  2  |  V  |

---

## 参考文献

* [MITRE ATLAS](https://atlas.mitre.org/)
* [MLOps Principles](https://ml-ops.org/content/mlops-principles)
* [Reinforcement fine-tuning](https://platform.openai.com/docs/guides/reinforcement-fine-tuning)
* [What is AI adversarial robustness? – IBM Research](https://research.ibm.com/blog/securing-ai-workflows-with-adversarial-robustness)


# C6 モデル、フレームワーク、およびデータのサプライチェーンセキュリティ

## 制御目標

AIサプライチェーン攻撃は、サードパーティのモデル、フレームワーク、またはデータセットを悪用して、バックドア、バイアス、または悪用可能なコードを埋め込みます。これらの制御は、エンドツーエンドのトレーサビリティ、脆弱性管理、および監視を提供し、モデルのライフサイクル全体を保護します。

---

## C6.1 事前学習済みモデルの審査および起源の完全性

サードパーティーモデルの起源、ライセンス、および隠れた挙動を、ファインチューニングや展開の前に評価および認証してください。

|   #   | 説明                                                                            | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------- | :-: | :-: |
| 6.1.1 | すべてのサードパーティモデルアーティファクトに、ソースリポジトリとコミットハッシュを特定する署名済みオリジンレコードが含まれていることを確認してください。 |  1  | D/V |
| 6.1.2 | モデルがインポートされる前に、自動化ツールを使用して悪意のあるレイヤーやトロイの木馬のトリガーがスキャンされていることを確認してください。         |  1  | D/V |
| 6.1.3 | 転移学習によるファインチューニングが、隠れた挙動を検出するための敵対的評価に合格することを検証する。                            |  2  |  D  |
| 6.1.4 | モデルのライセンス、輸出管理タグ、およびデータ出所の声明がML-BOMエントリに記録されていることを確認してください。                   |  2  |  V  |
| 6.1.5 | 高リスクモデル（公開アップロードされた重み、未検証の作成者）は、人間によるレビューと承認があるまで隔離されたままであることを確認してください。       |  3  | D/V |

---

## C6.2 フレームワーク＆ライブラリスキャンニング

ランタイムスタックの安全を保つために、MLフレームワークやライブラリのCVEおよび悪意のあるコードを継続的にスキャンします。

|   #   | 説明                                                                  | レベル | 役割  |
| :---: | ------------------------------------------------------------------- | :-: | :-: |
| 6.2.1 | CIパイプラインがAIフレームワークおよび重要なライブラリの依存関係スキャナーを実行することを確認してください。            |  1  | D/V |
| 6.2.2 | 重要な脆弱性（CVSS ≥ 7.0）が本番用イメージへのプロモーションをブロックすることを確認してください。              |  1  | D/V |
| 6.2.3 | フォークされたまたはベンダリングされたMLライブラリで静的コード解析が実行されることを確認してください。                |  2  |  D  |
| 6.2.4 | フレームワークのアップグレード提案に、公的なCVEフィードを参照したセキュリティ影響評価が含まれていることを確認してください。     |  2  |  V  |
| 6.2.5 | 署名されたSBOMから逸脱した予期しない動的ライブラリの読み込みに対して、ランタイムセンサーがアラートを発することを検証してください。 |  3  |  V  |

---

## C6.3 依存関係の固定と検証

すべての依存関係を不変のダイジェストに固定し、ビルドを再現して同一で改ざんされていない成果物を保証します。

|   #   | 説明                                                      | レベル | 役割  |
| :---: | ------------------------------------------------------- | :-: | :-: |
| 6.3.1 | すべてのパッケージマネージャがロックファイルを介してバージョン固定を強制していることを確認してください。    |  1  | D/V |
| 6.3.2 | コンテナ参照において、可変タグの代わりに不変のダイジェストが使用されていることを検証してください。       |  1  | D/V |
| 6.3.3 | 再現可能ビルドチェックが、同一の出力を保証するためにCI実行間でハッシュを比較していることを検証してください。 |  2  |  D  |
| 6.3.4 | 監査のトレーサビリティのために、ビルド証明書が18ヶ月間保存されていることを確認してください。         |  2  |  V  |
| 6.3.5 | 期限切れの依存関係が、自動プルリクエストの作成や固定バージョンのフォークを引き起こすことを確認してください。  |  3  |  D  |

---

## C6.4 信頼できるソースの強制措置

暗号学的に検証された、組織が承認したソースからのみアーティファクトのダウンロードを許可し、それ以外はすべてブロックします。

|   #   | 説明                                                                       | レベル | 役割  |
| :---: | ------------------------------------------------------------------------ | :-: | :-: |
| 6.4.1 | モデルの重み、データセット、およびコンテナが承認されたドメインまたは内部レジストリからのみダウンロードされることを確認してください。       |  1  | D/V |
| 6.4.2 | Sigstore/Cosignの署名がアーティファクトをローカルにキャッシュする前に、公開者の身元を検証することを確認してください。       |  1  | D/V |
| 6.4.3 | 信頼されたソースポリシーを適用するために、出口プロキシが認証されていないアーティファクトのダウンロードをブロックしていることを確認してください。 |  2  |  D  |
| 6.4.4 | リポジトリのホワイトリストが四半期ごとにレビューされており、各エントリーに対するビジネス上の正当性の証拠があることを確認してください。      |  2  |  V  |
| 6.4.5 | ポリシー違反がアーティファクトの隔離および依存するパイプラインのロールバックをトリガーすることを確認してください。                |  3  |  V  |

---

## C6.5 サードパーティデータセットリスク評価

外部データセットを毒性、バイアス、法的コンプライアンスの観点から評価し、そのライフサイクルを通じて監視する。

|   #   | 説明                                                                  | レベル | 役割  |
| :---: | ------------------------------------------------------------------- | :-: | :-: |
| 6.5.1 | 外部データセットがポイズニングリスクスコアリング（例：データフィンガープリンティング、外れ値検出）を受けていることを検証してください。 |  1  | D/V |
| 6.5.2 | バイアスメトリクス（人口統計的パリティ、平等機会）がデータセット承認前に計算されていることを確認してください。             |  1  |  D  |
| 6.5.3 | データセットの出所、系統、およびライセンス条件がML‑BOMエントリに記録されていることを確認してください。              |  2  |  V  |
| 6.5.4 | 定期的なモニタリングがホストされたデータセットのドリフトや破損を検出することを確認する。                        |  2  |  V  |
| 6.5.5 | トレーニング前に、自動スクラビングによって許可されていないコンテンツ（著作権、個人識別情報）が削除されていることを確認してください。  |  3  |  D  |

---

## C6.6 サプライチェーン攻撃モニタリング

CVEフィード、監査ログ分析、レッドチームシミュレーションを通じて、サプライチェーンの脅威を早期に検出します。

|   #   | 説明                                                                       | レベル | 役割  |
| :---: | ------------------------------------------------------------------------ | :-: | :-: |
| 6.6.1 | CI/CDの監査ログが、異常なパッケージプルや改ざんされたビルドステップの検出のためにSIEMにストリーミングされていることを検証してください。 |  1  |  V  |
| 6.6.2 | インシデント対応プレイブックに、侵害されたモデルやライブラリのロールバック手順が含まれていることを確認してください。               |  2  |  D  |
| 6.6.3 | アラートトリアージにおいて、脅威インテリジェンスの強化がML特有の指標（例：モデル汚染のIoC）をタグ付けしていることを検証する。        |  3  |  V  |

---

## C6.7 モデルアーティファクトのための ML-BOM

詳細なML特化型SBOM（ML-BOM）を生成および署名し、下流の利用者が展開時にコンポーネントの整合性を検証できるようにします。

|   #   | 説明                                                                            | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------- | :-: | :-: |
| 6.7.1 | すべてのモデルアーティファクトが、データセット、重み、ハイパーパラメータ、およびライセンスを一覧表示するML-BOMを公開していることを確認してください。 |  1  | D/V |
| 6.7.2 | ML‑BOMの生成とCosign署名がCIで自動化されており、マージに必須であることを確認してください。                          |  1  | D/V |
| 6.7.3 | ML‑BOMの完全性チェックが、コンポーネントのメタデータ（ハッシュ、ライセンス）が欠落している場合にビルドを失敗させることを確認してください。      |  2  |  D  |
| 6.7.4 | ダウンストリームの利用者が API を介して ML-BOM をクエリし、デプロイ時にインポートされたモデルを検証できることを確認してください。       |  2  |  V  |
| 6.7.5 | ML-BOMがバージョン管理されており、不正な変更を検出するために差分が確認されていることを検証してください。                       |  3  |  V  |

---

## 参考文献

* [OWASP LLM03:2025 Supply Chain](https://genai.owasp.org/llmrisk/llm032025-supply-chain/)
* [MITRE ATLAS : Supply Chain Compromise](https://atlas.mitre.org/techniques/AML.T0010)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)


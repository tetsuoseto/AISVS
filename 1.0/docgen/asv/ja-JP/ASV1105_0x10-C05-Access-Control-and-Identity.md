# AIコンポーネントおよびユーザーのためのC5アクセス制御とアイデンティティ管理

## 制御目標

AIシステムの効果的なアクセス制御には、堅牢なアイデンティティ管理、コンテキストに基づく認可、およびゼロトラスト原則に従った実行時の強制が必要です。これらの制御は、人間、サービス、自律エージェントが明示的に許可された範囲内のモデル、データ、および計算リソースとだけやり取りし、継続的な検証と監査機能を備えることを保証します。

---

## C5.1 アイデンティティ管理と認証

多要素認証を用いて、すべてのエンティティに対して暗号学的に裏付けられたIDを確立する。

|   #   | 説明                                                                                                         | レベル | 役割  |
| :---: | ---------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | すべての人間のユーザーおよびサービスプリンシパルが、OIDCおよび/またはSAMLプロトコルを使用して中央集約されたエンタープライズアイデンティティプロバイダー（IdP）を介して認証されることを確認してください。 |  1  | D/V |
| 5.1.2 | 高リスク操作（モデルのデプロイ、重みのエクスポート、トレーニングデータへのアクセス、本番環境の構成変更）が、多要素認証またはセッション再検証を伴うステップアップ認証を必要とすることを確認してください。       |  1  | D/V |
| 5.1.3 | フェデレーテッドAIエージェントが、最大有効期間24時間の署名付きJWTアサーションを介して認証され、かつ発信元の暗号学的証明を含んでいることを確認します。                             |  3  | D/V |

---

## C5.2 認可とポリシー

すべてのAIリソースに対して、明確な許可モデルと監査証跡を備えたアクセス制御を実装してください。

|   #   | 説明                                                                                                                            | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | すべてのAIリソース（データセット、モデル、エンドポイント、ベクターコレクション、埋め込みインデックス、コンピュートインスタンス）が、明示的な許可リストおよびデフォルト拒否ポリシーを用いたロールベースアクセス制御を実施していることを検証してください。 |  1  | D/V |
| 5.2.2 | すべてのアクセス制御の変更が、タイムスタンプ、実行者の識別情報、リソース識別子、および許可の変更内容とともに不変的に記録されていることを確認してください。                                                 |  1  |  V  |
| 5.2.3 | データ分類ラベル（PII、PHI、プロプライエタリなど）が派生リソース（埋め込み、プロンプトキャッシュ、モデル出力）に自動的に伝播されることを検証してください。                                              |  2  |  D  |
| 5.2.4 | 不正アクセスの試みや権限昇格イベントが、文脈メタデータ付きのリアルタイムアラートをトリガーすることを確認してください。                                                                   |  2  | D/V |
| 5.2.5 | 認証決定が専用のポリシーエンジン（OPA、Cedar、または同等のもの）に外部化されていることを確認してください。                                                                     |  1  | D/V |
| 5.2.6 | ポリシーが、ユーザーの役割やグループ、リソースの分類、リクエストのコンテキスト、テナントの分離、時間的制約などの動的属性を実行時に評価することを確認してください。                                             |  1  | D/V |
| 5.2.7 | 高感度リソースについてはポリシーキャッシュのTTL（有効期限）が5分を超えないこと、標準リソースについてはキャッシュ無効化機能を備え、TTLが1時間を超えないことを確認してください。                                   |  3  | D/V |

---

## C5.3 クエリ時のセキュリティ強制

必須フィルタリングおよび行レベルセキュリティポリシーを使用して、データベース層のセキュリティコントロールを実装します。

|   #   | 説明                                                                                                     | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.3.1 | すべてのベクターデータベースおよびSQLクエリに、データベースエンジンレベルで強制される必須のセキュリティフィルター（テナントID、機微ラベル、ユーザースコープ）が含まれていることを検証してください。   |  1  | D/V |
| 5.3.2 | すべてのベクターデータベース、検索インデックス、およびトレーニングデータセットに対して、ポリシー継承を伴う行レベルセキュリティポリシーとフィールドレベルマスキングが有効になっていることを確認してください。 |  1  | D/V |
| 5.3.3 | 失敗した認証評価が直ちにクエリを中止し、明確な認証エラーコードを返すことを検証してください。                                                         |  2  |  D  |
| 5.3.4 | クエリのリトライメカニズムが、アクティブなユーザーセッション内での動的な権限変更を考慮して認可ポリシーを再評価することを検証してください。                                  |  3  | D/V |

---

## C5.4 出力フィルタリングとデータ損失防止

AI生成コンテンツにおける不正なデータ露出を防ぐために、ポストプロセス制御を展開します。

|   #   | 説明                                                                                            | レベル | 役割  |
| :---: | --------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | 推論後のフィルタリング機構が、要求者にコンテンツを提供する前に、不正な個人識別情報（PII）、機密情報、および専有データを検出して削除することを確認してください。             |  1  | D/V |
| 5.4.2 | モデル出力内の引用、参考文献、および情報源の帰属が、呼び出し元の権限と照合され、無許可のアクセスが検出された場合は削除されることを検証してください。                    |  1  | D/V |
| 5.4.3 | ユーザーの許可レベルおよびデータ分類に基づいて、出力形式の制限（サニタイズされたPDF、メタデータを削除した画像、承認されたファイルタイプ）が適切に適用されていることを検証してください。 |  2  |  D  |

---

## C5.5 マルチテナント分離

共有AIインフラストラクチャにおいて、テナント間の暗号的および論理的分離を確保する。

|   #   | 説明                                                                                                      | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.5.1 | メモリースペース、埋め込みストア、キャッシュエントリ、および一時ファイルがテナントごとに名前空間で分離されていることを検証し、テナントの削除またはセッションの終了時に安全に消去されることを確認してください。 |  1  | D/V |
| 5.5.2 | すべてのAPIリクエストが、セッションコンテキストおよびユーザー権限に対して暗号的に検証された認証済みテナント識別子を含んでいることを確認してください。                            |  1  | D/V |
| 5.5.3 | サービスメッシュおよびコンテナオーケストレーションプラットフォーム内でのクロステナント通信に対し、ネットワークポリシーがデフォルト拒否ルールを実装していることを検証してください。               |  2  |  D  |
| 5.5.4 | 顧客管理キー（CMK）サポートを備えた各テナントごとに暗号化キーが一意であること、ならびにテナントデータストア間での暗号的分離が確保されていることを検証してください。                     |  3  |  D  |

---

## C5.6 自律エージェントの認可

スコープ付き能力トークンと継続的認可を通じて、AIエージェントおよび自律システムの制御権限を管理する。

|   #   | 説明                                                                                         | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.6.1 | 自律エージェントが、許可されたアクション、アクセス可能なリソース、時間的制約、および運用上の制約を明示的に列挙したスコープ付きの能力トークンを受け取っていることを検証してください。 |  1  | D/V |
| 5.6.2 | 高リスクな機能（ファイルシステムアクセス、コード実行、外部API呼び出し、金融取引）がデフォルトで無効化されており、明示的な許可が必要であることを確認してください。         |  1  | D/V |
| 5.6.3 | 能力トークンがユーザーセッションに紐づけられていること、暗号学的な整合性保護が含まれていること、およびオフラインシナリオで保存または再利用できないことを確認してください。      |  2  |  D  |
| 5.6.4 | エージェントが開始したアクションがABACポリシーエンジンによって認可されることを検証してください。                                         |  2  |  V  |

---

## 参考文献

* [NIST SP 800-162: Guide to Attribute Based Access Control (ABAC)](https://csrc.nist.gov/pubs/sp/800/162/final)
* [NIST SP 800-207: Zero Trust Architecture](https://csrc.nist.gov/pubs/sp/800/207/final)
* [NIST SP 800-63-3: Digital Identity Guidelines](https://csrc.nist.gov/pubs/sp/800/63/3/final)
* [NIST IR 8360: Machine Learning for Access Control Policy Verification](https://csrc.nist.gov/pubs/ir/8360/final)


# 付録D: AI支援によるセキュアコーディングのガバナンスと検証

## 目的

この章では、ソフトウェア開発中にAI支援コーディングツールを安全かつ効果的に使用するための基準となる組織的統制を定義し、SDLC全体でのセキュリティとトレーサビリティを確保します。

---

## AD.1 AI支援セキュアコーディングワークフロー

既存のセキュリティゲートを弱体化させることなく、組織のセキュアソフトウェア開発ライフサイクル（SSDLC）にAIツールを統合する。

|   #    | 説明                                                                       | レベル | 役割  |
| :----: | ------------------------------------------------------------------------ | :-: | :-: |
| AD.1.1 | 文書化されたワークフローが、AIツールがコードを生成、リファクタリング、またはレビューするタイミングと方法を説明していることを確認してください。 |  1  | D/V |
| AD.1.2 | ワークフローが各SSDLCフェーズ（設計、実装、コードレビュー、テスト、デプロイメント）に対応していることを検証してください。          |  2  |  D  |
| AD.1.3 | AI生成コードに対して指標（例：脆弱性密度、検出までの平均時間）が収集され、人間のみのベースラインと比較されていることを確認してください。    |  3  | D/V |

---

## AD.2 AIツール資格認定と脅威モデリング

AIコーディングツールは導入前に、セキュリティ機能、リスク、およびサプライチェーンへの影響について評価を行うことを確実にしてください。

|   #    | 説明                                                                              | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------- | :-: | :-: |
| AD.2.1 | 各AIツールの脅威モデルが、誤用、モデル逆転、データ漏洩、および依存関係チェーンのリスクを特定していることを確認してください。                 |  1  | D/V |
| AD.2.2 | ツールの評価に、ローカルコンポーネントの静的/動的解析およびSaaSエンドポイント（TLS、認証/認可、ログ記録）の評価が含まれていることを確認してください。 |  2  |  D  |
| AD.2.3 | 評価が認識されたフレームワークに従って行われていることを確認し、主要なバージョン変更後に再実施されていることを検証してください。                |  3  | D/V |

---

## AD.3 セキュアなプロンプトおよびコンテキスト管理

AIモデルのプロンプトやコンテキストを作成する際に、秘密情報、専有コード、および個人データの漏洩を防止してください。

|   #    | 説明                                                                         | レベル | 役割  |
| :----: | -------------------------------------------------------------------------- | :-: | :-: |
| AD.3.1 | 書面によるガイダンスが、プロンプト内で秘密情報、認証情報、または機密データの送信を禁止していることを確認してください。                |  1  | D/V |
| AD.3.2 | 技術的な制御（クライアント側の編集、承認されたコンテキストフィルター）が機密性の高い情報を自動的に除去することを検証してください。          |  2  |  D  |
| AD.3.3 | プロンプトと応答がトークン化され、転送中および保存時に暗号化されていること、そして保持期間がデータ分類ポリシーに準拠していることを確認してください。 |  3  | D/V |

---

## AD.4 AI生成コードの検証

コードがマージまたはデプロイされる前に、AI出力によって導入された脆弱性を検出し修正します。

|   #    | 説明                                                                                          | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------------------- | :-: | :-: |
| AD.4.1 | AI生成コードは常に人間によるコードレビューを受けることを確認してください。                                                      |  1  | D/V |
| AD.4.2 | AI生成コードを含むすべてのプルリクエストに対して、自動スキャナー（SAST/IAST/DAST）が実行され、重大な問題が検出された場合はマージをブロックすることを確認してください。 |  2  |  D  |
| AD.4.3 | 差分ファズテストやプロパティベースのテストによって、セキュリティに重要な動作（例：入力検証、認可ロジック）が証明されていることを確認してください。                   |  3  | D/V |

---

## AD.5 コード提案の説明可能性と追跡可能性

監査人や開発者に対して、なぜ提案がなされたのか、またそれがどのように進化したのかについての洞察を提供します。

|   #    | 説明                                                                                 | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------------- | :-: | :-: |
| AD.5.1 | プロンプトとレスポンスのペアがコミットIDと共にログに記録されていることを確認してください。                                     |  1  | D/V |
| AD.5.2 | 開発者が提案をサポートするモデルの引用（トレーニングの抜粋、ドキュメント）を表示できることを確認してください。                            |  2  |  D  |
| AD.5.3 | 説明可能性レポートが設計成果物と共に保存され、セキュリティレビューで参照され、ISO/IEC 42001のトレーサビリティ原則を満たしていることを確認してください。 |  3  | D/V |

---

## AD.6 継続的フィードバックとモデル微調整

モデルのセキュリティ性能を時間とともに向上させつつ、ネガティブドリフトを防止する。

|   #    | 説明                                                                                                  | レベル | 役割  |
| :----: | --------------------------------------------------------------------------------------------------- | :-: | :-: |
| AD.6.1 | 開発者が安全でない、または準拠していない提案にフラグを立てられること、そしてそのフラグが追跡されていることを確認してください。                                     |  1  | D/V |
| AD.6.2 | 集約されたフィードバックが、査定されたセキュアコーディングコーパス（例：OWASP チートシート）を用いた定期的なファインチューニングまたはリトリーバル強化生成に役立っていることを確認してください。 |  2  |  D  |
| AD.6.3 | 閉ループ評価ハーネスが、ファインチューニングのたびに回帰テストを実行することを確認してください。セキュリティ指標は、展開前に以前のベースラインを満たすかそれを超えている必要があります。        |  3  | D/V |

---

### 参考文献

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)


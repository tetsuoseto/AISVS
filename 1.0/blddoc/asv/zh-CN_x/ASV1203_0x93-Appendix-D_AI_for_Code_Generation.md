# 附录 D： AI辅助的安全编码治理与验证

## 目标

本章定义了在软件开发过程中安全且高效使用 AI 辅助编码工具所需的基线组织控制，确保在整个软件开发生命周期（SDLC）中实现安全性与可追溯性。

---

## AD.1 AI-辅助 安全‑编码 工作流程

在不削弱现有安全审查点的前提下，将人工智能工具整合到本组织的安全‑软件‑开发生命周期（SSDLC）中。

|   #    | 描述                                                                   | 等级  | 角色  |
| :----: | -------------------------------------------------------------------- | :-: | :-: |
| AD.1.1 | 验证文档化的工作流程是否描述了 AI 工具在何时以及如何生成、重构或审查代码。                              |  1  | D/V |
| AD.1.2 | 验证工作流是否映射到每个SSDLC阶段（设计、实现、代码审查、测试、部署）。                               |  2  |  D  |
| AD.1.3 | 验证是否在 AI‑生成的代码上收集度量指标（例如漏洞密度、mean‑time‑to‑detect），并将其与仅由人类产生的基线进行比较。 |  3  | D/V |

---

## AD.2 AI 工具资格与威胁建模

在采用之前，确保对 AI 编程工具进行安全能力、风险和供应‑链影响方面的评估。

|   #    | 描述                                                         | 等级  | 角色  |
| :----: | ---------------------------------------------------------- | :-: | :-: |
| AD.2.1 | 验证每个AI工具的威胁模型是否能够识别滥用、模型‑反演、数据泄露和依赖链风险。                    |  1  | D/V |
| AD.2.2 | 请确认工具评估包括对任何本地组件的静态/动态分析，以及对 SaaS 端点的评估（TLS、身份验证/授权、日志记录）。 |  2  |  D  |
| AD.2.3 | 验证评估是否遵循公认的框架，并在重大版本变更后重新执行 re‑performed。                  |  3  | D/V |

---

## AD.3 安全提示与上下文管理

在为 AI 模型构建提示或上下文时，防止机密信息、专有代码和个人数据泄露。

|   #    | 描述                                                    | 等级  | 角色  |
| :----: | ----------------------------------------------------- | :-: | :-: |
| AD.3.1 | 核实书面指引是否禁止在提示中发送机密信息、凭据或机密数据。                         |  1  | D/V |
| AD.3.2 | 验证技术控制（客户端脱敏、经批准的上下文过滤器）是否能自动去除敏感痕迹。                  |  2  |  D  |
| AD.3.3 | 请验证提示和响应是否已进行令牌化，在传输过程中和静态存储时是否已加密，以及保留期限是否符合数据‑分类政策。 |  3  | D/V |

---

## AD.4 AI‑生成的 代码 的 验证

在代码合并或部署之前，检测并修复由 AI 输出引入的漏洞。

|   #    | 描述                                                              | 等级  | 角色  |
| :----: | --------------------------------------------------------------- | :-: | :-: |
| AD.4.1 | 确保 AI‑生成的代码始终经过人工代码审查。                                          |  1  | D/V |
| AD.4.2 | 验证在每个包含 AI‑生成的代码的拉取请求上，自动化扫描工具（SAST/IAST/DAST）是否运行，并在关键发现时阻止合并。 |  2  |  D  |
| AD.4.3 | 验证差分模糊测试或基于属性‑的测试是否能证明安全‑关键行为（例如输入验证、授权逻辑）。                     |  3  | D/V |

---

## AD.5 代码建议的可解释性与可追溯性

向审计人员和开发人员提供洞察，以了解为什么提出该建议，以及它是如何演变的。

|   #    | 描述                                                       | 等级  | 角色  |
| :----: | -------------------------------------------------------- | :-: | :-: |
| AD.5.1 | 验证提示/响应对是否已记录并附有提交ID。                                    |  1  | D/V |
| AD.5.2 | 验证开发者是否能够公开用于支持某个建议的模型引文（训练片段、文档）。                       |  2  |  D  |
| AD.5.3 | 验证可解释性报告是否与设计工件一同存放，并在安全评审中被引用，符合 ISO/IEC 42001 的可追溯性原则。 |  3  | D/V |

---

## AD.6 持续反馈与模型微调

随着时间的推移，提升模型的安全性能，同时防止负向漂移。

|   #    | 描述                                                      | 等级  | 角色  |
| :----: | ------------------------------------------------------- | :-: | :-: |
| AD.6.1 | 验证开发人员是否能够标记不安全或不合规的建议，并对这些标记进行跟踪。                      |  1  | D/V |
| AD.6.2 | 验证聚合反馈是否用于定期微‑调或检索‑增强生成，并使用经过审核的安全‑编码语料库（例如 OWASP 速查表）。 |  2  |  D  |
| AD.6.3 | 确保闭环评估框架在每次 fine‑tune 之后执行回归测试； 在部署之前，安全指标必须达到或超过先前的基线。 |  3  | D/V |

---

### 参考文献

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)


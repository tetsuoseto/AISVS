# C12 监控、日志记录与异常检测

## 控制目标

本节提供关于对模型及其他人工智能组件所看到、所执行的操作及返回的结果的实时性与取证可视性的要求，以便检测威胁、分诊并从中学习。

## C12.1 请求与响应日志记录

|   #    | 描述                                                           | 等级  | 角色  |
| :----: | ------------------------------------------------------------ | :-: | :-: |
| 12.1.1 | 请验证所有用户提示和模型响应是否已经被记录，并附带适当的元数据（例如时间戳、用户ID、会话ID、模型版本）。       |  1  | D/V |
| 12.1.2 | 验证日志是否存储在安全、受访问控制的存储库中，并具备适当的保留策略和备份程序。                      |  1  | D/V |
| 12.1.3 | 验证日志存储系统是否在静态状态下对数据进行加密，以及在传输过程中对数据进行加密，以保护日志中包含的敏感信息。       |  1  | D/V |
| 12.1.4 | 验证在日志记录之前，提示和输出中的敏感数据是否已自动脱敏或屏蔽，并提供可配置的脱敏规则，适用于 PII、凭据和专有信息。 |  1  | D/V |
| 12.1.5 | 请验证政策决策和安全过滤操作是否被记录在日志中，以便对内容审核系统进行审计和调试。                    |  2  | D/V |
| 12.1.6 | 验证日志完整性是否通过数字签名或只写存储来保护。                                     |  2  | D/V |

---

## C12.2 滥用检测与告警

|   #    | 描述                                                      | 等级  | 角色  |
| :----: | ------------------------------------------------------- | :-: | :-: |
| 12.2.1 | 验证系统是否能够检测并对已知的越狱模式、提示注入尝试和对抗性输入发出警报，采用基于签名的检测方法。       |  1  | D/V |
| 12.2.2 | 验证系统是否与现有的安全信息与事件管理（SIEM）平台进行集成，并使用标准日志格式和协议。           |  1  | D/V |
| 12.2.3 | 验证增强的安全事件是否包含与人工智能相关的上下文，例如模型标识符、置信度分数以及安全过滤器的决策。       |  2  | D/V |
| 12.2.4 | 验证行为异常检测是否能够识别异常对话模式、过度重试尝试或系统性探测行为。                    |  2  | D/V |
| 12.2.5 | 验证实时告警机制在检测到潜在的策略违规或攻击企图时，是否会通知安全团队。                    |  2  | D/V |
| 12.2.6 | 请验证是否已包含自定义规则，以检测针对人工智能的特定威胁模式，包括协调的越狱尝试、提示注入活动和模型提取攻击。 |  2  | D/V |
| 12.2.7 | 验证自动化的事件响应工作流程是否能够隔离被妥协的模型、阻止恶意用户，并升级关键安全事件。            |  3  | D/V |

---

## C12.3 模型漂移检测

|   #    | 描述                                               | 等级  | 角色  |
| :----: | ------------------------------------------------ | :-: | :-: |
| 12.3.1 | 验证系统是否能够在不同模型版本和时间段内跟踪基本性能指标，例如准确性、置信度分数、延迟和错误率。 |  1  | D/V |
| 12.3.2 | 验证在性能指标超过预定义的降级阈值或相对于基线显著偏离时，自动告警是否触发。           |  2  | D/V |
| 12.3.3 | 验证幻觉检测监测器在模型输出包含事实性错误、前后不一致或捏造信息时，能够识别并标记这些情况。   |  2  | D/V |

---

## C12.4 性能与行为遥测

|   #    | 描述                                              | 等级  | 角色  |
| :----: | ----------------------------------------------- | :-: | :-: |
| 12.4.1 | 验证包括请求延迟、token 消耗、内存使用和吞吐量在内的运维指标是否被持续收集和监控。    |  1  | D/V |
| 12.4.2 | 验证是否对成功率和失败率进行跟踪，并按错误类型及其根本原因进行分类。              |  1  | D/V |
| 12.4.3 | 验证资源利用监控是否包含 GPU/CPU 使用情况、内存消耗和存储需求，并对阈值突破进行告警。 |  2  | D/V |

---

## C12.5 人工智能事件响应计划与执行

|   #    | 描述                                             | 等级  | 角色  |
| :----: | ---------------------------------------------- | :-: | :-: |
| 12.5.1 | 确保事件响应计划专门覆盖与 AI 相关的安全事件，包括模型被入侵、数据投毒和对抗性攻击。   |  1  | D/V |
| 12.5.2 | 确保事件响应团队具备使用 AI 专用取证工具和相关专业知识，以调查模型行为和攻击向量。    |  2  | D/V |
| 12.5.3 | 验证事后分析是否包含模型重新训练的考量因素、安全过滤器更新，以及将经验教训整合到安全控制中。 |  3  | D/V |

---

## C12.5 人工智能 性能下降 检测

监控并检测 AI 模型性能与质量随时间的下降。

|   #    | 描述                                        | 等级  | 角色  |
| :----: | ----------------------------------------- | :-: | :-: |
| 12.5.1 | 验证模型的准确率、精确度、召回率和 F1 分数是否持续监控，并与基线阈值进行比较。 |  1  | D/V |
| 12.5.2 | 验证数据漂移检测是否监控可能影响模型性能的输入分布变化。              |  1  | D/V |
| 12.5.3 | 验证概念漂移检测是否能够识别输入与期望输出之间关系的变化。             |  2  | D/V |
| 12.5.4 | 验证性能下降是否会触发自动告警并启动模型重新训练或替换工作流。           |  2  | D/V |
| 12.5.5 | 验证性能下降根因分析是否将性能下降与数据变更、基础设施问题或外部因素相关联。    |  3  |  V  |

---

## C12.6 有向无环图可视化 & 工作流安全

保护工作流可视化系统免受信息泄露和篡改攻击。

|   #    | 描述                                            | 等级  | 角色  |
| :----: | --------------------------------------------- | :-: | :-: |
| 12.6.1 | 请确认对 DAG 可视化数据已进行清洗，以在存储或传输之前移除敏感信息。          |  1  | D/V |
| 12.6.2 | 请确认工作流可视化访问控制是否仅允许已授权的用户查看智能体的决策路径和推理轨迹。      |  1  | D/V |
| 12.6.3 | 验证 DAG 数据的完整性是否通过数字签名和防篡改存储机制得到保护。            |  2  | D/V |
| 12.6.4 | 验证工作流可视化系统是否实现输入验证，以防止通过精心构造的节点数据或边数据进行的注入攻击。 |  2  | D/V |
| 12.6.5 | 验证实时 DAG（有向无环图）更新是否限流并经过校验，以防止对可视化系统的拒绝服务攻击。  |  3  | D/V |

---

## C12.7 主动安全行为监控

通过对代理行为的主动分析实现对安全威胁的检测与防护。

|   #    | 描述                                    | 等级  | 角色  |
| :----: | ------------------------------------- | :-: | :-: |
| 12.7.1 | 在执行之前，对主动代理行为进行安全性验证，并与风险评估集成。        |  1  | D/V |
| 12.7.2 | 请验证自主行动的触发条件是否包括安全上下文评估和威胁态势评估。       |  2  | D/V |
| 12.7.3 | 验证主动行为模式是否已被分析，以评估潜在的安全影响和意外后果。       |  2  | D/V |
| 12.7.4 | 请验证对安全至关重要的主动措施是否需要明确的审批链并具备审计日志。     |  3  | D/V |
| 12.7.5 | 验证行为异常检测是否能够识别主动代理模式中的偏离，这些偏离可能表示被妥协。 |  3  | D/V |

---

## 参考文献

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


# C12 监控、日志记录与异常检测

## 控制目标

本节提供了交付实时和取证可视化的要求，以展示模型及其他人工智能组件所见、所做及所返回的内容，从而能够检测、分类和学习威胁。

## C12.1 请求与响应日志记录

|   #    | 描述                                                               | 等级  | 角色  |
| :----: | ---------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | 验证所有用户提示和模型响应是否都记录了适当的元数据（例如时间戳、用户ID、会话ID、模型版本）。                 |  1  | D/V |
| 12.1.2 | 验证日志是否存储在安全的、具有访问控制的存储库中，并且具备适当的保留政策和备份程序。                       |  1  | D/V |
| 12.1.3 | 验证日志存储系统是否实现了静态加密和传输加密，以保护日志中包含的敏感信息。                            |  1  | D/V |
| 12.1.4 | 验证提示和输出中的敏感数据在记录之前是否自动被编辑或屏蔽，并且具有可配置的针对个人身份信息（PII）、凭证和专有信息的编辑规则。 |  1  | D/V |
| 12.1.5 | 验证策略决策和安全过滤操作是否被详细记录，以便审计和调试内容审核系统。                              |  2  | D/V |
| 12.1.6 | 验证日志完整性是否通过例如加密签名或只写存储得到保护。                                      |  2  | D/V |

---

## C12.2 滥用检测与警报

|   #    | 描述                                                    | 等级  | 角色  |
| :----: | ----------------------------------------------------- | :-: | :-: |
| 12.2.1 | 验证系统是否使用基于签名的检测方法检测并警报已知的越狱模式、提示注入尝试和对抗性输入。           |  1  | D/V |
| 12.2.2 | 验证系统是否使用标准日志格式和协议与现有的安全信息和事件管理（SIEM）平台集成。             |  1  | D/V |
| 12.2.3 | 验证丰富的安全事件是否包含特定于人工智能的上下文，如模型标识符、置信度分数和安全过滤决策。         |  2  | D/V |
| 12.2.4 | 验证行为异常检测是否能够识别异常的对话模式、过多的重试尝试或系统性的探测行为。               |  2  | D/V |
| 12.2.5 | 验证实时警报机制在检测到潜在的策略违规或攻击尝试时是否通知安全团队。                    |  2  | D/V |
| 12.2.6 | 验证是否包含用于检测特定于 AI 的威胁模式的自定义规则，包括协调的越狱尝试、提示注入活动和模型提取攻击。 |  2  | D/V |
| 12.2.7 | 验证自动化事件响应工作流是否能够隔离被攻破的模型，阻止恶意用户，并升级关键安全事件。            |  3  | D/V |

---

## C12.3 模型漂移检测

|   #    | 描述                                               | 等级  | 角色  |
| :----: | ------------------------------------------------ | :-: | :-: |
| 12.3.1 | 验证系统是否跟踪了基本性能指标，例如准确率、置信度评分、延迟和错误率，涵盖不同模型版本和时间段。 |  1  | D/V |
| 12.3.2 | 确认当性能指标超过预定义的降级阈值或与基线严重偏离时，自动警报能够触发。             |  2  | D/V |
| 12.3.3 | 验证幻觉检测监控器是否能够识别并标记模型输出中包含事实错误、不一致或捏造信息的实例。       |  2  | D/V |

---

## C12.4 性能与行为遥测

|   #    | 描述                                             | 等级  | 角色  |
| :----: | ---------------------------------------------- | :-: | :-: |
| 12.4.1 | 确保持续收集和监控包括请求延迟、令牌消耗、内存使用和吞吐量在内的运营指标。          |  1  | D/V |
| 12.4.2 | 验证成功率和失败率是否通过错误类型及其根本原因的分类进行跟踪。                |  1  | D/V |
| 12.4.3 | 验证资源利用率监控是否包括GPU/CPU使用率、内存消耗和存储需求，并在阈值超出时进行报警。 |  2  | D/V |

---

## C12.5 人工智能事件响应规划与执行

|   #    | 描述                                             | 等级  | 角色  |
| :----: | ---------------------------------------------- | :-: | :-: |
| 12.5.1 | 验证事件响应计划是否专门涵盖与人工智能相关的安全事件，包括模型被破坏、数据中毒和对抗性攻击。 |  1  | D/V |
| 12.5.2 | 确保事件响应团队能够使用专门针对人工智能的取证工具和专业知识，以调查模型行为和攻击向量。   |  2  | D/V |
| 12.5.3 | 验证事故后分析是否包括模型再训练的考虑、安全过滤器的更新以及将经验教训整合到安全控制中。   |  3  | D/V |

---

## C12.5 人工智能性能下降检测

监测并检测 AI 模型性能和质量随时间的下降情况。

|   #    | 描述                                     | 等级  | 角色  |
| :----: | -------------------------------------- | :-: | :-: |
| 12.5.1 | 确保持续监控模型的准确率、精确率、召回率和F1分数，并与基线阈值进行比较。  |  1  | D/V |
| 12.5.2 | 验证数据漂移检测是否监控可能影响模型性能的输入分布变化。           |  1  | D/V |
| 12.5.3 | 验证概念漂移检测是否能够识别输入与预期输出之间关系的变化。          |  2  | D/V |
| 12.5.4 | 验证性能下降是否会触发自动警报并启动模型重新训练或替换工作流程。       |  2  | D/V |
| 12.5.5 | 验证降级根本原因分析是否将性能下降与数据变化、基础设施问题或外部因素相关联。 |  3  |  V  |

---

## C12.6 有向无环图可视化与工作流安全

保护工作流可视化系统免受信息泄漏和篡改攻击。

|   #    | 描述                                           | 等级  | 角色  |
| :----: | -------------------------------------------- | :-: | :-: |
| 12.6.1 | 验证DAG可视化数据是否经过清理，确保在存储或传输之前去除敏感信息。           |  1  | D/V |
| 12.6.2 | 验证工作流可视化访问控制，确保只有授权用户才能查看代理决策路径和推理轨迹。        |  1  | D/V |
| 12.6.3 | 验证DAG数据完整性是否通过加密签名和防篡改存储机制得到保护。              |  2  | D/V |
| 12.6.4 | 验证工作流可视化系统是否实现了输入验证，以防止通过精心构造的节点或边数据进行的注入攻击。 |  2  | D/V |
| 12.6.5 | 验证实时DAG更新是否受到速率限制和验证，以防止对可视化系统的拒绝服务攻击。       |  3  | D/V |

---

## C12.7 主动安全行为监控

通过主动代理行为分析实现安全威胁的检测和预防。

|   #    | 描述                                          | 等级  | 角色  |
| :----: | ------------------------------------------- | :-: | :-: |
| 12.7.1 | 在执行之前，通过风险评估集成验证主动代理行为的安全性。                 |  1  | D/V |
| 12.7.2 | 验证自主主动性触发因素是否包括安全上下文评估和威胁态势评估。              |  2  | D/V |
| 12.7.3 | 验证是否分析了主动行为模式以评估潜在的安全影响和意外后果。               |  2  | D/V |
| 12.7.4 | 验证安全关键的主动措施需要明确的审批链和审计追踪。                   |  3  | D/V |
| 12.7.5 | 验证行为异常检测是否能够识别出主动代理模式中的偏差，这些偏差可能表明存在被入侵的情况。 |  3  | D/V |

---

## 参考文献

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


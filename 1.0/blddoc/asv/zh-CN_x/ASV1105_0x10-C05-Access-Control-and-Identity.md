# C5 面向 AI 组件与用户的访问控制与身份认证

## 控制目标

对 AI 系统的有效访问控制需要强健的身份管理、上下文感知的授权，以及在零信任原则指导下的运行时强制执行。这些控制确保人类、服务以及自治代理仅在明确授予的范围内与模型、数据和计算资源交互，并具备持续的验证与审计能力。

---

## C5.1 身份管理与认证

为所有实体建立基于密码学的身份，并对特权操作实施多因素认证。

|   #   | 描述                                                                                 | 等级  | 角色  |
| :---: | ---------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | 请验证所有人类用户和服务主体是否通过集中式企业身份提供者（IdP）进行身份验证，使用 OIDC/SAML 协议，并实现唯一的身份到令牌映射（不使用共享账户或凭据）。 |  1  | D/V |
| 5.1.2 | 请验证高风险操作（模型部署、权重导出、训练数据访问、生产配置变更）是否需要多因素认证或带有会话重新验证的分步认证。                          |  1  | D/V |
| 5.1.3 | 在获得生产系统访问权限之前，确保新主体的身份核验符合 NIST 800-63-3 的 IAL-2 或等效标准。                            |  2  |  D  |
| 5.1.4 | 验证访问权限审查是否按季度进行，并具备对不活跃账户的自动检测、凭据轮换的强制执行，以及注销访问的工作流。                               |  2  |  V  |
| 5.1.5 | 验证联邦 AI 代理通过签名的 JWT 断言进行身份验证，这些断言的最大有效期为 24 小时，并包含来源的密码学证明。                        |  3  | D/V |

---

## C5.2 资源授权与最小权限原则

为所有 AI 资源实现细粒度访问控制，采用显式权限模型并提供审计日志。

|   #   | 描述                                                                  | 等级  | 角色  |
| :---: | ------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | 验证每个 AI 资源（数据集、模型、端点、向量集合、嵌入索引、计算实例）是否实施基于角色的访问控制，并具备显式允许列表与默认拒绝策略。 |  1  | D/V |
| 5.2.2 | 请验证默认情况下是否强制执行最小权限原则：服务账户从只读权限开始，写访问需要提供书面业务正当性证明。                  |  1  | D/V |
| 5.2.3 | 验证所有访问控制修改是否与已批准的变更请求相关联，并以不可变的方式记录，包含时间戳、执行者身份、资源标识符和权限变更。         |  1  |  V  |
| 5.2.4 | 验证数据分类标签（PII、PHI、出口受控、专有）是否会自动传播到派生资源（嵌入向量、提示缓存、模型输出），并实现一致的策略执行。   |  2  |  D  |
| 5.2.5 | 验证未授权访问尝试和权限提升事件是否在5分钟内触发带有上下文元数据的实时警报，并将警报发送到 SIEM 系统。             |  2  | D/V |

---

## C5.3 动态策略评估

部署基于属性的访问控制（ABAC）引擎，以实现上下文感知的授权决策，并具备审计能力。

|   #   | 描述                                                                      | 等级  | 角色  |
| :---: | ----------------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | 验证授权决策是否外部化到一个专用的策略引擎（OPA、Cedar 或同等产品），该引擎通过经过身份验证的 API 访问，并具备密码学完整性保护。 |  1  | D/V |
| 5.3.2 | 验证策略在运行时对动态属性进行评估，包括用户授权级别、资源敏感性分类、请求上下文、租户隔离以及时间约束。                    |  1  | D/V |
| 5.3.3 | 在生产部署之前，确保策略定义经过版本控制、同行评审，并通过 CI/CD 流水线中的自动化测试进行验证。                     |  2  |  D  |
| 5.3.4 | 验证策略评估结果是否包含结构化的决策依据，并将其传输到 SIEM 系统以用于关联分析和合规报告。                        |  2  |  V  |
| 5.3.5 | 请核实策略缓存的生存时间（TTL）值在高敏感资源上不得超过 5 分钟，在具备缓存失效能力的标准资源上不得超过 1 小时。            |  3  | D/V |

---

## C5.4 查询时的安全执行

实现数据库层面的安全控制，包含强制性过滤和行级安全策略。

|   #   | 描述                                                                             | 等级  | 角色  |
| :---: | ------------------------------------------------------------------------------ | :-: | :-: |
| 5.4.1 | 验证所有向量数据库和 SQL 查询是否包含强制性的安全过滤器（租户 ID、敏感性标签、用户作用域），这些过滤器在数据库引擎层面强制执行，而非应用程序代码中。 |  1  | D/V |
| 5.4.2 | 请验证对所有向量数据库、搜索索引和训练数据集，是否启用带策略继承的行级安全策略（RLS）和字段级掩码。                            |  1  | D/V |
| 5.4.3 | 验证失败的授权评估将通过立即中止查询并返回明确的授权错误代码来防止“混淆代理攻击”，而不是返回空的结果集。                          |  2  |  D  |
| 5.4.4 | 验证策略评估延迟是否被持续监控，并对可能导致授权绕过的超时条件设置自动警报。                                         |  2  |  V  |
| 5.4.5 | 验证查询重试机制是否会重新评估授权策略，以适应活跃用户会话中的动态权限变化。                                         |  3  | D/V |

---

## C5.5 输出过滤与数据丢失防护

部署后处理控制，以防止 AI 生成内容中的未授权数据暴露。

|   #   | 描述                                                              | 等级  | 角色  |
| :---: | --------------------------------------------------------------- | :-: | :-: |
| 5.5.1 | 请核实，在向请求方交付内容之前，推理后过滤机制是否能够对未授权的个人身份信息（PII）、机密信息和专有数据进行扫描并将其涂黑。 |  1  | D/V |
| 5.5.2 | 验证模型输出中的引用、参考文献和来源归属是否已根据调用方权限进行校验，并在检测到未授权访问时将其移除。             |  1  | D/V |
| 5.5.3 | 验证输出格式限制（已脱敏的PDF、元数据已移除的图片、经批准的文件类型）是否根据用户权限级别和数据分类被强制执行。       |  2  |  D  |
| 5.5.4 | 验证脱敏算法具有确定性、具备版本控制，并能维护审计日志，以支持合规调查和取证分析。                       |  2  |  V  |
| 5.5.5 | 验证高风险脱敏事件是否会生成自适应日志，其中包含原始内容的密码学哈希值，以便在不暴露数据的前提下用于取证检索。         |  3  |  V  |

---

## C5.6 多租户-隔离

在共享的 AI 基础设施中确保租户之间的密码学与逻辑隔离。

|   #   | 描述                                                          | 等级  | 角色  |
| :---: | ----------------------------------------------------------- | :-: | :-: |
| 5.6.1 | 验证内存空间、嵌入向量存储、缓存条目和临时文件是否按租户进行命名空间隔离，并在租户删除或会话终止时进行安全擦除。    |  1  | D/V |
| 5.6.2 | 验证每个 API 请求是否包含经过身份验证的租户标识符，并且该标识符应通过密码学方法，与会话上下文和用户权限进行校验。 |  1  | D/V |
| 5.6.3 | 验证网络策略是否在服务网格和容器编排平台内实现默认拒绝规则，以阻止跨租户通信。                     |  2  |  D  |
| 5.6.4 | 验证对每个租户的加密密钥是否唯一，并且支持客户管理密钥（CMK），以及在租户数据存储之间实现加密隔离。         |  3  |  D  |

---

## C5.7 自主代理授权

通过带有作用域的能力令牌和持续授权来控制对人工智能代理和自主系统的权限。

|   #   | 描述                                                                   | 等级  | 角色  |
| :---: | -------------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | 验证自治代理是否接收具作用域的能力令牌，该令牌明确列出被许可的操作、可访问的资源、时间边界以及运行约束。                 |  1  | D/V |
| 5.7.2 | 请验证默认情况下高风险能力（文件系统访问、代码执行、外部 API 调用、金融交易）已被禁用，并在激活时需要明确的授权以及业务正当性理由。 |  1  | D/V |
| 5.7.3 | 验证能力令牌是否绑定到用户会话，包含密码学完整性保护，并确保它们在离线场景中不能被持久化或重复使用。                   |  2  |  D  |
| 5.7.4 | 验证代理-发起的操作是否通过 ABAC 策略引擎进行二次授权，并进行完整的上下文评估和审计日志记录。                   |  2  |  V  |
| 5.7.5 | 验证代理的错误条件和异常处理是否包含能力范围信息，以支持事件分析和取证调查。                               |  3  |  V  |

---

## 参考文献

### 标准与框架

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### 实现指南

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### AI-专用安全

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


# C5 访问控制与人工智能组件及用户身份管理

## 控制目标

对人工智能系统实施有效的访问控制需要强大的身份管理、上下文感知的授权以及遵循零信任原则的运行时执行。这些控制确保人类、服务和自主代理仅在明确授权的范围内与模型、数据和计算资源进行交互，并具备持续的验证和审计能力。

---

## C5.1 身份管理与认证

为所有实体建立由加密技术支持的身份，并针对特权操作实施多因素认证。

|   #   | 描述                                                                            | 级别  | 角色  |
| :---: | ----------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | 验证所有人类用户和服务主体均通过集中式企业身份提供者（IdP）使用 OIDC/SAML 协议进行身份验证，且具有唯一的身份到令牌映射（无共享账户或凭据）。 |  1  | D/V |
| 5.1.2 | 验证高风险操作（模型部署、权重导出、训练数据访问、生产配置更改）是否需要多因素认证或带有会话重新验证的逐级认证。                      |  1  | D/V |
| 5.1.3 | 验证新负责人在获得生产系统访问权限之前，必须进行符合 NIST 800-63-3 IAL-2 或等效标准的身份验证。                    |  2  |  D  |
| 5.1.4 | 验证访问审查是否每季度进行一次，并通过自动检测休眠账户、强制凭证轮换和注销工作流程来实现。                                 |  2  |  V  |
| 5.1.5 | 验证联合人工智能代理通过签名的 JWT 断言进行身份验证，该断言的最长有效期为 24 小时，并包含来源的加密证明。                     |  3  | D/V |

---

## C5.2 资源授权与最小权限

为所有人工智能资源实施细粒度访问控制，采用明确的权限模型和审计跟踪。

|   #   | 描述                                                                              | 级别  | 角色  |
| :---: | ------------------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | 验证每个 AI 资源（数据集、模型、端点、向量集合、嵌入索引、计算实例）是否实施基于角色的访问控制，采用显式允许列表和默认拒绝策略。              |  1  | D/V |
| 5.2.2 | 验证服务账户默认执行最小权限原则，权限从只读开始，写权限必须有书面业务理由。                                          |  1  | D/V |
| 5.2.3 | 验证所有访问控制修改是否与已批准的变更请求相关联，并以不可篡改的方式记录时间戳、操作人员身份、资源标识符和权限差异。                      |  1  |  V  |
| 5.2.4 | 验证数据分类标签（个人识别信息PII、受保护健康信息PHI、出口管制信息、专有信息）能否自动传播到派生资源（嵌入、提示缓存、模型输出），并确保策略的一致执行。 |  2  |  D  |
| 5.2.5 | 验证未经授权的访问尝试和权限提升事件是否在5分钟内触发带有上下文元数据的实时警报发送到SIEM系统。                              |  2  | D/V |

---

## C5.3 动态策略评估

部署基于属性的访问控制（ABAC）引擎，实现具有审计功能的上下文感知授权决策。

|   #   | 描述                                                            | 级别  | 角色  |
| :---: | ------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | 验证授权决策是否外部化到专用的策略引擎（OPA、Cedar或同类工具），并通过带有加密完整性保护的身份验证API进行访问。 |  1  | D/V |
| 5.3.2 | 验证策略在运行时评估动态属性，包括用户许可级别、资源敏感性分类、请求上下文、租户隔离和时间约束。              |  1  | D/V |
| 5.3.3 | 验证策略定义在生产部署前经过版本控制、同行评审，并通过CI/CD流水线中的自动化测试进行验证。               |  2  |  D  |
| 5.3.4 | 验证策略评估结果是否包含结构化的决策理由，并将其传输到 SIEM 系统以进行关联分析和合规性报告。             |  2  |  V  |
| 5.3.5 | 验证策略缓存的生存时间（TTL）值，对于高敏感度资源不超过5分钟，对于具有缓存失效功能的标准资源不超过1小时。       |  3  | D/V |

---

## C5.4 查询时的安全执行

实现数据库层的安全控制，包括强制过滤和行级安全策略。

|   #   | 描述                                                                             | 级别  | 角色  |
| :---: | ------------------------------------------------------------------------------ | :-: | :-: |
| 5.4.1 | 验证所有向量数据库和SQL查询均包含强制性的安全过滤器（租户ID、敏感性标签、用户范围），并且这些过滤器在数据库引擎层面强制执行，而非在应用程序代码中实施。 |  1  | D/V |
| 5.4.2 | 验证所有向量数据库、搜索索引和训练数据集是否启用了行级安全（RLS）策略和字段级屏蔽，并且支持策略继承。                           |  1  | D/V |
| 5.4.3 | 验证失败的授权评估将通过立即中止查询并返回明确的授权错误代码，而不是返回空结果集，从而防止“混淆副手攻击”。                         |  2  |  D  |
| 5.4.4 | 验证策略评估延迟是否被持续监控，并且针对可能导致授权绕过的超时情况设有自动警报。                                       |  2  |  V  |
| 5.4.5 | 验证查询重试机制是否重新评估授权策略，以考虑活动用户会话中动态权限的更改。                                          |  3  | D/V |

---

## C5.5 输出过滤与数据泄露防护

部署后期处理控制，以防止AI生成内容中的未经授权的数据泄露。

|   #   | 描述                                                      | 级别  | 角色  |
| :---: | ------------------------------------------------------- | :-: | :-: |
| 5.5.1 | 验证推理后过滤机制在向请求者交付内容之前，是否扫描并修订未经授权的个人身份信息（PII）、机密信息和专有数据。 |  1  | D/V |
| 5.5.2 | 验证模型输出中的引用、参考文献和来源归属是否已根据调用者权限进行验证，如果检测到未经授权的访问，则将其移除。  |  1  | D/V |
| 5.5.3 | 根据用户权限等级和数据分类，验证输出格式限制（如净化的PDF、去除元数据的图像、批准的文件类型）是否得到执行。 |  2  |  D  |
| 5.5.4 | 验证编辑算法是确定性的，具备版本控制，并保留审计日志，以支持合规调查和取证分析。                |  2  |  V  |
| 5.5.5 | 验证高风险编辑事件是否生成包含原始内容加密哈希的自适应日志，以便在不暴露数据的情况下进行取证检索。       |  3  |  V  |

---

## C5.6 多租户隔离

确保共享 AI 基础设施中租户之间的加密和逻辑隔离。

|   #   | 描述                                                       | 级别  | 角色  |
| :---: | -------------------------------------------------------- | :-: | :-: |
| 5.6.1 | 验证内存空间、嵌入存储、缓存条目和临时文件是否按租户进行命名空间分隔，并在租户删除或会话终止时进行安全清除。   |  1  | D/V |
| 5.6.2 | 验证每个 API 请求都包含经过身份验证的租户标识符，该标识符通过密码学方法相对于会话上下文和用户权限进行验证。 |  1  | D/V |
| 5.6.3 | 验证网络策略是否在服务网格和容器编排平台中对跨租户通信实施默认拒绝规则。                     |  2  |  D  |
| 5.6.4 | 验证加密密钥在支持客户管理密钥（CMK）的情况下是否针对每个租户唯一，并且租户数据存储之间具备密码学隔离。    |  3  |  D  |

---

## C5.7 自主代理授权

通过范围能力令牌和持续授权控制 AI 代理和自主系统的权限。

|   #   | 描述                                                               | 级别  | 角色  |
| :---: | ---------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | 验证自主代理是否接收了明确列出允许操作、可访问资源、时间限制和操作约束的范围能力令牌。                      |  1  | D/V |
| 5.7.2 | 验证高风险功能（文件系统访问、代码执行、外部API调用、金融交易）默认是否被禁用，并且激活这些功能是否需要明确的授权和业务理由。 |  1  | D/V |
| 5.7.3 | 验证能力令牌是否绑定到用户会话，包含加密完整性保护，并确保它们不能在离线场景中被持久化或重用。                  |  2  |  D  |
| 5.7.4 | 验证代理发起的操作是否通过基于属性的访问控制（ABAC）策略引擎进行二次授权，并进行完整的上下文评估和审计日志记录。       |  2  |  V  |
| 5.7.5 | 验证代理错误条件和异常处理是否包含能力范围信息，以支持事件分析和取证调查。                            |  3  |  V  |

---

## 参考文献

### 标准与框架

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### 实施指南

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### 人工智能专用安全

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


# امنیت زنجیره تامین C6 برای مدل‌ها، چارچوب‌ها و داده‌ها

## هدف کنترل

حملات زنجیره تأمین هوش مصنوعی از مدل‌ها، چارچوب‌ها یا مجموعه داده‌های شخص ثالث برای جاسازی درهای پشتی، سوگیری یا کد قابل سوء استفاده بهره می‌برند. این کنترل‌ها ردیابی کامل منبع، مدیریت آسیب‌پذیری و نظارت را فراهم می‌کنند تا از کل چرخه عمر مدل محافظت کنند.

---

## C6.1 بررسی مدل پیش‌آموزش‌دیده و اصالت آن

قبل از هرگونه آموزش مجدد یا استقرار، منابع، مجوزها و رفتارهای پنهان مدل‌های شخص ثالث را ارزیابی و تأیید کنید.

|   #   | توضیحات                                                                                                                                            | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.1.1 | تأیید کنید که هر اثر مدل شخص ثالث شامل یک رکورد منشأ امضا شده باشد که مخزن منبع و هش تعهد را مشخص می‌کند.                                          |  1  | D/V |
| 6.1.2 | اطمینان حاصل کنید که مدل‌ها قبل از واردسازی با استفاده از ابزارهای خودکار برای شناسایی لایه‌های مخرب یا محرک‌های تروجان اسکن می‌شوند.              |  1  | D/V |
| 6.1.3 | تأیید کنید که آموزش تکمیلی در یادگیری انتقالی از ارزیابی‌های خصمانه عبور می‌کند تا رفتارهای پنهان را شناسایی کند.                                  |  2  |  D  |
| 6.1.4 | تأیید کنید که مجوزهای مدل، برچسب‌های کنترل صادرات، و بیانیه‌های منبع داده‌ها در یک ورودی ML‑BOM ثبت شده باشند.                                     |  2  |  V  |
| 6.1.5 | اطمینان حاصل کنید که مدل‌های پرخطر (وزن‌های آپلود شده به‌صورت عمومی، سازندگان تأیید نشده) تا زمان بازبینی و تصویب انسانی در قرنطینه باقی می‌مانند. |  3  | D/V |

---

## C6.2 اسکن فریم‌ورک و کتابخانه

به طور مداوم چارچوب‌ها و کتابخانه‌های یادگیری ماشین را برای یافتن آسیب‌پذیری‌های امنیتی (CVE) و کدهای مخرب اسکن کنید تا لایه اجرایی ایمن باقی بماند.

|   #   | توضیحات                                                                                                                              | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 6.2.1 | تأیید کنید که خطوط لوله CI، اسکنرهای وابستگی را روی چارچوب‌های AI و کتابخانه‌های حیاتی اجرا می‌کنند.                                 |  1  | D/V |
| 6.2.2 | اطمینان حاصل کنید که آسیب‌پذیری‌های بحرانی (CVSS ≥ 7.0) مانع از ارتقاء به تصاویر تولیدی می‌شوند.                                     |  1  | D/V |
| 6.2.3 | تأیید کنید که تحلیل ایستای کد بر روی کتابخانه‌های یادگیری ماشین منشعب‌شده یا فروشگاهی اجرا می‌شود.                                   |  2  |  D  |
| 6.2.4 | اطمینان حاصل کنید که پیشنهادات ارتقاء چارچوب شامل ارزیابی تأثیر امنیتی با ارجاع به منابع عمومی CVE هستند.                            |  2  |  V  |
| 6.2.5 | اطمینان حاصل کنید که حسگرهای زمان اجرا در صورت بارگذاری کتابخانه‌های پویا غیرمنتظره که با SBOM امضا شده مطابقت ندارند هشدار می‌دهند. |  3  |  V  |

---

## C6.3 ثابت‌کردن و تأیید وابستگی‌ها

تمام وابستگی‌ها را به هش‌های غیرقابل تغییر ثابت کنید و ساخت‌ها را بازتولید کنید تا از تولید آثار کاملاً یکسان و بدون دستکاری اطمینان حاصل شود.

|   #   | توضیحات                                                                                                                | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.3.1 | اطمینان حاصل کنید که همه مدیران بسته نسخه‌ها را از طریق فایل‌های قفل اعمال می‌کنند.                                    |  1  | D/V |
| 6.3.2 | تأیید کنید که در ارجاعات کانتینر از چکیده‌های غیرقابل تغییر به جای برچسب‌های قابل تغییر استفاده شده است.               |  1  | D/V |
| 6.3.3 | اطمینان حاصل کنید که بررسی‌های بازتولیدپذیری با مقایسه هش‌ها در اجرای‌های CI، خروجی‌های یکسان را تضمین می‌کنند.        |  2  |  D  |
| 6.3.4 | اطمینان حاصل کنید که تاییدیه‌های ساخت به مدت 18 ماه برای قابلیت ردیابی حسابرسی ذخیره می‌شوند.                          |  2  |  V  |
| 6.3.5 | تأیید کنید که وابستگی‌های منقضی شده، درخواست‌های باز خودکار برای به‌روزرسانی یا فورک نسخه‌های پین شده را فعال می‌کنند. |  3  |  D  |

---

## C6.4 اجرای منبع مورد اعتماد

اجازه دانلود آثار فقط از منابعی که به صورت رمزنگاری شده تأیید شده‌اند و توسط سازمان تایید شده‌اند را بدهید و همه موارد دیگر را مسدود کنید.

|   #   | توضیحات                                                                                                            | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 6.4.1 | تأیید کنید که وزن‌های مدل، مجموعه‌داده‌ها و کانتینرها تنها از دامنه‌های تأییدشده یا رجیستری‌های داخلی دانلود شوند. |  1  | D/V |
| 6.4.2 | تأیید کنید که امضاهای Sigstore/Cosign هویت ناشر را قبل از ذخیره‌سازی محلی آثار تأیید می‌کنند.                      |  1  | D/V |
| 6.4.3 | تأیید کنید که پروکسی‌های خروجی دانلودهای آثار بدون احراز هویت را مسدود می‌کنند تا سیاست منبع مورد اعتماد اجرا شود. |  2  |  D  |
| 6.4.4 | تأیید کنید که فهرست‌های مجاز مخزن به‌صورت فصلی بازبینی می‌شوند و برای هر ورودی شاهدی از توجیه کسب‌وکار وجود دارد.  |  2  |  V  |
| 6.4.5 | تأیید کنید که نقض سیاست‌ها منجر به قرنطینه شدن مصنوعات و بازگردانی اجرای‌های وابسته به خط لوله شود.                |  3  |  V  |

---

## C6.5 ارزیابی ریسک داده‌های شخص ثالث

داده‌های خارجی را از نظر مسمومیت، تعصب و تطابق قانونی ارزیابی کنید و در طول چرخه عمر آن‌ها را نظارت کنید.

|   #   | توضیحات                                                                                                                              | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 6.5.1 | اطمینان حاصل کنید که داده‌های خارجی تحت ارزیابی ریسک آلوده شدن قرار می‌گیرند (برای مثال، اثر انگشت داده‌ها، شناسایی نقاط دورافتاده). |  1  | D/V |
| 6.5.2 | اطمینان حاصل کنید که معیارهای سوگیری (برابری جمعیتی، فرصت برابر) قبل از تصویب مجموعه داده محاسبه شده‌اند.                            |  1  |  D  |
| 6.5.3 | تأیید کنید که منشأ و شرایط مجوز برای مجموعه داده‌ها در ورودی‌های ML-BOM ثبت شده است.                                                 |  2  |  V  |
| 6.5.4 | اطمینان حاصل کنید که پایش دوره‌ای تغییر یا فساد در داده‌های میزبانی شده را شناسایی می‌کند.                                           |  2  |  V  |
| 6.5.5 | اطمینان حاصل کنید که محتوای غیرمجاز (حق نشر، اطلاعات شخصی شناسایی‌پذیر) از طریق پاک‌سازی خودکار پیش از آموزش حذف شده است.            |  3  |  D  |

---

## C6.6 نظارت بر حملات زنجیره تامین

تهدیدهای زنجیره تأمین را از طریق خوراک‌های CVE، تحلیل‌های لاگ حسابرسی و شبیه‌سازی‌های تیم قرمز به‌صورت زودهنگام شناسایی کنید.

|   #   | توضیحات                                                                                                                                          | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 6.6.1 | اطمینان حاصل کنید که گزارش‌های حسابرسی CI/CD به جریان تشخیص‌های SIEM برای دریافت‌های غیرعادی بسته یا مراحل ساخت دستکاری شده ارسال می‌شوند.       |  1  |  V  |
| 6.6.2 | اطمینان حاصل کنید که کتابچه‌های راهنمای واکنش به حادثه شامل رویه‌های بازگردانی برای مدل‌ها یا کتابخانه‌های به خطر افتاده باشند.                  |  2  |  D  |
| 6.6.3 | تأیید کنید که برچسب‌های غنی‌سازی اطلاعات تهدید شاخص‌های خاص ML (مثلاً IoCهای مرتبط با مسموم‌سازی مدل) را در دسته‌بندی هشدار علامت‌گذاری می‌کنند. |  3  |  V  |

---

## C6.7 فهرست مواد یادگیری ماشین (ML-BOM) برای آثار مدل

تولید و امضای SBOMهای تخصصی ML جزئی و دقیق (ML‑BOMها) به‌گونه‌ای که مصرف‌کنندگان نهایی بتوانند صحت یکپارچگی مؤلفه‌ها را در زمان استقرار تأیید کنند.

|   #   | توضیحات                                                                                                                                                                  | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 6.7.1 | تأیید کنید که هر اثر مدل یک ML‑BOM منتشر می‌کند که شامل مجموعه داده‌ها، وزن‌ها، ابرپارامترها و مجوزها باشد.                                                              |  1  | D/V |
| 6.7.2 | اطمینان حاصل کنید که تولید ML‑BOM و امضای Cosign به طور خودکار در CI انجام می‌شود و برای ادغام الزامی است.                                                               |  1  | D/V |
| 6.7.3 | اطمینان حاصل کنید که بررسی‌های کامل بودن ML-BOM در صورت فقدان هرگونه متادیتای مؤلفه (هش، مجوز) باعث شکست ساخت می‌شود.                                                    |  2  |  D  |
| 6.7.4 | اطمینان حاصل کنید که مصرف‌کنندگان پایین‌دستی می‌توانند از طریق API داده‌های BOM مدل‌های یادگیری ماشین را برای اعتبارسنجی مدل‌های وارد شده در زمان استقرار، پرس‌وجو کنند. |  2  |  V  |
| 6.7.5 | اطمینان حاصل کنید که ML-BOMها تحت کنترل نسخه هستند و تفاوت‌گیری می‌شوند تا تغییرات غیرمجاز شناسایی شوند.                                                                 |  3  |  V  |

---

## مراجع

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


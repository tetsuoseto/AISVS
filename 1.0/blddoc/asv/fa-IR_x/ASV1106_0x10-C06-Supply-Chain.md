# امنیت زنجیره تأمین C6 برای مدل‌ها، چارچوب‌ها و داده‌ها

## هدف کنترل

حملات زنجیره تأمین هوش مصنوعی از مدل‌ها، چارچوب‌ها یا مجموعه داده‌های شخص ثالث سوءاستفاده می‌کنند تا درهای پشتی، تعصب یا کدهای قابل سوءاستفاده را جاسازی کنند. این کنترل‌ها منشأ انتها به انتها، مدیریت آسیب‌پذیری و نظارت را فراهم می‌کنند تا از کل چرخه عمر مدل محافظت کنند.

---

## C6.1 ارزیابی و منشأ مدل پیش‌آموزش‌دیده

قبل از هرگونه ریزتنظیم یا استقرار، منشاء مدل‌های شخص ثالث، مجوزها و رفتارهای پنهان آن‌ها را ارزیابی و تایید کنید.

|   #   | توضیحات                                                                                                                                   | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.1.1 | اطمینان حاصل کنید که هر اثر مدل شخص ثالث شامل یک رکورد منشأ امضا شده است که مخزن منبع و هش کامیت را شناسایی می‌کند.                       |  1  | D/V |
| 6.1.2 | اطمینان حاصل کنید که مدل‌ها قبل از وارد شدن با استفاده از ابزارهای خودکار برای لایه‌های مخرب یا محرک‌های تروجان اسکن شده باشند.           |  1  | D/V |
| 6.1.3 | تأیید کنید که تنظیم دقیق در یادگیری انتقالی توانایی عبور از ارزیابی خصمانه برای شناسایی رفتارهای پنهان را دارد.                           |  2  |  D  |
| 6.1.4 | اطمینان حاصل کنید که مجوزهای مدل، برچسب‌های کنترل صادرات، و بیانیه‌های منشأ داده در یک ورودی ML-BOM ثبت شده‌اند.                          |  2  |  V  |
| 6.1.5 | اطمینان حاصل کنید که مدل‌های پرخطر (وزن‌های بارگذاری شده عمومی، سازندگان تایید نشده) تا زمان بررسی و تایید انسانی در قرنطینه باقی بمانند. |  3  | D/V |

---

## C6.2 اسکن فریم‌ورک و کتابخانه

به‌طور مداوم چارچوب‌ها و کتابخانه‌های یادگیری ماشین را برای CVEها و کدهای مخرب اسکن کنید تا لایه اجرای برنامه امن باقی بماند.

|   #   | توضیحات                                                                                                                         | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.2.1 | تأیید کنید که خط‌های لوله CI اسکنرهای وابستگی را روی چارچوب‌های هوش مصنوعی و کتابخانه‌های حیاتی اجرا می‌کنند.                   |  1  | D/V |
| 6.2.2 | تأیید کنید که آسیب‌پذیری‌های بحرانی (CVSS ≥ 7.0) از ارتقاء به تصاویر تولیدی جلوگیری می‌کنند.                                    |  1  | D/V |
| 6.2.3 | اطمینان حاصل کنید که تجزیه و تحلیل کد ایستا بر روی کتابخانه‌های یادگیری ماشین شاخه‌گیری شده یا وارد شده اجرا می‌شود.            |  2  |  D  |
| 6.2.4 | اطمینان حاصل کنید که پیشنهادهای ارتقاء چارچوب شامل ارزیابی تأثیر امنیتی با ارجاع به منابع عمومی CVE باشد.                       |  2  |  V  |
| 6.2.5 | تأیید کنید که سنسورهای زمان اجرا نسبت به بارگذاری‌های غیرمنتظره کتابخانه‌های پویا که از SBOM امضا شده انحراف دارند، هشدار دهند. |  3  |  V  |

---

## C6.3 ثابت‌سازی و تأیید وابستگی‌ها

تمام وابستگی‌ها را به صورت بلادرنگ و غیرقابل تغییر قفل کنید و ساخت‌ها را بازتولید کنید تا اطمینان حاصل شود که مصنوعات به صورت یکسان و بدون تغییر هستند.

|   #   | توضیحات                                                                                                                     | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.3.1 | تأیید کنید که همه مدیران بسته‌ها اعمال قفل نسخه (version pinning) را از طریق فایل‌های قفل انجام می‌دهند.                    |  1  | D/V |
| 6.3.2 | تأیید کنید که در مراجع کانتینر به‌جای برچسب‌های قابل تغییر، خلاصه‌های تغییرناپذیر استفاده شده است.                          |  1  | D/V |
| 6.3.3 | اطمینان حاصل کنید که بررسی‌های ساخت قابل تولید، هش‌ها را در اجرای مداوم CI مقایسه می‌کنند تا خروجی‌های یکسان را تضمین کنند. |  2  |  D  |
| 6.3.4 | تأیید کنید که تصدیق‌های ساخت به مدت 18 ماه برای ردیابی حسابرسی ذخیره می‌شوند.                                               |  2  |  V  |
| 6.3.5 | تأیید کنید که وابستگی‌های منقضی شده درخواست‌های کشش خودکاری را برای به‌روزرسانی یا فورک نسخه‌های پین‌شده تحریک می‌کنند.     |  3  |  D  |

---

## C6.4 اجرای منبع مورد اعتماد

دانلود آرتیفکت‌ها را فقط از منابع تأیید شده رمزنگاری شده و مورد تأیید سازمان مجاز کنید و همه چیزهای دیگر را مسدود نمایید.

|   #   | توضیحات                                                                                                                      | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.4.1 | تأیید کنید که وزن‌های مدل، مجموعه داده‌ها و کانتینرها فقط از دامنه‌های تأیید شده یا ثبت‌کننده‌های داخلی دانلود می‌شوند.      |  1  | D/V |
| 6.4.2 | تأیید کنید که امضاهای Sigstore/Cosign هویت ناشر را قبل از ذخیره محلی آثار اعتبارسنجی می‌کنند.                                |  1  | D/V |
| 6.4.3 | تأیید کنید که پراکسی‌های خروجی دانلودهای بدون احراز هویت آثار را مسدود می‌کنند تا سیاست منبع قابل اعتماد را اجرا کنند.       |  2  |  D  |
| 6.4.4 | اطمینان حاصل کنید که فهرست‌های مجاز مخزن به صورت سه‌ماهه بازبینی شده‌اند و برای هر ورودی مدارک توجیه کسب‌وکار ارائه شده است. |  2  |  V  |
| 6.4.5 | تأیید کنید که نقض سیاست‌ها باعث قرنطینه شدن آثار و بازگردانی اجرای خطوط لوله وابسته می‌شود.                                  |  3  |  V  |

---

## C6.5 ارزیابی ریسک مجموعه داده‌های شخص ثالث

داده‌های خارجی را از نظر آلودگی، جانب داری و انطباق قانونی ارزیابی کرده و آنها را در طول چرخه عمرشان تحت نظارت قرار دهید.

|   #   | توضیحات                                                                                                                          | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.5.1 | اطمینان حاصل شود که مجموعه داده‌های خارجی تحت ارزیابی ریسک دستکاری قرار می‌گیرند (مانند اثر انگشت داده‌ها، تشخیص نمونه‌های پرت). |  1  | D/V |
| 6.5.2 | اطمینان حاصل کنید که معیارهای سوگیری (توازن جمعیتی، فرصت برابر) قبل از تایید مجموعه داده محاسبه شده‌اند.                         |  1  |  D  |
| 6.5.3 | تأیید کنید که اطلاعات منبع و شرایط مجوز برای مجموعه داده‌ها در ورودی‌های ML‑BOM ثبت شده باشند.                                   |  2  |  V  |
| 6.5.4 | اطمینان حاصل کنید که نظارت دوره‌ای باعث شناسایی انحراف یا فساد در مجموعه داده‌های میزبانی شده می‌شود.                            |  2  |  V  |
| 6.5.5 | اطمینان حاصل کنید که محتوای ممنوعه (حق نشر، اطلاعات شناسایی شخصی) قبل از آموزش از طریق پاک‌سازی خودکار حذف شده است.              |  3  |  D  |

---

## C6.6 نظارت بر حملات زنجیره تامین

تشخیص زودهنگام تهدیدات زنجیره تأمین از طریق خوراک‌های CVE، تحلیل‌های لاگ‌های حسابرسی، و شبیه‌سازی‌های تیم قرمز.

|   #   | توضیحات                                                                                                                                                   | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.6.1 | اطمینان حاصل کنید که لاگ‌های حسابرسی CI/CD به صورت جریان به تشخیص‌های SIEM برای کشش‌های بسته نامعمول یا مراحل ساخت دستکاری شده ارسال می‌شوند.             |  1  |  V  |
| 6.6.2 | اطمینان حاصل کنید که کتابچه‌های عملیات پاسخ به حوادث شامل روندهای بازگشت به وضعیت قبلی برای مدل‌ها یا کتابخانه‌های دچار اختلال هستند.                     |  2  |  D  |
| 6.6.3 | اطمینان حاصل کنید که برچسب‌های غنی‌سازی اطلاعات تهدید، شاخص‌های خاص یادگیری ماشین (مثلاً IoCهای مربوط به مسمومیت مدل) را در دسته‌بندی هشدار مشخص می‌کنند. |  3  |  V  |

---

## C6.7 لیست مواد ماشین لرنینگ (ML-BOM) برای آثار مدل

تولید و امضای SBOMهای خاص یادگیری ماشین (ML-BOMها) با جزئیات دقیق تا مصرف‌کنندگان پایین‌دست بتوانند در زمان استقرار، صحت اجزا را تأیید کنند.

|   #   | توضیحات                                                                                                                                     | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.7.1 | اطمینان حاصل کنید که هر مدل مصنوعی یک ML-BOM منتشر می‌کند که شامل دیتاست‌ها، وزن‌ها، ابرپارامترها و مجوزها باشد.                            |  1  | D/V |
| 6.7.2 | تأیید کنید که تولید ML‑BOM و امضای Cosign در CI خودکار شده و برای ادغام الزامی است.                                                         |  1  | D/V |
| 6.7.3 | بررسی کنید که چک‌های کامل بودن ML‑BOM در صورت فقدان هرگونه فراداده مؤلفه (هش، مجوز) منجر به شکست ساخت شوند.                                 |  2  |  D  |
| 6.7.4 | تأیید کنید که مصرف‌کنندگان پایین‌دستی می‌توانند از طریق API به ML-BOMها پرس‌وجو کنند تا مدل‌های واردشده را در زمان استقرار اعتبارسنجی کنند. |  2  |  V  |
| 6.7.5 | اطمینان حاصل کنید که ML‑BOMها نسخه‌بندی شده و به منظور تشخیص تغییرات غیرمجاز، مقایسه شده‌اند.                                               |  3  |  V  |

---

## مراجع

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


# امنیت زنجیره تأمین C6 برای مدل‌ها، چارچوب‌ها و داده‌ها

## هدف کنترل

حملات زنجیره تامین هوش مصنوعی از مدل‌ها، چارچوب‌ها یا مجموعه‌داده‌های شخص ثالث بهره می‌برند تا درب‌های پشتی، تعصب یا کدهای قابل سوءاستفاده را جاسازی کنند. این کنترل‌ها مدیریت تمام‌عیار منشاء، مدیریت آسیب‌پذیری و نظارت را برای محافظت از کل چرخه عمر مدل فراهم می‌کنند.

---

## C6.1 بررسی مدل پیش‌آموزش‌دیده و پیشینه

قبل از هرگونه تنظیم دقیق یا استقرار، منشأ، مجوزها و رفتارهای مخفی مدل‌های شخص ثالث را ارزیابی و تأیید کنید.

|   #   | توضیحات                                                                                                                                 | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.1.1 | اطمینان حاصل کنید که هر اثر مدل شخص ثالث شامل یک رکورد منشأ امضا شده باشد که مخزن منبع و هش کامیت را شناسایی می‌کند.                    |  1  | D/V |
| 6.1.2 | اطمینان حاصل کنید که مدل‌ها قبل از وارد کردن، با استفاده از ابزارهای خودکار برای بررسی لایه‌های مخرب یا تریگرهای تروجان اسکن شده باشند. |  1  | D/V |
| 6.1.3 | اطمینان حاصل کنید که تنظیم دقیق با استفاده از یادگیری انتقالی، ارزیابی مقابله‌ای را برای شناسایی رفتارهای پنهان پشت سر می‌گذارد.        |  2  |  D  |
| 6.1.4 | اطمینان حاصل کنید که مجوزهای مدل، برچسب‌های کنترل صادرات و بیانیه‌های منشاء داده در یک ورودی ML-BOM ثبت شده باشند.                      |  2  |  V  |
| 6.1.5 | تأیید کنید که مدل‌های پرخطر (وزن‌های آپلود شده عمومی، سازندگان تأیید نشده) تا زمان بررسی و تأیید انسانی تحت قرنطینه باقی بمانند.        |  3  | D/V |

---

## C6.2 اسکن فریمورک و کتابخانه

به طور مداوم چارچوب‌ها و کتابخانه‌های یادگیری ماشین را برای CVEها و کد مخرب اسکن کنید تا پشته زمان اجرا امن باقی بماند.

|   #   | توضیحات                                                                                                                           | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.2.1 | اطمینان حاصل کنید که خطوط لوله CI اسکنرهای وابستگی را روی چارچوب‌های هوش مصنوعی و کتابخانه‌های حیاتی اجرا می‌کنند.                |  1  | D/V |
| 6.2.2 | تأیید کنید که آسیب‌پذیری‌های حیاتی (CVSS ≥ 7.0) از ارتقاء به تصاویر تولیدی جلوگیری می‌کنند.                                       |  1  | D/V |
| 6.2.3 | تأیید کنید که تحلیل ایستا کد بر روی کتابخانه‌های ML منشعب شده یا وارد شده اجرا می‌شود.                                            |  2  |  D  |
| 6.2.4 | تأیید کنید که پیشنهادهای ارتقاء چارچوب شامل ارزیابی تأثیر امنیتی با ارجاع به منابع عمومی CVE باشد.                                |  2  |  V  |
| 6.2.5 | تأیید کنید که حسگرهای زمان اجرا در مورد بارگذاری‌های غیرمنتظره کتابخانه‌های دینامیک که از SBOM امضا شده انحراف دارند، هشدار دهند. |  3  |  V  |

---

## C6.3 پین‌کردن و تأیید وابستگی‌ها

همه وابستگی‌ها را به هش‌های غیرقابل تغییر قفل کنید و ساخت‌ها را بازتولید کنید تا تضمین شود که آثار به‌دست‌آمده یکسان و بدون دستکاری هستند.

|   #   | توضیحات                                                                                                                                | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.3.1 | بررسی کنید که آیا تمام مدیران بسته اعمال قفل نسخه را از طریق فایل‌های قفل تضمین می‌کنند.                                               |  1  | D/V |
| 6.3.2 | تأیید کنید که در ارجاعات کانتینر به جای برچسب‌های متغیر از هش‌های تغییرناپذیر استفاده شده است.                                         |  1  | D/V |
| 6.3.3 | اطمینان حاصل کنید که بررسی‌های ساخت مجدد، هش‌ها را در طول اجرای CI مقایسه می‌کنند تا خروجی‌های یکسان تضمین شود.                        |  2  |  D  |
| 6.3.4 | اطمینان حاصل کنید که تصدیق‌های ساخت برای 18 ماه جهت ردیابی حسابرسی ذخیره می‌شوند.                                                      |  2  |  V  |
| 6.3.5 | اطمینان حاصل کنید که وابستگی‌های منقضی شده باعث ایجاد درخواست‌های خودکار اصلاح (PR) برای به‌روزرسانی یا فورک نسخه‌های پین‌شده می‌شوند. |  3  |  D  |

---

## C6.4 اجرای منبع مورد اعتماد

امکان دانلود مصنوعات فقط از منابع تأیید شده رمزنگاری شده و مورد تایید سازمان را فراهم کنید و سایر موارد را مسدود کنید.

|   #   | توضیحات                                                                                                             | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.4.1 | تأیید کنید که وزن‌های مدل، مجموعه‌داده‌ها و کانتینرها تنها از دامنه‌های تأیید شده یا رجیستری‌های داخلی دانلود شوند. |  1  | D/V |
| 6.4.2 | تأیید کنید که امضاهای Sigstore/Cosign هویت ناشر را قبل از ذخیره محلی آثار اعتبارسنجی می‌کنند.                       |  1  | D/V |
| 6.4.3 | اطمینان حاصل کنید که پراکسی‌های خروجی دانلودهای غیرمجاز آثار را مسدود می‌کنند تا سیاست منبع مورد اعتماد اعمال شود.  |  2  |  D  |
| 6.4.4 | تأیید کنید که فهرست‌های مجاز مخزن به صورت فصلی بازبینی می‌شوند و برای هر ورودی دلیل تجاری به‌عنوان مدرک وجود دارد.  |  2  |  V  |
| 6.4.5 | تأیید کنید که نقض‌های سیاست منجر به قرنطینه شدن مصنوعات و بازگشت اجرای خطوط لوله وابسته می‌شود.                     |  3  |  V  |

---

## C6.5 ارزیابی ریسک مجموعه داده‌های شخص ثالث

داده‌های خارجی را از نظر مسمومیت، تعصب و تطابق قانونی ارزیابی کرده و در طول چرخه عمر آنها را پایش کنید.

|   #   | توضیحات                                                                                                                         | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.5.1 | اطمینان حاصل کنید که مجموعه داده‌های خارجی تحت ارزیابی ریسک مسمومیت قرار می‌گیرند (مثلاً اثر انگشت داده، شناسایی داده‌های پرت). |  1  | D/V |
| 6.5.2 | اطمینان حاصل کنید که معیارهای تعصب (توازن جمعیتی، فرصت برابر) قبل از تایید مجموعه داده محاسبه شده‌اند.                          |  1  |  D  |
| 6.5.3 | اطمینان حاصل کنید که اصالت و شرایط مجوز برای مجموعه داده‌ها در ورودی‌های ML-BOM ثبت شده باشد.                                   |  2  |  V  |
| 6.5.4 | تأیید کنید که پایش دوره‌ای تغییر یا فساد در مجموعه داده‌های میزبانی شده را تشخیص دهد.                                           |  2  |  V  |
| 6.5.5 | تأیید کنید که محتوای غیرمجاز (حق نشر، اطلاعات شناسایی شخصی) پیش از آموزش از طریق پاک‌سازی خودکار حذف شده باشد.                  |  3  |  D  |

---

## C6.6 نظارت بر حملات زنجیره تأمین

تهدیدهای زنجیره تأمین را از طریق فیدهای CVE، تحلیل‌های لاگ حسابرسی و شبیه‌سازی‌های تیم قرمز به‌موقع تشخیص دهید.

|   #   | توضیحات                                                                                                                                                                 | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.6.1 | تأیید کنید که گزارش‌های حسابرسی CI/CD به جریان تشخیص‌های SIEM برای کشیدن‌های غیرعادی بسته یا مراحل ساخت دستکاری‌شده ارسال می‌شوند.                                      |  1  |  V  |
| 6.6.2 | تأیید کنید که کتابچه‌های پاسخ به حادثه شامل روش‌های بازگشت برای مدل‌ها یا کتابخانه‌های آسیب‌دیده باشد.                                                                  |  2  |  D  |
| 6.6.3 | تایید کنید که برچسب‌های غنی‌سازی اطلاعات تهدید، شاخص‌های خاص یادگیری ماشین (مانند نشانگرهای IoC مربوط به مسموم‌سازی مدل) را در مرحله سه‌گانه هشدار علامت‌گذاری می‌کنند. |  3  |  V  |

---

## C6.7 ML‑BOM برای مصنوعات مدل

تولید و امضای SBOMهای دقیق خاص یادگیری ماشین (ML‑BOMها) به طوری که مصرف‌کنندگان در مراحل بعدی بتوانند صحت اجزاء را در زمان استقرار بررسی کنند.

|   #   | توضیحات                                                                                                                                     | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.7.1 | اطمینان حاصل کنید که هر اثر مدل یک ML-BOM منتشر می‌کند که شامل مجموعه داده‌ها، وزن‌ها، هایپرپارامترها و مجوزها است.                         |  1  | D/V |
| 6.7.2 | اطمینان حاصل کنید که تولید ML‑BOM و امضای Cosign به صورت خودکار در CI انجام شده و برای ادغام ضروری هستند.                                   |  1  | D/V |
| 6.7.3 | اطمینان حاصل کنید که بررسی‌های کامل بودن ML‑BOM در صورت فقدان هر گونه متادیتای مؤلفه (هش، مجوز) ساخت را ناموفق اعلام می‌کنند.               |  2  |  D  |
| 6.7.4 | بررسی کنید که مصرف‌کنندگان پایین‌دستی قادر باشند از طریق API به ML-BOMها query کنند تا مدل‌های وارد شده را در زمان استقرار اعتبارسنجی کنند. |  2  |  V  |
| 6.7.5 | اطمینان حاصل کنید که ML-BOMها نسخه‌بندی شده و مقایسه می‌شوند تا تغییرات غیرمجاز شناسایی شوند.                                               |  3  |  V  |

---

## مراجع

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


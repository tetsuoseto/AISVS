# امنیت زنجیره تأمین C6 برای مدل‌ها، چارچوب‌ها و داده‌ها

## هدف کنترل

حملات زنجیره تأمین هوش مصنوعی از مدل‌ها، چارچوب‌ها یا مجموعه داده‌های شخص ثالث سوء استفاده می‌کنند تا درهای پشتی، تعصب یا کد قابل بهره‌برداری را جاسازی کنند. این کنترل‌ها شفافیت کامل منبع، مدیریت آسیب‌پذیری و نظارت را فراهم می‌کنند تا از کل چرخه عمر مدل محافظت شود.

---

## C6.1 بررسی و اصالت مدل‌های از پیش آموزش‌دیده‌شده

قبل از هرگونه تنظیم دقیق یا استقرار، منشاء، مجوزها و رفتارهای پنهان مدل‌های شخص ثالث را ارزیابی و تأیید کنید.

|   #   | توضیحات                                                                                                                                                | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 6.1.1 | اطمینان حاصل کنید که هر اثر مدل شخص ثالث شامل یک رکورد اصالت امضا شده باشد که مخزن منبع و هش کامیت را شناسایی می‌کند.                                  |  1  | D/V |
| 6.1.2 | اطمینان حاصل کنید که مدل‌ها قبل از وارد کردن، با استفاده از ابزارهای خودکار برای لایه‌های مخرب یا محرک‌های تروجان بررسی می‌شوند.                       |  1  | D/V |
| 6.1.3 | تأیید کنید که آموزش مجدد با انتقال یادگیری، ارزیابی ضد حمله را پشت سر می‌گذارد تا رفتارهای پنهان را شناسایی کند.                                       |  2  |  D  |
| 6.1.4 | اطمینان حاصل کنید که مجوزهای مدل، برچسب‌های کنترل صادرات، و بیانیه‌های منبع داده در یک ورودی ML-BOM ثبت شده‌اند.                                       |  2  |  V  |
| 6.1.5 | اطمینان حاصل کنید که مدل‌های پرخطر (وزن‌های بارگذاری شده به صورت عمومی، سازندگان تاییدنشده) تا زمان بررسی و تایید توسط انسان در قرنطینه باقی می‌مانند. |  3  | D/V |

---

## اسکن چارچوب و کتابخانه C6.2

به‌طور مداوم چارچوب‌ها و کتابخانه‌های یادگیری ماشین را برای آسیب‌پذیری‌های امنیتی (CVE) و کدهای مخرب اسکن کنید تا پشته زمان اجرا را امن نگه دارید.

|   #   | توضیحات                                                                                                                                   | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.2.1 | تأیید کنید که خطوط لوله CI اسکنرهای وابستگی را بر روی چارچوب‌های هوش مصنوعی و کتابخانه‌های حیاتی اجرا می‌کنند.                            |  1  | D/V |
| 6.2.2 | اطمینان حاصل کنید که آسیب‌پذیری‌های بحرانی (CVSS ≥ 7.0) باعث جلوگیری از ارتقاء به تصاویر تولیدی می‌شوند.                                  |  1  | D/V |
| 6.2.3 | اطمینان حاصل کنید که تحلیل ایستا کد بر روی کتابخانه‌های ML تقسیم‌شده یا فروشنده انجام می‌شود.                                             |  2  |  D  |
| 6.2.4 | تأیید کنید که پیشنهادهای ارتقاء چارچوب شامل ارزیابی تأثیر امنیتی با ارجاع به فیدهای عمومی CVE باشد.                                       |  2  |  V  |
| 6.2.5 | اطمینان حاصل کنید که حسگرهای زمان اجرا در صورت بارگذاری‌های غیرمنتظره کتابخانه‌های پویا که با SBOM امضا شده مطابقت ندارند، هشدار می‌دهند. |  3  |  V  |

---

## C6.3 تثبیت و تأیید وابستگی‌ها

تمام وابستگی‌ها را به هش‌های غیرقابل تغییر قفل کنید و بازسازی‌های تولید را انجام دهید تا از تولید مصنوعات مشابه و بدون دستکاری اطمینان حاصل شود.

|   #   | توضیحات                                                                                                                   | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.3.1 | اطمینان حاصل کنید که همه مدیران بسته نسخه‌بندی از طریق فایل‌های قفل را اعمال می‌کنند.                                     |  1  | D/V |
| 6.3.2 | تأیید کنید که به جای برچسب‌های قابل تغییر، از چکیده‌های غیرقابل تغییر در ارجاعات کانتینر استفاده شده باشد.                |  1  | D/V |
| 6.3.3 | اطمینان حاصل کنید که بررسی‌های ساخت قابل‌تکرار، هش‌ها را در اجرای CI مقایسه می‌کنند تا خروجی‌های یکسان تضمین شوند.        |  2  |  D  |
| 6.3.4 | اطمینان حاصل کنید که تاییدیه‌های ساخت به مدت 18 ماه برای ردیابی ممیزی ذخیره می‌شوند.                                      |  2  |  V  |
| 6.3.5 | تأیید کنید که وابستگی‌های منقضی شده، درخواست‌های کشش خودکار را برای به‌روزرسانی یا انشعاب نسخه‌های ثابت شده فعال می‌کنند. |  3  |  D  |

---

## C6.4 اجرای منبع مورد اعتماد

دانلود آثار فقط از منابعی که توسط سازمان به صورت رمزنگاری شده تأیید شده‌اند مجاز است و همه موارد دیگر مسدود شود.

|   #   | توضیحات                                                                                                                 | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.4.1 | تأیید کنید که وزن‌های مدل، مجموعه‌داده‌ها و کانتینرها فقط از دامنه‌های مورد تایید یا رجیستری‌های داخلی دانلود می‌شوند.  |  1  | D/V |
| 6.4.2 | اطمینان حاصل کنید که امضاهای Sigstore/Cosign قبل از ذخیره محلی آثار، هویت ناشر را تأیید می‌کنند.                        |  1  | D/V |
| 6.4.3 | تأیید کنید که پراکسی‌های خروجی دانلودهای بدون احراز هویت آثار را مسدود می‌کنند تا سیاست منبع مورد اعتماد را اعمال کنند. |  2  |  D  |
| 6.4.4 | بررسی کنید که فهرست‌های مجاز مخزن به صورت سه‌ماهه بازبینی می‌شوند و برای هر ورودی، شواهدی از توجیه کسب‌وکار وجود دارد.  |  2  |  V  |
| 6.4.5 | تأیید کنید که نقض سیاست‌ها موجب قرنطینه شدن آثار و بازگردانی اجرای خط‌لوله‌های وابسته می‌شود.                           |  3  |  V  |

---

## C6.5 ارزیابی ریسک داده‌های شخص ثالث

داده‌های خارجی را از نظر آلودگی، تعصب و تطابق قانونی ارزیابی کرده و در طول دوره عمر آن‌ها را نظارت کنید.

|   #   | توضیحات                                                                                                                    | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.5.1 | اطمینان حاصل کنید که داده‌های خارجی مورد ارزیابی ریسک آلودگی قرار می‌گیرند (مانند اثرانگشت داده‌ها، تشخیص نقاط دورافتاده). |  1  | D/V |
| 6.5.2 | اطمینان حاصل کنید که معیارهای تبعیض (برابری جمعیتی، فرصت برابر) قبل از تصویب مجموعه داده محاسبه شده‌اند.                   |  1  |  D  |
| 6.5.3 | اطمینان حاصل کنید که منشاء و شرایط مجوز برای مجموعه داده‌ها در ورودی‌های ML‑BOM ثبت شده است.                               |  2  |  V  |
| 6.5.4 | تأیید کنید که پایش دوره‌ای تغییر یا فساد در مجموعه داده‌های میزبانی‌شده را شناسایی می‌کند.                                 |  2  |  V  |
| 6.5.5 | اطمینان حاصل کنید که محتوای غیرمجاز (حق چاپ، اطلاعات شخصی شناسایی شده) از طریق پاکسازی خودکار پیش از آموزش حذف شده است.    |  3  |  D  |

---

## C6.6 نظارت بر حملات زنجیره تامین

تهدیدهای زنجیره تامین را از طریق خوراک‌های CVE، تحلیل‌های گزارش حسابرسی، و شبیه‌سازی‌های تیم قرمز به‌صورت زودهنگام شناسایی کنید.

|   #   | توضیحات                                                                                                                                                 | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.6.1 | بررسی کنید که لاگ‌های ممیزی CI/CD به صورت جریان به تشخیص‌های SIEM برای کشیدن بسته‌های غیرعادی یا مراحل ساخت دستکاری‌شده منتقل می‌شوند.                  |  1  |  V  |
| 6.6.2 | تأیید کنید که راهنماهای واکنش به حادثه شامل روش‌های بازگردانی برای مدل‌ها یا کتابخانه‌های به خطر افتاده باشند.                                          |  2  |  D  |
| 6.6.3 | تأیید کنید که برچسب‌های غنی‌سازی تهدید-اطلاعات، شاخص‌های اختصاصی یادگیری ماشین (مثلاً IoCهای مسموم‌سازی مدل) را در دسته‌بندی هشدار علامت‌گذاری می‌کنند. |  3  |  V  |

---

## C6.7 لیست مواد ماشین لرنینگ (ML‑BOM) برای مصنوعات مدل

تولید و امضای SBOMهای تخصصی ML (ML‑BOMها) به‌صورت دقیق تا مصرف‌کنندگان پایین‌دستی بتوانند صحت مؤلفه‌ها را در زمان استقرار تأیید کنند.

|   #   | توضیحات                                                                                                                                   | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.7.1 | اطمینان حاصل کنید که هر اثر مدل یک ML‑BOM منتشر می‌کند که شامل مجموعه داده‌ها، وزن‌ها، ابرپارامترها و مجوزها است.                         |  1  | D/V |
| 6.7.2 | تأیید کنید که تولید ML‑BOM و امضای Cosign در CI خودکار شده و برای ادغام ضروری است.                                                        |  1  | D/V |
| 6.7.3 | اطمینان حاصل کنید که بررسی‌های کامل بودن ML‑BOM در صورتی که هر گونه فراداده مؤلفه (هش، مجوز) مفقود باشد، فرایند ساخت را ناموفق می‌کند.    |  2  |  D  |
| 6.7.4 | تأیید کنید که مصرف‌کنندگان پایین‌دستی بتوانند از طریق API به ML-BOMها پرس‌وجو کنند تا مدل‌های واردشده را در زمان استقرار اعتبارسنجی کنند. |  2  |  V  |
| 6.7.5 | اطمینان حاصل کنید که ML‑BOMها تحت کنترل نسخه قرار دارند و برای شناسایی تغییرات غیرمجاز، تفاوت‌گیری می‌شوند.                               |  3  |  V  |

---

## مراجع

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


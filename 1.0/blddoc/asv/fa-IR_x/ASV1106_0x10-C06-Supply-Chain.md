# امنیت زنجیره تامین C6 برای مدل‌ها، چارچوب‌ها و داده‌ها

## هدف کنترل

حملات زنجیره تأمین هوش مصنوعی از مدل‌ها، چارچوب‌ها یا مجموعه‌داده‌های شخص ثالث سوءاستفاده می‌کنند تا درهای پشتی، تعصب یا کد قابل بهره‌برداری را جاسازی کنند. این کنترل‌ها ردیابی جامع، مدیریت آسیب‌پذیری و نظارت را برای محافظت از کل چرخه عمر مدل فراهم می‌کنند.

---

## C6.1 بررسی مدل‌های از پیش آموزش‌دیده و منشأ آنها

اصالت و منبع مدل‌های شخص ثالث، مجوزها و رفتارهای پنهان آن‌ها را پیش از هر گونه تنظیم دقیق یا استقرار ارزیابی و تأیید کنید.

|   #   | توضیحات                                                                                                                                         | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.1.1 | اطمینان حاصل کنید که هر اثر مدل شخص ثالث شامل یک رکورد منشاء امضاء شده باشد که مخزن منبع و هش کامیت را مشخص می‌کند.                             |  1  | D/V |
| 6.1.2 | اطمینان حاصل کنید که مدل‌ها با استفاده از ابزارهای خودکار قبل از وارد کردن، برای لایه‌های مخرب یا محرک‌های تروجان اسکن شده‌اند.                 |  1  | D/V |
| 6.1.3 | تأیید کنید که ریزتنظیم‌های یادگیری انتقالی از ارزیابی مقابله‌ای عبور می‌کنند تا رفتارهای پنهان را شناسایی کنند.                                 |  2  |  D  |
| 6.1.4 | اطمینان حاصل کنید که مجوزهای مدل، برچسب‌های کنترل صادرات، و بیانیه‌های منشأ داده در یک ورودی ML‑BOM ثبت شده‌اند.                                |  2  |  V  |
| 6.1.5 | اطمینان حاصل کنید که مدل‌های پرخطر (وزن‌های بارگذاری شده به‌صورت عمومی، سازندگان تأییدنشده) تا زمان بازبینی و تایید انسانی قرنطینه باقی بمانند. |  3  | D/V |

---

## C6.2 اسکن چارچوب و کتابخانه

مداوم فریم‌ورک‌ها و کتابخانه‌های یادگیری ماشین را برای CVEها و کدهای مخرب اسکن کنید تا پشته زمان اجرا ایمن بماند.

|   #   | توضیحات                                                                                                                       | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.2.1 | اطمینان حاصل کنید که خطوط لوله CI اسکنرهای وابستگی را بر روی چارچوب‌های هوش مصنوعی و کتابخانه‌های حیاتی اجرا می‌کنند.         |  1  | D/V |
| 6.2.2 | تأیید کنید که آسیب‌پذیری‌های بحرانی (CVSS ≥ 7.0) باعث جلوگیری از ترفیع به تصاویر تولید می‌شوند.                               |  1  | D/V |
| 6.2.3 | تأیید کنید که تجزیه و تحلیل کد ایستا بر روی کتابخانه‌های یادگیری ماشین منشعب شده یا واگذار شده اجرا می‌شود.                   |  2  |  D  |
| 6.2.4 | تأیید کنید که پیشنهادهای ارتقاء چهارچوب شامل ارزیابی تاثیر امنیتی با ارجاع به منابع عمومی CVE باشد.                           |  2  |  V  |
| 6.2.5 | تأیید کنید که حسگرهای زمان اجرا در بارگذاری‌های غیرمنتظره کتابخانه‌های پویا که از SBOM امضا شده منحرف می‌شوند، هشدار می‌دهند. |  3  |  V  |

---

## C6.3 ثابت نگه داشتن و تایید وابستگی‌ها

تمام وابستگی‌ها را به صورت گسسته و غیرقابل تغییر پین کنید و بازتولیدهای ساخت را انجام دهید تا آثار کاملاً مشابه و بدون دستکاری تضمین شود.

|   #   | توضیحات                                                                                                                | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.3.1 | بررسی کنید که آیا همه مدیران بسته‌ها اعمال پین‌کردن نسخه را از طریق فایل‌های قفل اجرا می‌کنند.                         |  1  | D/V |
| 6.3.2 | اطمینان حاصل کنید که در ارجاعات کانتینر از خلاصه‌های غیرقابل تغییر به جای برچسب‌های قابل تغییر استفاده شده است.        |  1  | D/V |
| 6.3.3 | اطمینان حاصل کنید که بررسی‌های ساخت بازتولیدپذیر، هش‌ها را در اجراهای CI مقایسه می‌کنند تا خروجی‌های یکسان تضمین شود.  |  2  |  D  |
| 6.3.4 | تأیید کنید که تصدیق‌های ساخت به مدت 18 ماه برای قابلیت ردیابی حسابرسی ذخیره می‌شوند.                                   |  2  |  V  |
| 6.3.5 | تأیید کنید که وابستگی‌های منقضی شده باعث ایجاد درخواست‌های خودکار برای به‌روزرسانی یا انشعاب نسخه‌های پین‌شده می‌شوند. |  3  |  D  |

---

## C6.4 اجرای منبع مورد اعتماد

دانلود آثار فقط از منابع تأییدشده رمزنگاری شده و سازمانی مجاز را مجاز کنید و بقیه را مسدود کنید.

|   #   | توضیحات                                                                                                                       | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.4.1 | تأیید کنید که وزن‌های مدل، مجموعه داده‌ها و کانتینرها تنها از دامنه‌های تایید شده یا رجیستری‌های داخلی دانلود شوند.           |  1  | D/V |
| 6.4.2 | تأیید کنید که امضاهای Sigstore/Cosign هویت ناشر را قبل از اینکه آثار به صورت محلی کش شوند، اعتبارسنجی می‌کنند.                |  1  | D/V |
| 6.4.3 | تأیید کنید که پراکسی‌های خروجی دانلودهای بدون تأیید هویت شده‌ی آثار را مسدود می‌کنند تا سیاست منبع مورد اعتماد را اعمال کنند. |  2  |  D  |
| 6.4.4 | تأیید کنید که فهرست‌های مجاز مخزن به صورت سه‌ماهه بازبینی می‌شوند و برای هر ورودی دلیل کسب‌وکاری قابل اثبات وجود دارد.        |  2  |  V  |
| 6.4.5 | تأیید کنید که نقض سیاست‌ها باعث قرنطینه شدن آثار و بازگردانی اجرای خطوط لوله وابسته می‌شود.                                   |  3  |  V  |

---

## C6.5 ارزیابی ریسک مجموعه داده‌های شخص ثالث

داده‌های خارجی را از نظر آلودگی، تعصب و تطابق قانونی ارزیابی کرده و در طول چرخه عمر آن‌ها را پایش کنید.

|   #   | توضیحات                                                                                                                                   | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.5.1 | اطمینان حاصل کنید که داده‌های مجموعه‌های خارجی تحت امتیازدهی ریسک مسمومیت قرار می‌گیرند (برای مثال، اثرانگشت داده، تشخیص نقاط دورافتاده). |  1  | D/V |
| 6.5.2 | تأیید کنید که معیارهای تبعیض (تساوی جمعیتی، فرصت برابر) قبل از تأیید مجموعه داده محاسبه شده‌اند.                                          |  1  |  D  |
| 6.5.3 | اطمینان حاصل کنید که منبع و شرایط مجوز داده‌ها در ورودی‌های ML‑BOM ثبت شده‌اند.                                                           |  2  |  V  |
| 6.5.4 | اطمینان حاصل کنید که پایش دوره‌ای تغییر یا فساد در داده‌های میزبانی شده را تشخیص می‌دهد.                                                  |  2  |  V  |
| 6.5.5 | اطمینان حاصل کنید که محتوای غیرمجاز (حق نشر، اطلاعات شخصی شناسایی‌پذیر) از طریق پاک‌سازی خودکار قبل از آموزش حذف شده باشد.                |  3  |  D  |

---

## C6.6 نظارت بر حمله به زنجیره تامین

تهدیدات زنجیره تامین را از طریق فیدهای CVE، تحلیل‌های لاگ‌های حسابرسی و شبیه‌سازی‌های تیم قرمز زودهنگام شناسایی کنید.

|   #   | توضیحات                                                                                                                                                                             | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.6.1 | تأیید کنید که لاگ‌های ممیزی CI/CD به جریان کشف‌های SIEM برای کشش‌های بسته غیرمعمول یا مراحل ساخت دستکاری شده منتقل می‌شوند.                                                         |  1  |  V  |
| 6.6.2 | اطمینان حاصل کنید که کتاب‌های راهنمای واکنش به حادثه شامل روش‌های بازگردانی برای مدل‌ها یا کتابخانه‌های آسیب‌دیده هستند.                                                            |  2  |  D  |
| 6.6.3 | اعتبارسنجی کنید که تگ‌های غنی‌سازی اطلاعات تهدید، شاخص‌های اختصاصی یادگیری ماشینی (برای مثال، IoCهای مربوط به مسموم‌سازی مدل) را در فرآیند سه‌مرحله‌ای هشدارها علامت‌گذاری می‌کنند. |  3  |  V  |

---

## C6.7 لیست مواد ماشین لرنینگ (ML-BOM) برای مصنوعات مدل

تولید و امضای SBOMهای خاص یادگیری ماشین (ML-BOMها) به‌صورت دقیق تا مصرف‌کنندگان پایین‌دست بتوانند صحت اجزا را در زمان استقرار تأیید کنند.

|   #   | توضیحات                                                                                                                                             | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.7.1 | تأیید کنید که هر نمونه مدل یک ML‑BOM منتشر می‌کند که شامل مجموعه داده‌ها، وزن‌ها، ابرپارامترها و مجوزها باشد.                                       |  1  | D/V |
| 6.7.2 | تأیید کنید که تولید ML‑BOM و امضای Cosign در فرآیند CI خودکار شده و برای ادغام الزامی است.                                                          |  1  | D/V |
| 6.7.3 | اطمینان حاصل کنید که بررسی‌های کامل بودن ML‑BOM در صورت فقدان هر گونه متاداده مؤلفه (هش، مجوز) فرآیند ساخت را متوقف می‌کنند.                        |  2  |  D  |
| 6.7.4 | اطمینان حاصل کنید که مصرف‌کنندگان پایین‌دستی می‌توانند از طریق API به ML-BOMها پرس‌وجو کنند تا مدل‌های وارد شده را در زمان استقرار اعتبارسنجی کنند. |  2  |  V  |
| 6.7.5 | اطمینان حاصل کنید که ML-BOMها تحت نسخه کنترل قرار دارند و تفاوت‌های آن‌ها بررسی می‌شود تا تغییرات غیرمجاز شناسایی شود.                              |  3  |  V  |

---

## مراجع

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


# C6 امنیت زنجیره تامین برای مدل‌ها، چارچوب‌ها و داده‌ها

## هدف کنترل

حملات زنجیره تامین هوش مصنوعی از مدل‌ها، چارچوب‌ها یا مجموعه‌داده‌های طرف ثالث برای جاسازی درب‌های پشتی، سوگیری یا کد قابل بهره‌برداری استفاده می‌کنند. این کنترل‌ها، ردپای یکپارچه از ابتدا تا انتها، مدیریت آسیب‌پذیری و نظارت را برای حفاظت از کل چرخه عمر مدل فراهم می‌آورند.

---

## C6.1 بازبینی و منشأ مدل از پیش‌آموزش‌دیده

ارزیابی و احراز اصالت منشأهای مدل‌های طرف ثالث، مجوزها و رفتارهای پنهان آنها پیش از هرگونه تنظیم دقیق یا استقرار.

|   #   | شرح                                                                                                                                              | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 6.1.1 | تأیید کنید که هر آرتیفکت مدلِ طرف‌سوم دارای یک سند منشأ امضا شده باشد که مخزن منبع و هش کامیت را مشخص کند.                                       |  1  | D/V |
| 6.1.2 | اطمینان حاصل کنید که مدل‌ها قبل از وارد کردن، با استفاده از ابزارهای خودکار برای وجود لایه‌های مخرب یا محرک‌های تروجان اسکن می‌شوند.             |  1  | D/V |
| 6.1.3 | تأیید کنید که transfer‑learning fine‑tunes از ارزیابی مهاجمانه عبور می‌کنند تا رفتارهای پنهان را تشخیص دهند.                                     |  2  |  D  |
| 6.1.4 | اطمینان حاصل کنید که مجوزهای مدل، برچسب‌های کنترل صادرات، و اظهارات منبع داده در ورودی ML‑BOM ثبت شده‌اند.                                       |  2  |  V  |
| 6.1.5 | تأیید کنید که مدل‌های با ریسک بالا (وزنه‌های بارگذاری‌شده توسط عموم، سازندگان تأییدنشده) تا بازبینی انسانی و امضای نهایی در قرنطینه باقی بمانند. |  3  | D/V |

---

## C6.2 اسکن چارچوب‌ها و کتابخانه‌ها

به طور مداوم چارچوب‌ها و کتابخانه‌های یادگیری ماشین را برای CVEs و کد مخرب اسکن کنید تا پشته زمان اجرا امن بماند.

|   #   | شرح                                                                                                                                           | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.2.1 | تأیید کنید که خط لوله‌های CI اسکنرهای وابستگی را روی چارچوب‌های هوش مصنوعی و کتابخانه‌های حیاتی اجرا کنند.                                    |  1  | D/V |
| 6.2.2 | تأیید کنید که آسیب‌پذیری‌های بحرانی (CVSS ≥ 7.0) مانع از ارتقاء تصاویر به محیط تولید می‌شوند.                                                 |  1  | D/V |
| 6.2.3 | تأیید کنید که تحلیل کد ایستا روی کتابخانه‌های یادگیری ماشین که فورک شده‌اند یا درون پروژه به عنوان وابستگی‌ها قرار داده شده‌اند، اجرا می‌شود. |  2  |  D  |
| 6.2.4 | اطمینان حاصل کنید که پیشنهادهای به‌روزرسانی فریم‌ورک شامل ارزیابی تأثیر امنیتی است که به فیدهای CVE عمومی ارجاع می‌کند.                       |  2  |  V  |
| 6.2.5 | اطمینان حاصل کنید که حسگرهای زمان اجرا به بارگذاری‌های نامنتظره کتابخانه‌های پویا که از SBOM امضاشده انحراف می‌کنند، هشدار دهند.              |  3  |  V  |

---

## C6.3 ثابت‌سازی وابستگی‌ها و تأیید

تمامی وابستگی‌ها را به هش‌های غیرقابل تغییر قفل کن و بیلدها را بازتولید کن تا اقلام ساخت یکسان و بدون دستکاری تضمین شوند.

|   #   | شرح                                                                                                                  | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.3.1 | بررسی کنید که تمامی مدیران بسته تثبیت نسخه را از طریق فایل‌های قفل اعمال می‌کنند.                                    |  1  | D/V |
| 6.3.2 | تأیید کنید که در ارجاع‌های کانتینر از هضم‌های غیرقابل تغییر به جای برچسب‌های قابل تغییر استفاده می‌شود.              |  1  | D/V |
| 6.3.3 | تأیید کنید که بررسی‌های reproducible-build هش‌ها را در طول اجراهای CI مقایسه می‌کنند تا خروجی‌های یکسانی تضمین شوند. |  2  |  D  |
| 6.3.4 | تأیید کنید که گواهی‌های ساخت به مدت 18 ماه برای ردیابی حسابرسی نگهداری می‌شوند.                                      |  2  |  V  |
| 6.3.5 | تصدیق کنید که وابستگی‌های منقضی‌شده، PRهای خودکار برای به‌روزرسانی یا فورک نسخه‌های پین‌شده را تحریک می‌کنند.        |  3  |  D  |

---

## C6.4 اجرای منبع معتبر

دانلود آرتیفکت‌ها را فقط از منابعی که از نظر رمزنگاری تأیید شده و توسط سازمان تأیید شده‌اند مجاز کنید و همه چیز غیر از آن را بلاک کنید.

|   #   | شرح                                                                                                                               | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.4.1 | اطمینان حاصل کنید که وزن‌های مدل، مجموعه داده‌ها و کانتینرها فقط از دامنه‌های تأییدشده یا رجیستری‌های داخلی دانلود می‌شوند.       |  1  | D/V |
| 6.4.2 | اطمینان حاصل کنید که امضاهای Sigstore/Cosign هویت ناشر را قبل از اینکه آثار نرم‌افزاری در کش محلی ذخیره شوند، اعتبارسنجی می‌کنند. |  1  | D/V |
| 6.4.3 | بررسی کنید که پروکسی‌های خروجی دانلودهای آرتیفکت بدون احراز هویت را مسدود می‌کنند تا سیاست منبع معتبر اعمال شود.                  |  2  |  D  |
| 6.4.4 | تأیید کنید که لیست‌های مجاز مخزن هر سه ماه یکبار بررسی می‌شوند و برای هر ورودی شواهد توجیه کسب‌وکار ارائه می‌شود.                 |  2  |  V  |
| 6.4.5 | تأیید کنید که نقض‌های سیاست منجر به قرنطینهٔ آثار و بازگردانی اجراهای وابسته به خط لوله می‌شود.                                   |  3  |  V  |

---

## C6.5 ارزیابی ریسک مجموعه داده‌های طرف سوم

مجموعه‌های دادهٔ خارجی را از نظر سم‌پاشی، سوگیری و تطابق قانونی ارزیابی کنید و آنها را در طول چرخه حیاتشان پایش کنید.

|   #   | شرح                                                                                                                                       | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.5.1 | اطمینان حاصل کنید که مجموعه‌های داده خارجی تحت امتیازدهی ریسک آلودگی داده‌ها قرار می‌گیرند (مثلاً اثر انگشت داده‌ها، تشخیص داده‌های پرت). |  1  | D/V |
| 6.5.2 | اطمینان حاصل کنید که معیارهای تبعیض (برابری جمعیتی، فرصت برابر) پیش از تأیید مجموعه داده محاسبه می‌شوند.                                  |  1  |  D  |
| 6.5.3 | اطمینان حاصل کنید که منشأ داده‌ها و شرایط مجوز برای مجموعه‌های داده در ورودی‌های ML‑BOM ثبت شده‌اند.                                      |  2  |  V  |
| 6.5.4 | اطمینان حاصل کنید که پایش دوره‌ای، انحراف داده یا خرابی داده را در مجموعه‌های داده میزبانی‌شده شناسایی می‌کند.                            |  2  |  V  |
| 6.5.5 | اطمینان حاصل کنید که محتوای غیرمجاز (حقوق کپی‌رایت، اطلاعات شناسایی شخصی) از طریق پاک‌سازی خودکار پیش از آموزش حذف شده است.               |  3  |  D  |

---

## C6.6 نظارت بر حملات زنجیره تأمین

تهدیدهای زنجیره تأمین را از طریق فیدهای CVE، تحلیل لاگ‌های حسابرسی، و شبیه‌سازی‌های تیم قرمز به‌سرعت شناسایی کنید.

|   #   | شرح                                                                                                                                                                   | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.6.1 | اطمینان حاصل کنید که لاگ‌های حسابرسی CI/CD به تشخیص‌های SIEM هدایت می‌شوند تا بارگیری‌های نامعمول بسته‌ها یا مراحل ساخت دستکاری‌شده را شناسایی کنند.                  |  1  |  V  |
| 6.6.2 | تأیید کنید که راهنماهای پاسخ به حوادث امنیتی شامل رویه‌های بازگردانی برای مدل‌ها یا کتابخانه‌های آسیب‌دیده هستند.                                                     |  2  |  D  |
| 6.6.3 | تأیید کنید که برچسب‌های غنی‌سازی اطلاعات تهدید، شاخص‌های مخصوص یادگیری ماشین (مثلاً IoCs مربوط به مسموم‌سازی مدل) را در طبقه‌بندی و اولویت‌بندی هشدارها لحاظ می‌کنند. |  3  |  V  |

---

## C6.7 ML‑BOM برای آرتیفکت‌های مدل

فهرست‌های SBOM دقیق مخصوص ML (ML‑BOMs) تولید و امضا کنید تا مصرف‌کنندگان پایین‌دستی بتوانند در زمان استقرار، یکپارچگی مؤلفه‌ها را تأیید کنند.

|   #   | شرح                                                                                                                                     | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 6.7.1 | اطمینان حاصل کنید که هر آرتیفکت مدل، ML‑BOM منتشر می‌کند که فهرستی از مجموعه‌داده‌ها، وزن‌ها، هایپرپارامترها و مجوزها را در بر می‌گیرد. |  1  | D/V |
| 6.7.2 | بررسی کنید که تولید ML‑BOM و امضای Cosign به‌طور خودکار در CI انجام می‌شوند و برای ادغام لازم‌اند.                                      |  1  | D/V |
| 6.7.3 | اطمینان حاصل کنید که بررسی‌های تکمیل ML‑BOM در صورت گم بودن هر یک از متاداده‌های مؤلفه (هاش، لایسنس) بیلد را با شکست مواجه می‌کنند.     |  2  |  D  |
| 6.7.4 | تایید کنید که مصرف‌کنندگان پایین‌دست می‌توانند ML-BOMs را از طریق API کوئری کنند تا مدل‌های واردشده در زمان استقرار را اعتبارسنجی کنند. |  2  |  V  |
| 6.7.5 | تأیید کنید که ML‑BOMها تحت کنترل نسخه هستند و برای تشخیص تغییرات غیرمجاز، با تفاوت‌یابی مقایسه می‌شوند.                                 |  3  |  V  |

---

## منابع

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


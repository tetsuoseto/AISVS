# C5 کنترل دسترسی و هویت برای اجزای هوش مصنوعی و کاربران

## هدف کنترل

کنترل دسترسی مؤثر برای سیستم‌های هوش مصنوعی نیازمند مدیریت هویت قوی، مجوزدهی آگاه به زمینه، و اجرای در زمان اجرا بر پایه اصول صفراعتماد است. این کنترل‌ها تضمین می‌کنند که انسان‌ها، خدمات و عوامل خودمختار تنها با مدل‌ها، داده‌ها و منابع محاسباتی در محدوده‌های صریحاً اعطا شده تعامل داشته باشند، با قابلیت‌های تأیید و بازرسی مستمر.

---

## C5.1 مدیریت هویت و احراز هویت

برای تمامی موجودیت‌ها، هویت‌های مبتنی بر رمزنگاری ایجاد کنید که برای عملیات با دسترسی ویژه از احراز هویت چندعاملی استفاده کنند.

|   #   | شرح                                                                                                                                                                                                                                                         | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | اطمینان حاصل کنید که تمامی کاربران انسانی و شناسه‌های سرویس از طریق یک ارائه‌دهنده هویت سازمانی متمرکز (IdP) با استفاده از پروتکل‌های OIDC/SAML احراز هویت می‌کنند و دارای نگاشت‌های هویت به توکن منحصربه‌فرد هستند (بدون حساب‌ها یا اعتبارنامه‌های مشترک). |  1  | D/V |
| 5.1.2 | تأیید کنید که عملیات با ریسک بالا (استقرار مدل، صادرات وزن‌ها، دسترسی به داده‌های آموزشی، تغییرات پیکربندی تولید) به احراز هویت چندعاملی یا احراز هویت سطح بالاتر با بازبینی مجدد نشست نیاز دارند.                                                          |  1  | D/V |
| 5.1.3 | اطمینان حاصل کنید که کاربران جدید فرایند احراز هویت همسو با NIST 800-63-3 IAL-2 یا استانداردهای معادل را طی می‌کنند پیش از دریافت دسترسی به محیط تولید.                                                                                                     |  2  |  D  |
| 5.1.4 | بررسی کنید که بازنگری‌های دسترسی به‌طور سه‌ماهه انجام می‌شوند، با تشخیص خودکار حساب‌های غیرفعال، اجرای چرخش اعتبارها و روندهای لغو دسترسی.                                                                                                                  |  2  |  V  |
| 5.1.5 | اطمینان حاصل کنید که عامل‌های هوش مصنوعی فدراسیونی از طریق ادعاهای JWT امضا شده احراز هویت می‌کنند که دارای حداکثر مدت اعتبار 24 ساعت هستند و شامل اثبات رمزنگاری مبدا می‌باشند.                                                                            |  3  | D/V |

---

## C5.2 مجوز منابع و حداقل سطح دسترسی

پیاده‌سازی کنترل‌های دسترسی دقیق برای تمامی منابع هوش مصنوعی با مدل‌های مجوز صریح و سوابق ممیزی.

|   #   | شرح                                                                                                                                                                                                                                             | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | اطمینان حاصل کنید که هر منبع هوش مصنوعی (مجموعه‌های داده، مدل‌ها، نقاط پایانی، مجموعه‌های برداری، نمایه‌های جاسازی‌شده، نمونه‌های محاسباتی)، کنترل‌های دسترسی مبتنی بر نقش را با فهرست‌های مجاز صریح و سیاست‌های رد به‌طور پیش‌فرض اجرا می‌کند. |  1  | D/V |
| 5.2.2 | اطمینان حاصل کنید که اصول حداقل دسترسی به‌طور پیش‌فرض اعمال می‌شوند، به‌طوری که حساب‌های سرویس از مجوزهای فقط‌خواندنی آغاز می‌شوند و برای دسترسی نوشتن، توجیه تجاری مستند لازم است.                                                             |  1  | D/V |
| 5.2.3 | اطمینان حاصل کنید که همه تغییرات کنترل دسترسی به درخواست‌های تغییر تأییدشده مرتبط‌اند و به‌طور غیرقابل تغییر با برچسب‌های زمانی، هویت‌های عامل، شناسه‌های منابع و تغییرات مجوز ثبت می‌شوند.                                                     |  1  |  V  |
| 5.2.4 | تأیید کنید که برچسب‌های طبقه‌بندی داده‌ها (PII، PHI، تحت کنترل صادرات، مالکیتِ اختصاصی) به‌طور خودکار به منابع مشتق‌شده (بردارهای جاسازی‌شده، کش‌های پرومپت، خروجی‌های مدل) منتقل می‌شوند، با اجرای سیاستی سازگار.                              |  2  |  D  |
| 5.2.5 | اطمینان حاصل کنید که تلاش‌های دسترسی غیرمجاز و رویدادهای ارتقاء سطح دسترسی، در عرض 5 دقیقه، باعث ایجاد هشدارهای زمان واقعی همراه با متادیتای زمینه‌ای به سیستم‌های SIEM می‌شوند.                                                                |  2  | D/V |

---

## C5.3 ارزیابی سیاست پویا

استقرار موتورهای کنترل دسترسی مبتنی بر ویژگی (ABAC) برای تصمیمات مجوزدهی با توجه به بافت با قابلیت‌های ممیزی.

|   #   | شرح                                                                                                                                                                                              | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.3.1 | تأیید کنید که تصمیمات مجوزدهی به یک موتور سیاستی اختصاصی (OPA، Cedar یا معادل آن) برون‌سپاری شده و از طریق APIهای احراز هویت‌شده در دسترس باشند و با حفاظت از یکپارچگی رمزنگاری‌شده محافظت شوند. |  1  | D/V |
| 5.3.2 | اطمینان حاصل کنید که سیاست‌ها در زمان اجرا، ویژگی‌های پویا را ارزیابی می‌کنند، از جمله سطح دسترسی کاربر، طبقه‌بندی حساسیت منابع، زمینه درخواست، جداسازی مستاجر و محدودیت‌های زمانی.              |  1  | D/V |
| 5.3.3 | اطمینان حاصل کنید که تعاریف سیاست دارای کنترل نسخه هستند، با بازبینی همتا به همتا همراه‌اند، و پیش از استقرار در محیط تولید از طریق آزمایش‌های خودکار در خط‌لوله‌های CI/CD اعتبارسنجی می‌شوند.   |  2  |  D  |
| 5.3.4 | اطمینان حاصل کنید که نتایج ارزیابی سیاست‌ها شامل دلایل تصمیم ساختارمند باشند و به سیستم‌های SIEM منتقل شوند تا برای تحلیل هم‌ارتباطی و گزارش انطباق استفاده شوند.                                |  2  |  V  |
| 5.3.5 | تأیید کنید که مقادیر زمان زندگی کش سیاستی (TTL) برای منابع با حساسیت بالا از 5 دقیقه فراتر نرود و برای منابع استاندارد با قابلیت باطل‌سازی کش از 1 ساعت فراتر نرود.                              |  3  | D/V |

---

## C5.4 Query-Time اجرای امنیت در زمان پرس‌وجو

پیاده‌سازی کنترل‌های امنیتی در لایه پایگاه داده با فیلترگذاری اجباری و سیاست‌های امنیتی سطح سطر.

|   #   | شرح                                                                                                                                                                                                                  | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | اطمینان حاصل کنید که تمام کوئری‌های پایگاه داده‌های برداری و SQL شامل فیلترهای امنیتی اجباری هستند (شناسه مستاجر، برچسب‌های حساسیت داده‌ها، دامنه کاربر) که در سطح موتور پایگاه داده اعمال می‌شوند، نه در کد برنامه. |  1  | D/V |
| 5.4.2 | اطمینان حاصل کنید که سیاست‌های امنیت سطح ردیف (RLS) و ماسک‌سازی سطح فیلد با وراثت سیاست برای همهٔ پایگاه‌های دادهٔ وکتور، شاخص‌های جستجو و مجموعه‌های دادهٔ آموزشی فعال شده‌اند.                                     |  1  | D/V |
| 5.4.3 | اطمینان حاصل کنید که ارزیابی‌های مجوز ناموفق از حملات «confused deputy attacks» جلوگیری می‌کنند، با توقف فوری کوئری‌ها و بازگرداندن کدهای خطای مجوز صریح به جای بازگرداندن مجموعه نتایج خالی.                        |  2  |  D  |
| 5.4.4 | تأیید کنید که تاخیر در ارزیابی سیاست به صورت پیوسته پایش می‌شود و برای شرایط تایم‌اوت که می‌تواند منجر به دور زدن مجوز شود، هشدارهای خودکار فعال هستند.                                                              |  2  |  V  |
| 5.4.5 | اطمینان حاصل کنید که مکانیسم‌های بازتلاش کوئری سیاست‌های دسترسی را دوباره ارزیابی می‌کنند تا تغییرات پویا در مجوزها را در نشست‌های کاربری فعال در نظر بگیرند.                                                        |  3  | D/V |

---

## C5.5 فیلتر خروجی و جلوگیری از نشت داده‌ها

برای جلوگیری از افشای داده‌های غیرمجاز در محتوای تولیدشده با هوش مصنوعی، کنترل‌های پس‌پردازش را پیاده‌سازی کنید.

|   #   | شرح                                                                                                                                                                                  | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.5.1 | اطمینان حاصل کنید که مکانیسم‌های غربالگری پس از استنتاج، PII غیرمجاز، اطلاعات طبقه‌بندی‌شده و داده‌های مالکیتی را قبل از ارائه محتوا به درخواست‌کنندگان اسکن کرده و محرمانه می‌کنند. |  1  | D/V |
| 5.5.2 | بررسی کنید که استنادها، ارجاعات و نسبت‌دهی به منابع در خروجی‌های مدل با مجوزهای دسترسی درخواست‌کننده اعتبارسنجی شوند و در صورت تشخیص دسترسی غیرمجاز، از خروجی‌های مدل حذف گردند.     |  1  | D/V |
| 5.5.3 | اطمینان حاصل کنید که محدودیت‌های فرمت خروجی (PDFهای ایمن‌شده، تصاویر بدون متادیتا، انواع فایل‌های مجاز) بر اساس سطوح مجوز کاربر و طبقه‌بندی داده‌ها اعمال می‌شوند.                   |  2  |  D  |
| 5.5.4 | تأیید کنید که الگوریتم‌های محرمانه‌سازی قطعی هستند، دارای کنترل نسخه‌اند و لاگ‌های حسابرسی را حفظ می‌کنند تا از تحقیقات تطابق با مقررات و تحلیل قضایی پشتیبانی کنند.                 |  2  |  V  |
| 5.5.5 | تأیید کنید که رویدادهای پنهان‌سازی با ریسک بالا لاگ‌های تطبیقی تولید می‌کنند که شامل هش‌های رمزنگاری‌شده از محتوای اصلی برای بازیابیِ شواهدِ قضایی بدون افشای داده باشد.             |  3  |  V  |

---

## C5.6 ایزولاسیون چند مستاجر

ایزولاسیون رمزنگاری‌شده و منطقی بین مستأجران در زیرساخت هوش مصنوعی مشترک را تضمین کنید.

|   #   | شرح                                                                                                                                                                                                     | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.6.1 | تأیید کنید که فضاهای حافظه، مخازن جاسازی، ورودی‌های کش و فایل‌های موقتی برای هر مستاجر به‌طور جداگانه در فضای نام تفکیک‌شده قرار دارند و در زمان حذف مستاجر یا پایان نشست، به‌طور ایمن پاکسازی می‌شوند. |  1  | D/V |
| 5.6.2 | بررسی کنید که هر درخواست API شامل شناسه مستاجر احراز هویت‌شده‌ای باشد که به‌وسیله رمزنگاری در برابر زمینه نشست و حقوق دسترسی کاربر اعتبارسنجی شده باشد.                                                 |  1  | D/V |
| 5.6.3 | بررسی کنید که سیاست‌های شبکه برای ارتباطات بین مستاجرهای مختلف در سرویس-مش‌ها و پلتفرم‌های ارکستراسیون کانتینرها، قوانین پیش‌فرض-انکار (default-deny) را اجرا می‌کنند.                                  |  2  |  D  |
| 5.6.4 | تأیید کنید که کلیدهای رمزگذاری برای هر مستاجر منحصر به فرد هستند و از پشتیبانی کلید مدیریت‌شده توسط مشتری (CMK) برخوردارند و ایزولاسیون رمزنگاری بین مخزن‌های دادهٔ مستاجرها برقرار است.                |  3  |  D  |

---

## C5.7 مجوز عامل خودمختار

کنترل مجوزها برای عامل‌های هوش مصنوعی و سیستم‌های خودمختار از طریق توکن‌های قابلیت‌دار با دامنه محدود و مجوزدهی مداوم.

|   #   | شرح                                                                                                                                                                                                         | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | اطمینان حاصل کنید که عوامل خودمختار توکن‌های قابلیت با دامنه محدود دریافت می‌کنند که به طور صریح اقدامات مجاز، منابع قابل دسترس، محدوده‌های زمانی و محدودیت‌های عملیاتی را فهرست می‌کنند.                   |  1  | D/V |
| 5.7.2 | تأیید کنید که قابلیت‌های با ریسک بالا (دسترسی به سیستم فایل، اجرای کد، تماس‌های API خارجی، معاملات مالی) به‌طور پیش‌فرض غیرفعال هستند و برای فعال‌سازی به مجوزهای صریح همراه با توجیه‌های تجاری نیاز دارند. |  1  | D/V |
| 5.7.3 | تایید کنید که توکن‌های قابلیت به نشست‌های کاربری پیوند داده می‌شوند، از حفاظت یکپارچگی رمزنگاری‌شده برخوردارند و اطمینان حاصل کنید که در سناریوهای آفلاین قابلیت نگهداری یا استفاده مجدد ندارند.            |  2  |  D  |
| 5.7.4 | تصدیق کنید که اقدامات آغازشده توسط عامل از طریق موتور سیاست‌گذاری ABAC با ارزیابی کامل زمینه و ثبت‌های حسابرسی، تحت تأیید ثانویه قرار می‌گیرند.                                                             |  2  |  V  |
| 5.7.5 | اطمینان حاصل کنید که شرایط خطای عامل و مدیریت استثناها شامل اطلاعات دامنه قابلیت باشند تا به تحلیل رویداد و تحقیقات جنایی دیجیتال کمک کنند.                                                                 |  3  |  V  |

---

## منابع

### استانداردها و چارچوب‌ها

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### راهنماهای پیاده‌سازی

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### امنیت مختص هوش مصنوعی

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


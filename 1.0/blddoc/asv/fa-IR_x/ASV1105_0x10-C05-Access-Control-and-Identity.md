# کنترل دسترسی C5 و هویت برای مؤلفه‌ها و کاربران هوش مصنوعی

## هدف کنترل

کنترل دسترسی مؤثر برای سیستم‌های هوش مصنوعی نیازمند مدیریت هویت قوی، مجوزدهی مبتنی بر زمینه و اجرای زمان اجرا بر اساس اصول اعتماد صفر است. این کنترل‌ها تضمین می‌کنند که انسان‌ها، خدمات و عامل‌های خودمختار تنها در محدوده‌های صریحاً مجاز با مدل‌ها، داده‌ها و منابع محاسباتی تعامل داشته باشند، همراه با قابلیت‌های تأیید و حسابرسی مداوم.

---

## C5.1 مدیریت هویت و احراز هویت

ایجاد هویت‌های مبتنی بر رمزنگاری برای همه نهادها همراه با احراز هویت چندعاملی برای عملیات دارای امتیاز دسترسی.

|   #   | توضیحات                                                                                                                                                                                                                   | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | تأیید کنید که تمام کاربران انسانی و اصول سرویس از طریق یک ارائه‌دهنده هویت سازمانی مرکزی (IdP) با استفاده از پروتکل‌های OIDC/SAML با نگاشت‌های منحصربه‌فرد هویت به توکن (بدون حساب‌ها یا مدارک مشترک) احراز هویت می‌شوند. |  1  | D/V |
| 5.1.2 | تأیید کنید که عملیات‌های با ریسک بالا (استقرار مدل، صدور وزن، دسترسی به داده‌های آموزش، تغییرات در پیکربندی تولید) نیازمند احراز هویت چندعاملی یا احراز هویت مرحله‌ای با اعتبارسنجی مجدد جلسه هستند.                      |  1  | D/V |
| 5.1.3 | اطمینان حاصل کنید که مدیران جدید قبل از دریافت دسترسی به سیستم تولید، مراحل احراز هویت را مطابق با استاندارد NIST 800-63-3 IAL-2 یا استانداردهای معادل انجام دهند.                                                        |  2  |  D  |
| 5.1.4 | اطمینان حاصل کنید که بررسی‌های دسترسی به‌صورت فصلی انجام می‌شوند، با شناسایی خودکار حساب‌های غیرفعال، اعمال چرخش مدارک و فرآیندهای حذف دسترسی.                                                                            |  2  |  V  |
| 5.1.5 | تأیید کنید که عوامل هوش مصنوعی فدرال از طریق تأیید هویت با توکن‌های JWT امضا شده که حداکثر عمر آنها 24 ساعت است و شامل اثبات رمزنگاری شده منشأ می‌باشند، احراز هویت می‌شوند.                                              |  3  | D/V |

---

## C5.2 مجوز منابع و حداقل امتیاز

پیاده‌سازی کنترل‌های دسترسی دقیق برای تمام منابع هوش مصنوعی با مدل‌های اجازه‌دهی صریح و مسیرهای حسابرسی.

|   #   | توضیحات                                                                                                                                                                                                                                                         | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | اطمینان حاصل کنید که هر منبع هوش مصنوعی (مجموعه داده‌ها، مدل‌ها، نقاط انتهایی، مجموعه‌های برداری، شاخص‌های جاسازی، نمونه‌های محاسباتی) کنترل‌های دسترسی مبتنی بر نقش را با فهرست‌های مجاز صریح و سیاست‌های پیش‌فرض انکار اعمال می‌کند.                          |  1  | D/V |
| 5.2.2 | تأیید کنید که اصول حداقل امتیاز به صورت پیش‌فرض در حساب‌های سرویس اعمال شده است، به طوری که دسترسی‌ها از مجوزهای فقط خواندنی شروع شده و برای دسترسی نوشتنی توجیه کسب‌وکار مستند شده لازم باشد.                                                                  |  1  | D/V |
| 5.2.3 | اطمینان حاصل کنید که تمام تغییرات کنترل دسترسی به درخواست‌های تغییر تأیید شده مرتبط هستند و به‌صورت تغییرناپذیر با زمان‌بندی‌ها، هویت بازیگران، شناسه‌های منابع و تغییرات دسترسی ثبت شده‌اند.                                                                   |  1  |  V  |
| 5.2.4 | اطمینان حاصل کنید که برچسب‌های طبقه‌بندی داده‌ها (اطلاعات شناسایی شخصی - PII، اطلاعات سلامت شخصی - PHI، کنترل صادرات، مالکیتی) به‌صورت خودکار به منابع مشتق شده (تعبیه‌ها، کش‌های پرامپت، خروجی‌های مدل) منتقل شده و سیاست‌های مرتبط به‌صورت یکپارچه اجرا شوند. |  2  |  D  |
| 5.2.5 | اطمینان حاصل کنید که تلاش‌های دسترسی غیرمجاز و رویدادهای افزایش امتیاز به صورت لحظه‌ای همراه با فراداده‌ متنی به سیستم‌های SIEM در مدت کمتر از 5 دقیقه هشدار ارسال می‌کنند.                                                                                     |  2  | D/V |

---

## C5.3 ارزیابی سیاست پویا

استقرار موتورهای کنترل دسترسی مبتنی بر ویژگی (ABAC) برای تصمیم‌گیری‌های مجوزدهی مبتنی بر زمینه با قابلیت‌های ممیزی.

|   #   | توضیحات                                                                                                                                                                                      | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | اطمینان حاصل کنید که تصمیمات تأیید هویت به یک موتور سیاست اختصاصی (OPA، Cedar، یا معادل آن) برون‌سپاری شده‌اند که از طریق APIهای احراز هویت شده و با حفاظت از صحت رمزنگاری قابل دسترسی باشد. |  1  | D/V |
| 5.3.2 | اطمینان حاصل کنید که سیاست‌ها خصوصیات دینامیک را در زمان اجرا ارزیابی می‌کنند، از جمله سطح مجوز کاربر، طبقه‌بندی حساسیت منبع، زمینه درخواست، جداسازی مستاجر و محدودیت‌های زمانی.             |  1  | D/V |
| 5.3.3 | اطمینان حاصل کنید که تعریف‌های سیاست‌ها تحت کنترل نسخه قرار دارند، توسط همتایان بررسی شده‌اند، و قبل از استقرار در تولید از طریق تست‌های خودکار در خطوط CI/CD اعتبارسنجی شده‌اند.            |  2  |  D  |
| 5.3.4 | اطمینان حاصل کنید که نتایج ارزیابی سیاست شامل دلایل ساختاریافته تصمیم‌گیری است و به سیستم‌های SIEM برای تحلیل همبستگی و گزارش‌دهی انطباق ارسال می‌شود.                                       |  2  |  V  |
| 5.3.5 | تأیید کنید که مقادیر زمان زندگی (TTL) کش سیاست برای منابع با حساسیت بالا از ۵ دقیقه و برای منابع استاندارد با قابلیت باطل‌سازی کش از ۱ ساعت تجاوز نکند.                                      |  3  | D/V |

---

## C5.4 اجرای امنیت در زمان پرس‌وجو

کنترل‌های امنیتی لایه پایگاه داده را با فیلتر اجباری و سیاست‌های امنیتی در سطح سطر پیاده‌سازی کنید.

|   #   | توضیحات                                                                                                                                                                                                   | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | اطمینان حاصل کنید که تمام کوئری‌های پایگاه داده برداری و SQL شامل فیلترهای اجباری امنیتی (شناسه مستاجر، برچسب‌های حساسیت، محدوده کاربر) هستند که در سطح موتور پایگاه داده اعمال می‌شوند، نه در کد برنامه. |  1  | D/V |
| 5.4.2 | تأیید کنید که سیاست‌های امنیت سطح ردیف (RLS) و ماسک‌گذاری سطح فیلد با ارث‌بری سیاست برای همه پایگاه‌های داده برداری، شاخص‌های جستجو و مجموعه داده‌های آموزشی فعال شده باشند.                              |  1  | D/V |
| 5.4.3 | تأیید کنید که ارزیابی‌های ناموفق مجوزدهی، با قطع فوری پرس‌وجوها و بازگرداندن کدهای خطای مجوزدهی صریح به جای بازگرداندن مجموعه نتایج خالی، از وقوع «حملات معاون گیج‌شده» جلوگیری خواهند کرد.               |  2  |  D  |
| 5.4.4 | اطمینان حاصل کنید که تأخیر ارزیابی سیاست به طور مداوم با هشدارهای خودکار برای شرایط تایم‌اوت که ممکن است باعث دورزدن مجوز شود، مورد نظارت قرار می‌گیرد.                                                   |  2  |  V  |
| 5.4.5 | اطمینان حاصل کنید که مکانیزم‌های تکرار پرس‌وجو، سیاست‌های مجوزدهی را مجدداً ارزیابی می‌کنند تا تغییرات دینامیک مجوزها در طول جلسات فعال کاربر را در نظر بگیرند.                                           |  3  | D/V |

---

## فیلتر خروجی C5.5 و پیشگیری از از دست دادن داده‌ها

کنترل‌های پس‌پردازش را برای جلوگیری از افشای غیرمجاز داده‌ها در محتوای تولید شده توسط هوش مصنوعی پیاده‌سازی کنید.

|   #   | توضیحات                                                                                                                                                                                              | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.5.1 | اطمینان حاصل کنید که مکانیزم‌های فیلترینگ پس از استنتاج، داده‌های شناسایی شخصی غیرمجاز (PII)، اطلاعات طبقه‌بندی شده و داده‌های اختصاصی را قبل از ارائه محتوا به درخواست‌کنندگان، اسکن و حذف می‌کنند. |  1  | D/V |
| 5.5.2 | بررسی کنید که ارجاعات، مآخذ و انتساب منابع در خروجی‌های مدل بر اساس مجوزهای تماس‌گیرنده تأیید شده باشند و در صورت شناسایی دسترسی غیرمجاز، حذف شوند.                                                  |  1  | D/V |
| 5.5.3 | اطمینان حاصل کنید که محدودیت‌های قالب خروجی (فایل‌های PDF پاک‌سازی شده، تصاویر بدون متادیتا، انواع فایل‌های تأیید شده) بر اساس سطح دسترسی کاربران و طبقه‌بندی داده‌ها اعمال می‌شوند.                 |  2  |  D  |
| 5.5.4 | تأیید کنید که الگوریتم‌های سانسور قطعی، کنترل‌شده با نسخه و دارای ثبت گزارش‌های حسابرسی هستند تا از تحقیقات تطبیق و تحلیل قانونی پشتیبانی کنند.                                                      |  2  |  V  |
| 5.5.5 | تأیید کنید که رویدادهای حذف با ریسک بالا، گزارش‌های تطبیقی تولید می‌کنند که شامل هش‌های رمزنگاری شده از محتوای اصلی برای بازیابی جرم‌شناسی بدون افشای داده‌ها باشد.                                  |  3  |  V  |

---

## C5.6 ایزولاسیون چند مستاجری

اطمینان از جداسازی رمزنگاری‌شده و منطقی بین مستأجران در زیرساخت مشترک هوش مصنوعی.

|   #   | توضیحات                                                                                                                                                                                    | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.6.1 | تأیید کنید که فضاهای حافظه، ذخیره‌های تعبیه شده، ورودی‌های کش و فایل‌های موقتی به صورت جداشده بر اساس فضای نام هر مستأجر باشند و پاک‌سازی ایمن در زمان حذف مستأجر یا پایان جلسه انجام شود. |  1  | D/V |
| 5.6.2 | اطمینان حاصل کنید که هر درخواست API شامل شناسه مستاجر احراز هویت شده است که به صورت رمزنگاری شده در برابر زمینه جلسه و سطح دسترسی‌های کاربر اعتبارسنجی می‌شود.                             |  1  | D/V |
| 5.6.3 | اطمینان حاصل کنید که سیاست‌های شبکه قوانین پیش‌فرض-رد را برای ارتباطات بین مستاجران در داخل سرویس مش‌ها و پلتفرم‌های ارکستراسیون کانتینر اجرا می‌کنند.                                     |  2  |  D  |
| 5.6.4 | بررسی کنید که کلیدهای رمزنگاری شده برای هر مستأجر یکتا باشند، با پشتیبانی از کلید مدیریت شده توسط مشتری (CMK) و جداسازی رمزنگاری بین مخازن داده مستأجران.                                  |  3  |  D  |

---

## C5.7 مجوز عامل خودران

کنترل دسترسی‌ها برای عامل‌های هوش مصنوعی و سیستم‌های خودران از طریق توکن‌های قابلیت محدود شده و مجوزدهی مستمر.

|   #   | توضیحات                                                                                                                                                                                                  | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | تأیید کنید که نمایندگان خودگردان توکن‌های قابلیت محدوده‌دار دریافت می‌کنند که به‌طور صریح اقدامات مجاز، منابع قابل دسترسی، محدوده‌های زمانی و محدودیت‌های عملیاتی را فهرست می‌کند.                       |  1  | D/V |
| 5.7.2 | تأیید کنید که قابلیت‌های پرخطر (دسترسی به سیستم فایل، اجرای کد، تماس‌های API خارجی، تراکنش‌های مالی) به طور پیش‌فرض غیرفعال هستند و برای فعال‌سازی نیاز به مجوزهای صریح همراه با توجیهات کسب‌وکار دارند. |  1  | D/V |
| 5.7.3 | اطمینان حاصل کنید که توکن‌های قابلیت به جلسات کاربری متصل شده‌اند، از حفاظت صحت رمزنگاری برخوردارند و تضمین کنید که در سناریوهای آفلاین قابل ذخیره یا استفاده مجدد نیستند.                               |  2  |  D  |
| 5.7.4 | تأیید کنید که اقدامات آغاز شده توسط عامل از طریق موتور سیاست ABAC با ارزیابی کامل زمینه و ثبت گزارش حسابرسی، تأیید ثانویه می‌شوند.                                                                       |  2  |  V  |
| 5.7.5 | تأیید کنید که شرایط خطای عامل و مدیریت استثنا شامل اطلاعات دامنه قابلیت برای پشتیبانی از تجزیه و تحلیل حادثه و تحقیق قانونی باشد.                                                                        |  3  |  V  |

---

## مراجع

### استانداردها و چارچوب‌ها

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### راهنمای پیاده‌سازی

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### امنیت ویژه هوش مصنوعی

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


# کنترل دسترسی C5 و هویت برای اجزاء و کاربران هوش مصنوعی

## هدف کنترل

کنترل دسترسی مؤثر برای سیستم‌های هوش مصنوعی نیازمند مدیریت هویت قوی، تأیید مجوز آگاه به زمینه و اجرای زمان اجرا طبق اصول اعتماد صفر است. این کنترل‌ها تضمین می‌کنند که انسان‌ها، خدمات و عامل‌های خودمختار تنها در محدوده‌های صریحاً مجاز شده با مدل‌ها، داده‌ها و منابع محاسباتی تعامل داشته باشند، همراه با قابلیت‌های تأیید و بررسی مداوم.

---

## C5.1 مدیریت هویت و احراز هویت

ایجاد هویت‌های مبتنی بر رمزنگاری برای همه نهادها با احراز هویت چندعاملی برای عملیات دارای امتیاز ویژه.

|   #   | توضیحات                                                                                                                                                                                                                                         | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | اطمینان حاصل کنید که همه کاربران انسانی و اصول خدماتی از طریق یک ارائه‌دهنده هویت سازمانی متمرکز (IdP) با استفاده از پروتکل‌های OIDC/SAML احراز هویت می‌کنند، با نگاشت‌های یکتای هویت به توکن (عدم استفاده از حساب‌ها یا اعتبارنامه‌های مشترک). |  1  | D/V |
| 5.1.2 | تأیید کنید که عملیات‌های پرخطر (استقرار مدل، صدور وزن، دسترسی به داده‌های آموزش، تغییرات پیکربندی تولید) نیازمند احراز هویت چندعاملی یا احراز هویت افزایشی با بازتأیید جلسه باشند.                                                              |  1  | D/V |
| 5.1.3 | اطمینان حاصل کنید که مدیران جدید قبل از دسترسی به سیستم تولید، فرآیند احراز هویت هویتی را مطابق با استانداردهای NIST 800-63-3 IAL-2 یا معادل آن گذرانده باشند.                                                                                  |  2  |  D  |
| 5.1.4 | اطمینان حاصل کنید که بازبینی‌های دسترسی به صورت فصلی انجام می‌شود با تشخیص خودکار حساب‌های غیرفعال، اجرای چرخش اعتبارات و جریان‌های کاری حذف دسترسی.                                                                                            |  2  |  V  |
| 5.1.5 | تأیید کنید که عوامل هوش مصنوعی فدرال از طریق ادعاهای JWT امضا شده که حداکثر مدت زمان زندگی آنها 24 ساعت است و شامل اثبات رمزنگاری شده منبع می‌باشند، احراز هویت می‌شوند.                                                                        |  3  | D/V |

---

## C5.2 مجوز دسترسی منابع و حداقل امتیاز

اجرای کنترل‌های دسترسی دقیق برای تمام منابع هوش مصنوعی با مدل‌های اجازه صریح و مسیرهای حسابرسی.

|   #   | توضیحات                                                                                                                                                                                                                                   | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | اطمینان حاصل کنید که هر منبع هوش مصنوعی (مجموعه‌داده‌ها، مدل‌ها، نقاط پایانی، مجموعه‌های برداری، شاخص‌های جاسازی‌شده، نمونه‌های محاسباتی) کنترل‌های دسترسی مبتنی بر نقش را با فهرست‌های اجازه صریح و سیاست‌های پیش‌فرض انکار اجرا می‌کند. |  1  | D/V |
| 5.2.2 | اطمینان حاصل کنید که اصول حداقل امتیاز به طور پیش‌فرض با حساب‌های سرویس اجرا می‌شوند، به گونه‌ای که مجوزهای فقط خواندنی در ابتدا اعمال شده و مستندات توجیه کسب‌وکار برای دسترسی نوشتن لازم است.                                           |  1  | D/V |
| 5.2.3 | تأیید کنید که تمامی تغییرات کنترل دسترسی به درخواست‌های تغییر تأیید شده مرتبط هستند و به‌صورت غیرقابل تغییر با زمان‌سنجی، هویت بازیگر، شناسه‌های منابع و تفاوت‌های مجوز ثبت شده‌اند.                                                      |  1  |  V  |
| 5.2.4 | تأیید کنید که برچسب‌های طبقه‌بندی داده‌ها (PII، PHI، کنترل شده توسط صادرات، مالکیتی) به‌طور خودکار به منابع مشتق شده (تعبیه‌ها، کش‌های پرامپت، خروجی‌های مدل) با رعایت سیاست‌های سازگار منتقل می‌شوند.                                    |  2  |  D  |
| 5.2.5 | اطمینان حاصل کنید که تلاش‌های دسترسی غیرمجاز و رویدادهای افزایش امتیازات، هشدارهای بلادرنگ با متادیتای متنی به سیستم‌های SIEM را ظرف 5 دقیقه ایجاد می‌کنند.                                                                               |  2  | D/V |

---

## C5.3 ارزیابی سیاست پویا

موتورهای کنترل دسترسی مبتنی بر ویژگی (ABAC) را برای تصمیم‌گیری‌های مجوزدهی مبتنی بر زمینه با قابلیت‌های حسابرسی مستقر کنید.

|   #   | توضیحات                                                                                                                                                                                 | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | اطمینان حاصل کنید که تصمیمات مجوزدهی به یک موتور سیاست اختصاصی (OPA، Cedar، یا معادل آن) که از طریق APIهای احراز هویت‌شده با حفاظت از صحت رمزنگاری قابل دسترسی است، برون‌سپاری شده‌اند. |  1  | D/V |
| 5.3.2 | اطمینان حاصل کنید که سیاست‌ها هنگام اجرا ویژگی‌های پویا مانند سطح دسترسی کاربر، طبقه‌بندی حساسیت منابع، زمینه درخواست، جداسازی مستاجر و محدودیت‌های زمانی را ارزیابی می‌کنند.           |  1  | D/V |
| 5.3.3 | اطمینان حاصل کنید که تعاریف سیاست‌ها تحت کنترل نسخه، بررسی‌شده توسط همتایان، و از طریق تست‌های خودکار در خطوط لوله CI/CD قبل از استقرار در محیط تولید معتبر شده‌اند.                    |  2  |  D  |
| 5.3.4 | اطمینان حاصل کنید که نتایج ارزیابی سیاست شامل دلایل ساختاریافته برای تصمیم‌گیری است و به سیستم‌های SIEM برای تحلیل همبستگی و گزارش‌دهی انطباق ارسال می‌شود.                             |  2  |  V  |
| 5.3.5 | اطمینان حاصل کنید که مقادیر زمان حیات کش سیاست (TTL) برای منابع با حساسیت بالا از 5 دقیقه تجاوز نکند و برای منابع استاندارد با قابلیت ابطال کش از 1 ساعت بیشتر نشود.                    |  3  | D/V |

---

## اجرای امنیت در زمان اجرای پرس‌وجو C5.4

کنترل‌های امنیتی لایه پایگاه داده را با فیلترینگ اجباری و سیاست‌های امنیتی سطح ردیف پیاده‌سازی کنید.

|   #   | توضیحات                                                                                                                                                                                                   | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | اطمینان حاصل کنید که همه پرس‌وجوهای پایگاه داده برداری و SQL شامل فیلترهای امنیتی اجباری (شناسه مستاجر، برچسب‌های حساسیت، دامنه کاربر) هستند که در سطح موتور پایگاه داده اعمال می‌شوند و نه در کد برنامه. |  1  | D/V |
| 5.4.2 | اطمینان حاصل کنید که سیاست‌های امنیت سطح ردیف (RLS) و ماسک‌گذاری سطح فیلد با ارث‌بری سیاست برای تمام پایگاه‌های داده وکتور، شاخص‌های جستجو و مجموعه داده‌های آموزشی فعال شده باشند.                       |  1  | D/V |
| 5.4.3 | تأیید کنید که ارزیابی‌های مجوز ناموفق از حملات «معاون سردرگم» جلوگیری می‌کنند با قطع فوری پرس‌وجوها و بازگرداندن کدهای خطای مجوز صریح به جای بازگرداندن مجموعه نتایج خالی.                                |  2  |  D  |
| 5.4.4 | اطمینان حاصل شود که تأخیر ارزیابی سیاست به طور مستمر با هشدارهای خودکار برای شرایط تایم‌اوت که ممکن است امکان دور زدن مجوز را فراهم کنند، نظارت می‌شود.                                                   |  2  |  V  |
| 5.4.5 | تأیید کنید که مکانیزم‌های تلاش مجدد پرس‌و‌جو سیاست‌های مجوزدهی را مجدداً ارزیابی می‌کنند تا تغییرات دینامیکی دسترسی‌ها در طی جلسات فعال کاربر در نظر گرفته شوند.                                          |  3  | D/V |

---

## فیلتر خروجی C5.5 و پیشگیری از نشت داده‌ها

کنترل‌های پس‌پردازش را برای جلوگیری از افشای غیرمجاز داده‌ها در محتوای تولید شده توسط هوش مصنوعی پیاده‌سازی کنید.

|   #   | توضیحات                                                                                                                                                                                         | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.5.1 | اطمینان حاصل کنید که مکانیزم‌های فیلترینگ پس از استنتاج، اطلاعات شخصی شناسایی‌نشده (PII)، اطلاعات طبقه‌بندی‌شده و داده‌های مالیکی را قبل از تحویل محتوا به درخواست‌کنندگان، اسکن و حذف می‌کنند. |  1  | D/V |
| 5.5.2 | اطمینان حاصل کنید که ارجاعات، منابع و انتساب‌های منبع در خروجی‌های مدل بر اساس مجوزهای فراخواننده اعتبارسنجی شده و در صورت شناسایی دسترسی غیرمجاز حذف شوند.                                     |  1  | D/V |
| 5.5.3 | اطمینان حاصل کنید که محدودیت‌های فرمت خروجی (PDFهای پاک‌سازی شده، تصاویر بدون متادیتا، انواع فایل‌های تأیید شده) بر اساس سطوح دسترسی کاربران و طبقه‌بندی داده‌ها اعمال می‌شوند.                 |  2  |  D  |
| 5.5.4 | اطمینان حاصل کنید که الگوریتم‌های حذف اطلاعات تعیین‌پذیر، کنترل‌شده به‌وسیله نسخه، و دارای ثبت گزارش‌های حسابرسی هستند تا از تحقیقات تطابق و تجزیه و تحلیل قانونی پشتیبانی نمایند.              |  2  |  V  |
| 5.5.5 | اطمینان حاصل کنید که رویدادهای حذف اطلاعات با ریسک بالا، لاگ‌های تطبیقی تولید می‌کنند که شامل هش‌های رمزنگاری شده از محتوای اصلی برای بازیابی قانونی بدون افشای داده‌ها باشند.                  |  3  |  V  |

---

## C5.6 جداسازی چندمستاجری

اطمینان حاصل کنید که جداسازی رمزنگاری و منطقی بین مستاجرها در زیرساخت مشترک هوش مصنوعی برقرار باشد.

|   #   | توضیحات                                                                                                                                                                                                    | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.6.1 | اطمینان حاصل کنید که فضاهای حافظه، ذخیره‌سازی‌های جاسازی، ورودی‌های کش و فایل‌های موقت به‌طور جداگانه براساس فضای نام هر مستأجر تفکیک شده‌اند و پاک‌سازی ایمن هنگام حذف مستأجر یا پایان جلسه انجام می‌شود. |  1  | D/V |
| 5.6.2 | اطمینان حاصل کنید که هر درخواست API شامل یک شناسه مستأجر احراز هویت شده باشد که به صورت رمزنگاری شده با زمینه جلسه و مجوزهای کاربر اعتبارسنجی شده است.                                                     |  1  | D/V |
| 5.6.3 | تأیید کنید که سیاست‌های شبکه قوانین پیش‌فرض رد کردن (default-deny) را برای ارتباطات بین مستاجران (cross-tenant) درون شبکه‌های سرویس و پلتفرم‌های ارکستراسیون کانتینر پیاده‌سازی می‌کنند.                   |  2  |  D  |
| 5.6.4 | اطمینان حاصل کنید که کلیدهای رمزگذاری برای هر مستأجر یکتا هستند، با پشتیبانی از کلید مدیریت شده توسط مشتری (CMK) و جداسازی رمزنگاری بین مخازن داده‌های مستأجران.                                           |  3  |  D  |

---

## C5.7 مجوز عامل خودکار

کنترل مجوزها برای عوامل هوش مصنوعی و سیستم‌های خودمختار از طریق توکن‌های قابلیت محدود شده و احراز هویت مستمر.

|   #   | توضیحات                                                                                                                                                                                                      | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.7.1 | اطمینان حاصل کنید که عوامل خودمختار توکن‌های قابلیت محدود شده دریافت می‌کنند که اقدامات مجاز، منابع قابل دسترسی، محدوده‌های زمانی و محدودیت‌های عملیاتی را به‌طور صریح فهرست می‌کنند.                        |  1  | D/V |
| 5.7.2 | اطمینان حاصل کنید که قابلیت‌های پرخطر (دسترسی به سیستم فایل، اجرای کد، تماس‌های API خارجی، تراکنش‌های مالی) به‌طور پیش‌فرض غیرفعال بوده و برای فعال‌سازی آن‌ها مجوزهای صریح همراه با توجیهات تجاری لازم است. |  1  | D/V |
| 5.7.3 | تأیید کنید که توکن‌های قابلیت به جلسات کاربری متصل شده‌اند، شامل حفاظت از صحت رمزنگاری هستند و اطمینان حاصل شود که نمی‌توان آنها را در سناریوهای آفلاین ذخیره یا مجدداً استفاده کرد.                         |  2  |  D  |
| 5.7.4 | اطمینان حاصل کنید که اقدامات آغاز شده توسط عامل از طریق موتور سیاست ABAC با ارزیابی کامل زمینه و ثبت لاگ حسابرسی، تحت تأیید ثانویه قرار می‌گیرند.                                                            |  2  |  V  |
| 5.7.5 | اطمینان حاصل کنید که شرایط خطای عامل و مدیریت استثنا شامل اطلاعات دامنه قابلیت برای پشتیبانی از تحلیل حادثه و بررسی جرم‌شناسی باشد.                                                                          |  3  |  V  |

---

## مراجع

### استانداردها و چارچوب‌ها

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### راهنمای پیاده‌سازی

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### امنیت ویژه هوش مصنوعی

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


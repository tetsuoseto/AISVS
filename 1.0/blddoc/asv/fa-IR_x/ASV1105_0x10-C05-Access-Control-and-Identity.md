# کنترل دسترسی C5 و هویت برای مؤلفه‌ها و کاربران هوش مصنوعی

## هدف کنترل

کنترل دسترسی موثر برای سیستم‌های هوش مصنوعی نیازمند مدیریت هویت قوی، مجوزدهی مبتنی بر زمینه و اعمال در زمان اجرا بر اساس اصول اعتماد صفر است. این کنترل‌ها تضمین می‌کنند که انسان‌ها، سرویس‌ها و عامل‌های خودمختار فقط در محدوده‌هایی که صراحتاً اعطا شده‌اند با مدل‌ها، داده‌ها و منابع محاسباتی تعامل داشته باشند، همراه با قابلیت‌های تأیید مستمر و حسابرسی.

---

## C5.1 مدیریت هویت و احراز هویت

شناسایی‌های مبتنی بر رمزنگاری را برای همه موجودیت‌ها با استفاده از تأیید هویت چندعاملی برای عملیات ممتاز برقرار کنید.

|   #   | توضیحات                                                                                                                                                                                                                                 | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | تأیید کنید که همه کاربران انسانی و اصول‌گرایان خدماتی از طریق یک ارائه‌دهنده هویت سازمانی متمرکز (IdP) با استفاده از پروتکل‌های OIDC/SAML احراز هویت می‌کنند و نگاشت‌های منحصر به فرد هویت به توکن دارند (بدون حساب‌ها یا مدارک مشترک). |  1  | D/V |
| 5.1.2 | اطمینان حاصل کنید که عملیات با ریسک بالا (استقرار مدل، صادرات وزن، دسترسی به داده‌های آموزشی، تغییرات پیکربندی تولید) نیازمند احراز هویت چند عاملی یا احراز هویت پله‌ای همراه با بازتأیید جلسه است.                                     |  1  | D/V |
| 5.1.3 | اطمینان حاصل کنید که مدیران جدید قبل از دریافت دسترسی به سیستم تولید، از فرآیند اثبات هویت مطابق با استانداردهای NIST 800-63-3 IAL-2 یا استانداردهای معادل آن عبور کنند.                                                                |  2  |  D  |
| 5.1.4 | اطمینان حاصل کنید که بازبینی‌های دسترسی به صورت فصلی انجام می‌شود و شامل شناسایی خودکار حساب‌های غیرفعال، اجرای چرخش اعتبارنامه‌ها و فرآیندهای حذف دسترسی است.                                                                          |  2  |  V  |
| 5.1.5 | اطمینان حاصل کنید که عوامل هوش مصنوعی فدرال از طریق ادعاهای JWT امضا شده که حداکثر عمر آنها 24 ساعت است و شامل اثبات رمزنگاری شده منشأ می‌باشند، احراز هویت می‌کنند.                                                                    |  3  | D/V |

---

## C5.2 مجوز دسترسی به منابع و حداقل امتیاز لازم

پیاده‌سازی کنترل‌های دسترسی دقیق برای تمام منابع هوش مصنوعی با مدل‌های اجازه صریح و ردهای ممیزی.

|   #   | توضیحات                                                                                                                                                                                                                                   | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | تأیید کنید که هر منبع هوش مصنوعی (مجموعه داده‌ها، مدل‌ها، نقطه‌های انتهایی، مجموعه‌های برداری، شاخص‌های تعبیه شده، نمونه‌های محاسباتی) کنترل‌های دسترسی مبتنی بر نقش را با فهرست‌های اجازه صریح و سیاست‌های پیش‌فرض جلوگیری اعمال می‌کند. |  1  | D/V |
| 5.2.2 | اطمینان حاصل کنید که اصول حداقل امتیاز به طور پیش‌فرض برای حساب‌های سرویس اجرا می‌شود، به‌طوری که از دسترسی فقط‌خواندنی شروع شده و مستندات توجیه تجاری برای دسترسی نوشتن مورد نیاز باشد.                                                  |  1  | D/V |
| 5.2.3 | تأیید کنید که تمامی تغییرات کنترل دسترسی به درخواست‌های تغییر تأیید شده مرتبط باشند و به صورت غیرقابل تغییر با زمان‌بندی‌ها، شناسه‌های عامل، شناسه‌های منابع و اختلاف‌های دسترسی، ثبت شده باشند.                                          |  1  |  V  |
| 5.2.4 | اطمینان حاصل کنید که برچسب‌های طبقه‌بندی داده‌ها (PII, PHI, کنترل‌شده برای صادرات، مالکیتی) به‌صورت خودکار به منابع مشتق‌شده (تعبیه‌ها، حافظه‌های کش درخواست، خروجی‌های مدل) منتقل می‌شوند و اعمال سیاست به‌صورت یکنواخت انجام می‌شود.    |  2  |  D  |
| 5.2.5 | اطمینان حاصل کنید که تلاش‌های دسترسی غیرمجاز و رویدادهای افزایش سطح دسترسی، هشدارهای هم‌زمان با متادیتای زمینه‌ای به سیستم‌های SIEM در عرض ۵ دقیقه ارسال می‌کنند.                                                                         |  2  | D/V |

---

## C5.3 ارزیابی سیاست پویا

پیاده‌سازی موتورهای کنترل دسترسی مبتنی بر ویژگی (ABAC) برای تصمیم‌گیری‌های مجوزدهی آگاه از زمینه با قابلیت‌های حسابرسی.

|   #   | توضیحات                                                                                                                                                                                | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | تأیید کنید که تصمیمات مجوزدهی به یک موتور سیاست اختصاصی (OPA، Cedar، یا معادل آن) برون‌سپاری شده‌اند که از طریق APIهای احراز هویت شده با حفاظت یکپارچگی رمزنگاری‌شده قابل دسترسی باشد. |  1  | D/V |
| 5.3.2 | تأیید کنید که سیاست‌ها در زمان اجرا ویژگی‌های پویا را ارزیابی می‌کنند، از جمله سطح دسترسی کاربر، طبقه‌بندی حساسیت منبع، زمینه درخواست، جداسازی مستأجر و محدودیت‌های زمانی.             |  1  | D/V |
| 5.3.3 | اطمینان حاصل کنید که تعریف‌های سیاست‌ها کنترل نسخه شده، بازبینی توسط همتا انجام شده و از طریق تست‌های خودکار در خطوط CI/CD قبل از استقرار در محیط تولید تأیید شده‌اند.                 |  2  |  D  |
| 5.3.4 | اطمینان حاصل کنید که نتایج ارزیابی سیاست شامل دلایل منطقی تصمیم‌گیری ساختاریافته باشد و برای تحلیل همبستگی و گزارش‌دهی تطابق به سیستم‌های SIEM ارسال شود.                              |  2  |  V  |
| 5.3.5 | تأیید کنید که مقادیر زمان زندگی (TTL) کش سیاست برای منابع با حساسیت بالا از ۵ دقیقه و برای منابع استاندارد با قابلیت‌های باطل‌سازی کش از ۱ ساعت تجاوز نکند.                            |  3  | D/V |

---

## C5.4 اجرای امنیت در زمان پرس‌وجو

اجرای کنترل‌های امنیتی در لایه پایگاه داده با فیلترینگ اجباری و سیاست‌های امنیتی در سطح ردیف.

|   #   | توضیحات                                                                                                                                                                                              | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | اطمینان حاصل کنید که همه پرس‌وجوهای پایگاه داده برداری و SQL شامل فیلترهای امنیتی اجباری (شناسه مستاجر، برچسب‌های حساسیت، حوزه کاربر) هستند که در سطح موتور پایگاه داده اعمال می‌شوند، نه کد برنامه. |  1  | D/V |
| 5.4.2 | اطمینان حاصل کنید که سیاست‌های امنیت سطح سطر (RLS) و ماسک‌گذاری سطح فیلد با ارث‌بری سیاست برای همه پایگاه‌های داده برداری، شاخص‌های جستجو و مجموعه‌داده‌های آموزشی فعال شده‌اند.                     |  1  | D/V |
| 5.4.3 | اطمینان حاصل کنید که ارزیابی‌های ناموفق مجوز، از حملات "معاون سردرگم" با قطع فوری پرس‌وجوها و بازگرداندن کدهای خطای مجوز صریح به جای بازگرداندن مجموعه نتایج خالی، جلوگیری می‌کنند.                  |  2  |  D  |
| 5.4.4 | اطمینان حاصل کنید که تأخیر ارزیابی سیاست به‌طور مستمر با هشدارهای خودکار برای شرایط تایم‌اوت که ممکن است باعث دورزدن مجوزها شود، پایش می‌شود.                                                        |  2  |  V  |
| 5.4.5 | تأیید کنید که مکانیزم‌های تلاش مجدد درخواست، سیاست‌های مجوزدهی را مجدداً ارزیابی می‌کنند تا تغییرات پویا در دسترسی‌ها را در جلسات فعال کاربر در نظر بگیرند.                                          |  3  | D/V |

---

## فیلتر خروجی C5.5 و جلوگیری از از دست دادن داده‌ها

استقرار کنترل‌های پس‌پردازش برای جلوگیری از افشای غیرمجاز داده‌ها در محتوای تولیدشده توسط هوش مصنوعی.

|   #   | توضیحات                                                                                                                                                                                             | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.5.1 | اطمینان حاصل کنید که مکانیزم‌های فیلترینگ پس از استنتاج، اطلاعات شناسایی شخصی غیرمجاز (PII)، اطلاعات طبقه‌بندی‌شده و داده‌های مالکیتی را قبل از تحویل محتوا به درخواست‌کنندگان، اسکن و حذف می‌کنند. |  1  | D/V |
| 5.5.2 | اطمینان حاصل کنید که استنادات، مراجعات و نسبت‌های منبع در خروجی‌های مدل بر اساس مجوزهای فراخواننده اعتبارسنجی شده و در صورت شناسایی دسترسی غیرمجاز حذف شوند.                                        |  1  | D/V |
| 5.5.3 | تأیید کنید که محدودیت‌های فرمت خروجی (PDFهای پاک‌سازی شده، تصاویر بدون فراداده، انواع فایل‌های تأیید شده) بر اساس سطوح اجازه کاربران و طبقه‌بندی داده‌ها اعمال می‌شوند.                             |  2  |  D  |
| 5.5.4 | تأیید کنید که الگوریتم‌های مخفی‌سازی تعیین‌پذیر، کنترل‌شده با نسخه، و دارای سابقه‌های حسابرسی هستند تا از تحقیقات انطباق و تحلیل‌های جرم‌شناسی پشتیبانی کنند.                                       |  2  |  V  |
| 5.5.5 | اطمینان حاصل کنید که رویدادهای حذف اطلاعات با ریسک بالا، گزارش‌های تطبیقی تولید می‌کنند که شامل هش‌های رمزنگاری‌شده از محتوای اصلی برای بازیابی قانونی بدون افشای داده‌ها باشد.                     |  3  |  V  |

---

## C5.6 ایزولاسیون چند مستاجری

اطمینان از جداسازی رمزنگاری و منطقی بین مستاجران در زیرساخت مشترک هوش مصنوعی.

|   #   | توضیحات                                                                                                                                                                                             | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.6.1 | اطمینان حاصل کنید که فضای حافظه، فروشگاه‌های جاسازی، داده‌های کش و فایل‌های موقت به صورت جداگانه برای هر مستأجر (tenant) تفکیک شده‌اند و پاک‌سازی ایمن هنگام حذف مستأجر یا پایان جلسه انجام می‌شود. |  1  | D/V |
| 5.6.2 | اطمینان حاصل کنید که هر درخواست API شامل یک شناسه مستاجر تایید شده است که به صورت رمزنگاری شده در برابر زمینه جلسه و مجوزهای کاربر اعتبارسنجی می‌شود.                                               |  1  | D/V |
| 5.6.3 | اطمینان حاصل کنید که سیاست‌های شبکه قوانین پیش‌فرض انکار را برای ارتباطات بین مستاجران در داخل سرویس مش‌ها و پلتفرم‌های ارکستراسیون کانتینرها پیاده‌سازی می‌کنند.                                   |  2  |  D  |
| 5.6.4 | تأیید کنید که کلیدهای رمزنگاری برای هر مستأجر منحصر به فرد باشند، با پشتیبانی از کلید مدیریت شده توسط مشتری (CMK) و جداسازی رمزنگاری بین مخازن داده‌های مستأجر.                                     |  3  |  D  |

---

## C5.7 مجوز عامل خودمختار

کنترل مجوزها برای عوامل هوش مصنوعی و سیستم‌های خودران از طریق توکن‌های قابلیت با دامنه محدود و مجوزدهی پیوسته.

|   #   | توضیحات                                                                                                                                                                                                            | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.7.1 | اطمینان حاصل کنید که عامل‌های خودران توکن‌های قابلیت محدوده‌بندی شده دریافت می‌کنند که به‌طور صریح اقدامات مجاز، منابع قابل دسترسی، محدوده‌های زمانی و محدودیت‌های عملیاتی را فهرست می‌کند.                        |  1  | D/V |
| 5.7.2 | اطمینان حاصل کنید که قابلیت‌های پرخطر (دسترسی به سیستم فایل، اجرای کد، تماس‌های API خارجی، تراکنش‌های مالی) به طور پیش‌فرض غیرفعال شده‌اند و برای فعال‌سازی نیازمند مجوزهای صریح همراه با توجیهات کسب‌وکاری هستند. |  1  | D/V |
| 5.7.3 | تأیید کنید که توکن‌های قابلیت به نشست‌های کاربری متصل شده‌اند، حفاظت از صحت رمزنگاری را شامل می‌شوند و اطمینان حاصل کنید که نمی‌توانند در سناریوهای آفلاین ذخیره یا مجدداً استفاده شوند.                           |  2  |  D  |
| 5.7.4 | تأیید کنید که اقدامات آغاز شده توسط عامل از طریق موتور سیاست ABAC با ارزیابی کامل زمینه و ثبت گزارش حسابرسی، مجوز ثانویه دریافت می‌کنند.                                                                           |  2  |  V  |
| 5.7.5 | اطمینان حاصل کنید که شرایط خطای عامل و مدیریت استثنا شامل اطلاعات دامنه قابلیت برای پشتیبانی از تحلیل حادثه و تحقیقات جنایی باشد.                                                                                  |  3  |  V  |

---

## مراجع

### استانداردها و چهارچوب‌ها

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### راهنمای پیاده‌سازی

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### امنیت مخصوص هوش مصنوعی

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


# کنترل دسترسی C5 و هویت برای اجزای هوش مصنوعی و کاربران

## هدف کنترل

کنترل دسترسی موثر برای سیستم‌های هوش مصنوعی نیازمند مدیریت هویت قوی، احراز هویت مبتنی بر زمینه و اجرای زمان اجرا مطابق با اصول اعتماد صفر است. این کنترل‌ها تضمین می‌کنند که انسان‌ها، سرویس‌ها و عوامل خودکار تنها در محدوده‌های صریحاً مجاز شده به مدل‌ها، داده‌ها و منابع محاسباتی دسترسی داشته باشند و با قابلیت‌های تأیید و ممیزی مستمر همراه باشند.

---

## C5.1 مدیریت هویت و احراز هویت

شناسایی‌های مبتنی بر رمزنگاری را برای تمامی موجودیت‌ها با احراز هویت چندعاملی برای عملیات دارای امتیاز برقرار کنید.

|   #   | توضیحات                                                                                                                                                                                                                                     | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | اطمینان حاصل کنید که تمام کاربران انسانی و اصول‌های سرویس از طریق یک ارائه‌دهنده هویت سازمانی متمرکز (IdP) با استفاده از پروتکل‌های OIDC/SAML احراز هویت می‌شوند، با نگاشت‌های یکتا بین هویت و توکن (بدون حساب‌ها یا اعتبارنامه‌های مشترک). |  1  | D/V |
| 5.1.2 | اطمینان حاصل کنید که عملیات پرریسک (استقرار مدل، صادرات وزن، دسترسی به داده‌های آموزشی، تغییرات پیکربندی تولید) نیاز به احراز هویت چندمرحله‌ای یا احراز هویت مرحله‌ای با بازتأیید جلسه دارند.                                               |  1  | D/V |
| 5.1.3 | اطمینان حاصل کنید که مدیران جدید قبل از دریافت دسترسی به سیستم تولید، فرآیند اثبات هویت را مطابق با استانداردهای NIST 800-63-3 IAL-2 یا استانداردهای معادل آن انجام می‌دهند.                                                                |  2  |  D  |
| 5.1.4 | تأیید کنید که بازبینی‌های دسترسی به صورت فصلی انجام می‌شوند همراه با شناسایی خودکار حساب‌های غیرفعال، اجرای گردش کار چرخش اعتبارنامه، و فرآیندهای حذف دسترسی.                                                                               |  2  |  V  |
| 5.1.5 | تأیید کنید که عوامل هوش مصنوعی فدرال شده از طریق ادعاهای JWT امضا شده که حداکثر عمر 24 ساعت دارند و شامل اثبات رمزنگاری شده از مبدأ هستند، احراز هویت می‌شوند.                                                                              |  3  | D/V |

---

## C5.2 مجوز دسترسی منابع و کمترین سطح دسترسی

کنترل‌های دسترسی دقیق برای تمامی منابع هوش مصنوعی با مدل‌های مجوز صریح و سوابق حسابرسی اجرا کنید.

|   #   | توضیحات                                                                                                                                                                                                                          | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | تأیید کنید که هر منبع هوش مصنوعی (مجموعه داده‌ها، مدل‌ها، نقاط انتهایی، مجموعه‌های برداری، شاخص‌های جاسازی، نمونه‌های محاسباتی) کنترل‌های دسترسی مبتنی بر نقش را با فهرست‌های اجازه صریح و سیاست‌های پیش‌فرض انکار اعمال می‌کند. |  1  | D/V |
| 5.2.2 | تأیید کنید که اصول حداقل دسترسی به صورت پیش‌فرض با حساب‌های سرویس اعمال شده‌اند، به‌طوری‌که دسترسی‌ها از سطح فقط خواندنی شروع شده و برای دسترسی نوشتن توجیه کسب‌وکاری مستند شده مورد نیاز باشد.                                  |  1  | D/V |
| 5.2.3 | اطمینان حاصل کنید که همه تغییرات کنترل دسترسی به درخواست‌های تغییر تایید شده مرتبط هستند و به صورت غیرقابل تغییر با زمان‌سنجی، هویت بازیگران، شناسه‌های منابع و تغییرات مجوز ثبت شده‌اند.                                        |  1  |  V  |
| 5.2.4 | تأیید کنید که برچسب‌های دسته‌بندی داده‌ها (PII، PHI، کنترل‌ شده برای صادرات، مالکیتی) به طور خودکار به منابع مشتق‌شده (برداشت‌ها، کش‌های درخواست، خروجی‌های مدل) با اعمال سیاست‌های سازگار منتقل می‌شوند.                        |  2  |  D  |
| 5.2.5 | تأیید کنید که تلاش‌های دسترسی غیرمجاز و رویدادهای بالا بردن امتیازات، هشدارهای زنده با متادیتای متنی به سیستم‌های SIEM ظرف 5 دقیقه ارسال می‌کنند.                                                                                |  2  | D/V |

---

## C5.3 ارزیابی پویا سیاست

پیاده‌سازی موتورهای کنترل دسترسی مبتنی بر ویژگی (ABAC) برای تصمیم‌گیری‌های مجازسازی آگاه به زمینه با قابلیت‌های حسابرسی.

|   #   | توضیحات                                                                                                                                                                                    | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.3.1 | تأیید کنید که تصمیمات مجوزدهی به یک موتور سیاست مستقل (OPA، Cedar یا معادل آن) واگذار شده است که از طریق APIهای احراز هویت شده با محافظت از صحت رمزنگاری شده قابل دسترسی باشد.             |  1  | D/V |
| 5.3.2 | بررسی کنید که سیاست‌ها ویژگی‌های پویا را در زمان اجرا ارزیابی می‌کنند، از جمله سطح تصفیه کاربر، طبقه‌بندی حساسیت منبع، زمینه درخواست، جداسازی مستأجر و محدودیت‌های زمانی.                  |  1  | D/V |
| 5.3.3 | اطمینان حاصل کنید که تعریف‌های سیاست‌ها تحت کنترل نسخه قرار دارند، توسط هم‌رده‌ها بازبینی شده‌اند، و از طریق تست‌های خودکار در خطوط لوله CI/CD قبل از استقرار در محیط تولید تایید شده‌اند. |  2  |  D  |
| 5.3.4 | اطمینان حاصل کنید که نتایج ارزیابی سیاست شامل دلایل ساخت‌یافته تصمیم‌گیری هستند و به سیستم‌های SIEM برای تحلیل همبستگی و گزارش‌دهی تطبیق منتقل می‌شوند.                                    |  2  |  V  |
| 5.3.5 | تأیید کنید که مقادیر زمان زندگی (TTL) حافظه نهان سیاست برای منابع با حساسیت بالا بیش از ۵ دقیقه و برای منابع استاندارد با قابلیت باطل‌سازی حافظه نهان بیش از ۱ ساعت نباشد.                 |  3  | D/V |

---

## اجرای امنیت در زمان پرس‌وجو C5.4

کنترل‌های امنیتی لایه پایگاه داده را با فیلترینگ اجباری و سیاست‌های امنیتی در سطح ردیف پیاده‌سازی کنید.

|   #   | توضیحات                                                                                                                                                                                                          | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | تأیید کنید که تمامی پرس‌وجوهای پایگاه داده برداری و SQL شامل فیلترهای امنیتی اجباری (شناسه مستاجر، برچسب‌های حساسیت، دامنه کاربر) باشند که در سطح موتور پایگاه داده اعمال می‌شوند، نه در کد برنامه.              |  1  | D/V |
| 5.4.2 | تأیید کنید که سیاست‌های امنیت در سطح ردیف (RLS) و ماسکینگ در سطح فیلد با ارث‌بری سیاست برای تمام پایگاه‌های داده برداری، شاخص‌های جستجو و مجموعه داده‌های آموزش فعال شده‌اند.                                    |  1  | D/V |
| 5.4.3 | تأیید کنید که ارزیابی‌های ناموفق مجوز، از حملات "معاون گیج‌شده" جلوگیری می‌کنند، با این کار که بلافاصله پرس‌وجوها را متوقف کرده و کدهای خطای مجوز صریح را برمی‌گردانند به جای اینکه مجموعه نتایج خالی برگردانند. |  2  |  D  |
| 5.4.4 | تأیید کنید که تأخیر ارزیابی سیاست به طور مداوم با هشدارهای خودکار برای شرایط زمان‌بندی معیوب که می‌تواند باعث دور زدن مجوزها شود، نظارت می‌شود.                                                                  |  2  |  V  |
| 5.4.5 | تأیید کنید که مکانیزم‌های تلاش مجدد پرس و جو، سیاست‌های مجوزدهی را بازنگری می‌کنند تا تغییرات پویا در سطح دسترسی‌ها در جلسات فعال کاربر لحاظ شوند.                                                               |  3  | D/V |

---

## فیلتر خروجی C5.5 و جلوگیری از نشت داده‌ها

اجرای کنترل‌های پس‌پردازش به منظور جلوگیری از افشای غیرمجاز داده‌ها در محتوای تولید شده توسط هوش مصنوعی.

|   #   | توضیحات                                                                                                                                                                                                   | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.5.1 | اطمینان حاصل کنید که مکانیزم‌های فیلترینگ پس از استنتاج، اطلاعات شناسایی شخصی غیرمجاز (PII)، اطلاعات طبقه‌بندی شده و داده‌های اختصاصی را قبل از ارائه محتوا به درخواست‌ کنندگان، اسکن و پاک‌سازی می‌کنند. |  1  | D/V |
| 5.5.2 | اطمینان حاصل کنید که استنادها، مراجع و نسبت‌دهی منابع در خروجی‌های مدل بر اساس مجوزهای تماس‌گیرنده اعتبارسنجی شده و در صورت شناسایی دسترسی غیرمجاز حذف شوند.                                              |  1  | D/V |
| 5.5.3 | اطمینان حاصل کنید که محدودیت‌های قالب خروجی (PDFهای پاک‌سازی‌شده، تصاویر بدون متادیتا، انواع فایل‌های تأییدشده) بر اساس سطح دسترسی کاربران و طبقه‌بندی داده‌ها اعمال می‌شود.                              |  2  |  D  |
| 5.5.4 | اطمینان حاصل کنید که الگوریتم‌های حذف اطلاعات به صورت تعیین‌پذیر، کنترل نسخه شده و دارای ثبت گزارش‌های حسابرسی برای پشتیبانی از تحقیقات تطبیقی و تحلیل‌های جنایی هستند.                                   |  2  |  V  |
| 5.5.5 | تأیید کنید که رویدادهای تحریر با ریسک بالا، لاگ‌های تطبیقی تولید می‌کنند که شامل هش‌های رمزنگاری شده از محتوای اصلی برای بازیابی قضایی بدون افشای داده‌ها هستند.                                          |  3  |  V  |

---

## C5.6 ایزولاسیون چند مستاجری

اطمینان از جداسازی رمزنگاری و منطقی بین مستاجران در زیرساخت مشترک هوش مصنوعی.

|   #   | توضیحات                                                                                                                                                                                                  | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.6.1 | اطمینان حاصل کنید که فضای حافظه، فروشگاه‌های تعبیه، ورودی‌های کش، و فایل‌های موقت به صورت جداشده بر اساس فضای نام هر مستاجر نگهداری می‌شوند و هنگام حذف مستاجر یا اتمام جلسه، پاک‌سازی امن انجام می‌شود. |  1  | D/V |
| 5.6.2 | تأیید کنید که هر درخواست API شامل یک شناسه مستأجر احراز هویت شده باشد که به صورت رمزنگاری شده بر اساس زمینه جلسه و مجوزهای کاربر اعتبارسنجی شود.                                                         |  1  | D/V |
| 5.6.3 | بررسی کنید که سیاست‌های شبکه قوانین پیش‌فرض-رد را برای ارتباط بین مستأجرها در داخل شبکه‌های خدمت و پلتفرم‌های ارکستراسیون کانتینر اعمال می‌کنند.                                                         |  2  |  D  |
| 5.6.4 | تأیید کنید که کلیدهای رمزگذاری برای هر مستأجر منحصر به فرد هستند با پشتیبانی از کلید مدیریت شده توسط مشتری (CMK) و جداسازی رمزنگاری شده بین مخازن داده‌های مستأجر.                                       |  3  |  D  |

---

## C5.7 مجوز عامل خودمختار

کنترل دسترسی‌ها برای عوامل هوش مصنوعی و سیستم‌های خودمختار از طریق نشانه‌های قابلیت محدوده‌دار و مجوزدهی مداوم.

|   #   | توضیحات                                                                                                                                                                                                   | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | تأیید کنید که عوامل خودکار توکن‌های قابلیت محدوده‌دار دریافت می‌کنند که به‌طور صریح اقدامات مجاز، منابع قابل دسترسی، محدودیت‌های زمانی و محدودیت‌های عملیاتی را فهرست می‌کنند.                            |  1  | D/V |
| 5.7.2 | تأیید کنید که قابلیت‌های پرخطر (دسترسی به سیستم فایل، اجرای کد، تماس‌های API خارجی، تراکنش‌های مالی) به‌طور پیش‌فرض غیرفعال هستند و برای فعال‌سازی نیاز به مجوزهای صریح همراه با توجیهات کسب‌وکاری دارند. |  1  | D/V |
| 5.7.3 | تأیید کنید که توکن‌های قابلیت به جلسات کاربری متصل شده‌اند، حفاظت از یکپارچگی رمزنگاری شده را شامل می‌شوند، و اطمینان حاصل شود که نمی‌توانند در سناریوهای آفلاین ذخیره یا دوباره استفاده شوند.            |  2  |  D  |
| 5.7.4 | تأیید کنید که اقدامات آغاز شده توسط عامل، از طریق موتور سیاست ABAC با ارزیابی کامل زمینه و ثبت گزارش حسابرسی، مورد مجوز ثانویه قرار می‌گیرند.                                                             |  2  |  V  |
| 5.7.5 | اطمینان حاصل کنید که شرایط خطاهای عامل و بررسی استثناها شامل اطلاعات دامنه قابلیت برای پشتیبانی از تجزیه و تحلیل حادثه و تحقیق قضایی باشد.                                                                |  3  |  V  |

---

## مراجع

### استانداردها و چارچوب‌ها

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### راهنمای پیاده‌سازی

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### امنیت خاص هوش مصنوعی

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


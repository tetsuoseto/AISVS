# کنترل دسترسی C5 و هویت برای مولفه‌ها و کاربران هوش مصنوعی

## هدف کنترل

کنترل دسترسی مؤثر برای سیستم‌های هوش مصنوعی نیازمند مدیریت هویت قوی، مجوزدهی آگاه به زمینه و اجرای در زمان اجرا بر اساس اصول اعتماد صفر است. این کنترل‌ها اطمینان می‌دهند که انسان‌ها، سرویس‌ها و عوامل خودران تنها در محدوده‌های صریحاً اعطا شده با مدل‌ها، داده‌ها و منابع محاسباتی تعامل دارند، همراه با قابلیت‌های تأیید و حسابرسی مداوم.

---

## C5.1 مدیریت هویت و احراز هویت

ایجاد هویت‌های مبتنی بر رمزنگاری برای تمام موجودیت‌ها با استفاده از احراز هویت چندعاملی برای عملیات دارای امتیاز ویژه.

|   #   | توضیحات                                                                                                                                                                                                                                                          | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | تأیید کنید که همه کاربران انسانی و اصول سرویس از طریق یک ارائه‌دهنده هویت سازمانی متمرکز (IdP) با استفاده از پروتکل‌های OIDC/SAML احراز هویت می‌کنند، به طوری که نگاشت‌های منحصر به فرد هویت به توکن وجود داشته باشد (هیچ حساب یا مدرک مشترکی وجود نداشته باشد). |  1  | D/V |
| 5.1.2 | اطمینان حاصل کنید که عملیات پرخطر (استقرار مدل، صادرات وزن، دسترسی به داده‌های آموزش، تغییرات پیکربندی تولید) نیازمند احراز هویت چندمرحله‌ای یا احراز هویت افزایش سطح با اعتبارسنجی مجدد جلسه باشد.                                                              |  1  | D/V |
| 5.1.3 | اطمینان حاصل کنید که مدیران جدید قبل از دریافت دسترسی به سیستم تولید، فرآیند اثبات هویت را بر اساس استانداردهای NIST 800-63-3 IAL-2 یا معادل آن انجام دهند.                                                                                                      |  2  |  D  |
| 5.1.4 | تأیید کنید که مرورهای دسترسی به صورت فصلی انجام می‌شود و شامل تشخیص خودکار حساب‌های غیرفعال، اعمال چرخش اطلاعات اعتباری، و جریان‌های کاری حذف دسترسی است.                                                                                                        |  2  |  V  |
| 5.1.5 | اطمینان حاصل کنید که عامل‌های هوش مصنوعی فدرال از طریق اثبات‌های JWT امضا شده که حداکثر طول عمر 24 ساعت دارند و شامل اثبات رمزنگاری شده منبع هستند، احراز هویت می‌شوند.                                                                                          |  3  | D/V |

---

## C5.2 مجوز دسترسی به منابع و حداقل امتیاز

اجرای کنترل دسترسی دقیق برای تمامی منابع هوش مصنوعی با مدل‌های اجازه صریح و سوابق بازرسی.

|   #   | توضیحات                                                                                                                                                                                                                             | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | تأیید کنید که هر منبع هوش مصنوعی (مجموعه داده‌ها، مدل‌ها، نقاط انتهایی، مجموعه‌های برداری، شاخص‌های جاسازی، نمونه‌های محاسباتی) کنترل‌های دسترسی مبتنی بر نقش را با فهرست‌های صریح مجاز و سیاست‌های پیش‌فرض عدم اجازه اعمال می‌کند. |  1  | D/V |
| 5.2.2 | تأیید کنید که اصول کمترین سطح دسترسی به طور پیش‌فرض برای حساب‌های سرویس اعمال می‌شود، به طوری که دسترسی‌ها از سطح فقط خواندنی شروع شده و برای دسترسی نوشتن، توجیه تجاری مستند شده لازم است.                                         |  1  | D/V |
| 5.2.3 | تأیید کنید که تمام تغییرات کنترل دسترسی به درخواست‌های تغییر تأیید شده مرتبط هستند و به صورت غیرقابل تغییر با زمان‌بندی‌ها، هویت‌های عامل، شناسه‌های منابع و تغییرات مجوزها ثبت شده‌اند.                                            |  1  |  V  |
| 5.2.4 | اطمینان حاصل کنید که برچسب‌های طبقه‌بندی داده‌ها (PII، PHI، تحت کنترل صادرات، مالکیتی) به صورت خودکار به منابع مشتق شده (تعبیه‌ها، حافظه‌های کش درخواست‌ها، خروجی‌های مدل) منتقل شده و با اجرای سیاست‌های یکسان اعمال می‌شوند.      |  2  |  D  |
| 5.2.5 | تأیید کنید که تلاش‌های دسترسی غیرمجاز و رویدادهای افزایش سطح دسترسی، هشدارهای بلادرنگ با فراداده متنی مربوطه را در عرض 5 دقیقه به سیستم‌های SIEM ارسال می‌کنند.                                                                     |  2  | D/V |

---

## C5.3 ارزیابی خط‌مشی پویا

استقرار موتورهای کنترل دسترسی مبتنی بر ویژگی (ABAC) برای تصمیم‌گیری‌های مجوزدهی آگاه از زمینه همراه با قابلیت‌های حسابرسی.

|   #   | توضیحات                                                                                                                                                                                  | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | تأیید کنید که تصمیمات مجوزدهی به یک موتور سیاست اختصاصی (مانند OPA، Cedar یا معادل آن) که از طریق APIهای احراز هویت شده و با حفاظت یکپارچگی رمزنگاری شده قابل دسترسی است، منتقل شده‌اند. |  1  | D/V |
| 5.3.2 | اطمینان حاصل کنید که سیاست‌ها ویژگی‌های پویا را در زمان اجرا ارزیابی می‌کنند، از جمله سطح دسترسی کاربر، طبقه‌بندی حساسیت منبع، زمینه درخواست، جداسازی مستاجران و محدودیت‌های زمانی.      |  1  | D/V |
| 5.3.3 | اطمینان حاصل کنید که تعاریف سیاست‌ها تحت کنترل نسخه، بازبینی شده توسط هم‌رده‌ها و از طریق تست‌های خودکار در خطوط CI/CD قبل از استقرار در تولید، معتبر شده‌اند.                           |  2  |  D  |
| 5.3.4 | اطمینان حاصل کنید که نتایج ارزیابی سیاست شامل دلایل تصمیم‌گیری ساختاریافته هستند و برای تجزیه و تحلیل همبستگی و گزارش‌دهی انطباق به سیستم‌های SIEM ارسال می‌شوند.                        |  2  |  V  |
| 5.3.5 | تأیید کنید که مقادیر زمان زندگی کش سیاست (TTL) برای منابع با حساسیت بالا بیش از 5 دقیقه و برای منابع استاندارد با قابلیت ابطال کش بیش از 1 ساعت نشود.                                    |  3  | D/V |

---

## C5.4 اعمال امنیت در زمان پرس‌وجو

اجرای کنترل‌های امنیتی لایه پایگاه داده با فیلترینگ اجباری و سیاست‌های امنیت سطح ردیف.

|   #   | توضیحات                                                                                                                                                                                                                        | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.4.1 | اطمینان حاصل کنید که تمام کوئری‌های پایگاه داده برداری و SQL شامل فیلترهای امنیتی اجباری (شناسه مستاجر، برچسب‌های حساسیت، دامنه کاربر) باشند که در سطح موتور پایگاه داده اعمال می‌شوند و نه در کد برنامه.                      |  1  | D/V |
| 5.4.2 | تأیید کنید که سیاست‌های امنیت سطح ردیف (RLS) و ماسک‌گذاری سطح فیلد با ارث‌بری سیاست برای تمامی پایگاه‌های داده برداری، شاخص‌های جستجو و داده‌های آموزشی فعال شده‌اند.                                                          |  1  | D/V |
| 5.4.3 | تأیید کنید که ارزیابی‌های مجوز ناموفق از «حملات معاون سردرگم» جلوگیری می‌کنند با اینکه به محض مواجهه با این وضعیت، پرس‌وجوها را فوراً متوقف کرده و کدهای خطای مجوز صریح را بازمی‌گردانند، به جای بازگرداندن مجموعه نتایج خالی. |  2  |  D  |
| 5.4.4 | اطمینان حاصل کنید که تاخیر در ارزیابی سیاست به طور مداوم با هشدارهای خودکار برای شرایط تایم اوت که ممکن است باعث عبور غیرمجاز از مجوز شود، تحت نظارت قرار دارد.                                                                |  2  |  V  |
| 5.4.5 | اطمینان حاصل کنید که مکانیزم‌های تلاش مجدد پرس‌وجو (query retry) سیاست‌های مجوزدهی را مجدداً ارزیابی می‌کنند تا تغییرات پویا در دسترسی‌ها در طول جلسات فعال کاربر در نظر گرفته شود.                                            |  3  | D/V |

---

## فیلتر خروجی C5.5 و پیشگیری از از دست دادن داده‌ها

استقرار کنترل‌های پس‌پردازش برای جلوگیری از افشای داده‌های غیرمجاز در محتوای تولیدشده توسط هوش مصنوعی.

|   #   | توضیحات                                                                                                                                                                                       | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.5.1 | اطمینان حاصل کنید که مکانیزم‌های فیلترینگ پس از استنتاج، اطلاعات شناسایی شخصی غیرمجاز، اطلاعات طبقه‌بندی‌شده و داده‌های مالکیتی را قبل از ارائه محتوا به درخواست‌کنندگان، اسکن و حذف می‌کنند. |  1  | D/V |
| 5.5.2 | تأیید کنید که ارجاعات، مآخذ و نسبت‌دهی منابع در خروجی‌های مدل مطابق با مجوزهای فراخواننده بررسی شده و در صورت تشخیص دسترسی غیرمجاز حذف شوند.                                                  |  1  | D/V |
| 5.5.3 | تأیید کنید که محدودیت‌های فرمت خروجی (PDFهای تصفیه‌شده، تصاویر فاقد فراداده، انواع فایل‌های تأییدشده) بر اساس سطوح دسترسی کاربران و رده‌بندی داده‌ها اعمال می‌شوند.                           |  2  |  D  |
| 5.5.4 | تأیید کنید که الگوریتم‌های پوشش اطلاعات به صورت قطعی، کنترل نسخه شده و دارای گزارش‌های ممیزی برای پشتیبانی از تحقیقات انطباق و تحلیل‌های جنایی باشند.                                         |  2  |  V  |
| 5.5.5 | تأیید کنید که رویدادهای حذف اطلاعات با ریسک بالا، لاگ‌های تطبیقی تولید می‌کنند که شامل هش‌های رمزنگاری شده از محتوای اصلی برای بازیابی جرم‌شناسی بدون افشای داده‌ها هستند.                    |  3  |  V  |

---

## C5.6 ایزولاسیون چند مستاجری

اطمینان از جداسازی رمزنگاری و منطقی بین مستاجران در زیرساخت مشترک هوش مصنوعی.

|   #   | توضیحات                                                                                                                                                                                                 | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.6.1 | تأیید کنید که فضاهای حافظه، ذخیره‌گاه‌های تعبیه‌شده، ورودی‌های کش و فایل‌های موقت به‌صورت جداشده بر اساس فضای نام هر مستأجر نگهداری شده و پس از حذف مستأجر یا خاتمه جلسه به‌صورت ایمن پاک‌سازی می‌شوند. |  1  | D/V |
| 5.6.2 | اطمینان حاصل کنید که هر درخواست API شامل یک شناسه مستأجر احراز هویت شده باشد که به‌طور رمزنگاری شده در برابر زمینه نشست و مجوزهای کاربر اعتبارسنجی شده است.                                             |  1  | D/V |
| 5.6.3 | اطمینان حاصل کنید که سیاست‌های شبکه قوانین پیش‌فرض-رد را برای ارتباط بین مستاجرها در درون سرویس مش‌ها و پلتفرم‌های ارکستراسیون کانتینرها اعمال می‌کنند.                                                 |  2  |  D  |
| 5.6.4 | تأیید کنید که کلیدهای رمزنگاری برای هر مستأجر منحصر به فرد هستند و از کلید مدیریت شده توسط مشتری (CMK) پشتیبانی می‌شود و ایزولاسیون رمزنگاری بین مخازن داده‌های مستأجران وجود دارد.                     |  3  |  D  |

---

## C5.7 مجوز عامل خودمختار

کنترل مجوزها برای عامل‌های هوش مصنوعی و سیستم‌های خودکار از طریق توکن‌های قابلیت محدود شده و تأیید مداوم.

|   #   | توضیحات                                                                                                                                                                                                     | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | تأیید کنید که عامل‌های خودکار توکن‌های قابلیت محدوده‌دار دریافت می‌کنند که به‌صراحت اقدامات مجاز، منابع قابل دسترسی، محدودیت‌های زمانی و محدودیت‌های عملیاتی را فهرست می‌کنند.                              |  1  | D/V |
| 5.7.2 | تأیید کنید که قابلیت‌های پرریسک (دسترسی به سیستم فایل، اجرای کد، تماس با APIهای خارجی، تراکنش‌های مالی) به‌طور پیش‌فرض غیرفعال بوده و برای فعال‌سازی نیاز به مجوزهای صریح همراه با توجیهات کسب‌وکاری دارند. |  1  | D/V |
| 5.7.3 | اطمینان حاصل کنید که توکن‌های قابلیت به نشست‌های کاربری متصل شده‌اند، شامل حفاظت از صحت رمزنگاری هستند و تضمین کنید که نمی‌توان آن‌ها را در سناریوهای آفلاین ذخیره یا مجدداً استفاده کرد.                   |  2  |  D  |
| 5.7.4 | تأیید کنید که اقدامات آغاز شده توسط عامل، از طریق موتور سیاست ABAC با ارزیابی کامل زمینه و ثبت گزارش بازبینی، مورد تایید ثانویه قرار می‌گیرند.                                                              |  2  |  V  |
| 5.7.5 | اطمینان حاصل کنید که شرایط خطاهای عامل و مدیریت استثناها شامل اطلاعات حوزه قابلیت‌ها باشد تا از تحلیل حادثه و تحقیقات جنایی پشتیبانی کند.                                                                   |  3  |  V  |

---

## مراجع

### استانداردها و چهارچوب‌ها

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### راهنمای پیاده‌سازی

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### امنیت خاص هوش مصنوعی

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


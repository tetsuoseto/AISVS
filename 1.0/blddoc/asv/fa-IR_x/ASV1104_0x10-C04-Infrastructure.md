# زیرساخت C4، پیکربندی و امنیت استقرار

## هدف کنترل

زیرساخت هوش مصنوعی باید در برابر افزایش دسترسی‌های غیرمجاز، دستکاری زنجیره تامین و حرکت جانبی از طریق پیکربندی امن، جداسازی در زمان اجرا، خطوط لوله استقرار معتبر و پایش جامع سخت‌گیرانه شود. تنها اجزای زیرساخت و پیکربندی‌های مجاز و معتبر شده از طریق فرآیندهای کنترل شده که امنیت، یکپارچگی و امکان حسابرسی را حفظ می‌کنند، به محیط تولید می‌رسند.

هدف اصلی امنیت: تنها اجزای زیرساختی که به صورت رمزنگاری شده امضاء شده و از نظر آسیب‌پذیری اسکن شده‌اند، از طریق خطوط لوله اعتبارسنجی خودکار که سیاست‌های امنیتی را اجرا می‌کنند و سوابق حسابرسی تغییرناپذیر را حفظ می‌کنند، به محیط تولید می‌رسند.

---

## C4.1 جداسازی محیط اجرای زمان اجرا

جلوگیری از فرار از کانتینر و افزایش امتیاز از طریق ابتداییات ایزوله‌سازی در سطح کرنل و کنترل‌های دسترسی اجباری.

|   #   | توضیحات                                                                                                                                                                                                                      | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.1.1 | اطمینان حاصل کنید که تمام کانتینرهای هوش مصنوعی تمامی قابلیت‌های لینوکس را به استثنای CAP_SETUID، CAP_SETGID، و قابلیت‌های صریحاً مورد نیاز که در مبناهای امنیتی مستند شده‌اند، حذف کنند.                                    |  1  | D/V |
| 4.1.2 | اطمینان حاصل کنید که پروفایل‌های seccomp تمامی فراخوانی‌های سیستمی را به جز آن‌هایی که در فهرست‌های مجاز از پیش تعیین‌شده هستند، مسدود می‌کنند، به گونه‌ای که هرگونه تخلف منجر به خاتمه کانتینر و ایجاد هشدارهای امنیتی شود. |  1  | D/V |
| 4.1.3 | بررسی کنید که بارهای کاری هوش مصنوعی با سیستم‌فایل‌های ریشه فقط خواندنی، tmpfs برای داده‌های موقتی، و حجم‌های نامگذاری شده برای داده‌های پایدار با گزینه‌های اتصال noexec اجرا شوند.                                         |  2  | D/V |
| 4.1.4 | اطمینان حاصل کنید که پایش زمان اجرا مبتنی بر eBPF (مانند Falco، Tetragon یا معادل آن) تلاش‌های افزایش امتیازات دسترسی را شناسایی کرده و فرآیندهای متخلف را به‌طور خودکار در چارچوب زمان پاسخگویی سازمانی خاتمه می‌دهد.       |  2  | D/V |
| 4.1.5 | تأیید کنید که بارهای کاری هوش مصنوعی با ریسک بالا در محیط‌های ایزوله سخت‌افزاری (Intel TXT، AMD SVM، یا گره‌های اختصاصی بدون سیستم‌عامل) با تأیید اعتبار اجرا می‌شوند.                                                       |  3  | D/V |

---

## C4.2  خطوط لوله ساخت و استقرار ایمن

از طریق ساخت‌های قابل بازتولید و آثار امضا شده، یکپارچگی رمزنگاری و امنیت زنجیره تأمین را تضمین کنید.

|   #   | توضیحات                                                                                                                                                                                                        | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.2.1 | تأیید کنید که زیرساخت به‌عنوان کد با ابزارهایی مانند tfsec، Checkov، یا Terrascan در هر مرتبه کامیت اسکن می‌شود و ادغام‌ها در صورت وجود یافته‌های با شدت CRITICAL یا HIGH مسدود می‌شوند.                       |  1  | D/V |
| 4.2.2 | اطمینان حاصل کنید که ساخت کانتینرها با هش‌های SHA256 یکسان در تمام ساخت‌ها قابل بازتولید باشند و گواهی‌های اثبات اصالت سطح 3 SLSA با امضای Sigstore تولید شوند.                                                |  1  | D/V |
| 4.2.3 | تأیید کنید که تصاویر کانتینر شامل CycloneDX یا SPDX SBOM‌ها هستند و قبل از ارسال به رجیستری با Cosign امضا شده‌اند، و تصاویر بدون امضا در زمان استقرار رد شوند.                                                |  2  | D/V |
| 4.2.4 | اطمینان حاصل کنید که خطوط لوله CI/CD از توکن‌های OIDC از HashiCorp Vault، نقش‌های IAM در AWS، یا شناسه مدیریت‌شده Azure استفاده می‌کنند که طول عمر آن‌ها از محدودیت‌های سیاست‌های امنیتی سازمان فراتر نمی‌رود. |  2  | D/V |
| 4.2.5 | اطمینان حاصل کنید که امضاهای Cosign و منشأ SLSA در طول فرآیند استقرار قبل از اجرای کانتینر اعتبارسنجی می‌شوند و خطاهای تأیید باعث شکست استقرار می‌شوند.                                                        |  2  | D/V |
| 4.2.6 | اطمینان حاصل کنید که محیط‌های ساخت در کانتینرهای موقت یا ماشین‌های مجازی اجرا می‌شوند که ذخیره‌سازی مداوم ندارند و از شبکه‌های VPC تولید به صورت ایزوله جدا شده‌اند.                                           |  2  | D/V |

---

## C4.3 امنیت شبکه و کنترل دسترسی

اجرای شبکه‌سازی اعتماد صفر با سیاست‌های پیش‌فرض انکار و ارتباطات رمزگذاری‌شده.

|   #   | توضیحات                                                                                                                                                                                              | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.3.1 | بررسی کنید که Kubernetes NetworkPolicies یا معادل آن پیاده‌سازی پیش‌فرض مسدودسازی ورودی/خروجی به همراه قوانین صریح اجازه برای پورت‌های مورد نیاز (443، 8080 و غیره) را انجام داده باشد.              |  1  | D/V |
| 4.3.2 | اطمینان حاصل کنید که پورت SSH (پورت 22)، پورت RDP (پورت 3389) و نقاط پایانی متادیتای ابری (169.254.169.254) مسدود شده‌اند یا به احراز هویت مبتنی بر گواهی‌نامه نیاز دارند.                           |  1  | D/V |
| 4.3.3 | تأیید کنید که ترافیک خروجی از طریق پراکسی‌های HTTP/HTTPS (مانند Squid، Istio، یا دروازه‌های NAT ابری) با استفاده از فهرست‌های مجاز دامنه فیلتر شده و درخواست‌های مسدود شده ثبت شوند.                 |  2  | D/V |
| 4.3.4 | تأیید کنید که ارتباط بین سرویس‌ها از TLS متقابل با گواهی‌نامه‌هایی که طبق سیاست سازمانی چرخش می‌یابند استفاده می‌کند و اعتبارسنجی گواهی‌نامه‌ها اجرا می‌شود (بدون استفاده از گزینه‌های skip-verify). |  2  | D/V |
| 4.3.5 | تأیید کنید که زیرساخت‌های هوش مصنوعی در VPCها/VNetهای اختصاصی اجرا می‌شوند که دسترسی مستقیم به اینترنت ندارند و فقط از طریق دروازه‌های NAT یا میزبان‌های بستیون ارتباط برقرار می‌کنند.               |  2  | D/V |

---

## C4.4 مدیریت اسرار و کلیدهای رمزنگاری

محافظت از اعتبارنامه‌ها از طریق ذخیره‌سازی پشتیبانی‌شده توسط سخت‌افزار و چرخش خودکار با دسترسی مبتنی بر اعتماد صفر.

|   #   | توضیحات                                                                                                                                                                                          | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 4.4.1 | اطمینان حاصل کنید که اسرار در HashiCorp Vault، AWS Secrets Manager، Azure Key Vault یا Google Secret Manager با رمزنگاری در حالت استراحت با استفاده از AES-256 ذخیره شده‌اند.                    |  1  | D/V |
| 4.4.2 | تأیید کنید که کلیدهای رمزنگاری در HSMهای سطح 2 FIPS 140-2 (AWS CloudHSM، Azure Dedicated HSM) با چرخش کلید مطابق با سیاست رمزنگاری سازمانی تولید شده‌اند.                                        |  1  | D/V |
| 4.4.3 | تأیید کنید که چرخش اسرار به صورت خودکار با استقرار بدون زمان توقف و چرخش فوری ناشی از تغییرات پرسنلی یا رخدادهای امنیتی انجام می‌شود.                                                            |  2  | D/V |
| 4.4.4 | اطمینان حاصل کنید که تصاویر کانتینر با ابزارهایی مانند GitLeaks، TruffleHog یا detect-secrets اسکن می‌شوند تا ساخت‌هایی که شامل کلیدهای API، گذرواژه‌ها یا گواهینامه‌ها هستند، مسدود شوند.       |  2  | D/V |
| 4.4.5 | تأیید کنید که دسترسی به کلیدهای محرمانه تولیدی مستلزم MFA با توکن‌های سخت‌افزاری (YubiKey، FIDO2) باشد و این دسترسی توسط لاگ‌های حسابرسی غیرقابل تغییر با شناسه کاربران و زمان‌بندی‌ها ثبت گردد. |  2  | D/V |
| 4.4.6 | اطمینان حاصل کنید که اسرار از طریق اسرار Kubernetes، حجم‌های متصل شده یا کانتینرهای init تزریق می‌شوند و مطمئن شوید که اسرار هرگز در متغیرهای محیطی یا ایمیج‌ها جاسازی نشده‌اند.                 |  2  | D/V |

---

## C4.5 جداسازی و اعتبارسنجی بار کاری هوش مصنوعی

مدل‌های هوش مصنوعی غیرقابل اعتماد را در محیط‌های محافظت‌شده ایزوله کنید و تحلیل رفتاری جامع انجام دهید.

|   #   | توضیحات                                                                                                                                                                                          | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 4.5.1 | بررسی کنید که مدل‌های هوش مصنوعی خارجی در gVisor، microVMها (مانند Firecracker، CrossVM) یا کانتینرهای داکر با گزینه‌های --security-opt=no-new-privileges و --read-only اجرا می‌شوند.            |  1  | D/V |
| 4.5.2 | تأیید کنید که محیط‌های سندباکس هیچ اتصال شبکه‌ای نداشته باشند (--network=none) یا فقط به localhost دسترسی داشته باشند و تمامی درخواست‌های خارجی توسط قوانین iptables مسدود شده باشند.            |  1  | D/V |
| 4.5.3 | اطمینان حاصل کنید که اعتبارسنجی مدل هوش مصنوعی شامل آزمایش خودکار تیم قرمز با پوشش تست تعریف شده توسط سازمان و تحلیل رفتاری برای تشخیص درب پشتی است.                                             |  2  | D/V |
| 4.5.4 | تأیید کنید که قبل از ارتقاء یک مدل هوش مصنوعی به محیط تولید، نتایج آن در محیط آزمایشی به‌صورت رمزنگاری شده توسط پرسنل امنیتی مجاز امضا شده و در گزارش‌های حسابرسی غیرقابل تغییر ذخیره شده باشند. |  2  | D/V |
| 4.5.5 | تأیید کنید که محیط‌های سندباکس بین ارزیابی‌ها با تخریب و بازسازی از تصاویر طلایی همراه با پاک‌سازی کامل فایل‌سیستم و حافظه انجام می‌شوند.                                                        |  2  | D/V |

---

## C4.6 نظارت بر امنیت زیرساخت

زیرساخت را به‌طور مداوم اسکن و پایش کنید با اصلاح خودکار و هشداردهی در لحظه.

|   #   | توضیحات                                                                                                                                                                                | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.6.1 | اطمینان حاصل کنید که تصاویر کانتینر طبق برنامه‌های سازمانی اسکن می‌شوند و آسیب‌پذیری‌های بحرانی بر اساس آستانه‌های ریسک سازمانی، مانع از استقرار می‌شوند.                              |  1  | D/V |
| 4.6.2 | تأیید کنید که زیرساخت‌ها با معیارهای CIS یا کنترل‌های NIST 800-53، همراه با آستانه‌های انطباق تعریف‌شده توسط سازمان و اصلاح خودکار برای بررسی‌های ناموفق، مطابقت دارند.                |  1  | D/V |
| 4.6.3 | اطمینان حاصل کنید که آسیب‌پذیری‌های با شدت بالا بر اساس زمان‌بندی مدیریت ریسک سازمانی رفع شده‌اند و رویه‌های اضطراری برای CVEهای فعال که مورد سوءاستفاده قرار می‌گیرند، اعمال شده است. |  2  | D/V |
| 4.6.4 | تأیید کنید که هشدارهای امنیتی با پلتفرم‌های SIEM (مانند Splunk، Elastic یا Sentinel) با استفاده از فرمت‌های CEF یا STIX/TAXII و با غنی‌سازی خودکار یکپارچه شده باشند.                  |  2  |  V  |
| 4.6.5 | تأیید کنید که معیارهای زیرساخت به سیستم‌های نظارتی (مانند Prometheus، DataDog) صادر می‌شوند و داشبوردهای SLA و گزارش‌گیری مدیریتی نیز فراهم شده‌اند.                                   |  3  |  V  |
| 4.6.6 | تأیید کنید که انحراف پیکربندی با استفاده از ابزارها (Chef InSpec، AWS Config) مطابق با الزامات نظارتی سازمانی شناسایی شود و تغییرات غیرمجاز به‌صورت خودکار بازگردانده شوند.            |  2  | D/V |

---

## مدیریت منابع زیرساخت هوش مصنوعی C4.7

جلوگیری از حملات خستگی منابع و اطمینان از تخصیص منصفانه منابع از طریق سهمیه‌بندی و نظارت.

|   #   | توضیحات                                                                                                                                                                                      | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.7.1 | تأیید کنید که استفاده از GPU/TPU زیر نظر گرفته شده است و هشدارها در آستانه‌های تعریف شده سازمانی فعال می‌شوند و مقیاس‌بندی خودکار یا تعادل بار بر اساس سیاست‌های مدیریت ظرفیت انجام می‌گردد. |  1  | D/V |
| 4.7.2 | تأیید کنید که معیارهای بار کاری هوش مصنوعی (تاخیر استنباط، توان عملیاتی، نرخ خطاها) بر اساس الزامات نظارت سازمانی جمع‌آوری شده و با استفاده زیرساختی مرتبط شده‌اند.                          |  1  | D/V |
| 4.7.3 | اطمینان حاصل کنید که Kubernetes ResourceQuotas یا معادل آن، بارهای کاری فردی را مطابق با سیاست‌های تخصیص منابع سازمانی با محدودیت‌های سخت‌گیرانه اعمال شده محدود می‌کند.                     |  2  | D/V |
| 4.7.4 | تأیید کنید که پایش هزینه، هزینه‌ها را برای هر بار کاری/مستأجر ردیابی می‌کند و هشدارهایی بر اساس آستانه‌های بودجه سازمانی و کنترل‌های خودکار برای تجاوزات بودجه ارائه می‌دهد.                 |  2  |  V  |
| 4.7.5 | تأیید کنید که برنامه‌ریزی ظرفیت از داده‌های تاریخی با دوره‌های پیش‌بینی تعریف‌شده سازمانی و تأمین منابع خودکار بر اساس الگوهای تقاضا استفاده می‌کند.                                         |  3  |  V  |
| 4.7.6 | اطمینان حاصل کنید که فرسودگی منابع، قطع‌کننده‌های مدار را مطابق با نیازهای پاسخ سازمانی فعال می‌کند، از جمله محدودیت نرخ بر اساس سیاست‌های ظرفیت و ایزوله‌سازی بار کاری.                     |  2  | D/V |

---

## C4.8 تفکیک محیط و کنترل‌های ارتقاء

اجرای مرزهای محیطی سختگیرانه با دروازه‌های ارتقاء خودکار و اعتبارسنجی امنیتی.

|   #   | توضیحات                                                                                                                                                                                                  | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.8.1 | تأیید کنید که محیط‌های توسعه/تست/تولید در VPCها/VNetهای جداگانه اجرا می‌شوند و هیچ نقش IAM، گروه امنیتی یا اتصال شبکه مشترکی ندارند.                                                                     |  1  | D/V |
| 4.8.2 | تأیید کنید که ترفیع محیط نیازمند تأییدیه از افراد مجاز تعریف شده توسط سازمان با امضاهای رمزنگاری شده و سوابق بازبینی غیرقابل تغییر باشد.                                                                 |  1  | D/V |
| 4.8.3 | تأیید کنید که محیط‌های تولیدی دسترسی SSH را مسدود می‌کنند، نقاط اشکال‌زدایی را غیرفعال می‌کنند و درخواست‌های تغییر با الزامات اطلاع قبلی سازمانی، به جز موارد اضطراری، را لازم می‌دانند.                 |  2  | D/V |
| 4.8.4 | تأیید کنید که تغییرات زیرساخت به‌عنوان‌کد نیازمند بازبینی همتایان همراه با آزمایش خودکار و اسکن امنیتی قبل از ادغام به شاخه اصلی است.                                                                    |  2  | D/V |
| 4.8.5 | تأیید کنید که داده‌های غیرتولیدی بر اساس الزامات حفظ حریم خصوصی سازمانی ناشناس شده‌اند، تولید داده‌های مصنوعی انجام شده است، یا ماسک‌گذاری کامل داده‌ها با حذف اطلاعات شناسایی شخصی (PII) تأیید شده است. |  2  | D/V |
| 4.8.6 | اطمینان حاصل کنید که در دروازه‌های ارتقاء، آزمون‌های امنیتی خودکار (SAST، DAST، اسکن کانتینر) شامل شده باشند و هیچ نتیجه بحرانی (CRITICAL) برای تأیید مورد نیاز نباشد.                                   |  2  | D/V |

---

## پشتیبان‌گیری و بازیابی زیرساخت C4.9

اطمینان از مقاومت زیرساخت از طریق پشتیبان‌گیری‌های خودکار، رویه‌های بازیابی آزمایش‌شده و قابلیت‌های بازیابی از فاجعه.

|   #   | توضیحات                                                                                                                                                                        | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 4.9.1 | اطمینان حاصل کنید که پیکربندی‌های زیرساخت مطابق با برنامه‌های پشتیبان‌گیری سازمانی به مناطق جغرافیایی جداگانه پشتیبان‌گیری شده‌اند و استراتژی پشتیبان‌گیری 3-2-1 اجرا شده است. |  1  | D/V |
| 4.9.2 | اطمینان حاصل کنید که سیستم‌های پشتیبان‌گیری در شبکه‌های جداگانه با اعتبارنامه‌های مجزا و ذخیره‌سازی ایزوله شده (air-gapped) برای حفاظت در برابر باج‌افزار اجرا می‌شوند.        |  2  | D/V |
| 4.9.3 | اطمینان حاصل کنید که روش‌های بازیابی از طریق تست خودکار مطابق با برنامه‌های سازمانی و با اهداف RTO و RPO که نیازهای سازمان را برآورده می‌کنند، آزمایش و تأیید شده‌اند.         |  2  |  V  |
| 4.9.4 | تأیید کنید که بازیابی از فاجعه شامل کتابچه‌های راهنمای خاص هوش مصنوعی با بازسازی وزن مدل، بازسازی خوشه GPU، و نقشه‌برداری وابستگی سرویس‌ها باشد.                               |  3  |  V  |

---

## C4.10 تطابق زیرساخت و حاکمیت

با ارزیابی مداوم، مستندسازی و کنترل‌های خودکار، هماهنگی با قوانین و مقررات را حفظ کنید.

|   #    | توضیحات                                                                                                                                                      | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 4.10.1 | اطمینان حاصل شود که تطابق زیرساخت طبق برنامه‌های سازمان و با استفاده از جمع‌آوری خودکار مدارک، بر اساس کنترل‌های SOC 2، ISO 27001 یا FedRAMP ارزیابی می‌شود. |  2  | D/V |
| 4.10.2 | تایید کنید که مستندات زیرساخت شامل نمودارهای شبکه، نقشه‌های جریان داده و مدل‌های تهدید به‌روز شده مطابق با الزامات مدیریت تغییر سازمانی باشد.                |  2  |  V  |
| 4.10.3 | اطمینان حاصل کنید که تغییرات زیرساختی، ارزیابی تأثیر تطابق خودکار با گردش‌کارهای تأییدیه قانونی برای اصلاحات پرخطر را طی می‌کنند.                            |  3  | D/V |

---

## C4.11 امنیت سخت‌افزار هوش مصنوعی

حفاظت از سخت‌افزارهای خاص هوش مصنوعی شامل GPUها، TPUها و شتاب‌دهنده‌های تخصصی هوش مصنوعی.

|   #    | توضیحات                                                                                                                                                                                             | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.11.1 | اطمینان حاصل کنید که سیستم‌عامل تسریع‌کننده هوش مصنوعی (GPU BIOS، سیستم‌عامل TPU) با امضاهای رمزنگاری شده تأیید شده و مطابق با زمان‌بندی مدیریت پچ سازمانی به‌روزرسانی می‌شود.                      |  2  | D/V |
| 4.11.2 | اطمینان حاصل کنید که قبل از اجرای بار کاری، یکپارچگی شتاب‌دهنده هوش مصنوعی از طریق تصدیق سخت‌افزاری با استفاده از TPM 2.0، Intel TXT یا AMD SVM تأیید شود.                                          |  2  | D/V |
| 4.11.3 | تأیید کنید که حافظه GPU بین بارهای کاری با استفاده از SR-IOV، MIG (کارت گرافیک چند نمونه‌ای) یا تقسیم‌بندی سخت‌افزاری معادل به همراه پاک‌سازی حافظه بین وظایف ایزوله شده است.                       |  2  | D/V |
| 4.11.4 | اطمینان حاصل کنید که زنجیره تامین سخت‌افزار هوش مصنوعی شامل تایید اصالت با گواهی‌های تولیدکننده و اعتبارسنجی بسته‌بندی مقاوم در برابر دستکاری باشد.                                                 |  3  |  V  |
| 4.11.5 | اطمینان حاصل کنید که ماژول‌های امنیت سخت‌افزاری (HSMها) وزن‌های مدل هوش مصنوعی و کلیدهای رمزنگاری را با گواهی‌نامه FIPS 140-2 سطح 3 یا معیارهای عمومی Common Criteria با رتبه EAL4+ محافظت می‌کنند. |  3  | D/V |

---

## C4.12 زیرساخت هوش مصنوعی لبه و توزیع‌شده

استقرارهای ایمن هوش مصنوعی توزیع‌شده از جمله محاسبات لبه، یادگیری فدرال و معماری‌های چندسایتی.

|   #    | توضیحات                                                                                                                                                                                      | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.12.1 | اطمینان حاصل کنید که دستگاه‌های هوش مصنوعی لبه‌ای از طریق TLS متقابل با زیرساخت مرکزی احراز هویت می‌شوند و گواهی‌های دستگاه مطابق با سیاست مدیریت گواهی سازمانی چرخش می‌یابند.               |  2  | D/V |
| 4.12.2 | تأیید کنید که دستگاه‌های لبه‌ای بوت امن را با امضاهای تأیید شده و محافظت در برابر بازگشت به نسخه‌های قبلی (rollback protection) پیاده‌سازی می‌کنند تا از حملات کاهش نسخه فرم‌ور جلوگیری شود. |  2  | D/V |
| 4.12.3 | تأیید کنید که هماهنگی هوش مصنوعی توزیع‌شده از الگوریتم‌های اجماع تحمل خرابی بیزانسی با اعتبارسنجی شرکت‌کنندگان و شناسایی گره‌های مخرب استفاده می‌کند.                                        |  3  | D/V |
| 4.12.4 | تأیید کنید که ارتباط لبه تا ابر شامل محدودیت پهنای باند، فشرده‌سازی داده‌ها و قابلیت‌های عملکرد آفلاین با ذخیره‌سازی محلی ایمن باشد.                                                         |  3  | D/V |

---

## C4.13 امنیت زیرساخت چندابری و ترکیبی

بارکاری‌های امن هوش مصنوعی را در چندین ارائه‌دهنده ابری و استقرارهای ترکیبی ابری-محلی تضمین کنید.

|   #    | توضیحات                                                                                                                                                                                                        | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.13.1 | بررسی کنید که استقرارهای چندابری هوش مصنوعی از اتحاد هویت مستقل از ابر (OIDC، SAML) با مدیریت سیاست متمرکز در سراسر ارائه‌دهندگان استفاده می‌کنند.                                                             |  2  | D/V |
| 4.13.2 | اطمینان حاصل کنید که انتقال داده‌های بین ابرها از رمزگذاری انتها به انتها با کلیدهای مدیریت شده توسط مشتری و کنترل‌های محل نگهداری داده‌ها مطابق با حوزه قضایی اعمال می‌شود.                                   |  2  | D/V |
| 4.13.3 | اطمینان حاصل کنید که بارهای کاری هوش مصنوعی در ابر هیبریدی سیاست‌های امنیتی یکسانی را در محیط‌های محلی و ابر پیاده‌سازی می‌کنند، همراه با نظارت و هشداردهی یکپارچه.                                            |  2  | D/V |
| 4.13.4 | اطمینان حاصل کنید که پیشگیری از قفل شدن در فروشنده ابر شامل زیرساخت قابل حمل به‌صورت کد (infrastructure-as-code)، رابط‌های برنامه‌نویسی استاندارد (APIs) و قابلیت‌های صادرات داده با ابزارهای تبدیل فرمت باشد. |  3  |  V  |
| 4.13.5 | اطمینان حاصل کنید که بهینه‌سازی هزینه چندابری شامل کنترل‌های امنیتی برای جلوگیری از پراکندگی منابع و همچنین هزینه‌های انتقال داده غیرمجاز بین ابرها است.                                                       |  3  |  V  |

---

## امنیت خودکارسازی زیرساخت و GitOps C4.14

خطوط لوله خودکارسازی زیرساخت امن و جریان‌های کاری GitOps برای مدیریت زیرساخت هوش مصنوعی.

|   #    | توضیحات                                                                                                                                                                    | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.14.1 | اطمینان حاصل کنید که مخازن GitOps نیاز به کامیت‌های امضاشده با کلیدهای GPG دارند و قوانین محافظت از شاخه که از push مستقیم به شاخه‌های اصلی جلوگیری می‌کند، اعمال شده‌اند. |  2  | D/V |
| 4.14.2 | اطمینان حاصل کنید که اتوماسیون زیرساخت شامل تشخیص انحراف با قابلیت اصلاح خودکار و بازگردانی است که بر اساس نیازهای پاسخ سازمانی برای تغییرات غیرمجاز فعال می‌شود.          |  2  | D/V |
| 4.14.3 | اطمینان حاصل کنید که فرآیند خودکار تهیه زیرساخت شامل اعتبارسنجی سیاست امنیتی با مسدودسازی استقرار برای پیکربندی‌های غیرمنطبق باشد.                                         |  2  | D/V |
| 4.14.4 | تأیید کنید که اسرار اتوماسیون زیرساخت از طریق اپراتورهای مخفی خارجی (External Secrets Operator، Bank-Vaults) با گردش خودکار مدیریت می‌شوند.                                |  2  | D/V |
| 4.14.5 | تأیید کنید که زیرساخت خودترمیم شامل همبستگی رویدادهای امنیتی با پاسخ خودکار به حوادث و گردش‌کارهای اطلاع‌رسانی به ذینفعان باشد.                                            |  3  |  V  |

---

## C4.15 امنیت زیرساخت مقاوم در برابر کوانتوم

آماده‌سازی زیرساخت هوش مصنوعی در برابر تهدیدات محاسبات کوانتومی از طریق رمزنگاری پساکوانتومی و پروتکل‌های ایمن در برابر کوانتوم.

|   #    | توضیحات                                                                                                                                                                                      | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.15.1 | تأیید کنید که زیرساخت هوش مصنوعی الگوریتم‌های رمزنگاری پساکوانتومی تاییدشده توسط NIST (CRYSTALS-Kyber، CRYSTALS-Dilithium، SPHINCS+) را برای تبادل کلید و امضاهای دیجیتال پیاده‌سازی می‌کند. |  3  | D/V |
| 4.15.2 | اطمینان حاصل کنید که سیستم‌های توزیع کلید کوانتومی (QKD) برای ارتباطات هوش مصنوعی با امنیت بالا با پروتکل‌های مدیریت کلید کوانتومی ایمن پیاده‌سازی شده‌اند.                                  |  3  | D/V |
| 4.15.3 | اطمینان حاصل کنید که چارچوب‌های تطبیق‌پذیری رمزنگاری امکان مهاجرت سریع به الگوریتم‌های جدید پساکوانتومی را با چرخش خودکار گواهی‌نامه و کلید فراهم می‌کنند.                                   |  3  | D/V |
| 4.15.4 | تأیید کنید که مدل‌سازی تهدید کوانتومی آسیب‌پذیری زیرساخت هوش مصنوعی در برابر حملات کوانتومی را با جدول زمانی مهاجرت مستند و ارزیابی‌های ریسک بررسی می‌کند.                                   |  3  |  V  |
| 4.15.5 | اطمینان حاصل کنید که سیستم‌های رمزنگاری هیبریدی کلاسیک-کوانتومی در طول دوره گذار کوانتومی با نظارت بر عملکرد، حفاظت چندلایه فراهم می‌کنند.                                                   |  3  | D/V |

---

## C4.16 محاسبات محرمانه و انکلاک‌های امن

محافظت از بارهای کاری هوش مصنوعی و وزن‌های مدل با استفاده از محیط‌های اجرای مورد اعتماد مبتنی بر سخت‌افزار و فناوری‌های محاسبات محرمانه.

|   #    | توضیحات                                                                                                                                                            | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 4.16.1 | تأیید کنید که مدل‌های حساس هوش مصنوعی درون مناطق امن Intel SGX، AMD SEV-SNP، یا ARM TrustZone با حافظه رمزنگاری شده و بررسی تصدیق اجرا می‌شوند.                    |  3  | D/V |
| 4.16.2 | تأیید کنید که کانتینرهای محرمانه (Kata Containers، gVisor با محاسبات محرمانه) بارهای کاری هوش مصنوعی را با رمزنگاری حافظه سخت‌افزاری ایزوله می‌کنند.               |  3  | D/V |
| 4.16.3 | اطمینان حاصل کنید که تصدیق از راه دور اعتبار انسجام محصور را قبل از بارگذاری مدل‌های هوش مصنوعی با اثبات رمزنگاری از اصالت محیط اجرا تایید می‌کند.                 |  3  | D/V |
| 4.16.4 | اطمینان حاصل کنید که خدمات استنتاج هوش مصنوعی محرمانه از استخراج مدل از طریق محاسبات رمزگذاری شده با وزن‌های مدل مهر و موم‌شده و اجرای محافظت‌شده جلوگیری می‌کنند. |  3  | D/V |
| 4.16.5 | تأیید کنید که ارکستراسیون محیط اجرای مورد اعتماد (TEE) چرخه عمر ناحیه امن را با تأیید از راه دور و کانال‌های ارتباطی رمزگذاری شده مدیریت می‌کند.                   |  3  | D/V |
| 4.16.6 | اطمینان حاصل کنید که محاسبات چندجانبه امن (SMPC) امکان آموزش مشترک هوش مصنوعی را بدون افشای داده‌های فردی یا پارامترهای مدل فراهم می‌کند.                          |  3  | D/V |

---

## C4.17 زیرساخت دانش صفر

پیاده‌سازی سیستم‌های اثبات دانش صفر برای تأیید و احراز هویت هوش مصنوعی با حفظ حریم خصوصی بدون افشای اطلاعات حساس.

|   #    | توضیحات                                                                                                                                                            | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 4.17.1 | تأیید کنید که اثبات‌های دانش صفر (ZK-SNARKs، ZK-STARKs) صحت مدل هوش مصنوعی و منشأ آموزش را بدون افشای وزن‌های مدل یا داده‌های آموزش تأیید می‌کنند.                 |  3  | D/V |
| 4.17.2 | تأیید کنید که سیستم‌های احراز هویت مبتنی بر ZK امکان تأیید هویت کاربران با حفظ حریم خصوصی برای خدمات هوش مصنوعی را بدون افشای اطلاعات مربوط به هویت فراهم می‌کنند. |  3  | D/V |
| 4.17.3 | تأیید کنید که پروتکل‌های اشتراک‌گذاری مجموعه خصوصی (PSI) امکان تطبیق امن داده‌ها برای هوش مصنوعی فدرال را بدون افشای مجموعه داده‌های فردی فراهم می‌کنند.           |  3  | D/V |
| 4.17.4 | اطمینان حاصل کنید که سیستم‌های یادگیری ماشین صفر-دانش (ZKML) استنباط‌های هوش مصنوعی قابل تأیید را با اثبات رمزنگاری شده از صحت محاسبه امکان‌پذیر می‌سازند.         |  3  | D/V |
| 4.17.5 | تأیید کنید که ZK-rollups پردازش تراکنش‌های AI مقیاس‌پذیر و حفظ‌کننده حریم خصوصی را با تأیید دسته‌ای و کاهش بار محاسباتی فراهم می‌کنند.                             |  3  | D/V |

---

## C4.18 پیشگیری از حملات کانال جانبی

زیرساخت هوش مصنوعی را در برابر حملات کانال جانبی مبتنی بر زمان‌بندی، قدرت، الکترومغناطیسی و حافظه کش که ممکن است اطلاعات حساس را فاش کنند، محافظت کنید.

|   #    | توضیحات                                                                                                                                                               | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.18.1 | تأیید کنید که زمان‌بندی استنتاج هوش مصنوعی با استفاده از الگوریتم‌های زمان ثابت و پرکردن (padding) نرمال شده است تا از حملات استخراج مدل مبتنی بر زمان جلوگیری شود.   |  3  | D/V |
| 4.18.2 | اطمینان حاصل کنید که حفاظت از تحلیل توان شامل تزریق نویز، فیلتر کردن خطوط برق و الگوهای اجرای تصادفی برای سخت‌افزار هوش مصنوعی است.                                   |  3  | D/V |
| 4.18.3 | اطمینان حاصل کنید که کاهش کانال جانبی مبتنی بر حافظه نهان از تقسیم‌بندی حافظه نهان، تصادفی‌سازی و دستورالعمل‌های پاک‌سازی برای جلوگیری از نشت اطلاعات استفاده می‌کند. |  3  | D/V |
| 4.18.4 | اطمینان حاصل کنید که حفاظت در برابر انتشار الکترومغناطیسی شامل محافظت، فیلتر کردن سیگنال و پردازش تصادفی برای جلوگیری از حملات به سبک TEMPEST باشد.                   |  3  | D/V |
| 4.18.5 | تأیید کنید که دفاع‌های جانبی میکرومعماری شامل کنترل‌های اجرای حدسی و مبهم‌سازی الگوهای دسترسی به حافظه است.                                                           |  3  | D/V |

---

## C4.19 امنیت سخت‌افزار تخصصی و نئومورفیک AI

ایمن‌سازی معماری‌های سخت‌افزاری نوظهور هوش مصنوعی شامل تراشه‌های نورومورفی، FPGAها، ASICهای سفارشی و سیستم‌های محاسبات نوری.

|   #    | توضیحات                                                                                                                                                                              | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 4.19.1 | تأیید کنید که امنیت تراشه‌های نوروμορفیک شامل رمزنگاری الگوی پالس‌ها، حفاظت از وزن سیناپسی و اعتبارسنجی قانون یادگیری مبتنی بر سخت‌افزار است.                                        |  3  | D/V |
| 4.19.2 | اطمینان حاصل کنید که شتاب‌دهنده‌های هوش مصنوعی مبتنی بر FPGA، رمزنگاری بیت‌استریم، مکانیزم‌های ضد دستکاری و بارگذاری پیکربندی امن با به‌روزرسانی‌های احراز هویت شده را اجرا می‌کنند. |  3  | D/V |
| 4.19.3 | تأیید کنید که امنیت ASIC سفارشی شامل پردازنده‌های امنیتی درون تراشه، ریشه اعتماد سخت‌افزاری و ذخیره کلید امن با قابلیت تشخیص دستکاری باشد.                                           |  3  | D/V |
| 4.19.4 | تأیید کنید که سیستم‌های محاسبات نوری رمزنگاری نوری ایمن کوانتومی، سوئیچینگ فوتونیک امن، و پردازش سیگنال نوری محافظت‌شده را پیاده‌سازی می‌کنند.                                       |  3  | D/V |
| 4.19.5 | اطمینان حاصل کنید که چیپ‌های هوش مصنوعی هیبریدی آنالوگ-دیجیتال شامل محاسبات آنالوگ ایمن، ذخیره‌سازی وزن محافظت‌شده و تبدیل آنالوگ به دیجیتال احراز هویت‌شده هستند.                   |  3  | D/V |

---

## زیرساخت محاسباتی حفاظت از حریم خصوصی C4.20

پیاده‌سازی کنترل‌های زیرساختی برای محاسبات حفظ حریم خصوصی به منظور محافظت از داده‌های حساس در طول پردازش و تحلیل هوش مصنوعی.

|   #    | توضیحات                                                                                                                                                              | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.20.1 | اطمینان حاصل کنید که زیرساخت رمزنگاری همومورفیک امکان انجام محاسبات رمزنگاری شده بر روی بارهای کاری حساس AI را با تأیید صحت رمزنگاری و نظارت بر عملکرد فراهم می‌کند. |  3  | D/V |
| 4.20.2 | تأیید کنید که سیستم‌های بازیابی اطلاعات خصوصی امکان انجام پرس‌وجوهای پایگاه داده را بدون افشای الگوهای پرس‌وجو با حفاظت رمزنگاری از الگوهای دسترسی فراهم می‌کنند.    |  3  | D/V |
| 4.20.3 | تأیید کنید که پروتکل‌های محاسبات چندجانبه امن امکان استنتاج هوش مصنوعی محافظت‌شده از حریم خصوصی را بدون افشای ورودی‌های فردی یا محاسبات میانی فراهم می‌کنند.         |  3  | D/V |
| 4.20.4 | اطمینان حاصل کنید که مدیریت کلید حفظ حریم خصوصی شامل تولید کلید توزیع‌شده، رمزنگاری آستانه‌ای و چرخش ایمن کلید با حفاظت مبتنی بر سخت‌افزار است.                      |  3  | D/V |
| 4.20.5 | تأیید کنید که عملکرد محاسبات حفظ حریم خصوصی از طریق دسته‌بندی، کشینگ و شتاب‌دهی سخت‌افزاری بهینه شده است در حالی که تضمین‌های امنیت رمزنگاری حفظ می‌شوند.            |  3  | D/V |

---

## امنیت ادغام ابری چارچوب عامل C4.15 و استقرار هیبریدی

کنترل‌های امنیتی برای چارچوب‌های عامل یکپارچه با ابر با معماری‌های هیبریدی محلی/ابر.

|   #    | توضیحات                                                                                                                  | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 4.15.1 | تأیید کنید که یکپارچه‌سازی ذخیره‌سازی ابری از رمزگذاری انتها به انتها با مدیریت کلید کنترل‌شده توسط عامل استفاده می‌کند. |  1  | D/V |
| 4.15.2 | تأیید کنید که مرزهای امنیتی استقرار ترکیبی به وضوح تعریف شده‌اند و کانال‌های ارتباطی رمزنگاری شده هستند.                 |  2  | D/V |
| 4.15.3 | اطمینان حاصل کنید که دسترسی به منابع ابری شامل تأیید هویت صفر–اعتماد با احراز هویت مداوم باشد.                           |  2  | D/V |
| 4.15.4 | اطمینان حاصل کنید که الزامات اقامت داده‌ها توسط گواهی رمزنگاری شده مکان‌های ذخیره‌سازی اعمال می‌شوند.                    |  3  | D/V |
| 4.15.5 | اطمینان حاصل کنید که ارزیابی‌های امنیتی ارائه‌دهنده خدمات ابری شامل مدل‌سازی تهدیدات خاص عامل و ارزیابی ریسک می‌باشند.   |  3  | D/V |

---

## مراجع

* [NIST Cybersecurity Framework 2.0](https://www.nist.gov/cyberframework)
* [CIS Controls v8](https://www.cisecurity.org/controls/v8)
* [OWASP Container Security Verification Standard](https://github.com/OWASP/Container-Security-Verification-Standard)
* [Kubernetes Security Best Practices](https://kubernetes.io/docs/concepts/security/)
* [SLSA Supply Chain Security Framework](https://slsa.dev/)
* [NIST SP 800-190: Application Container Security Guide](https://csrc.nist.gov/publications/detail/sp/800-190/final)
* [Cloud Security Alliance: Cloud Controls Matrix](https://cloudsecurityalliance.org/research/cloud-controls-matrix/)
* [ENISA: Secure Infrastructure Design](https://www.enisa.europa.eu/topics/critical-information-infrastructures-and-services)
* [NIST SP 800-53: Security Controls for Federal Information Systems](https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final)
* [ISO 27001:2022 Information Security Management](https://www.iso.org/standard/27001)
* [NIST AI Risk Management Framework](https://www.nist.gov/itl/ai-risk-management-framework)
* [CIS Kubernetes Benchmark](https://www.cisecurity.org/benchmark/kubernetes)
* [FIPS 140-2 Security Requirements](https://csrc.nist.gov/publications/detail/fips/140/2/final)
* [NIST SP 800-207: Zero Trust Architecture](https://csrc.nist.gov/publications/detail/sp/800-207/final)
* [IEEE 2857: Privacy Engineering for AI Systems](https://standards.ieee.org/ieee/2857/7273/)
* [NIST SP 800-161: Cybersecurity Supply Chain Risk Management](https://csrc.nist.gov/publications/detail/sp/800-161/rev-1/final)
* [NIST Post-Quantum Cryptography Standards](https://csrc.nist.gov/Projects/post-quantum-cryptography)
* [Intel SGX Developer Guide](https://www.intel.com/content/www/us/en/developer/tools/software-guard-extensions/overview.html)
* [AMD SEV-SNP White Paper](https://www.amd.com/system/files/TechDocs/SEV-SNP-strengthening-vm-isolation-with-integrity-protection-and-more.pdf)
* [ARM TrustZone Technology](https://developer.arm.com/ip-products/security-ip/trustzone)
* [ZK-SNARKs: A Gentle Introduction](https://blog.ethereum.org/2016/12/05/zksnarks-in-a-nutshell/)
* [NIST SP 800-57: Cryptographic Key Management](https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final)
* [Side-Channel Attack Countermeasures](https://link.springer.com/book/10.1007/978-3-319-75268-6)
* [Neuromorphic Computing Security Challenges](https://ieeexplore.ieee.org/document/9458103)
* [FPGA Security: Fundamentals, Evaluation, and Countermeasures](https://link.springer.com/book/10.1007/978-3-319-90385-9)
* [Microsoft SEAL: Homomorphic Encryption Library](https://github.com/Microsoft/SEAL)
* [HElib: Homomorphic Encryption Library](https://github.com/homenc/HElib)
* [PALISADE Lattice Cryptography Library](https://palisade-crypto.org/)
* [Differential Privacy: A Survey of Results](https://link.springer.com/chapter/10.1007/978-3-540-79228-4_1)
* [Secure Aggregation for Federated Learning](https://eprint.iacr.org/2017/281.pdf)
* [Private Information Retrieval: Concepts and Constructions](https://link.springer.com/book/10.1007/978-3-030-16234-8)


# امنیت زیرساخت، پیکربندی و استقرار C4

## هدف کنترل

زیرساخت هوش مصنوعی باید از طریق پیکربندی امن، جداسازی در زمان اجرا، خطوط اجرای معتبر و مورد اعتماد و نظارت جامع، در برابر افزایش سطح دسترسی، دستکاری زنجیره تأمین و حرکت جانبی مقاوم شود. تنها اجزای زیرساختی تأیید شده و مجاز از طریق فرآیندهای کنترل‌شده که امنیت، یکپارچگی و قابلیت حسابرسی را تضمین می‌کنند، به محیط تولید می‌رسند.

---

## C4.1 جداسازی محیط اجرای زمان اجرا

جلوگیری از فرار از کانتینر و افزایش امتیازات از طریق اصول جداسازی در سطح سیستم‌عامل.

|   #   | توضیحات                                                                                                                                                                                                    | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.1.1 | اطمینان حاصل کنید که تمامی بارهای کاری هوش مصنوعی با حداقل مجوزهای لازم روی سیستم عامل اجرا می‌شوند، به عنوان مثال با حذف قابلیت‌های اضافی لینوکس در صورت استفاده از کانتینر.                              |  1  | D/V |
| 4.1.2 | اطمینان حاصل کنید که بارهای کاری توسط فناوری‌هایی که بهره‌برداری را محدود می‌کنند مانند سندباکسینگ، پروفایل‌های seccomp، AppArmor، SELinux یا مشابه آنها محافظت شده‌اند و پیکربندی به‌درستی انجام شده است. |  1  | D/V |
| 4.1.3 | اطمینان حاصل کنید که بارهای کاری با یک سیستم فایل ریشه فقط خواندنی اجرا می‌شوند و هرگونه نصب نوشتنی به‌طور صریح تعریف شده و با گزینه‌های محدودکننده (مانند noexec، nosuid، nodev) سخت‌سازی شده باشد.       |  2  | D/V |
| 4.1.4 | تأیید کنید که نظارت زمان اجرا رفتارهای افزایش امتیاز و فرار از کانتینر را تشخیص داده و به طور خودکار فرایندهای متخلف را خاتمه می‌دهد.                                                                      |  2  | D/V |
| 4.1.5 | اطمینان حاصل کنید که بارهای کاری هوش مصنوعی با ریسک بالا فقط پس از تأیید از راه دور موفق، در محیط‌های ایزوله از نظر سخت‌افزاری (مانند TEEs، هایپروایزرهای مورد اعتماد یا گره‌های بدون واسطه) اجرا می‌شوند. |  3  | D/V |

---

## C4.2 خطوط لوله ساخت و استقرار امن

از طریق ساخت‌های قابل تولید مجدد و آثار امضا شده، یکپارچگی رمزنگاری و امنیت زنجیره تأمین را تضمین کنید.

|   #   | توضیحات                                                                                                                                                              | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.2.1 | اطمینان حاصل کنید که ساخت‌ها قابل بازتولید باشند و متادیتای اثبات منشأ امضا شده را به صورت مناسب برای مصنوعات ساخت تولید کنند که بتوان آن را به طور مستقل تأیید کرد. |  1  | D/V |
| 4.2.2 | اطمینان حاصل کنید که فرایندهای ساخت نرم‌افزار، فهرست مواد نرم‌افزاری (SBOM) تولید کرده و قبل از پذیرش برای استقرار، امضا شده باشند.                                  |  2  | D/V |
| 4.2.3 | اطمینان حاصل کنید که امضاها و فراداده‌های منشأ آثار ساختمانی (مانند تصاویر کانتینر) هنگام استقرار تأیید می‌شوند و آثار غیرقابل تأیید رد می‌شوند.                     |  2  | D/V |

---

## C4.3 امنیت شبکه و کنترل دسترسی

شبکه‌سازی صفر اعتمادی را با سیاست‌های پیش‌فرض نفی و ارتباطات رمزگذاری‌شده پیاده‌سازی کنید.

|   #   | توضیحات                                                                                                                                                                                                                              | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 4.3.1 | بررسی کنید که سیاست‌های شبکه به صورت پیش‌فرض اجازه ورود و خروج را ندهند و تنها خدمات مورد نیاز به طور صریح مجاز باشند.                                                                                                               |  1  | D/V |
| 4.3.2 | اطمینان حاصل کنید که پروتکل‌های دسترسی مدیریتی (مانند SSH، RDP) و دسترسی به خدمات متادیتای ابری محدود شده و نیازمند احراز هویت قوی هستند.                                                                                            |  1  | D/V |
| 4.3.3 | تأیید کنید که ترافیک خروجی محدود به مقاصد تأیید شده باشد و همه درخواست‌ها ثبت شوند.                                                                                                                                                  |  2  | D/V |
| 4.3.4 | اطمینان حاصل کنید که ارتباط بین سرویس‌ها از TLS متقابل با اعتبارسنجی گواهی و چرخش خودکار منظم استفاده می‌کند.                                                                                                                        |  2  | D/V |
| 4.3.5 | اطمینان حاصل کنید که بارهای کاری هوش مصنوعی و محیط‌ها (توسعه، تست، تولید) در بخش‌های شبکه جداگانه (VPCs/VNets) اجرا می‌شوند که دسترسی مستقیم به اینترنت ندارند و نقش‌های IAM، گروه‌های امنیتی یا ارتباطات متقابل محیطی مشترک ندارند. |  2  | D/V |

## C4.4 مدیریت اسرار و کلیدهای رمزنگاری

محافظت از اسرار و کلیدهای رمزنگاری شده با ذخیره‌سازی امن، چرخش خودکار و کنترل‌های دسترسی قوی.

|   #   | توضیحات                                                                                                                                                                                                      | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 4.4.1 | اطمینان حاصل کنید که اسرار در یک سیستم مدیریت اسرار اختصاصی با رمزنگاری در حالت استراحت و جدا از بار کاری برنامه ذخیره می‌شوند.                                                                              |  1  | D/V |
| 4.4.2 | اطمینان حاصل کنید که کلیدهای رمزنگاری در ماژول‌های پشتیبانی شده توسط سخت‌افزار (مانند HSMها، سیستم مدیریت کلید ابری) تولید و ذخیره می‌شوند.                                                                  |  1  | D/V |
| 4.4.3 | اطمینان حاصل کنید که دسترسی به اسرار محیط تولید نیازمند احراز هویت قوی است.                                                                                                                                  |  1  | D/V |
| 4.4.4 | تأیید کنید که اسرار در زمان اجرای برنامه‌ها از طریق یک سیستم مدیریت اسرار اختصاصی مستقر می‌شوند. اسرار هرگز نباید در کد منبع، فایل‌های پیکربندی، مصنوعات ساخت، تصاویر کانتینر یا متغیرهای محیطی جاسازی شوند. |  1  | D/V |
| 4.4.5 | تأیید کنید که گردش اسرار به‌صورت خودکار انجام می‌شود.                                                                                                                                                        |  2  | D/V |

---

## C4.5 ایزوله‌سازی و اعتبارسنجی بار کاری هوش مصنوعی

مدل‌های هوش مصنوعی غیرقابل اعتماد را در محیط‌های مجازی ایزوله شده و محافظت شده قرار دهید و بارهای کاری حساس هوش مصنوعی را با استفاده از محیط‌های اجرای مورد اعتماد (TEEs) و فناوری‌های محاسبات محرمانه محافظت کنید.

|   #   | توضیحات                                                                                                                                                   | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.5.1 | تأیید کنید که مدل‌های هوش مصنوعی خارجی یا غیرقابل اعتماد در محیط‌های ایزوله شده و محصور اجرا می‌شوند.                                                     |  1  | D/V |
| 4.5.2 | اطمینان حاصل کنید که بارهای کاری در محیط ایزوله به طور پیش‌فرض هیچ اتصال شبکه خروجی ندارند و هر دسترسی مورد نیاز به طور صریح تعریف شده باشد.              |  1  | D/V |
| 4.5.3 | تأیید کنید که گواهی‌نامه بار کاری قبل از بارگذاری مدل یا بار کاری انجام می‌شود و اثبات رمزنگاری شده‌ای از محیط اجرای مورداعتماد فراهم می‌کند.             |  2  | D/V |
| 4.5.4 | تأیید کنید که بارهای کاری محرمانه در محیط اجرای مورد اعتماد (TEE) اجرا می‌شوند که جداسازی سخت‌افزاری، رمزگذاری حافظه و حفاظت از یکپارچگی را فراهم می‌کند. |  3  | D/V |
| 4.5.5 | تأیید کنید که خدمات استنتاج محرمانه از استخراج مدل از طریق محاسبات رمزنگاری‌شده با وزن‌های مدل مهروموم‌شده و اجرای محافظت‌شده جلوگیری می‌کنند.            |  3  | D/V |
| 4.5.6 | تأیید کنید که ارکستراسیون محیط‌های اجرای مورد اعتماد شامل مدیریت چرخه عمر، تصدیق از راه دور و کانال‌های ارتباطی رمزگذاری شده است.                         |  3  | D/V |
| 4.5.7 | تأیید کنید که محاسبات چندجانبه امن (SMPC) امکان آموزش همکاری هوش مصنوعی را بدون افشای داده‌های فردی یا پارامترهای مدل فراهم می‌کند.                       |  3  | D/V |

---

## C4.6 مدیریت منابع زیرساخت هوش مصنوعی، پشتیبان‌گیری و بازیابی

جلوگیری از حملات تخلیه منابع و اطمینان از تخصیص عادلانه منابع از طریق سهمیه‌ها و نظارت. حفظ تاب‌آوری زیرساخت از طریق پشتیبان‌گیری‌های امن، روش‌های بازیابی آزمایش‌شده و قابلیت‌های بازیابی در برابر بلایا.

|   #   | توضیحات                                                                                                                                                                                                                                                                   | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.6.1 | اطمینان حاصل کنید که مصرف منابع بار کاری به طور مناسب با استفاده از منابعی مانند Kubernetes ResourceQuotas یا مشابه آن محدود شده است تا از حملات انکار سرویس جلوگیری شود.                                                                                                 |  2  | D/V |
| 4.6.2 | اطمینان حاصل کنید که فرسودگی منابع پس از تجاوز از آستانه‌های تعریف‌شده پردازنده، حافظه یا درخواست، حفاظ‌های خودکار (مانند محدودیت نرخ یا جداسازی بار کاری) را فعال می‌کند.                                                                                                |  2  | D/V |
| 4.6.3 | اطمینان حاصل کنید که سیستم‌های پشتیبان‌گیری در شبکه‌های ایزوله با اعتبارنامه‌های جداگانه اجرا می‌شوند و سیستم ذخیره‌سازی یا در یک شبکه ایزوله از نظر فیزیکی (air-gapped) اجرا می‌شود یا حفاظت WORM (نوشتن-یک بار، خواندن-بارها) را در برابر تغییرات غیرمجاز اعمال می‌کند. |  2  | D/V |

---

## امنیت سخت‌افزاری هوش مصنوعی C4.7

کامپوننت‌های سخت‌افزاری خاص هوش مصنوعی از جمله GPUها، TPUها و شتاب‌دهنده‌های تخصصی هوش مصنوعی را امن کنید.

|   #   | توضیحات                                                                                                                                                                                         | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.7.1 | اطمینان حاصل کنید که قبل از اجرای بار کاری، یکپارچگی تسریع‌کننده هوش مصنوعی با استفاده از مکانیزم‌های تأیید مبتنی بر سخت‌افزار (مانند TPM، DRTM، یا معادل آن) اعتبارسنجی می‌شود.                |  2  | D/V |
| 4.7.2 | اطمینان حاصل کنید که حافظه شتاب‌دهنده (GPU) بین بارهای کاری از طریق مکانیزم‌های تقسیم‌بندی جدا شده باشد و حافظه بین هر وظیفه با روش‌های پاک‌سازی حافظه ایزوله شده باشد.                         |  2  | D/V |
| 4.7.3 | اطمینان حاصل کنید که ماژول‌های امنیتی سخت‌افزاری (HSM) وزن‌های مدل هوش مصنوعی و کلیدهای رمزنگاری را با گواهی FIPS 140-3 سطح ۳ یا Common Criteria EAL4+ محافظت می‌کنند.                          |  3  | D/V |
| 4.7.4 | تأیید کنید که فریم‌ورک شتاب‌دهنده‌ها (GPU/TPU/NPUs) نسخه‌ثابت، امضا شده و در زمان بوت تأیید شده باشد؛ فریم‌ورک‌های بدون امضا یا نسخه‌های اشکال‌زدایی شده مسدود شوند.                            |  2  | D/V |
| 4.7.5 | اطمینان حاصل کنید که VRAM و حافظه درون‌بسته بین وظایف/مستأجرها صفر شده‌اند و سیاست‌های بازنشانی دستگاه از باقی‌ماندن داده‌های متقاطع بین مستأجرها جلوگیری می‌کنند.                              |  2  | D/V |
| 4.7.6 | تأیید کنید که ویژگی‌های بخش‌بندی/جداسازی (به عنوان مثال، بخش‌بندی MIG/VM) به‌ازای هر مستأجر اعمال شده و دسترسی حافظه نظیر به نظیر بین بخش‌ها را جلوگیری می‌کنند.                                |  2  | D/V |
| 4.7.7 | تأیید کنید که اتصال‌های شتاب‌دهنده (NVLink/PCIe/InfiniBand/RDMA/NCCL) محدود به توپولوژی‌های تأیید شده و نقاط انتهایی احراز هویت شده باشند؛ لینک‌های متنی ساده میان مستاجرهای مختلف مجاز نیستند. |  3  | D/V |
| 4.7.8 | بررسی کنید که تله‌متری تسریع‌کننده (توان، دماها، ECC، شمارنده‌های عملکرد) به SIEM/OTel صادر شده و بر روی ناهنجاری‌هایی که نشان‌دهنده کانال‌های جانبی یا کانال‌های مخفی هستند، هشدار داده شود.   |  3  |  D  |

---

## امنیت هوش مصنوعی لبه‌ای و توزیع‌شده C4.8

استقرارهای ایمن هوش مصنوعی توزیع شده شامل محاسبات لبه، یادگیری فدرال و معماری‌های چندمکانی.

|   #   | توضیحات                                                                                                                                                                                                                                                                                                       | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.8.1 | اطمینان حاصل کنید که دستگاه‌های هوش مصنوعی لبه‌ای با استفاده از TLS متقابل به زیرساخت مرکزی احراز هویت می‌کنند.                                                                                                                                                                                               |  2  | D/V |
| 4.8.2 | تأیید کنید که دستگاه‌های لبه‌ای بوت امن با امضاهای تایید شده و حفاظت در برابر بازگشت نسخه را برای جلوگیری از حملات کاهش نسخه فرم‌ویر اجرا می‌کنند.                                                                                                                                                            |  2  | D/V |
| 4.8.3 | تأیید کنید که هماهنگی هوش مصنوعی توزیع‌شده از مکانیزم‌های اجماع تحمل خطای بیزانس با اعتبارسنجی شرکت‌کنندگان و کشف گره‌های مخرب استفاده می‌کند.                                                                                                                                                                |  3  | D/V |
| 4.8.4 | تأیید کنید که ارتباط لبه تا ابر از محدودیت پهنای باند، فشرده‌سازی داده‌ها و عملیات ایمن آفلاین با ذخیره‌سازی محلی رمزگذاری‌شده پشتیبانی می‌کند.                                                                                                                                                               |  3  | D/V |
| 4.8.5 | تأیید کنید که برنامه‌های استنتاج موبایل یا لبه، حفاظت‌های ضد دستکاری در سطح پلتفرم را پیاده‌سازی کرده‌اند (برای مثال، امضای کد، بوت بررسی شده، بررسی‌های صحت خودکار در زمان اجرا) که فایل‌های دودویی تغییر یافته، برنامه‌های بسته‌بندی شده مجدد یا چارچوب‌های ابزارگذاری متصل شده را شناسایی و مسدود می‌کنند. |  3  | D/V |
| 4.8.6 | اطمینان حاصل کنید که مدل‌هایی که برای دستگاه‌های لبه یا موبایل مستقر می‌شوند، در طول بسته‌بندی به صورت رمزنگاری شده امضا شده‌اند و زمان اجرای روی دستگاه این امضاها یا چکسام‌ها را قبل از بارگذاری یا استنتاج اعتبارسنجی می‌کند؛ مدل‌های تاییدنشده یا تغییر یافته باید رد شوند.                               |  3  | D/V |
| 4.8.7 | تأیید کنید که زمان‌های اجرای استنتاج درون دستگاهی جداسازی فرآیند، حافظه و دسترسی به فایل‌ها را برای جلوگیری از استخراج مدل، اشکال‌زدایی یا استخراج جاسازی‌ها و فعال‌سازی‌های میانی اعمال می‌کنند.                                                                                                             |  3  | D/V |
| 4.8.8 | اطمینان حاصل کنید که وزن‌های مدل و پارامترهای حساس که به صورت محلی ذخیره شده‌اند، با استفاده از کلیدهای پشتیبانی‌شده توسط سخت‌افزار یا محیط‌های امن (مانند Android Keystore، iOS Secure Enclave، TPM/TEE) رمزگذاری شده‌اند، به‌طوری که کلیدها برای فضای کاربری غیرقابل دسترس باشند.                           |  3  | D/V |
| 4.8.9 | اطمینان حاصل کنید که مدل‌های بسته‌بندی شده در برنامه‌های موبایل، اینترنت اشیاء، یا برنامه‌های تعبیه‌شده در حالت استراحت رمزگذاری یا مبهم‌سازی شده‌اند و فقط داخل محیط اجرایی مورد اعتماد یا محفظه امنیتی رمزگشایی می‌شوند، به طوری که استخراج مستقیم از بسته برنامه یا سیستم فایل جلوگیری شود.                |  3  | D/V |

---

## مراجع

* [NIST Cybersecurity Framework 2.0](https://www.nist.gov/cyberframework)
* [CIS Controls v8](https://www.cisecurity.org/controls/v8)
* [Kubernetes Security Best Practices](https://kubernetes.io/docs/concepts/security/)
* [Cloud Security Alliance: Cloud Controls Matrix](https://cloudsecurityalliance.org/research/cloud-controls-matrix/)
* [ENISA: Secure Infrastructure Design](https://www.enisa.europa.eu/topics/critical-information-infrastructures-and-services)
* [NIST AI Risk Management Framework](https://www.nist.gov/itl/ai-risk-management-framework)


# رفتار مدل C7، کنترل خروجی و تضمین ایمنی

## هدف کنترل

خروجی‌های مدل باید ساختارمند، قابل اعتماد، ایمن، قابل توضیح و به طور مداوم در محیط تولید پایش شوند. این کار باعث کاهش توهم‌ها، نشت‌های حریم خصوصی، محتوای مضر و رفتارهای خارج از کنترل می‌شود، در عین حال اعتماد کاربران و رعایت الزامات قانونی را نیز افزایش می‌دهد.

---

## C7.1 اجرای فرمت خروجی

اسکیماهای سختگیرانه، دیکودینگ محدود، و اعتبارسنجی پایین‌دستی محتواهای نامعتبر یا مخرب را پیش از گسترش آن‌ها متوقف می‌کنند.

|   #   | شرح                                                                                                                                                                       | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 7.1.1 | تأیید کنید که الگوهای پاسخ (به‌عنوان مثال JSON Schema) در پرامپت سیستمی ارائه می‌شوند و هر خروجی به‌طور خودکار اعتبارسنجی می‌شود؛ خروجی‌های ناسازگار تعمیر یا رد می‌شوند. |  1  | D/V |
| 7.1.2 | اطمینان حاصل کنید که رمزگشایی محدود (توکن‌های توقف، regex، max-tokens) فعال است تا از سرریز یا کانال‌های جانبی تزریق پرامپت جلوگیری شود.                                  |  1  | D/V |
| 7.1.3 | تأیید کنید که اجزای پایین‌دست خروجی‌ها را نامعتبر تلقی کرده و آنها را در برابر اسکیماها اعتبارسنجی نمایند یا از دیسریالایزرهای امن برای جلوگیری از تزریق استفاده کنند.    |  2  | D/V |
| 7.1.4 | تأیید کنید که رویدادهای خروجی نامناسب ثبت می‌شوند، دارای محدودیت نرخ هستند و به سامانهٔ مانیتورینگ نمایش داده می‌شوند.                                                    |  3  |  V  |

---

## C7.2 تشخیص و کاهش توهم

برآورد عدم قطعیت و استراتژی‌های جایگزین از پاسخ‌های ساختگی جلوگیری می‌کنند.

|   #   | شرح                                                                                                                                                                         | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 7.2.1 | بررسی کنید که احتمال‌های لگاریتمی در سطح توکن، هم‌سازگاری مجموعه، یا تشخیص‌دهنده‌های توهم‌زایی با تنظیم دقیق، برای هر پاسخ نمره اعتماد اختصاص دهند.                         |  1  | D/V |
| 7.2.2 | تأیید کنید که پاسخ‌هایی که زیر آستانه اعتماد قابل پیکربندی قرار دارند، جریان‌های جایگزین (مثلاً تولید تقویت‌شده با بازیابی، مدل ثانویه، یا بازبینی انسانی) را فعال می‌کنند۔ |  1  | D/V |
| 7.2.3 | اطمینان حاصل کنید که موارد توهم با متادادهٔ علت ریشه برچسب‌گذاری شده‌اند و به زنجیره‌های پردازشی پس از حادثه و فاین‌تیونینگ تغذیه می‌شوند.                                  |  2  | D/V |
| 7.2.4 | تأیید کنید که آستانه‌ها و تشخیصگرها پس از به‌روزرسانی‌های عمده مدل یا پایگاه دانش دوباره کالیبره می‌شوند.                                                                   |  3  | D/V |
| 7.2.5 | بررسی کنید که نمایش‌های داشبورد نرخ‌های توهم را رصد می‌کنند.                                                                                                                |  3  |  V  |

---

## C7.3 فیلتر ایمنی خروجی و حریم خصوصی

فیلترهای سیاستی و پوشش تیم قرمز از کاربران و داده‌های محرمانه محافظت می‌کنند.

|   #   | شرح                                                                                                                                                                     | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 7.3.1 | تأیید کنید که طبقه‌بندهای قبل از تولید و پس از تولید، محتوای نفرت‌انگیز، آزار و اذیت، خودآزاری، مطالب افراط‌گرایانه و محتوای جنسی صریح را مطابق با سیاست مسدود می‌کنند. |  1  | D/V |
| 7.3.2 | تأیید کنید که تشخیص PII/PCI و پنهان‌سازی خودکار در هر پاسخ اجرا می‌شود؛ هر نقض منجر به بروز رویداد حریم خصوصی می‌شود.                                                   |  1  | D/V |
| 7.3.3 | اطمینان حاصل کنید که برچسب‌های محرمانگی (مثلاً رازهای بازرگانی) در قالب‌های مختلف گسترش می‌یابند تا از نشت در متن، تصاویر یا کد جلوگیری شود.                            |  2  |  D  |
| 7.3.4 | تأیید کنید که تلاش‌های عبور از فیلتر یا طبقه‌بندی‌های پرخطر نیاز به تأیید ثانویه یا احراز هویت مجدد کاربر دارند.                                                        |  3  | D/V |
| 7.3.5 | اطمینان حاصل کنید که آستانه‌های فیلترینگ با حوزه‌های قضایی و زمینه‌ی سنی/نقش کاربر مطابقت دارند.                                                                        |  3  | D/V |

---

## C7.4 محدودیت خروجی و اقدام

محدودیت‌های نرخ-گذاری و دروازه‌های تأیید از سوءاستفاده و استقلال بیش از حد جلوگیری می‌کنند.

|   #   | شرح                                                                                                                                                                  | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 7.4.1 | بررسی کنید که برای هر کاربر و هر کلید API، سهمیه‌هایی وجود دارند که درخواست‌ها، توکن‌ها و هزینه را محدود می‌کنند، با تاخیر افزایشی نمایی در خطاهای 429.              |  1  |  D  |
| 7.4.2 | تأیید کنید که اقدامات دارای امتیاز ویژه (نوشتن فایل‌ها، اجرای کد، فراخوانی‌های شبکه) نیازمند تأیید مبتنی بر سیاست یا حضور انسان در حلقه تصمیم‌گیری است.              |  1  | D/V |
| 7.4.3 | تأیید کنید که بررسی‌های سازگاری بین‌مدالی اطمینان می‌دهند تصاویر، کد و متنی که برای همان درخواست تولید شده‌اند، نمی‌توانند برای پنهان‌کردن محتوای مخرب استفاده شوند. |  2  | D/V |
| 7.4.4 | بررسی کنید که عمق واگذاری عامل، محدودیت‌های بازگشتی و فهرست ابزارهای مجاز به‌طور صریح پیکربندی شده‌اند.                                                              |  2  |  D  |
| 7.4.5 | اطمینان حاصل کنید که نقض محدودیت‌ها منجر به ایجاد رویدادهای امنیتی ساختارمند برای ورود به SIEM می‌شود.                                                               |  3  |  V  |

---

## C7.5 توضیح‌پذیری خروجی

سیگنال‌های شفاف اعتماد کاربران را افزایش می‌دهند و عیب‌یابی داخلی را بهبود می‌بخشند.

|   #   | شرح                                                                                                                                         | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 7.5.1 | تایید کنید که نمره‌های اعتماد نمایش داده‌شده به کاربر یا خلاصه‌های استدلال کوتاه، در صورت مناسب بودن ارزیابی ریسک، به کاربر نشان داده شوند. |  2  | D/V |
| 7.5.2 | تأیید کنید که توضیحات تولیدشده از افشای دستورات سیستمی حساس یا داده‌های دارای حق مالکیت جلوگیری می‌کنند.                                    |  2  | D/V |
| 7.5.3 | بررسی کنید که سیستم، احتمالات لگاریتمی سطح توکن یا نقشه‌های توجه را ضبط می‌کند و آنها را برای بازرسی مجاز ذخیره می‌کند.                     |  3  |  D  |
| 7.5.4 | تأیید کنید که اقلام توضیح‌پذیری در کنار انتشار مدل‌ها دارای کنترل نسخه باشند تا قابلیت بازرسی فراهم شود.                                    |  3  |  V  |

---

## C7.6 یکپارچه‌سازی مانیتورینگ

مشاهده‌پذیری در زمان واقعی حلقه بین توسعه و تولید را می‌بندد.

|   #   | شرح                                                                                                                                                        | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 7.6.1 | اطمینان حاصل کنید که معیارها (نقض‌های طرح‌واره، نرخ توهم، سمیت، افشای داده‌های شخصی قابل شناسایی (PII)، تاخیر، هزینه) به پلتفرم نظارت مرکزی منتقل می‌شوند. |  1  |  D  |
| 7.6.2 | تأیید کنید که آستانه‌های هشدار برای هر معیار ایمنی تعیین شده‌اند، به همراه مسیرهای ارجاع در حالت آماده به کار.                                             |  1  |  V  |
| 7.6.3 | بررسی کنید که داشبوردها با ناهنجاری‌های خروجی همبستگی دارند با مدل/نسخه، پرچم ویژگی و تغییرات داده‌های بالادستی.                                           |  2  |  V  |
| 7.6.4 | اطمینان حاصل کنید که داده‌های پایش به بازآموزی، تنظیم دقیق یا به‌روزرسانی قواعد در یک گردش کار MLOps مستند منجر می‌شوند.                                   |  2  | D/V |
| 7.6.5 | تأیید کنید که خطوط پایش تحت آزمایش نفوذ قرار گرفته و دارای کنترل دسترسی هستند تا از نشت لاگ‌های حساس جلوگیری شود.                                          |  3  |  V  |

---

## 7.7 حفاظت‌های رسانه‌های مولد

اطمینان حاصل کنید که سیستم‌های هوش مصنوعی محتوای رسانه‌ای غیرقانونی، مضر یا غیرمجاز تولید نکنند با اعمال محدودیت‌های سیاستی، اعتبارسنجی خروجی و قابلیت ردیابی.

|   #   | شرح                                                                                                                                                                                                             | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 7.7.1 | اطمینان حاصل کنید که پرومپت‌های سیستمی و دستورالعمل‌های کاربری صریحاً منع تولید محتوای دی‌فیک غیرقانونی، مضر یا بدون رضایت را می‌کنند (مثلاً تصویر، ویدیو یا صدا).                                              |  1  | D/V |
| 7.7.2 | بررسی کنید که درخواست‌ها برای تلاش‌هایی جهت تولید جعل هویت، دی‌فیک‌های جنسی صریح، یا محتوایی که افراد واقعی را بدون رضایت آنها به تصویر می‌کشد، فیلتر می‌شوند.                                                  |  2  | D/V |
| 7.7.3 | اطمینان حاصل کنید که سیستم از هش ادراکی، تشخیص واترمارک یا اثر انگشت دیجیتال برای جلوگیری از بازتولید غیرمجاز محتوای دارای حق نشر استفاده می‌کند.                                                               |  2  |  V  |
| 7.7.4 | اطمینان حاصل کنید که تمام رسانه‌های تولیدشده دارای امضای رمزنگاری‌شده هستند، یا واترمارک شده‌اند، یا با فراداده‌های منبع مقاوم در برابر دستکاری جاسازی شده‌اند تا برای ردیابی در مراحل بعدی قابل استفاده باشند. |  3  | D/V |
| 7.7.5 | اطمینان حاصل کنید که تلاش‌های عبور (مثلاً پنهان‌سازی پرامپت، زبان عامیانه، عبارات تهاجمی) شناسایی شده، ثبت می‌شوند و محدودیت نرخ برای آنها اعمال می‌شود؛ سوءاستفادهٔ مکرر به سامانه‌های نظارتی گزارش می‌شود.    |  3  |  V  |

## منابع

* [NIST AI Risk Management Framework](https://www.nist.gov/itl/ai-risk-management-framework)
* [ISO/IEC 42001:2023 – AI Management System](https://www.iso.org/obp/ui/en/)
* [OWASP Top-10 for Large Language Model Applications (2025)](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Improper Output Handling – OWASP LLM05:2025](https://genai.owasp.org/llmrisk/llm052025-improper-output-handling/)
* [Practical Techniques to Constrain LLM Output](https://mychen76.medium.com/practical-techniques-to-constraint-llm-output-in-json-format-e3e72396c670)
* [Dataiku – Structured Text Generation Guide](https://blog.dataiku.com/your-guide-to-structured-text-generation)
* [VL-Uncertainty: Detecting Hallucinations](https://arxiv.org/abs/2411.11919)
* [HaDeMiF: Hallucination Detection & Mitigation](https://openreview.net/forum?id=VwOYxPScxB)
* [Building Confidence in LLM Outputs](https://www.alkymi.io/data-science-room/building-confidence-in-llm-outputs)
* [Explainable AI & LLMs](https://duncsand.medium.com/explainable-ai-140912d31b3b)
* [LLM Red-Teaming Guide](https://www.confident-ai.com/blog/red-teaming-llms-a-step-by-step-guide)
* [Sensitive Information Disclosure in LLMs](https://virtualcyberlabs.com/llm-sensitive-information-disclosure/)
* [LangChain – Chat Model Rate Limiting](https://python.langchain.com/docs/how_to/chat_model_rate_limiting/)
* [OpenAI Rate-Limit & Exponential Back-off](https://hackernoon.com/openais-rate-limit-a-guide-to-exponential-backoff-for-llm-evaluation)
* [Arize AI – LLM Observability Platform](https://arize.com/)


# C12 نظارت، ثبت لاگ و تشخیص ناهنجاری

## هدف کنترل

این بخش الزامات ارائه دیدگاه بلادرنگ و قانونی درباره اینکه مدل و سایر اجزای هوش مصنوعی چه می‌بینند، انجام می‌دهند و برمی‌گردانند را فراهم می‌کند تا تهدیدها شناسایی، اولویت‌بندی و از آنها درس گرفته شود.

## C12.1 ثبت درخواست و پاسخ

|   #    | توضیحات                                                                                                                                                                                      | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | اطمینان حاصل کنید که همه درخواست‌های کاربر و پاسخ‌های مدل با متادیتای مناسب (مانند زمان ثبت، شناسه کاربر، شناسه جلسه، نسخه مدل) ثبت می‌شوند.                                                 |  1  | D/V |
| 12.1.2 | اطمینان حاصل کنید که لاگ‌ها در مخازن امن و با کنترل دسترسی ذخیره شده‌اند که دارای سیاست‌های نگهداری مناسب و روش‌های پشتیبان‌گیری باشند.                                                      |  1  | D/V |
| 12.1.3 | اطمینان حاصل کنید که سیستم‌های ذخیره‌سازی لاگ، رمزگذاری هنگام ذخیره (at rest) و در انتقال (in transit) را برای محافظت از اطلاعات حساس موجود در لاگ‌ها پیاده‌سازی می‌کنند.                    |  1  | D/V |
| 12.1.4 | اطمینان حاصل کنید که داده‌های حساس در پرامپت‌ها و خروجی‌ها به‌طور خودکار قبل از ثبت، حذف یا ماسک می‌شوند، با قوانین حذف قابل تنظیم برای اطلاعات شناسایی شخصی (PII)، مدارک و اطلاعات اختصاصی. |  1  | D/V |
| 12.1.5 | اطمینان حاصل کنید که تصمیمات سیاستی و اقدامات فیلترینگ ایمنی با جزئیات کافی ثبت می‌شوند تا امکان حسابرسی و اشکال‌زدایی سیستم‌های مدیریت محتوا فراهم گردد.                                    |  2  | D/V |
| 12.1.6 | بررسی کنید که یکپارچگی لاگ‌ها از طریق مثلاً امضاهای رمزنگاری‌شده یا ذخیره‌سازی فقط‌نوشتنی محافظت می‌شود.                                                                                     |  2  | D/V |

---

## C12.2 شناسایی سوءاستفاده و هشداردهی

|   #    | توضیحات                                                                                                                                                                                                                                   | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | تأیید کنید که سیستم با استفاده از تشخیص مبتنی بر امضا، الگوهای شناخته شده فرار از سیستم (jailbreak)، تلاش‌های تزریق دستورات (prompt injection) و ورودی‌های خصمانه را شناسایی و هشدار می‌دهد.                                              |  1  | D/V |
| 12.2.2 | اطمینان حاصل کنید که سیستم با استفاده از قالب‌ها و پروتکل‌های استاندارد لاگ، با پلتفرم‌های مدیریت اطلاعات امنیتی و رویدادها (SIEM) موجود، یکپارچه می‌شود.                                                                                 |  1  | D/V |
| 12.2.3 | بررسی کنید که رویدادهای امنیتی غنی‌شده شامل زمینه‌های خاص هوش مصنوعی مانند شناسه‌های مدل، امتیازهای اطمینان و تصمیمات فیلتر ایمنی باشند.                                                                                                  |  2  | D/V |
| 12.2.4 | اطمینان حاصل کنید که تشخیص ناهنجاری رفتاری الگوهای غیرمعمول گفتگو، تلاش‌های مکرر بیش از حد، یا رفتارهای بررسی سیستماتیک را شناسایی می‌کند.                                                                                                |  2  | D/V |
| 12.2.5 | اطمینان حاصل کنید که مکانیزم‌های هشداردهی در زمان واقعی، تیم‌های امنیتی را هنگام شناسایی تخلفات احتمالی سیاست یا تلاش‌های حمله، اطلاع‌رسانی می‌کنند.                                                                                      |  2  | D/V |
| 12.2.6 | اطمینان حاصل کنید که قوانین سفارشی برای شناسایی الگوهای تهدید خاص هوش مصنوعی از جمله تلاش‌های هماهنگ برای فرار از محدودیت‌ها (jailbreak)، کمپین‌های تزریق دستورات (prompt injection) و حملات استخراج مدل (model extraction) شامل شده‌اند. |  2  | D/V |
| 12.2.7 | تأیید کنید که گردش کارهای پاسخ به حادثه خودکار قادر به جداسازی مدل‌های به خطر افتاده، مسدود کردن کاربران مخرب و ارجاع رویدادهای امنیتی حیاتی هستند.                                                                                       |  3  | D/V |

---

## C12.3 تشخیص تغییر مدل

|   #    | توضیحات                                                                                                                                                                              | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 12.3.1 | اطمینان حاصل کنید که سیستم معیارهای عملکرد پایه‌ای مانند دقت، امتیازهای اطمینان، تأخیر و نرخ خطاها را در نسخه‌های مدل و بازه‌های زمانی مختلف پیگیری می‌کند.                          |  1  | D/V |
| 12.3.2 | اطمینان حاصل کنید که هشدارهای خودکار زمانی فعال می‌شوند که معیارهای عملکرد از آستانه‌های کاهش عملکرد از پیش تعیین‌ شده فراتر روند یا به طور قابل توجهی از مبناها انحراف داشته باشند. |  2  | D/V |
| 12.3.3 | اطمینان حاصل کنید که مانیتورهای شناسایی توهم مواردی را که خروجی‌های مدل حاوی اطلاعات نادرست از نظر واقعی، ناسازگار یا ساختگی هستند، شناسایی و علامت‌گذاری کنند.                      |  2  | D/V |

---

## C12.4 عملکرد و تلومتری رفتار

|   #    | توضیحات                                                                                                                                            | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.4.1 | تأیید کنید که متریک‌های عملیاتی شامل تأخیر درخواست، مصرف توکن، استفاده از حافظه و توان عملیاتی به‌طور مداوم جمع‌آوری و نظارت می‌شوند.              |  1  | D/V |
| 12.4.2 | اطمینان حاصل کنید که نرخ‌های موفقیت و شکست با دسته‌بندی انواع خطاها و علل اصلی آنها ردیابی می‌شوند.                                                |  1  | D/V |
| 12.4.3 | تأیید کنید که نظارت بر استفاده از منابع شامل استفاده از GPU/CPU، مصرف حافظه و نیازهای ذخیره‌سازی باشد و هشدار در صورت عبور از آستانه‌ها فعال باشد. |  2  | D/V |

---

## C12.5 برنامه‌ریزی و اجرای پاسخ به حادثه هوش مصنوعی

|   #    | توضیحات                                                                                                                                                          | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | اطمینان حاصل کنید که طرح‌های واکنش به حادثه به‌طور خاص به رویدادهای امنیتی مرتبط با هوش مصنوعی شامل نفوذ به مدل، مسموم‌سازی داده‌ها، و حملات خصمانه پرداخته‌اند. |  1  | D/V |
| 12.5.2 | اطمینان حاصل کنید که تیم‌های پاسخ به حادثه به ابزارها و تخصص‌های خاص مقوله هوش مصنوعی برای بررسی رفتار مدل و بردارهای حمله دسترسی دارند.                         |  2  | D/V |
| 12.5.3 | بررسی کنید که تحلیل پس از حادثه شامل ملاحظات بازآموزی مدل، به‌روزرسانی فیلترهای ایمنی، و ادغام درس‌های آموخته شده در کنترل‌های امنیتی باشد.                      |  3  | D/V |

---

## C12.5 تشخیص کاهش عملکرد AI

نظارت و شناسایی کاهش عملکرد و کیفیت مدل هوش مصنوعی در طول زمان.

|   #    | توضیحات                                                                                                                     | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | اطمینان حاصل کنید که دقت مدل، دقت، بازیابی و نمرات F1 به طور مداوم نظارت شده و با آستانه‌های پایه مقایسه می‌شوند.           |  1  | D/V |
| 12.5.2 | تأیید کنید که تشخیص تغییر داده، تغییرات توزیع ورودی که ممکن است بر عملکرد مدل تأثیر بگذارد را نظارت می‌کند.                 |  1  | D/V |
| 12.5.3 | بررسی کنید که تشخیص انحراف مفهوم تغییرات در رابطه بین ورودی‌ها و خروجی‌های مورد انتظار را شناسایی می‌کند.                   |  2  | D/V |
| 12.5.4 | اطمینان حاصل کنید که کاهش عملکرد باعث ایجاد هشدارهای خودکار شده و فرآیندهای بازآموزی یا جایگزینی مدل را آغاز می‌کند.        |  2  | D/V |
| 12.5.5 | تأیید کنید که تحلیل علت ریشه‌ای کاهش کیفیت با افت عملکرد مرتبط با تغییرات داده، مشکلات زیرساخت یا عوامل خارجی همبستگی دارد. |  3  |  V  |

---

## C12.6 تجسم DAG و امنیت گردش‌کار

سیستم‌های تجسم جریان کاری را در برابر نشت اطلاعات و حملات دستکاری محافظت کنید.

|   #    | توضیحات                                                                                                                                                | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 12.6.1 | اطمینان حاصل کنید که داده‌های تصویری DAG پیش از ذخیره‌سازی یا ارسال، به منظور حذف اطلاعات حساس پاک‌سازی شده‌اند.                                       |  1  | D/V |
| 12.6.2 | تأیید کنید که کنترل‌های دسترسی به تجسم گردش کار اطمینان می‌دهند فقط کاربران مجاز قادر به مشاهده مسیرهای تصمیم‌گیری عامل و ردپاهای استدلال باشند.       |  1  | D/V |
| 12.6.3 | تأیید کنید که یکپارچگی داده‌های DAG از طریق امضاهای رمزنگاری شده و مکانیزم‌های ذخیره‌سازی مقاوم در برابر دستکاری محافظت شده است.                       |  2  | D/V |
| 12.6.4 | اطمینان حاصل کنید که سیستم‌های نمایش جریان کاری اعتبارسنجی ورودی را اجرا می‌کنند تا از حملات تزریقی از طریق داده‌های طراحی شده گره یا یال جلوگیری شود. |  2  | D/V |
| 12.6.5 | اطمینان حاصل کنید که به‌روزرسانی‌های DAG در زمان واقعی محدودیت نرخ دارند و اعتبارسنجی می‌شوند تا از حملات انکار سرویس به سیستم‌های تصویری جلوگیری شود. |  3  | D/V |

---

## C12.7 نظارت پیشگیرانه بر رفتار امنیتی

شناسایی و پیشگیری از تهدیدات امنیتی از طریق تحلیل رفتاری فعال و پیشگیرانه عامل.

|   #    | توضیحات                                                                                                                       | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | اطمینان حاصل کنید که رفتارهای پیشگیرانه عامل قبل از اجرا با ادغام ارزیابی ریسک از نظر امنیتی تایید شده‌اند.                   |  1  | D/V |
| 12.7.2 | اطمینان حاصل کنید که محرک‌های ابتکار خودمختار شامل ارزیابی زمینه امنیتی و تحلیل چشم‌انداز تهدید هستند.                        |  2  | D/V |
| 12.7.3 | اطمینان حاصل کنید که الگوهای رفتار پیشگیرانه برای پیامدهای احتمالی امنیتی و عواقب ناخواسته تحلیل شده‌اند.                     |  2  | D/V |
| 12.7.4 | تأیید کنید که اقدامات پیشگیرانه حساس به امنیت نیازمند زنجیره‌های تأیید صریح با سوابق حسابرسی هستند.                           |  3  | D/V |
| 12.7.5 | تأیید کنید که شناسایی ناهنجاری رفتاری انحرافات در الگوهای عامل پیشگیرانه را که ممکن است نشان‌دهنده نفوذ باشد، شناسایی می‌کند. |  3  | D/V |

---

## مراجع

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


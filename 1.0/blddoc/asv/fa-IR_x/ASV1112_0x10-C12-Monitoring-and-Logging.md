# C12 نظارت، ثبت وقایع و شناسایی ناهنجاری

## هدف کنترل

این بخش نیازمندی‌هایی را برای ارائه دیدگاه بلادرنگ و جرم‌شناسی نسبت به آنچه مدل و سایر اجزای هوش مصنوعی مشاهده، انجام و بازمی‌گردانند، فراهم می‌کند تا تهدیدها شناسایی، اولویت‌بندی و از آنها درس گرفته شود.

## C12.1 ثبت درخواست و پاسخ

|   #    | توضیحات                                                                                                                                                                                                  | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | اطمینان حاصل کنید که تمام درخواست‌های کاربر و پاسخ‌های مدل با فراداده‌های مناسب (مانند زمان‌سنجی، شناسه کاربر، شناسه جلسه، نسخه مدل) ثبت شده باشند.                                                      |  1  | D/V |
| 12.1.2 | اطمینان حاصل کنید که لاگ‌ها در مخازن امن و کنترل‌شده بر اساس دسترسی با سیاست‌های نگهداری مناسب و رویه‌های پشتیبان‌گیری ذخیره می‌شوند.                                                                    |  1  | D/V |
| 12.1.3 | اطمینان حاصل کنید که سیستم‌های ذخیره‌سازی لاگ، رمزگذاری در حالت استراحت و در انتقال را برای حفاظت از اطلاعات حساس موجود در لاگ‌ها اجرا می‌کنند.                                                          |  1  | D/V |
| 12.1.4 | اطمینان حاصل کنید که داده‌های حساس در درخواست‌ها و خروجی‌ها به‌طور خودکار قبل از ثبت لاگ، حذف یا مخفی می‌شوند، با قوانین قابل تنظیم برای حذف اطلاعات شناسایی شخصی (PII)، اطلاعات ورود و اطلاعات اختصاصی. |  1  | D/V |
| 12.1.5 | اطمینان حاصل کنید که تصمیمات سیاستی و اقدامات فیلترینگ ایمنی با جزئیات کافی ثبت می‌شوند تا امکان حسابرسی و اشکال‌زدایی سیستم‌های مدیریت محتوا فراهم شود.                                                 |  2  | D/V |
| 12.1.6 | اطمینان حاصل کنید که صحت لاگ از طریق امضاهای رمزنگاری شده یا ذخیره‌سازی فقط-نوشتنی محافظت می‌شود.                                                                                                        |  2  | D/V |

---

## C12.2 شناسایی سوء استفاده و هشدار دهی

|   #    | توضیحات                                                                                                                                                                                                          | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | اطمینان حاصل کنید که سیستم الگوهای شناخته شده فرار از محدودیت، تلاش‌های تزریق درخواست و ورودی‌های خصمانه را با استفاده از شناسایی مبتنی بر امضاء شناسایی و هشدار می‌دهد.                                         |  1  | D/V |
| 12.2.2 | اطمینان حاصل کنید که سیستم با استفاده از فرمت‌ها و پروتکل‌های استاندارد لاگ، با پلتفرم‌های موجود مدیریت اطلاعات و رویدادهای امنیتی (SIEM) یکپارچه می‌شود.                                                        |  1  | D/V |
| 12.2.3 | تأیید کنید که رویدادهای امنیتی غنی شده شامل زمینه‌های خاص هوش مصنوعی مانند شناسه‌های مدل، امتیازهای اطمینان و تصمیمات فیلتر ایمنی باشند.                                                                         |  2  | D/V |
| 12.2.4 | اطمینان حاصل کنید که تشخیص ناهنجاری رفتاری الگوهای غیرمعمول گفتگو، تلاش‌های مکرر بیش از حد، یا رفتارهای سیستماتیک بررسی را شناسایی می‌کند.                                                                       |  2  | D/V |
| 12.2.5 | تأیید کنید که مکانیزم‌های هشداردهی در زمان واقعی، تیم‌های امنیتی را هنگام شناسایی تخلفات احتمالی سیاست یا تلاش‌های حمله مطلع می‌کنند.                                                                            |  2  | D/V |
| 12.2.6 | تأیید کنید که قوانین سفارشی برای شناسایی الگوهای تهدید خاص هوش مصنوعی شامل تلاش‌های هماهنگ شده برای دورزدن محدودیت‌ها (jailbreak)، کمپین‌های تزریق فرمان (prompt injection) و حملات استخراج مدل گنجانده شده‌اند. |  2  | D/V |
| 12.2.7 | تأیید کنید که جریان‌های کاری پاسخ خودکار به حادثه می‌توانند مدل‌های به‌خطر افتاده را ایزوله کنند، کاربران مخرب را مسدود کنند و رویدادهای امنیتی بحرانی را ارتقاء دهند.                                           |  3  | D/V |

---

## C12.3 تشخیص انحراف مدل

|   #    | توضیحات                                                                                                                                                    | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | اطمینان حاصل کنید که سیستم معیارهای عملکرد پایه مانند دقت، امتیازهای اطمینان، تأخیر و نرخ خطا را در نسخه‌های مدل و بازه‌های زمانی مختلف رصد می‌کند.        |  1  | D/V |
| 12.3.2 | تأیید کنید که هشدار خودکار زمانی فعال می‌شود که شاخص‌های عملکرد از آستانه‌های تخریب از پیش تعریف شده فراتر روند یا به طور قابل توجهی از مبناها منحرف شوند. |  2  | D/V |
| 12.3.3 | تأیید کنید که مانیتورهای تشخیص هالوسیناسیون مواردی را که خروجی‌های مدل شامل اطلاعات نادرست، ناسازگار یا ساختگی است، شناسایی و علامت‌گذاری می‌کنند.         |  2  | D/V |

---

## C12.4 عملکرد و تله‌متری رفتار

|   #    | توضیحات                                                                                                                                                          | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.4.1 | اطمینان حاصل کنید که معیارهای عملیاتی شامل تأخیر درخواست، مصرف توکن، استفاده از حافظه و توان عملیاتی به صورت مداوم جمع‌آوری و نظارت می‌شوند.                     |  1  | D/V |
| 12.4.2 | اطمینان حاصل کنید که نرخ‌های موفقیت و شکست همراه با دسته‌بندی انواع خطاها و علل اصلی آن‌ها پیگیری می‌شوند.                                                       |  1  | D/V |
| 12.4.3 | اطمینان حاصل کنید که مانیتورینگ استفاده از منابع شامل استفاده از GPU/CPU، مصرف حافظه و نیازهای ذخیره‌سازی باشد و در صورت عبور از آستانه‌های تعیین شده هشدار دهد. |  2  | D/V |

---

## C12.5 برنامه ریزی و اجرای واکنش به حادثه هوش مصنوعی

|   #    | توضیحات                                                                                                                                                              | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | بررسی کنید که برنامه‌های پاسخ به حادثه به‌طور خاص به رویدادهای امنیتی مرتبط با هوش مصنوعی از جمله به خطر افتادن مدل، مسموم‌سازی داده‌ها و حملات دشمنی پرداخته باشند. |  1  | D/V |
| 12.5.2 | اطمینان حاصل کنید که تیم‌های پاسخ به حوادث دسترسی به ابزارهای تخصصی جرم‌شناسی مرتبط با هوش مصنوعی و تخصص لازم برای بررسی رفتار مدل و بردارهای حمله را دارند.         |  2  | D/V |
| 12.5.3 | تأیید کنید که تحلیل پس از حادثه شامل ملاحظاتی برای بازآموزی مدل، به‌روزرسانی فیلترهای ایمنی، و ادغام درس‌های آموخته شده در کنترل‌های امنیتی باشد.                    |  3  | D/V |

---

## C12.5 تشخیص افت عملکرد هوش مصنوعی

نظارت و شناسایی کاهش عملکرد و کیفیت مدل هوش مصنوعی در طول زمان.

|   #    | توضیحات                                                                                                                           | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | اطمینان حاصل کنید که دقت مدل، دقت مثبت، بازیابی و نمرات F1 به طور مداوم پایش شده و با آستانه‌های پایه مقایسه می‌شوند.             |  1  | D/V |
| 12.5.2 | تأیید کنید که تشخیص تغییر داده‌ها، تغییرات توزیع ورودی را که ممکن است بر عملکرد مدل تأثیر بگذارد، پایش کند.                       |  1  | D/V |
| 12.5.3 | تأیید کنید که تشخیص تغییر مفهوم، تغییرات در رابطه بین ورودی‌ها و خروجی‌های مورد انتظار را شناسایی می‌کند.                         |  2  | D/V |
| 12.5.4 | تأیید کنید که کاهش عملکرد، هشدارهای خودکار را فعال می‌کند و فرایندهای بازآموزی یا جایگزینی مدل را شروع می‌کند.                    |  2  | D/V |
| 12.5.5 | اطمینان حاصل کنید که تحلیل علت اصلی کاهش کیفیت، افت عملکرد را با تغییرات داده‌ها، مشکلات زیرساختی یا عوامل خارجی هم‌بستگی می‌دهد. |  3  |  V  |

---

## C12.6 تجسم DAG و امنیت گردش‌کار

سیستم‌های تصویری گردش کار را در برابر نشت اطلاعات و حملات دستکاری محافظت کنید.

|   #    | توضیحات                                                                                                                                                     | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.6.1 | اطمینان حاصل کنید که داده‌های تصویری DAG برای حذف اطلاعات حساس قبل از ذخیره‌سازی یا انتقال پاک‌سازی شده‌اند.                                                |  1  | D/V |
| 12.6.2 | اطمینان حاصل کنید که کنترل‌های دسترسی به تجسم گردش کار فقط به کاربران مجاز اجازه می‌دهد مسیرهای تصمیم‌گیری عامل و ردگیری‌های استدلال را مشاهده کنند.        |  1  | D/V |
| 12.6.3 | تأیید کنید که یکپارچگی داده‌های DAG از طریق امضاهای رمزنگاری شده و مکانیزم‌های ذخیره‌سازی ضد دستکاری محافظت می‌شود.                                         |  2  | D/V |
| 12.6.4 | تأیید کنید که سیستم‌های تصویری‌سازی جریان‌های کاری اعتبارسنجی ورودی را پیاده‌سازی می‌کنند تا از حملات تزریق از طریق داده‌های ساختگی گره یا یال جلوگیری شود. |  2  | D/V |
| 12.6.5 | بررسی کنید که به‌روزرسانی‌های DAG در زمان واقعی محدود به نرخ شده و اعتبارسنجی می‌شوند تا از حملات انکار سرویس بر سیستم‌های تجسم جلوگیری شود.                |  3  | D/V |

---

## C12.7 نظارت بر رفتار پیشگیرانه امنیت

شناسایی و پیشگیری از تهدیدات امنیتی از طریق تحلیل رفتار پیشگیرانه عامل.

|   #    | توضیحات                                                                                                                             | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | اطمینان حاصل کنید که رفتارهای پیش‌دستانه عامل قبل از اجرا با ادغام ارزیابی ریسک از نظر امنیتی تایید شده‌اند.                        |  1  | D/V |
| 12.7.2 | تأیید کنید که محرک‌های ابتکار خودمختار شامل ارزیابی زمینه امنیتی و ارزیابی چشم‌انداز تهدید هستند.                                   |  2  | D/V |
| 12.7.3 | تأیید کنید که الگوهای رفتار پیشگیرانه برای پیامدهای احتمالی امنیتی و عواقب ناخواسته تحلیل می‌شوند.                                  |  2  | D/V |
| 12.7.4 | اطمینان حاصل کنید که اقدامات پیشگیرانه حیاتی برای امنیت نیاز به زنجیره‌های تایید صریح همراه با سوابق حسابرسی دارند.                 |  3  | D/V |
| 12.7.5 | اطمینان حاصل کنید که شناسایی ناهنجاری رفتاری انحرافات در الگوهای عامل پیشگیرانه را که ممکن است نشان‌دهنده نفوذ باشند، تشخیص می‌دهد. |  3  | D/V |

---

## مراجع

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


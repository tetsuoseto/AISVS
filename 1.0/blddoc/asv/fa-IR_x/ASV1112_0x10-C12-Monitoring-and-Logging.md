# C12 مانیتورینگ، لاگ‌برداری و تشخیص ناهنجاری

## هدف کنترل

این بخش الزامات ارائه دید هم‌زمان و قضایی نسبت به آنچه مدل و سایر اجزای هوش مصنوعی می‌بینند، انجام می‌دهند و بازمی‌گردانند را مشخص می‌کند تا تهدیدها شناسایی، اولویت‌بندی و از آنها آموخته شوند.

## C12.1 لاگ درخواست و پاسخ

|   #    | شرح                                                                                                                                                                                              | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 12.1.1 | اطمینان حاصل کنید که تمامی درخواست‌های کاربر و پاسخ‌های مدل با فراداده‌های مناسب ثبت می‌شوند (مثلاً نشان زمانی، شناسه کاربر، شناسه نشست، نسخه مدل).                                              |  1  | D/V |
| 12.1.2 | اطمینان حاصل کنید که لاگ‌ها در مخازن امن و دارای کنترل دسترسی ذخیره می‌شوند با سیاست‌های نگهداری مناسب و رویه‌های پشتیبان‌گیری.                                                                  |  1  | D/V |
| 12.1.3 | اطمینان حاصل کنید که سیستم‌های ذخیره‌سازی لاگ‌ها رمزگذاری در حالت استراحت و در حال انتقال را پیاده‌سازی می‌کنند تا از اطلاعات حساس موجود در لاگ‌ها محافظت شود.                                   |  1  | D/V |
| 12.1.4 | اطمینان حاصل کنید که داده‌های حساس در درخواست‌ها و خروجی‌ها قبل از ثبت در لاگ‌ها به‌طور خودکار محو یا ماسک می‌شوند، با قواعد ماسک‌گذاری قابل پیکربندی برای PII، اعتبارنامه‌ها و اطلاعات مالکیتی. |  1  | D/V |
| 12.1.5 | اطمینان حاصل کنید که تصمیمات سیاستی و اقدامات فیلترینگ ایمنی با جزئیات کافی ثبت می‌شوند تا امکان بازرسی و اشکال‌زدایی سیستم‌های نظارت بر محتوا فراهم گردد.                                       |  2  | D/V |
| 12.1.6 | اطمینان حاصل کنید که یکپارچگی لاگ از طریق امضای رمزنگاری‌شده یا ذخیره‌سازی صرفاً نوشتنی محافظت می‌شود.                                                                                           |  2  | D/V |

---

## C12.2 تشخیص سوء استفاده و هشدار

|   #    | شرح                                                                                                                                                                              | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | تأیید کنید که سیستم با استفاده از تشخیص مبتنی بر امضا، الگوهای معروف جیلبریک، تلاش‌های تزریق پرامپت و ورودی‌های خصمانه را شناسایی کرده و هشدار می‌دهد.                           |  1  | D/V |
| 12.2.2 | اطمینان حاصل کنید که سیستم با پلتفرم‌های مدیریت امنیتی اطلاعات و رویدادها (SIEM) موجود از طریق فرمت‌های لاگ استاندارد و پروتکل‌ها یکپارچه می‌شود.                                |  1  | D/V |
| 12.2.3 | تأیید کنید که رویدادهای امنیتی غنی‌شده شامل زمینه مخصوص هوش مصنوعی از جمله شناسه‌های مدل، نمره‌های اطمینان و تصمیم‌های فیلتر ایمنی هستند.                                        |  2  | D/V |
| 12.2.4 | تأیید کنید که تشخیص ناهنجاری رفتاری، الگوهای مکالمه نامعمول، یا تلاش‌های تکرار بیش از حد، یا رفتارهای کاوش سیستماتیک را شناسایی می‌کند.                                          |  2  | D/V |
| 12.2.5 | اطمینان حاصل کنید که مکانیسم‌های هشداردهی در زمان واقعی تیم‌های امنیتی را مطلع می‌کنند هنگامی که نقض‌های سیاستی احتمالی یا تلاش‌های حمله تشخیص داده می‌شوند.                     |  2  | D/V |
| 12.2.6 | اطمینان حاصل کنید که قواعد سفارشی برای تشخیص الگوهای تهدید خاص هوش مصنوعی، از جمله تلاش‌های جیل‌بریک هماهنگ‌شده، کارزارهای تزریق پرامپت و حملات استخراج مدل گنجانده شده‌اند.     |  2  | D/V |
| 12.2.7 | تأیید کنید که گردش‌کارهای پاسخ به حوادث خودکار می‌توانند مدل‌های به‌خطر افتاده را ایزوله کنند، کاربران مخرب را مسدود کنند و رویدادهای امنیتی بحرانی را به سطح بالاتر ارجاع دهند. |  3  | D/V |

---

## C12.3 تشخیص انحراف مدل

|   #    | شرح                                                                                                                                                                             | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | تأیید کنید که سیستم معیارهای عملکرد پایه‌ای مانند دقت، نمره‌های اطمینان، تاخیر و نرخ‌های خطا را در سراسر نسخه‌های مدل و بازه‌های زمانی پیگیری می‌کند.                           |  1  | D/V |
| 12.3.2 | تأیید کنید که هشدار خودکار زمانی فعال می‌شود که معیارهای عملکرد از آستانه‌های از پیش تعیین‌شده برای افت کارایی فراتر روند یا به طور قابل توجهی از خطوط مبنای عملکرد منحرف شوند. |  2  | D/V |
| 12.3.3 | اطمینان حاصل کنید که سامانه‌های تشخیص توهم مواردی را شناسایی و علامت‌گذاری می‌کنند که خروجی‌های مدل حاوی اطلاعات نادرست از نظر واقعیت، ناسازگار یا ساختگی هستند.                |  2  | D/V |

---

## C12.4 تله‌متری عملکرد و رفتار

|   #    | شرح                                                                                                                                        | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 12.4.1 | تأیید کنید که معیارهای عملیاتی از جمله زمان تاخیر درخواست، مصرف توکن، استفاده از حافظه و نرخ عبور به‌طور پیوسته جمع‌آوری و نظارت می‌شوند.  |  1  | D/V |
| 12.4.2 | اطمینان حاصل کنید که نرخ‌های موفقیت و شکست با دسته‌بندی انواع خطاها و علل ریشه‌ای آن‌ها پیگیری می‌شوند.                                    |  1  | D/V |
| 12.4.3 | اطمینان حاصل کنید که پایش استفاده از منابع شامل مصرف GPU/CPU، مصرف حافظه و نیازهای ذخیره‌سازی باشد و در صورت نقض آستانه‌ها هشدار داده شود. |  2  | D/V |

---

## C12.5 پاسخ به رویدادهای هوش مصنوعی: برنامه‌ریزی و اجرا

|   #    | شرح                                                                                                                                                                | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 12.5.1 | تأیید کنید که برنامه‌های پاسخ به حوادث امنیتی به‌طور مشخص رویدادهای امنیتی مرتبط با هوش مصنوعی را در برگیرند، از جمله مختل شدن مدل، آلودگی داده‌ها و حملات خصمانه. |  1  | D/V |
| 12.5.2 | اطمینان حاصل کنید که تیم‌های پاسخ به حوادث به ابزارهای فارنسیک مخصوص هوش مصنوعی و تخصص لازم برای بررسی رفتار مدل و بردارهای حمله دسترسی دارند.                     |  2  | D/V |
| 12.5.3 | اطمینان حاصل کنید که تحلیل پس از رخداد شامل ملاحظات بازآموزی مدل، به‌روزرسانی‌های فیلتر ایمنی و ادغام درس‌های آموخته‌شده در کنترل‌های امنیتی باشد.                 |  3  | D/V |

---

## C12.5 تشخیص کاهش کارایی هوش مصنوعی

نظارت و تشخیص کاهش کارایی و کیفیت مدل هوش مصنوعی در طول زمان.

|   #    | شرح                                                                                                                               | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | بررسی کنید که دقت مدل، دقت پیش‌بینی، بازشناسی، و نمره‌های F1 به طور مداوم پایش می‌شوند و در برابر آستانه‌های پایه مقایسه می‌شوند. |  1  | D/V |
| 12.5.2 | تأیید کنید که تشخیص انحراف داده‌ها تغییرات توزیع ورودی را پایش می‌کند که ممکن است بر عملکرد مدل تأثیر بگذارد.                     |  1  | D/V |
| 12.5.3 | تایید کنید که تشخیص انحراف مفهوم تغییرات در رابطه بین ورودی‌ها و خروجی‌های مورد انتظار را شناسایی می‌کند.                         |  2  | D/V |
| 12.5.4 | تأیید کنید که کاهش عملکرد منجر به ایجاد هشدارهای خودکار می‌شود و گردش‌های کاری بازآموزی یا جایگزینی مدل را آغاز می‌کند.           |  2  | D/V |
| 12.5.5 | بررسی کنید که تحلیل علت ریشه‌ای افت عملکرد با تغییرات داده‌ها، مشکلات زیرساختی یا عوامل خارجی همبسته است.                         |  3  |  V  |

---

## C12.6 نمایش DAG و امنیت گردش کار

سیستم‌های بصری‌سازی گردش کار را در برابر نشت اطلاعات و حملات دستکاری محافظت کنید.

|   #    | شرح                                                                                                                                                                          | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.6.1 | اطمینان حاصل کنید که داده‌های نمایش DAG قبل از ذخیره‌سازی یا انتقال، برای حذف اطلاعات حساس پاک‌سازی می‌شوند.                                                                 |  1  | D/V |
| 12.6.2 | اطمینان حاصل کنید که کنترل‌های دسترسی به نمایش گراف گردش کار تنها به کاربران مجاز اجازه می‌دهند تا مسیرهای تصمیم‌گیری عامل و ردیابی‌های استدلال را مشاهده کنند.              |  1  | D/V |
| 12.6.3 | تأیید کنید که یکپارچگی داده‌های DAG از طریق امضاهای رمزنگاری‌شده و مکانیسم‌های ذخیره‌سازی ضد دستکاری محافظت می‌شود.                                                          |  2  | D/V |
| 12.6.4 | تأیید کنید که سیستم‌های نمایش گردش کار اعتبارسنجی ورودی را پیاده‌سازی می‌کنند تا از حملات تزریق از طریق داده‌های گره یا لبه‌های ساخته‌شده جلوگیری شود.                       |  2  | D/V |
| 12.6.5 | بررسی کنید که به‌روزرسانی‌های زمان واقعی گراف جهت‌دار بدون حلقه (DAG) دارای محدودیت نرخ و اعتبارسنجی هستند تا از حملات انکار سرویس (DoS) به سیستم‌های تجسم داده جلوگیری شود. |  3  | D/V |

---

## C12.7 نظارت پیشگیرانه بر رفتار امنیتی

تشخیص و جلوگیری از تهدیدات امنیتی از طریق تحلیل رفتار عامل به طور فعال.

|   #    | شرح                                                                                                                        | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | تأیید کنید که رفتارهای عامل پیش‌فعال قبل از اجرا از نظر امنیتی اعتبارسنجی شده‌اند و با ادغام ارزیابی ریسک یکپارچه هستند.   |  1  | D/V |
| 12.7.2 | اطمینان حاصل کنید که محرک‌های ابتکار خودمختار شامل ارزیابی زمینه امنیتی و ارزیابی چشم‌انداز تهدید است.                     |  2  | D/V |
| 12.7.3 | اطمینان حاصل کنید که الگوهای رفتار پیشگیرانه برای پیامدهای امنیتی بالقوه و پیامدهای ناخواسته تحلیل می‌شوند.                |  2  | D/V |
| 12.7.4 | تأیید کنید که اقدامات پیشگیرانه امنیتی حساس به امنیت نیازمند زنجیره‌های تأیید صریح همراه با سوابق حسابرسی هستند.           |  3  | D/V |
| 12.7.5 | بررسی کنید که آیا تشخیص ناهنجاری رفتاری انحراف‌ها را در الگوهای عامل پیش‌فعال شناسایی می‌کند که ممکن است نشانگر نفوذ باشد. |  3  | D/V |

---

## منابع

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


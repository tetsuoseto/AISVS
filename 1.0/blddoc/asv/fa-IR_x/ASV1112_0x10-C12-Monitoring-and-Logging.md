# C12 نظارت، ثبت وقایع و شناسایی ناهنجاری

## هدف کنترل

این بخش الزامات ارائه دید بلادرنگ و قضایی نسبت به آنچه مدل و دیگر اجزای هوش مصنوعی می‌بینند، انجام می‌دهند و بازمی‌گردانند را ارائه می‌دهد، تا تهدیدات بتوانند شناسایی، اولویت‌بندی و از آنها یاد گرفته شود.

## C12.1 ثبت درخواست و پاسخ

|   #    | توضیحات                                                                                                                                                                                            | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | اطمینان حاصل کنید که تمام دستورات کاربر و پاسخ‌های مدل با فراداده‌های مناسب (مانند زمان‌سنجی، شناسه کاربر، شناسه جلسه، نسخه مدل) ثبت شده‌اند.                                                      |  1  | D/V |
| 12.1.2 | بررسی کنید که لاگ‌ها در مخازن امن و دارای کنترل دسترسی با سیاست‌های نگهداری مناسب و روش‌های پشتیبان‌گیری ذخیره شوند.                                                                               |  1  | D/V |
| 12.1.3 | اطمینان حاصل کنید که سیستم‌های ذخیره‌سازی لاگ، رمزنگاری در حالت استراحت و در انتقال را برای محافظت از اطلاعات حساس موجود در لاگ‌ها اعمال می‌کنند.                                                  |  1  | D/V |
| 12.1.4 | تأیید کنید که داده‌های حساس در درخواست‌ها و خروجی‌ها به‌طور خودکار قبل از ثبت لاگ، حذف یا مخفی می‌شوند، با قوانین قابل تنظیم برای حذف اطلاعات شناسایی شخصی (PII)، گواهی‌نامه‌ها و اطلاعات مالکیتی. |  1  | D/V |
| 12.1.5 | اطمینان حاصل کنید که تصمیمات سیاستی و اقدامات فیلترینگ ایمنی با جزئیات کافی ثبت می‌شوند تا امکان بررسی و اشکال‌زدایی سیستم‌های نظارت بر محتوا فراهم شود.                                           |  2  | D/V |
| 12.1.6 | تأیید کنید که یکپارچگی گزارش‌ها از طریق مثلاً امضاهای رمزنگاری شده یا ذخیره‌سازی فقط‌نوشتنی محافظت می‌شود.                                                                                         |  2  | D/V |

---

## C12.2 تشخیص و هشدار سوءاستفاده

|   #    | توضیحات                                                                                                                                                                                               | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | تأیید کنید که سیستم الگوهای شناخته شده فرار از محدودیت (jailbreak)، تلاش‌های تزریق درخواست (prompt injection) و ورودی‌های خصمانه را با استفاده از شناسایی مبتنی بر امضا تشخیص داده و هشدار می‌دهد.    |  1  | D/V |
| 12.2.2 | اطمینان حاصل کنید که سیستم با استفاده از فرمت‌ها و پروتکل‌های استاندارد گزارش، با پلتفرم‌های موجود مدیریت اطلاعات و رویدادهای امنیتی (SIEM) ادغام می‌شود.                                             |  1  | D/V |
| 12.2.3 | تأیید کنید که رویدادهای امنیتی غنی‌شده شامل زمینه‌های خاص هوش مصنوعی مانند شناسه‌های مدل، نمره‌های اطمینان، و تصمیمات فیلتر ایمنی باشد.                                                               |  2  | D/V |
| 12.2.4 | تأیید کنید که تشخیص ناهنجاری رفتاری الگوهای غیرمعمول مکالمه، تلاش‌های مکرر بیش از حد یا رفتارهای کاوش سیستماتیک را شناسایی می‌کند.                                                                    |  2  | D/V |
| 12.2.5 | اطمینان حاصل کنید که مکانیزم‌های هشدار به‌صورت زنده تیم‌های امنیتی را هنگام شناسایی نقض‌های احتمالی سیاست یا تلاش‌های حمله آگاه می‌کنند.                                                              |  2  | D/V |
| 12.2.6 | اطمینان حاصل کنید که قوانین سفارشی برای شناسایی الگوهای تهدید خاص هوش مصنوعی از جمله تلاش‌های هماهنگ برای فرار از محدودیت‌ها (jailbreak)، کمپین‌های تزریق پرامپت و حملات استخراج مدل گنجانده شده‌اند. |  2  | D/V |
| 12.2.7 | تأیید کنید که گردش‌کارهای پاسخ خودکار به حادثه می‌توانند مدل‌های به‌خطر افتاده را جدا کنند، کاربران مخرب را مسدود کنند، و رویدادهای امنیتی بحرانی را ارتقا دهند.                                      |  3  | D/V |

---

## کشف تغییر مدل C12.3

|   #    | توضیحات                                                                                                                                                                      | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | اطمینان حاصل کنید که سیستم معیارهای اساسی عملکرد مانند دقت، امتیازهای اطمینان، تأخیر و نرخ خطا را در نسخه‌های مدل و دوره‌های زمانی مختلف ردیابی می‌کند.                      |  1  | D/V |
| 12.3.2 | اطمینان حاصل کنید که هشدار خودکار هنگامی که شاخص‌های عملکرد از آستانه‌های تخریب از پیش تعریف شده فراتر می‌روند یا به طور قابل توجهی از خطوط مبنا منحرف می‌شوند، فعال می‌شود. |  2  | D/V |
| 12.3.3 | اطمینان حاصل کنید که مانیتورهای تشخیص هذیان، مواردی را که خروجی‌های مدل حاوی اطلاعات نادرست، ناسازگار یا ساختگی هستند، شناسایی کرده و علامت‌گذاری می‌کنند.                   |  2  | D/V |

---

## C12.4 عملکرد و تله‌متری رفتار

|   #    | توضیحات                                                                                                                                         | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.4.1 | اطمینان حاصل کنید که معیارهای عملیاتی از جمله تأخیر درخواست، مصرف توکن، استفاده از حافظه، و توان عملیاتی به طور مداوم جمع‌آوری و نظارت می‌شوند. |  1  | D/V |
| 12.4.2 | اطمینان حاصل کنید که نرخ‌های موفقیت و شکست با دسته‌بندی انواع خطاها و علل اصلی آنها ردیابی می‌شوند.                                             |  1  | D/V |
| 12.4.3 | تأیید کنید که پایش استفاده از منابع شامل مصرف GPU/CPU، مصرف حافظه و نیازهای ذخیره‌سازی باشد و هشداردهی در هنگام عبور از آستانه‌ها انجام شود.    |  2  | D/V |

---

## C12.5 برنامه‌ریزی و اجرای واکنش به حوادث هوش مصنوعی

|   #    | توضیحات                                                                                                                                                                       | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | اطمینان حاصل کنید که برنامه‌های واکنش به حادثه به‌طور خاص حوادث امنیتی مرتبط با هوش مصنوعی از جمله نفوذ به مدل، آلوده‌سازی داده‌ها و حملات خصمانه را مورد بررسی قرار می‌دهند. |  1  | D/V |
| 12.5.2 | اطمینان حاصل کنید که تیم‌های واکنش به حوادث به ابزارها و تخصص‌های خاص جرم‌شناسی هوش مصنوعی دسترسی داشته باشند تا رفتار مدل و مسیرهای حمله را بررسی کنند.                      |  2  | D/V |
| 12.5.3 | تأیید کنید که تحلیل پس از حادثه شامل ملاحظات بازآموزی مدل، به‌روزرسانی فیلترهای ایمنی، و ادغام درس‌های آموخته شده در کنترل‌های امنیتی باشد.                                   |  3  | D/V |

---

## C12.5 تشخیص کاهش عملکرد هوش مصنوعی

نظارت و شناسایی کاهش عملکرد و کیفیت مدل هوش مصنوعی در طول زمان.

|   #    | توضیحات                                                                                                                              | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 12.5.1 | اطمینان حاصل کنید که دقت مدل، دقت (precision)، بازیابی (recall) و نمره F1 به طور مداوم پایش شده و با آستانه‌های پایه مقایسه می‌شوند. |  1  | D/V |
| 12.5.2 | تأیید کنید که تشخیص انحراف داده تغییرات توزیع ورودی را که ممکن است بر عملکرد مدل تأثیر بگذارد، نظارت می‌کند.                         |  1  | D/V |
| 12.5.3 | تأیید کنید که تشخیص تغییر مفهوم، تغییرات در رابطه بین ورودی‌ها و خروجی‌های مورد انتظار را شناسایی می‌کند.                            |  2  | D/V |
| 12.5.4 | تأیید کنید که افت عملکرد باعث فعال‌سازی هشدارهای خودکار شده و روندهای بازآموزی یا جایگزینی مدل را آغاز می‌کند.                       |  2  | D/V |
| 12.5.5 | تأیید کنید که تحلیل ریشه‌ای کاهش عملکرد ارتباط بین کاهش عملکرد را با تغییرات داده‌ها، مشکلات زیرساخت یا عوامل خارجی برقرار می‌کند.   |  3  |  V  |

---

## C12.6 تجسم DAG و امنیت جریان کاری

سیستم‌های تصویری‌سازی جریان‌کار را در برابر نشت اطلاعات و حملات دستکاری محافظت کنید.

|   #    | توضیحات                                                                                                                                                          | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.6.1 | اطمینان حاصل کنید که داده‌های مصورسازی DAG پاک‌سازی شده‌اند تا اطلاعات حساس قبل از ذخیره‌سازی یا انتقال حذف شوند.                                                |  1  | D/V |
| 12.6.2 | اطمینان حاصل کنید که کنترل‌های دسترسی به مصورسازی جریان کاری تضمین می‌کنند تنها کاربران مجاز قادر به مشاهده مسیرهای تصمیم‌گیری عامل و ردگیری‌های استدلالی باشند. |  1  | D/V |
| 12.6.3 | تأیید کنید که یکپارچگی داده‌های DAG از طریق امضاهای رمزنگاری شده و مکانیزم‌های ذخیره‌سازی مقاوم در برابر دستکاری محافظت می‌شود.                                  |  2  | D/V |
| 12.6.4 | اطمینان حاصل کنید که سیستم‌های تجسم گردش کار، اعتبارسنجی ورودی را پیاده‌سازی می‌کنند تا از حملات تزریق از طریق داده‌های ساختاریافته گره یا یال جلوگیری شود.      |  2  | D/V |
| 12.6.5 | تأیید کنید که به‌روزرسانی‌های DAG در زمان واقعی دارای محدودیت نرخ و اعتبارسنجی شده‌اند تا از حملات انکار سرویس به سیستم‌های تصویری جلوگیری شود.                  |  3  | D/V |

---

## C12.7 نظارت پیشگیرانه بر رفتارهای امنیتی

شناسایی و پیشگیری از تهدیدات امنیتی از طریق تحلیل رفتار پیشگیرانه عامل.

|   #    | توضیحات                                                                                                             | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | اطمینان حاصل کنید که رفتارهای عامل پیشگیرانه قبل از اجرا با ارزیابی ریسک یکپارچه شده، از نظر امنیتی تأیید شده‌اند.  |  1  | D/V |
| 12.7.2 | تأیید کنید که محرک‌های ابتکار خودمختار شامل ارزیابی زمینه امنیتی و ارزیابی منظره تهدیدات می‌شود.                    |  2  | D/V |
| 12.7.3 | تأیید کنید که الگوهای رفتار پیش‌دستانه برای پیامدهای احتمالی امنیتی و عواقب ناخواسته تجزیه و تحلیل شوند.            |  2  | D/V |
| 12.7.4 | تأیید کنید که اقدامات پیشگیرانه بحرانی امنیتی نیازمند زنجیره‌های تصویب صریح با ردپاهای حسابرسی هستند.               |  3  | D/V |
| 12.7.5 | تأیید کنید که شناسایی ناهنجاری رفتاری انحرافات در الگوهای عامل فعال را که ممکن است نشانه‌ی نفوذ باشد، تشخیص می‌دهد. |  3  | D/V |

---

## مراجع

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


# C12 پایش، لاگ‌برداری و تشخیص ناهنجاری

## هدف کنترل

این بخش الزامات ارائه دیدگاه بلادرنگ و جرم‌یابی را در مورد آنچه مدل و سایر مؤلفه‌های هوش مصنوعی مشاهده، انجام و بازمی‌گردانند فراهم می‌کند، تا تهدیدها شناسایی، طبقه‌بندی و از آنها درس گرفته شود.

## C12.1 ثبت درخواست و پاسخ

|   #    | توضیحات                                                                                                                                                                                        | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | تأیید کنید که تمام پیام‌های کاربر و پاسخ‌های مدل با فراداده‌های مناسب (مثلاً زمان ثبت، شناسه کاربر، شناسه جلسه، نسخه مدل) ثبت می‌شوند.                                                         |  1  | D/V |
| 12.1.2 | تأیید کنید که گزارش‌ها در مخازن امن و کنترل شده با دسترسی محدود و با سیاست‌های نگهداری مناسب و روندهای پشتیبان‌گیری ذخیره شده‌اند.                                                             |  1  | D/V |
| 12.1.3 | تأیید کنید که سیستم‌های ذخیره‌سازی لاگ، رمزگذاری در حالت استراحت و در حین انتقال را برای محافظت از اطلاعات حساس موجود در لاگ‌ها پیاده‌سازی می‌کنند.                                            |  1  | D/V |
| 12.1.4 | تأیید کنید که داده‌های حساس در ورودی‌ها و خروجی‌ها قبل از ثبت به‌طور خودکار حذف یا مسدود می‌شوند، همراه با قوانین حذف قابل تنظیم برای اطلاعات شخصی شناسایی‌شده (PII)، مدارک و اطلاعات اختصاصی. |  1  | D/V |
| 12.1.5 | اطمینان حاصل کنید که تصمیمات سیاستی و اقدامات فیلترینگ ایمنی با جزئیات کافی ثبت می‌شوند تا امکان حسابرسی و اشکال‌زدایی سیستم‌های مدیریت محتوا فراهم شود.                                       |  2  | D/V |
| 12.1.6 | اطمینان حاصل کنید که یکپارچگی لاگ از طریق مثلاً امضاهای رمزنگاری شده یا ذخیره‌سازی فقط-نوشتنی محافظت می‌شود.                                                                                   |  2  | D/V |

---

## C12.2 تشخیص سوءاستفاده و اطلاع‌رسانی

|   #    | توضیحات                                                                                                                                                                                                                 | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | اطمینان حاصل کنید که سیستم الگوهای شناخته شده فرار از سیستم، تلاش‌های تزریق فرمان و ورودی‌های خصمانه را با استفاده از شناسایی مبتنی بر امضا تشخیص داده و هشدار دهد.                                                     |  1  | D/V |
| 12.2.2 | اطمینان حاصل کنید که سیستم با پلتفرم‌های موجود مدیریت اطلاعات و رویدادهای امنیتی (SIEM) با استفاده از فرمت‌ها و پروتکل‌های استاندارد لاگ، یکپارچه می‌شود.                                                               |  1  | D/V |
| 12.2.3 | اطمینان حاصل کنید که رویدادهای امنیتی غنی شده شامل زمینه‌های خاص هوش مصنوعی مانند شناسه‌های مدل، نمرات اطمینان و تصمیمات فیلتر ایمنی باشند.                                                                             |  2  | D/V |
| 12.2.4 | اطمینان حاصل کنید که شناسایی ناهنجاری رفتاری الگوهای غیرمعمول مکالمه، تلاش‌های بیش از حد برای دوباره‌کار و یا رفتارهای سیستماتیک کاوش را شناسایی می‌کند.                                                                |  2  | D/V |
| 12.2.5 | اطمینان حاصل کنید که مکانیزم‌های هشداردهی بلادرنگ، تیم‌های امنیتی را هنگام شناسایی نقض‌های احتمالی سیاست یا تلاش‌های حمله، مطلع می‌کنند.                                                                                |  2  | D/V |
| 12.2.6 | اطمینان حاصل کنید که قوانین سفارشی برای شناسایی الگوهای تهدید خاص هوش مصنوعی از جمله تلاش‌های هماهنگ برای دور زدن محدودیت‌ها (jailbreak)، کمپین‌های تزریق فرمان (prompt injection) و حملات استخراج مدل گنجانده شده‌اند. |  2  | D/V |
| 12.2.7 | تأیید کنید که گردش‌کارهای پاسخ خودکار به رخدادها قادر به جداسازی مدل‌های به خطر افتاده، مسدود کردن کاربران مخرب و افزایش سطح رخدادهای امنیتی بحرانی هستند.                                                              |  3  | D/V |

---

## C12.3 تشخیص انحراف مدل

|   #    | توضیحات                                                                                                                                                            | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 12.3.1 | تأیید کنید که سیستم معیارهای عملکرد پایه مانند دقت، امتیازهای اطمینان، تأخیر و نرخ خطاها را در نسخه‌های مدل و دوره‌های زمانی مختلف رصد می‌کند.                     |  1  | D/V |
| 12.3.2 | اطمینان حاصل کنید که هشدار خودکار زمانی فعال می‌شود که معیارهای عملکرد از حدود کاهش تعریف‌شده فراتر رفته یا به طور قابل توجهی از معیارهای پایه انحراف داشته باشند. |  2  | D/V |
| 12.3.3 | بررسی کنید که مانیتورهای تشخیص هذیان نمونه‌هایی را شناسایی و علامت‌گذاری کنند که خروجی‌های مدل شامل اطلاعات نادرست، ناسازگار یا ساختگی باشد.                       |  2  | D/V |

---

## C12.4 اجرای عملکرد و تلومتری رفتار

|   #    | توضیحات                                                                                                                                            | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.4.1 | اطمینان حاصل کنید که معیارهای عملیاتی شامل تأخیر درخواست، مصرف توکن، استفاده از حافظه و توان عملیاتی به طور مداوم جمع‌آوری و نظارت می‌شوند.        |  1  | D/V |
| 12.4.2 | تأیید کنید که نرخ‌های موفقیت و شکست همراه با دسته‌بندی انواع خطاها و عوامل اصلی آن‌ها رصد می‌شود.                                                  |  1  | D/V |
| 12.4.3 | بررسی کنید که نظارت بر استفاده از منابع شامل استفاده از GPU/CPU، مصرف حافظه و نیازهای ذخیره‌سازی باشد و هشدار در صورت عبور از آستانه‌ها فعال گردد. |  2  | D/V |

---

## C12.5 برنامه‌ریزی و اجرای واکنش به حوادث هوش مصنوعی

|   #    | توضیحات                                                                                                                                                           | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | اطمینان حاصل کنید که برنامه‌های پاسخ به حادثه به طور خاص به رویدادهای امنیتی مرتبط با هوش مصنوعی از جمله نفوذ به مدل، مسمومیت داده‌ها و حملات خصمانه پرداخته‌اند. |  1  | D/V |
| 12.5.2 | اطمینان حاصل کنید که تیم‌های پاسخ به حادثه به ابزارهای تخصصی جرم‌شناسی هوش مصنوعی و تخصص لازم برای بررسی رفتار مدل و مسیرهای حمله دسترسی دارند.                   |  2  | D/V |
| 12.5.3 | اطمینان حاصل کنید که تحلیل پس از حادثه شامل ملاحظات بازآموزی مدل، به‌روزرسانی فیلترهای ایمنی و ادغام درس‌های آموخته‌شده در کنترل‌های امنیتی باشد.                 |  3  | D/V |

---

## C12.5 تشخیص افت عملکرد هوش مصنوعی

نظارت و شناسایی کاهش عملکرد و کیفیت مدل هوش مصنوعی در طول زمان.

|   #    | توضیحات                                                                                                                                 | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | اطمینان حاصل کنید که دقت مدل، صحت (precision)، بازیابی (recall) و امتیاز F1 به طور مداوم نظارت شده و با آستانه‌های پایه مقایسه می‌شوند. |  1  | D/V |
| 12.5.2 | اطمینان حاصل کنید که تشخیص تغییر داده‌ها، تغییرات توزیع ورودی که ممکن است بر عملکرد مدل تأثیر بگذارد را نظارت می‌کند.                   |  1  | D/V |
| 12.5.3 | اطمینان حاصل کنید که تشخیص تغییر مفهوم تغییرات در رابطه بین ورودی‌ها و خروجی‌های مورد انتظار را شناسایی می‌کند.                         |  2  | D/V |
| 12.5.4 | اطمینان حاصل کنید که کاهش عملکرد باعث فعال شدن هشدارهای خودکار شده و روندهای آموزش مجدد مدل یا جایگزینی آن را آغاز می‌کند.              |  2  | D/V |
| 12.5.5 | اطمینان حاصل کنید که تحلیل ریشه‌ای علل افت کیفیت با کاهش عملکرد به تغییرات داده، مشکلات زیرساخت یا عوامل خارجی مرتبط است.               |  3  |  V  |

---

## C12.6 تجسم DAG و امنیت گردش کار

سیستم‌های تصویری‌سازی جریان کار را از نشت اطلاعات و حملات دستکاری محافظت کنید.

|   #    | توضیحات                                                                                                                                                             | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.6.1 | اطمینان حاصل کنید که داده‌های تجسم DAG قبل از ذخیره‌سازی یا انتقال پاک‌سازی شده و اطلاعات حساس را حذف کرده‌اند.                                                     |  1  | D/V |
| 12.6.2 | بررسی کنید که کنترل‌های دسترسی به تجسم جریان کاری تضمین می‌کنند که تنها کاربران مجاز قادر به مشاهده مسیرهای تصمیم‌گیری عامل و ردپاهای استدلالی باشند.               |  1  | D/V |
| 12.6.3 | اطمینان حاصل کنید که یکپارچگی داده‌های DAG از طریق امضاهای رمزنگاری شده و مکانیزم‌های ذخیره‌سازی مقاوم در برابر دستکاری محافظت می‌شود.                              |  2  | D/V |
| 12.6.4 | اطمینان حاصل کنید که سیستم‌های تصویری سازی گردش کار، اعتبارسنجی ورودی را پیاده‌سازی می‌کنند تا از حملات تزریقی از طریق داده‌های طراحی شده‌ی گره یا یال جلوگیری شود. |  2  | D/V |
| 12.6.5 | تأیید کنید که به‌روزرسانی‌های DAG در زمان واقعی با محدودیت نرخ و اعتبارسنجی شده‌اند تا از حملات انکار سرویس به سیستم‌های بصری‌سازی جلوگیری شود.                     |  3  | D/V |

---

## C12.7 پایش رفتار امنیتی پیشگیرانه

شناسایی و پیشگیری از تهدیدات امنیتی از طریق تحلیل رفتار پیشگیرانه عامل.

|   #    | توضیحات                                                                                                                      | سطح | نقش |
| :----: | ---------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | اطمینان حاصل کنید که رفتارهای عاملی پیشگیرانه قبل از اجرا با ادغام ارزیابی ریسک از نظر امنیتی تأیید شده‌اند.                 |  1  | D/V |
| 12.7.2 | اطمینان حاصل کنید که عوامل تحریک ابتکار خودکار شامل ارزیابی زمینه امنیتی و ارزیابی چشم‌انداز تهدید هستند.                    |  2  | D/V |
| 12.7.3 | تأیید کنید که الگوهای رفتار پیشگیرانه برای پیامدهای احتمالی امنیتی و عواقب ناخواسته تحلیل شوند.                              |  2  | D/V |
| 12.7.4 | تأیید کنید که اقدامات پیشگیرانه حیاتی امنیتی نیازمند زنجیره‌های تأیید صریح با سوابق حسابرسی هستند.                           |  3  | D/V |
| 12.7.5 | تأیید کنید که تشخیص ناهنجاری رفتاری، انحرافات در الگوهای عامل پیشگیرانه را که ممکن است نشان‌دهنده نفوذ باشد، شناسایی می‌کند. |  3  | D/V |

---

## مراجع

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


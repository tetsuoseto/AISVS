# پایش، ثبت وقایع و تشخیص ناهنجاری C12

## هدف کنترل

این بخش نیازمندی‌هایی را برای ارائه دید زنده و قانونی به آنچه مدل و دیگر اجزای هوش مصنوعی مشاهده، انجام و بازگردانی می‌کنند، فراهم می‌کند تا تهدیدات قابل‌شناسایی، اولویت‌بندی و مورد یادگیری قرار گیرند.

## C12.1 ثبت درخواست و پاسخ

|   #    | توضیحات                                                                                                                                                                                                   | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | اطمینان حاصل کنید که تمام اعلان‌های کاربر و پاسخ‌های مدل با فراداده‌های مناسب (مانند زمان‌سنجی، شناسه کاربر، شناسه جلسه، نسخه مدل) ثبت می‌شوند.                                                           |  1  | D/V |
| 12.1.2 | اطمینان حاصل کنید که لاگ‌ها در مخازن ایمن با کنترل دسترسی مناسب و سیاست‌های نگهداری و فرآیندهای پشتیبان‌گیری مناسب ذخیره می‌شوند.                                                                         |  1  | D/V |
| 12.1.3 | اطمینان حاصل کنید که سیستم‌های ذخیره‌سازی لاگ، رمزگذاری در حالت استراحت (at rest) و در حین انتقال (in transit) را برای حفاظت از اطلاعات حساس موجود در لاگ‌ها اعمال می‌کنند.                               |  1  | D/V |
| 12.1.4 | اطمینان حاصل کنید که داده‌های حساس در پرامپت‌ها و خروجی‌ها به‌طور خودکار قبل از ثبت، مخفی یا ماسک می‌شوند، با قوانین قابل تنظیم برای مخفی‌سازی اطلاعات شناسایی شخصی (PII)، مدارک ورود، و اطلاعات مالکیتی. |  1  | D/V |
| 12.1.5 | اطمینان حاصل کنید که تصمیمات سیاستی و اقدامات فیلترینگ ایمنی با جزئیات کافی ثبت می‌شوند تا امکان حسابرسی و اشکال‌زدایی سیستم‌های نظارت بر محتوا فراهم گردد.                                               |  2  | D/V |
| 12.1.6 | اطمینان حاصل کنید که یکپارچگی گزارش‌ها از طریق مثلاً امضاهای رمزنگاری یا ذخیره‌سازی فقط-نوشتنی محافظت می‌شود.                                                                                             |  2  | D/V |

---

## C12.2 تشخیص سوءاستفاده و هشداردهی

|   #    | توضیحات                                                                                                                                                                                                                          | سطح | نقش |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | تأیید کنید که سیستم الگوهای شناخته شده جیلبریک، تلاش‌های تزریق درخواست و ورودی‌های دشمنانه را با استفاده از تشخیص مبتنی بر امضا شناسایی و هشدار می‌دهد.                                                                          |  1  | D/V |
| 12.2.2 | تأیید کنید که سیستم با استفاده از فرمت‌ها و پروتکل‌های استاندارد لاگ، با پلتفرم‌های موجود مدیریت اطلاعات و رویدادهای امنیتی (SIEM) یکپارچه می‌شود.                                                                               |  1  | D/V |
| 12.2.3 | تأیید کنید که رویدادهای امنیتی غنی‌شده شامل زمینه‌های خاص هوش مصنوعی مانند شناسه‌های مدل، امتیازهای اطمینان، و تصمیمات فیلتر ایمنی باشند.                                                                                        |  2  | D/V |
| 12.2.4 | تأیید کنید که تشخیص ناهنجاری رفتاری الگوهای غیرمعمول گفتگو، تلاش‌های مکرر بیش از حد، یا رفتارهای کاوش سیستماتیک را شناسایی می‌کند.                                                                                               |  2  | D/V |
| 12.2.5 | اطمینان حاصل کنید که مکانیزم‌های هشدار دهی در زمان واقعی، تیم‌های امنیتی را هنگام شناسایی نقض‌های احتمالی سیاست یا تلاش‌های حمله مطلع می‌کنند.                                                                                   |  2  | D/V |
| 12.2.6 | اطمینان حاصل کنید که قوانین سفارشی برای شناسایی الگوهای خاص تهدیدات هوش مصنوعی از جمله تلاش‌های هماهنگ شده برای دور زدن محدودیت‌ها (jailbreak)، کمپین‌های تزریق درخواست (prompt injection)، و حملات استخراج مدل گنجانده شده‌اند. |  2  | D/V |
| 12.2.7 | تأیید کنید که گردش‌کارهای واکنش خودکار به حادثه قادر به جداکردن مدل‌های به خطر افتاده، مسدود کردن کاربران مخرب و افزایش رویدادهای امنیتی حیاتی هستند.                                                                            |  3  | D/V |

---

## C12.3 تشخیص انحراف مدل

|   #    | توضیحات                                                                                                                                                   | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | اطمینان حاصل کنید که سیستم معیارهای عملکرد پایه مانند دقت، نمرات اطمینان، تأخیر، و نرخ‌های خطا را در نسخه‌های مدل و بازه‌های زمانی مختلف رصد می‌کند.      |  1  | D/V |
| 12.3.2 | تأیید کنید که هشدارهای خودکار زمانی فعال می‌شوند که معیارهای عملکرد از آستانه‌های کاهش تعریف‌شده فراتر رفته یا به‌طور قابل توجهی از خطوط پایه منحرف شوند. |  2  | D/V |
| 12.3.3 | تأیید کنید که مانیتورهای تشخیص هذیان بتوانند مواردی را که خروجی‌های مدل شامل اطلاعات نادرست، ناسازگار یا ساختگی هستند، شناسایی و علامت‌گذاری کنند.        |  2  | D/V |

---

## C12.4 داده‌کاوی عملکرد و رفتار

|   #    | توضیحات                                                                                                                                         | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.4.1 | اطمینان حاصل کنید که معیارهای عملیاتی شامل تأخیر درخواست، مصرف توکن، استفاده از حافظه، و توان عملیاتی به طور مداوم جمع‌آوری و نظارت می‌شوند.    |  1  | D/V |
| 12.4.2 | تایید کنید که نرخ‌های موفقیت و شکست با دسته‌بندی انواع خطاها و علل ریشه‌ای آنها پیگیری می‌شوند.                                                 |  1  | D/V |
| 12.4.3 | تأیید کنید که نظارت بر استفاده منابع شامل استفاده از GPU/CPU، مصرف حافظه و نیازهای ذخیره‌سازی باشد و هشدار در صورت عبور از آستانه‌ها فعال باشد. |  2  | D/V |

---

## C12.5 برنامه‌ریزی و اجرای واکنش به حادثه AI

|   #    | توضیحات                                                                                                                                                           | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | اطمینان حاصل کنید که برنامه‌های پاسخ به حادثه به‌طور خاص به رویدادهای امنیتی مرتبط با هوش مصنوعی از جمله نفوذ به مدل، آلودگی داده‌ها، و حملات خصمانه پرداخته‌اند. |  1  | D/V |
| 12.5.2 | اطمینان حاصل کنید که تیم‌های پاسخ به حادثه به ابزارهای پزشکی قانونی مخصوص هوش مصنوعی و تخصص لازم برای بررسی رفتار مدل و بردارهای حمله دسترسی دارند.               |  2  | D/V |
| 12.5.3 | تأیید کنید که تحلیل پس از حادثه شامل ملاحظات بازآموزی مدل، به‌روزرسانی فیلترهای ایمنی و ادغام درس‌های آموخته شده در کنترل‌های امنیتی است.                         |  3  | D/V |

---

## C12.5 تشخیص کاهش عملکرد هوش مصنوعی

نظارت و شناسایی کاهش عملکرد و کیفیت مدل هوش مصنوعی در طول زمان.

|   #    | توضیحات                                                                                                                                     | سطح | نقش |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | اطمینان حاصل کنید که دقت مدل، دقت (precision)، بازیابی (recall) و امتیازهای F1 به‌صورت مداوم نظارت شده و با آستانه‌های پایه مقایسه می‌شوند. |  1  | D/V |
| 12.5.2 | تأیید کنید که شناسایی تغییر داده‌ها، تغییرات توزیع ورودی را که ممکن است بر عملکرد مدل تأثیر بگذارد، نظارت می‌کند.                           |  1  | D/V |
| 12.5.3 | تأیید کنید که تشخیص تغییر مفهوم (concept drift) تغییرات در رابطه بین ورودی‌ها و خروجی‌های مورد انتظار را شناسایی می‌کند.                    |  2  | D/V |
| 12.5.4 | اطمینان حاصل کنید که کاهش عملکرد باعث فعال شدن هشدارهای خودکار شده و فرآیندهای بازآموزی یا جایگزینی مدل را آغاز می‌کند.                     |  2  | D/V |
| 12.5.5 | اطمینان حاصل کنید که تحلیل ریشه‌ای علت افت کیفیت، کاهش عملکرد را با تغییرات داده، مشکلات زیرساخت یا عوامل خارجی مرتبط می‌سازد.              |  3  |  V  |

---

## C12.6 تجسم DAG و امنیت جریان کاری

سیستم‌های تجسم جریان کاری را در برابر نشت اطلاعات و حملات دستکاری محافظت کنید.

|   #    | توضیحات                                                                                                                                                     | سطح | نقش |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.6.1 | اطمینان حاصل کنید که داده‌های تجسم گراف جهت‌دار غیر循回 (DAG) پیش از ذخیره‌سازی یا انتقال، پاک‌سازی شده و اطلاعات حساس از آن حذف شده باشد.                    |  1  | D/V |
| 12.6.2 | اطمینان حاصل کنید که کنترل‌های دسترسی به تجسم جریان کاری تنها به کاربران مجاز اجازه می‌دهند تا مسیرهای تصمیم‌گیری عامل و ردپاهای استدلال را مشاهده کنند.    |  1  | D/V |
| 12.6.3 | تأیید کنید که یکپارچگی داده‌های DAG از طریق امضاهای رمزنگاری شده و مکانیزم‌های ذخیره‌سازی قابل تشخیص تغییر محافظت می‌شود.                                   |  2  | D/V |
| 12.6.4 | اطمینان حاصل کنید که سیستم‌های نمایش جریان کاری، اعتبارسنجی ورودی را پیاده‌سازی کرده‌اند تا از حملات تزریق از طریق داده‌های ساختگی گره یا یال جلوگیری کنند. |  2  | D/V |
| 12.6.5 | تأیید کنید که به‌روزرسانی‌های DAG در زمان واقعی محدود به نرخ و معتبر شده‌اند تا از حملات انکار سرویس بر روی سیستم‌های نمایش جلوگیری شود.                    |  3  | D/V |

---

## C12.7 نظارت پیشگیرانه بر رفتار امنیتی

شناسایی و پیشگیری از تهدیدات امنیتی از طریق تحلیل رفتار پیشگیرانه عامل.

|   #    | توضیحات                                                                                                                     | سطح | نقش |
| :----: | --------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | اطمینان حاصل کنید که رفتارهای پیشگیرانه عامل قبل از اجرا با ادغام ارزیابی ریسک از نظر امنیتی تایید شده‌اند.                 |  1  | D/V |
| 12.7.2 | تأیید کنید که محرک‌های ابتکار خودمختار شامل ارزیابی زمینه امنیتی و ارزیابی چشم‌انداز تهدید می‌باشند.                        |  2  | D/V |
| 12.7.3 | اطمینان حاصل کنید که الگوهای رفتار فعال برای پیامدهای امنیتی احتمالی و عواقب ناخواسته تحلیل می‌شوند.                        |  2  | D/V |
| 12.7.4 | تأیید کنید که اقدامات پیشگیرانه بحرانی امنیتی نیازمند زنجیره‌های تصویب صریح همراه با سوابق حسابرسی هستند.                   |  3  | D/V |
| 12.7.5 | تأیید کنید که تشخیص ناهنجاری رفتاری انحرافات در الگوهای عامل پیشگیرانه را که ممکن است نشان‌دهنده نفوذ باشد، شناسایی می‌کند. |  3  | D/V |

---

## مراجع

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


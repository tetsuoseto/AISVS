# امنیت حافظه C8، جاسازی‌ها و پایگاه داده برداری

## هدف کنترل

تعبیه‌ها و فروشگاه‌های برداری به‌عنوان «حافظه زنده» سیستم‌های هوش مصنوعی معاصر عمل می‌کنند و به‌طور مداوم داده‌های ارائه شده توسط کاربران را دریافت کرده و از طریق تولید تقویت‌شده با بازیابی (Retrieval-Augmented Generation - RAG) آن‌ها را دوباره در زمینه‌های مدل نشان می‌دهند. اگر این حافظه بدون کنترل رها شود، ممکن است اطلاعات شخصی قابل شناسایی (PII) نشت کند، رضایت نقض شود یا با معکوس‌سازی متن اصلی بازسازی شود. هدف این خانواده از کنترل‌ها، تقویت خطوط لوله حافظه و پایگاه‌های داده برداری است تا دسترسی با کمترین امتیاز باشد، تعبیه‌ها حفظ حریم خصوصی را تضمین کنند، بردارهای ذخیره‌شده منقضی شده یا به‌صورت درخواست‌شده لغو شوند و حافظه هر کاربر هرگز باعث آلودگی درخواست‌ها یا تکمیل‌های کاربر دیگر نشود.

---

## C8.1 کنترل‌های دسترسی در حافظه و شاخص‌های RAG

اجرای کنترل‌های دسترسی دقیق برای هر مجموعه وکتور.

|   #   | توضیحات                                                                                                                                                                           | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.1.1 | بررسی کنید که قوانین کنترل دسترسی در سطح ردیف/نام‌فضا عملیات‌های درج، حذف و پرس‌وجو را برای هر مستأجر، مجموعه یا برچسب سند محدود می‌کنند.                                         |  1  | D/V |
| 8.1.2 | اطمینان حاصل کنید که کلیدهای API یا JWTها دارای ادعاهای محدوده‌دار (مانند شناسه‌های مجموعه، افعال عملیاتی) هستند و حداقل هر سه ماه یکبار چرخش داده می‌شوند.                       |  1  | D/V |
| 8.1.3 | اطمینان حاصل کنید که تلاش‌های ارتقای دسترسی (مانند درخواست‌های مشابهت بین فضای نام‌ها) در عرض ۵ دقیقه شناسایی و به سامانه مدیریت اطلاعات و رویدادهای امنیتی (SIEM) گزارش می‌شوند. |  2  | D/V |
| 8.1.4 | اطمینان حاصل کنید که پایگاه داده برداری سوابق ممیزی شامل شناسه موضوع، عملیات، شناسه بردار/نام‌فضا، آستانه شباهت و تعداد نتایج را ثبت می‌کند.                                      |  2  | D/V |
| 8.1.5 | اطمینان حاصل کنید که تصمیمات دسترسی هر زمان که موتور‌ها به‌روزرسانی می‌شوند یا قوانین تقسیم‌بندی شاخص تغییر می‌کنند، برای وجود نقص‌های دورزدن آزمایش شوند.                        |  3  |  V  |

---

## C8.2 پاک‌سازی و اعتبارسنجی جاسازی

متن را برای اطلاعات شناسایی شخصی (PII) پیش‌غربالگری کنید، قبل از بردارسازی آن را محرمانه یا نماینده‌سازی کنید، و در صورت نیاز پس‌پردازش تعبیه‌ها را برای حذف سیگنال‌های باقی‌مانده انجام دهید.

|   #   | توضیحات                                                                                                                                                                                        | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.2.1 | تأیید کنید که داده‌های شخصی قابل شناسایی (PII) و داده‌های تنظیم‌شده از طریق طبقه‌بندی‌کننده‌های خودکار شناسایی شده و پیش از جاسازی، ماسک شده، توکنیزه شده یا حذف می‌شوند.                      |  1  | D/V |
| 8.2.2 | اطمینان حاصل کنید که خطوط لوله امبدینگ ورودی‌هایی که حاوی کد اجرایی یا آثار غیر UTF-8 هستند و ممکن است شاخص را مسموم کنند، رد یا قرنطینه می‌کنند.                                              |  1  |  D  |
| 8.2.3 | تأیید کنید که پاک‌سازی با حفظ حریم خصوصی محلی یا متریکی به بردارهای جاسازی جمله اعمال شده است که فاصله آنها تا هر توکن شناخته‌شده‌ی اطلاعات شخصی حساس (PII) کمتر از یک آستانه قابل تنظیم باشد. |  2  | D/V |
| 8.2.4 | تأیید کنید که اثربخشی تصفیه‌سازی (مانند بازیابی حذف اطلاعات شناسایی شخصی، تغییر معنایی) حداقل به صورت نیم‌سالانه در برابر مجموعه‌های معیار ارزیابی شود.                                        |  2  |  V  |
| 8.2.5 | اطمینان حاصل کنید که تنظیمات پاکسازی تحت کنترل نسخه هستند و تغییرات تحت بازبینی همتا قرار می‌گیرند.                                                                                            |  3  | D/V |

---

## C8.3 انقضای حافظه، لغو و حذف

قانون GDPR درباره «حق فراموش شدن» و قوانین مشابه، نیازمند پاک‌سازی به موقع است؛ بنابراین، فروشگاه‌های برداری باید از TTLها، حذف کامل و علامت‌گذاری به‌عنوان حذف شده پشتیبانی کنند تا بردارهای لغوشده قابل بازیابی یا بازنمایه‌سازی نباشند.

|   #   | توضیحات                                                                                                                                                  | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.3.1 | اطمینان حاصل کنید که هر رکورد وکتور و متادیتا دارای یک TTL یا برچسب نگهداری صریح است که توسط وظایف پاکسازی خودکار رعایت می‌شود.                          |  1  | D/V |
| 8.3.2 | تأیید کنید که درخواست‌های حذف توسط کاربر، بردارها، فراداده‌ها، نسخه‌های کش و شاخص‌های مشتق شده را ظرف 30 روز پاک می‌کنند.                                |  1  | D/V |
| 8.3.3 | اطمینان حاصل کنید که حذف‌های منطقی با پاک‌سازی رمزنگاری شده بلوک‌های ذخیره‌سازی در صورت پشتیبانی سخت‌افزار، یا با تخریب کلید در مخزن کلید دنبال می‌شوند. |  2  |  D  |
| 8.3.4 | اطمینان حاصل کنید که بردارهای منقضی شده ظرف کمتر از 500 میلی‌ثانیه پس از انقضا از نتایج جستجوی نزدیک‌ترین همسایه حذف می‌شوند.                            |  3  | D/V |

---

## C8.4 جلوگیری از معکوس‌سازی و نشت جاسازی

دفاع‌های اخیر—جمع‌گذاری نویز، شبکه‌های پروجکشن، تغییر نورون حفظ حریم خصوصی، و رمزنگاری لایه برنامه—می‌توانند نرخ معکوس‌سازی در سطح توکن را به کمتر از ۵٪ کاهش دهند.

|   #   | توضیحات                                                                                                                                                         | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.4.1 | اطمینان حاصل کنید که یک مدل تهدید رسمی که شامل حملات وارونگی، عضویت و استنتاج ویژگی‌ها باشد، وجود دارد و به صورت سالانه بازبینی می‌شود.                         |  1  |  V  |
| 8.4.2 | تأیید کنید که رمزنگاری در لایه کاربرد یا رمزنگاری قابل جستجو، بردارها را از خوانش مستقیم توسط مدیران زیرساخت یا کارکنان ابر محافظت می‌کند.                      |  2  | D/V |
| 8.4.3 | اطمینان حاصل کنید که پارامترهای دفاعی (ε برای DP، نویز σ، رتبه‌ی پرجکشن k) تعادل بین حفظ حریم خصوصی ≥ ۹۹٪ حفاظت از توکن و بهره‌وری ≤ ۳٪ افت دقت را برقرار کنند. |  3  |  V  |
| 8.4.4 | اطمینان حاصل کنید که معیارهای مقاومت در برابر وارونگی بخشی از دروازه‌های انتشار برای به‌روزرسانی مدل‌ها هستند و بودجه‌های رگرسیون تعریف شده‌اند.                |  3  | D/V |

---

## اجرای دامنه C8.5 برای حافظهٔ خاص کاربر

نشت بین مستاجران همچنان یکی از خطرات اصلی RAG است: پرس‌وجوهای اشتباه در فیلتر شباهت می‌توانند اسناد خصوصی مشتری دیگری را آشکار کنند.

|   #   | توضیحات                                                                                                                                                                     | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.5.1 | اطمینان حاصل کنید که هر پرس‌وجوی بازیابی پیش از ارسال به درخواست LLM، بر اساس شناسه مستاجر/کاربر پس از فیلتر شدن باشد.                                                      |  1  | D/V |
| 8.5.2 | اطمینان حاصل کنید که نام مجموعه‌ها یا شناسه‌های دارای فضای نام به ازای هر کاربر یا مستاجر به صورت salted شده باشند تا بردارها در سطح دامنه‌ها تداخل نکنند.                  |  1  |  D  |
| 8.5.3 | اطمینان حاصل کنید که نتایج شباهت بالاتر از آستانه فاصله قابل پیکربندی اما خارج از دامنه مراجعه‌کننده کنار گذاشته شده و هشدارهای امنیتی ایجاد می‌کنند.                       |  2  | D/V |
| 8.5.4 | تأیید کنید که تست‌های فشار چند مستأجره شبیه‌سازی درخواست‌های خصمانه‌ای هستند که تلاش می‌کنند اسناد خارج از حوزه را بازیابی کنند و نشان دهند که هیچ نشت اطلاعاتی رخ نمی‌دهد. |  2  |  V  |
| 8.5.5 | اطمینان حاصل کنید که کلیدهای رمزگذاری به ازای هر مستأجر جدا شده‌اند، به طوری که جداسازی رمزنگاری حتی در صورت اشتراک‌گذاری فضای ذخیره‌سازی فیزیکی حفظ شود.                   |  3  | D/V |

---

## C8.6 امنیت پیشرفته سیستم حافظه

کنترل‌های امنیتی برای معماری‌های پیچیده حافظه شامل حافظه اپیزودیک، معنایی و کاری با نیازهای خاص ایزوله‌سازی و اعتبارسنجی.

|   #   | توضیحات                                                                                                                                                                                                                  | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 8.6.1 | تأیید کنید که انواع مختلف حافظه (اپیزودیک، معنایی، کاری) دارای زمینه‌های امنیتی جداگانه با کنترل‌های دسترسی مبتنی بر نقش، کلیدهای رمزنگاری جداگانه و الگوهای دسترسی مستند شده برای هر نوع حافظه باشند.                   |  1  | D/V |
| 8.6.2 | اطمینان حاصل کنید که فرآیندهای تثبیت حافظه شامل اعتبارسنجی امنیتی برای جلوگیری از تزریق خاطرات مخرب از طریق پاک‌سازی محتوا، تأیید منبع و بررسی‌های صحت قبل از ذخیره‌سازی هستند.                                          |  2  | D/V |
| 8.6.3 | اطمینان حاصل کنید که پرس‌وجوهای بازیابی حافظه اعتبارسنجی و پاکسازی شده‌اند تا از استخراج اطلاعات غیرمجاز از طریق تحلیل الگوی پرس‌وجو، اجرای کنترل دسترسی و فیلتر کردن نتایج جلوگیری شود.                                 |  2  | D/V |
| 8.6.4 | اطمینان حاصل کنید که مکانیسم‌های فراموشی حافظه اطلاعات حساس را به‌صورت ایمن با تضمین‌های پاک‌سازی رمزنگاری‌شده حذف می‌کنند، از طریق حذف کلید، بازنویسی چندباره، یا حذف ایمن مبتنی بر سخت‌افزار همراه با گواهی‌های تایید. |  3  | D/V |
| 8.6.5 | تأیید کنید که یکپارچگی سیستم حافظه به طور مداوم برای تغییرات یا خرابی‌های غیرمجاز از طریق چکسام‌ها، لاگ‌های حسابرسی، و هشدارهای خودکار هنگام تغییر محتوای حافظه خارج از عملیات عادی کنترل می‌شود.                        |  3  | D/V |

---

## مراجع

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)


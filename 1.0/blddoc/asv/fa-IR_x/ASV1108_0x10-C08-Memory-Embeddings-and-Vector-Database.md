# امنیت حافظه C8، تعبیه‌ها و پایگاه داده‌های برداری

## هدف کنترل

تعبیه‌ها و فروشگاه‌های برداری به‌عنوان «حافظه زنده» سیستم‌های هوش مصنوعی معاصر عمل می‌کنند، به‌طور مستمر داده‌های ارائه شده توسط کاربر را دریافت کرده و از طریق تولید تقویت‌شده با بازیابی (RAG) آن‌ها را دوباره در زمینه‌های مدل نمایش می‌دهند. اگر این حافظه بدون نظارت باقی بماند، ممکن است اطلاعات شناسایی شخصی (PII) را نشت دهد، رضایت را نقض کند یا به‌صورت معکوس برای بازسازی متن اصلی استفاده شود. هدف این خانواده کنترل‌ها، تقویت خطوط انتقال حافظه و پایگاه‌های داده برداری است به‌گونه‌ای که دسترسی حداقل مجاز باشد، تعبیه‌ها حریم خصوصی را حفظ کنند، بردارهای ذخیره‌شده منقضی شوند یا در صورت درخواست لغو شوند، و حافظه هر کاربر هرگز باعث آلودگی پیام‌ها یا تکمیل‌های کاربران دیگر نشود.

---

## C8.1 کنترل‌های دسترسی بر حافظه و شاخص‌های RAG

اجرای کنترل‌های دسترسی دقیق و ریزبر به هر مجموعه برداری.

|   #   | توضیحات                                                                                                                                                                       | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.1.1 | تأیید کنید که قوانین کنترل دسترسی در سطح ردیف/ Namespace، عملیات درج، حذف و پرس‌وجو را برای هر مستاجر، مجموعه یا برچسب سند محدود می‌کنند.                                     |  1  | D/V |
| 8.1.2 | اطمینان حاصل کنید که کلیدهای API یا JWT دارای ادعاهای محدودشده (مانند شناسه‌های مجموعه، افعال عملیاتی) هستند و حداقل هر سه ماه یکبار تعویض می‌شوند.                           |  1  | D/V |
| 8.1.3 | تأیید کنید که تلاش‌های افزایش امتیاز (مانند کوئری‌های تشابه در میان فضاهای نام مختلف) شناسایی شده و ظرف ۵ دقیقه به سیستم مدیریت اطلاعات و رویدادهای امنیتی (SIEM) گزارش شوند. |  2  | D/V |
| 8.1.4 | بررسی کنید که پایگاه داده برداری گزارش‌های ممیزی شامل شناسه موضوع، عملیات، شناسه بردار/فضای نام، آستانه شباهت و تعداد نتایج را ثبت می‌کند.                                    |  2  | D/V |
| 8.1.5 | اطمینان حاصل کنید که تصمیمات دسترسی برای نقص‌های دورزدن هرگاه موتور‌ها به‌روزرسانی می‌شوند یا قوانین تقسیم‌بندی شاخص تغییر می‌کنند، آزمایش می‌شوند.                           |  3  |  V  |

---

## C8.2 پاک‌سازی و اعتبارسنجی جاسازی‌ها

متن را برای اطلاعات شناسایی شخصی (PII) پیش‌غربالگری کنید، قبل از تبدیل به بردار، آن را سانسور یا شبه‌نام‌گذاری کنید و در صورت تمایل پس از پردازش تعبیه‌ها، سیگنال‌های باقی‌مانده را حذف کنید.

|   #   | توضیحات                                                                                                                                                                                             | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.2.1 | تأیید کنید که داده‌های شناسایی شخصی (PII) و داده‌های تنظیم‌شده از طریق طبقه‌بندهای خودکار شناسایی شده و پیش از جاسازی، به صورت ماسک‌شده، توکنیزه شده یا حذف شده باشند.                              |  1  | D/V |
| 8.2.2 | اطمینان حاصل کنید که پایپلاین‌های تعبیه‌سازی ورودی‌هایی که حاوی کد اجرایی یا آثار غیر UTF-8 هستند و ممکن است ایندکس را آلوده کنند، رد یا قرنطینه می‌کنند.                                           |  1  |  D  |
| 8.2.3 | اطمینان حاصل کنید که پاک‌سازی حریم خصوصی تفاضلی محلی یا متریکی روی تعبیه‌های جمله‌ای اعمال شده است که فاصله‌شان با هر توکن شناخته‌شده اطلاعات شناسایی شخصی (PII) کمتر از یک آستانه قابل تنظیم باشد. |  2  | D/V |
| 8.2.4 | تأیید کنید که اثربخشی پاک‌سازی (مثلاً بازیابی حذف اطلاعات شناسایی شخصی، انحراف معنایی) حداقل نیم‌سالانه بر اساس متون معیار ارزیابی شود.                                                             |  2  |  V  |
| 8.2.5 | اطمینان حاصل کنید که تنظیمات پاک‌سازی تحت کنترل نسخه قرار دارند و تغییرات آن‌ها مورد بازبینی همتا قرار می‌گیرد.                                                                                     |  3  | D/V |

---

## C8.3 انقضای حافظه، لغو و حذف

قوانین GDPR مبنی بر «حق فراموش شدن» و قوانین مشابه، نیاز به حذف به موقع دارند؛ بنابراین فروشگاه‌های وکتور باید از TTLها، حذف‌های سخت و تدفین (tomb-stoning) پشتیبانی کنند تا وکتورهای لغو شده قابل بازیابی یا دوباره نمایه‌سازی نباشند.

|   #   | توضیحات                                                                                                                                                                   | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.3.1 | اطمینان حاصل کنید که هر رکورد بردار و فراداده دارای یک TTL یا برچسب نگهداری صریح است که توسط وظایف پاک‌سازی خودکار رعایت می‌شود.                                          |  1  | D/V |
| 8.3.2 | اطمینان حاصل کنید که درخواست‌های حذف شده توسط کاربر، بردارها، فراداده‌ها، نسخه‌های کش و شاخص‌های مشتق شده را ظرف 30 روز پاک می‌کنند.                                      |  1  | D/V |
| 8.3.3 | اطمینان حاصل کنید که حذف‌های منطقی پس از آن با تخریب رمزنگاری‌شده بلوک‌های ذخیره‌سازی در صورتی که سخت‌افزار از آن پشتیبانی کند، یا با نابودی کلیدهای مخزن کلید انجام شود. |  2  |  D  |
| 8.3.4 | تأیید کنید که بردارهای منقضی‌شده ظرف کمتر از ۵۰۰ میلی‌ثانیه پس از انقضا از نتایج جستجوی نزدیک‌ترین همسایه حذف می‌شوند.                                                    |  3  | D/V |

---

## C8.4 جلوگیری از معکوس‌سازی جاسازی و نشت‌ها

دفاع‌های اخیر—هم‌پوشانی نویز، شبکه‌های نگاشت، برهم‌نهی نورون حریم خصوصی، و رمزگذاری لایه کاربرد—می‌توانند نرخ‌های معکوس‌سازی در سطح توکن را به زیر 5% برسانند.

|   #   | توضیحات                                                                                                                                                    | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.4.1 | تأیید کنید که یک مدل تهدید رسمی که حملات معکوس، عضویت و استنتاج ویژگی‌ها را پوشش می‌دهد، وجود دارد و هر سال بازبینی می‌شود.                                |  1  |  V  |
| 8.4.2 | اطمینان حاصل کنید که رمزنگاری در سطح لایه برنامه یا رمزنگاری قابل جستجو، بردارها را از خوانش مستقیم توسط مدیران زیرساخت یا کارکنان ابر محافظت می‌کند.      |  2  | D/V |
| 8.4.3 | تأیید کنید که پارامترهای دفاعی (ε برای DP، نویز σ، رتبه پروجکشن k) تعادل بین حریم خصوصی ≥ ۹۹٪ حفاظت از توکن و کاربردپذیری ≤ ۳٪ کاهش دقت را برقرار می‌کنند. |  3  |  V  |
| 8.4.4 | اطمینان حاصل کنید که معیارهای مقاومت در برابر وارونگی بخشی از دروازه‌های انتشار برای به‌روزرسانی‌های مدل هستند، همراه با بودجه‌های رگرسیون تعریف‌شده.      |  3  | D/V |

---

## C8.5 اعمال محدودیت برای حافظه اختصاصی کاربر

نشت اطلاعات میان مستاجرها همچنان یکی از مهم‌ترین ریسک‌های RAG است: کوئری‌های شباهت که به درستی فیلتر نشده باشند می‌توانند اسناد خصوصی مشتری دیگر را نشان دهند.

|   #   | توضیحات                                                                                                                                                                  | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 8.5.1 | اطمینان حاصل کنید که هر پرس و جوی بازیابی قبل از ارسال به پیشنهاد LLM، توسط شناسه مستأجر/کاربر پس پردازش می‌شود.                                                         |  1  | D/V |
| 8.5.2 | تأیید کنید که نام‌های مجموعه یا شناسه‌های نام‌فضا شده به ازای هر کاربر یا مستأجر به صورت نمک‌دار (salted) باشند تا بردارها در محدوده‌های مختلف تداخل نداشته باشند.       |  1  |  D  |
| 8.5.3 | تأیید کنید که نتایج شباهت بالاتر از آستانه فاصله قابل تنظیم اما خارج از حوزه تماس‌گیرنده حذف شده و هشدارهای امنیتی را فعال می‌کنند.                                      |  2  | D/V |
| 8.5.4 | تأیید کنید که تست‌های فشار چند مستاجمی شبیه‌سازی پرسش‌های خصمانه‌ای هستند که تلاش می‌کنند اسناد خارج از حوزه را بازیابی کنند و نشان دهند که هیچ نشت اطلاعاتی وجود ندارد. |  2  |  V  |
| 8.5.5 | اطمینان حاصل کنید که کلیدهای رمزنگاری به‌طور جداگانه برای هر مستاجر تفکیک شده‌اند، تا جداسازی رمزنگاری حتی در صورت اشتراک ذخیره‌سازی فیزیکی تضمین شود.                   |  3  | D/V |

---

## C8.6 امنیت پیشرفته سیستم حافظه

کنترل‌های امنیتی برای معماری‌های پیچیده حافظه از جمله حافظه اپیزودیک، معنایی و کاری با نیازهای خاص ایزولاسیون و اعتبارسنجی.

|   #   | توضیحات                                                                                                                                                                                                                     | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.6.1 | تأیید کنید که انواع مختلف حافظه (اپیزودیک، معنایی، کاری) دارای زمینه‌های امنیتی مجزا با کنترل‌های دسترسی مبتنی بر نقش، کلیدهای رمزگذاری مجزا و الگوهای دسترسی مستندسازی شده برای هر نوع حافظه هستند.                        |  1  | D/V |
| 8.6.2 | اطمینان حاصل کنید که فرآیندهای تثبیت حافظه شامل اعتبارسنجی امنیتی برای جلوگیری از تزریق حافظه‌های مخرب از طریق پاک‌سازی محتوا، تأیید منبع و بررسی‌های صحت قبل از ذخیره‌سازی می‌باشند.                                       |  2  | D/V |
| 8.6.3 | اطمینان حاصل کنید که پرس‌وجوهای بازیابی حافظه اعتبارسنجی و پاک‌سازی می‌شوند تا از استخراج اطلاعات غیرمجاز از طریق تحلیل الگوهای پرس‌وجو، اعمال کنترل دسترسی و فیلتر کردن نتایج جلوگیری شود.                                 |  2  | D/V |
| 8.6.4 | تأیید کنید که مکانیزم‌های فراموشی حافظه اطلاعات حساس را با تضمین‌های حذف رمزنگاری شده به‌صورت ایمن حذف می‌کنند، از جمله حذف کلید، بازنویسی چند مرحله‌ای، یا حذف ایمن مبتنی بر سخت‌افزار همراه با گواهی‌های تأیید.           |  3  | D/V |
| 8.6.5 | تأیید کنید که یکپارچگی سیستم حافظه به طور مداوم برای تغییرات غیرمجاز یا فساد از طریق جمع‌های کنترلی (checksum)، گزارش‌های بازرسی (audit logs)، و هشدارهای خودکار هنگام تغییر محتوای حافظه خارج از عملیات عادی، پایش می‌شود. |  3  | D/V |

---

## مراجع

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)


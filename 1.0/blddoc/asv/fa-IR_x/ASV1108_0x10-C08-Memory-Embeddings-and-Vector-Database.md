# امنیت حافظه C8، تعبیه‌ها و پایگاه داده‌های برداری

## هدف کنترل

تعبیه‌ها و فروشگاه‌های برداری به عنوان "حافظه زنده" سیستم‌های هوش مصنوعی معاصر عمل می‌کنند که به طور مداوم داده‌های ارائه شده توسط کاربر را می‌پذیرند و آن‌ها را از طریق تولید تقویت‌شده با بازیابی (RAG) به بستر مدل بازمی‌گردانند. اگر این حافظه بدون کنترل رها شود، ممکن است اطلاعات شناسایی شخصی (PII) نشت کند، رضایت نقض شود یا بتواند برای بازسازی متن اصلی معکوس شود. هدف این خانواده کنترل، سخت‌کردن خط‌های لوله حافظه و پایگاه‌های داده برداری است به طوری که دسترسی با حداقل امتیاز باشد، تعبیه‌ها حفظ حریم خصوصی را تضمین کنند، بردارهای ذخیره‌شده منقضی شوند یا در صورت درخواست قابل لغو باشند، و حافظه کاربر به صورت جداگانه از داده‌های دیگر کاربران محافظت شود تا هیچ آلودگی در پرسش‌ها یا تکمیل‌های دیگر کاربران رخ ندهد.

---

## C8.1 کنترل‌های دسترسی بر حافظه و نمایه‌های RAG

اجرای کنترل‌های دسترسی دقیق و جزئی بر روی هر مجموعه برداری.

|   #   | توضیحات                                                                                                                                                                           | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.1.1 | تأیید کنید که قوانین کنترل دسترسی در سطح ردیف/فضای نام، عملیات درج، حذف و پرس‌وجو را بر اساس مستاجر، مجموعه یا برچسب سند محدود می‌کنند.                                           |  1  | D/V |
| 8.1.2 | اطمینان حاصل کنید که کلیدهای API یا JWT دارای ادعاهای محدوده‌دار (مانند شناسه‌های مجموعه، افعال عملیاتی) هستند و حداقل هر سه ماه یکبار تعویض می‌شوند.                             |  1  | D/V |
| 8.1.3 | اطمینان حاصل کنید که تلاش‌های افزایش دسترسی (مثلاً پرس‌وجوهای مشابهت در فضای نام‌های مختلف) طی ۵ دقیقه شناسایی و در یک سیستم مدیریت اطلاعات و رویدادهای امنیتی (SIEM) ثبت شوند.   |  2  | D/V |
| 8.1.4 | بررسی کنید که پایگاه داده برداری (vector DB) سوابق ممیزی شامل شناسه موضوع، عملیات، شناسه/نام فضای بردار، آستانه شباهت، و تعداد نتایج را ثبت کند.                                  |  2  | D/V |
| 8.1.5 | اطمینان حاصل کنید که تصمیمات دسترسی به منظور بررسی نقص‌های عبور (bypass flaws) هر زمان که موتور‌ها به‌روزرسانی می‌شوند یا قوانین تقسیم‌بندی ایندکس تغییر می‌کنند، آزمایش می‌شوند. |  3  |  V  |

---

## C8.2 پاکسازی و اعتبارسنجی جاسازی‌ها

متن را قبل از بردارسازی برای اطلاعات شناسایی شخصی (PII) پیش‌پردازش کنید، آن را حذف یا شبه‌نام‌گذاری کنید و به طور اختیاری پس از بردارسازی، تعبیه‌ها را پردازش کنید تا سیگنال‌های باقیمانده حذف شوند.

|   #   | توضیحات                                                                                                                                                                                    | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 8.2.1 | اطمینان حاصل کنید که داده‌های شخصی شناسایی‌پذیر (PII) و داده‌های تنظیم‌شده توسط طبقه‌بندهای خودکار شناسایی شده و پیش از جاسازی، به صورت ماسک شده، توکنیزه شده یا حذف شده‌اند.              |  1  | D/V |
| 8.2.2 | اطمینان حاصل کنید که خطوط پردازش تعبیه‌ها ورودی‌هایی که حاوی کد اجرایی یا آثار غیر UTF-8 هستند و می‌توانند اندیس را مسموم کنند را رد یا قرنطینه می‌کنند.                                   |  1  |  D  |
| 8.2.3 | تأیید کنید که پاک‌سازی حریم خصوصی تفاضلی محلی یا معیار به تعبیه‌های جمله اعمال شده باشد که فاصله آن‌ها با هر توکن اطلاعات شناسایی شخصی (PII) شناخته شده کمتر از یک آستانه قابل تنظیم باشد. |  2  | D/V |
| 8.2.4 | تأیید کنید که اثربخشی پاک‌سازی (مثلاً یادآوری حذف اطلاعات شخصی حساس، انحراف معنایی) حداقل هر شش ماه یک‌بار بر اساس مجموعه‌های مرجع ارزیابی می‌شود.                                         |  2  |  V  |
| 8.2.5 | اطمینان حاصل کنید که پیکربندی‌های پاکسازی تحت کنترل نسخه هستند و تغییرات آن‌ها تحت بررسی همتا قرار می‌گیرد.                                                                                |  3  | D/V |

---

## C8.3 انقضای حافظه، لغو و حذف

قانون GDPR درباره «حق فراموش شدن» و قوانین مشابه نیازمند پاک‌سازی به موقع است؛ بنابراین، فروشگاه‌های وکتور باید از TTLها، حذف‌های سخت و تخریب تدریجی پشتیبانی کنند تا وکتورهای لغو شده نتوانند بازیابی یا دوباره فهرست‌بندی شوند.

|   #   | توضیحات                                                                                                                                           | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.3.1 | تأیید کنید که هر وکتور و رکورد متادیتا برچسب TTL یا نگهداری صریحی دارد که توسط عملیات پاک‌سازی خودکار رعایت می‌شود.                               |  1  | D/V |
| 8.3.2 | تأیید کنید که درخواست‌های حذف شده توسط کاربر، بردارها، فراداده‌ها، نسخه‌های کش و شاخص‌های مشتق شده را ظرف 30 روز پاکسازی می‌کنند.                 |  1  | D/V |
| 8.3.3 | تأیید کنید که حذف‌های منطقی با از بین بردن رمزنگاری‌شده بلوک‌های ذخیره‌سازی در صورت پشتیبانی سخت‌افزار، یا با تخریب کلید در کلیدخانه همراه هستند. |  2  |  D  |
| 8.3.4 | اطمینان حاصل کنید که بردارهای منقضی شده در کمتر از 500 میلی‌ثانیه پس از انقضا از نتایج جستجوی نزدیک‌ترین همسایه حذف می‌شوند.                      |  3  | D/V |

---

## C8.4 جلوگیری از وارونگی و نشت جاسازی

دفاع‌های اخیر—تقویت نویز، شبکه‌های پروجکشن، اختلال نورون حریم خصوصی، و رمزگذاری در لایه برنامه—می‌توانند نرخ معکوس‌سازی در سطح توکن را به کمتر از ۵٪ کاهش دهند.

|   #   | توضیحات                                                                                                                                                     | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.4.1 | اطمینان حاصل کنید که مدل تهدید رسمی شامل حملات وارونگی، عضویت و استنباط ویژگی وجود دارد و سالانه بررسی می‌شود.                                              |  1  |  V  |
| 8.4.2 | تأیید کنید که رمزگذاری در لایه برنامه یا رمزگذاری قابل جستجو، بردارها را از خوانش مستقیم توسط مدیران زیرساخت یا کارکنان ابر محافظت می‌کند.                  |  2  | D/V |
| 8.4.3 | اطمینان حاصل کنید که پارامترهای دفاعی (ε برای DP، نویز σ، رتبه تصویر k) تعادلی بین حفظ حریم خصوصی ≥ ۹۹٪ حفاظت از توکن و بهره‌وری ≤ ۳٪ کاهش دقت برقرار کنند. |  3  |  V  |
| 8.4.4 | اطمینان حاصل کنید که معیارهای مقاومت در برابر وارونگی جزئی از دروازه‌های انتشار به‌روزرسانی مدل هستند، با بودجه‌های رگرسیون مشخص شده.                       |  3  | D/V |

---

## C8.5 اجرای محدوده برای حافظه مختص به کاربر

نشت بین مشتریان مختلف هنوز هم یکی از بزرگ‌ترین ریسک‌های RAG است: جستجوهای شبیه‌سازی به‌طور نادرست فیلتر شده می‌تواند اسناد خصوصی مشتری دیگری را نمایش دهد.

|   #   | توضیحات                                                                                                                                                       | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.5.1 | تأیید کنید که هر پرس‌و‌جوی بازیابی قبل از ارسال به درخواست LLM، توسط شناسه مستاجر/کاربر پس‌پردازش (post-filter) شده باشد.                                     |  1  | D/V |
| 8.5.2 | اطمینان حاصل کنید که نام‌های مجموعه یا شناسه‌های فضای نام‌گذاری شده به ازای هر کاربر یا مستأجر جدا شده‌اند تا بردارها در سطوح مختلف با هم تداخل نداشته باشند. |  1  |  D  |
| 8.5.3 | تأیید کنید که نتایج شباهت بالاتر از یک آستانه فاصله قابل تنظیم اما خارج از حوزه تماس‌گیرنده، رد شده و هشدارهای امنیتی را فعال می‌کنند.                        |  2  | D/V |
| 8.5.4 | تأیید کنید که آزمایش‌های فشار چند مستاجری، پرسش‌های خصمانه‌ای که تلاش می‌کنند اسناد خارج از حوزه را بازیابی کنند شبیه‌سازی می‌کنند و نشت صفر را نشان می‌دهند. |  2  |  V  |
| 8.5.5 | اطمینان حاصل کنید که کلیدهای رمزگذاری به ازای هر مستأجر جدا شده‌اند، به گونه‌ای که جداسازی رمزنگاری حتی در صورت اشتراک‌گذاری ذخیره‌سازی فیزیکی برقرار باشد.   |  3  | D/V |

---

## C8.6 امنیت پیشرفته سامانه حافظه

کنترل‌های امنیتی برای معماری‌های پیچیده حافظه شامل حافظه اپیزودیک، معنایی و کاری با نیازهای خاص جداسازی و اعتبارسنجی.

|   #   | توضیحات                                                                                                                                                                                                      | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 8.6.1 | اطمینان حاصل کنید که انواع مختلف حافظه (اپیزودیک، معنایی، کاری) دارای زمینه‌های امنیتی مجزا با کنترل‌های دسترسی مبتنی بر نقش، کلیدهای رمزنگاری جداگانه، و الگوهای دسترسی مستند شده برای هر نوع حافظه هستند.  |  1  | D/V |
| 8.6.2 | اطمینان حاصل کنید که فرآیندهای تثبیت حافظه شامل اعتبارسنجی امنیتی برای جلوگیری از تزریق خاطرات مخرب از طریق تصفیه محتوا، تأیید منبع و بررسی‌های صحت قبل از ذخیره‌سازی می‌باشد.                               |  2  | D/V |
| 8.6.3 | تأیید کنید که پرس‌وجوهای بازیابی حافظه اعتبارسنجی و پاک‌سازی شده‌اند تا از استخراج اطلاعات غیرمجاز از طریق تحلیل الگوی پرس‌وجو، اعمال کنترل دسترسی و فیلتر کردن نتایج جلوگیری شود.                           |  2  | D/V |
| 8.6.4 | اطمینان حاصل کنید که مکانیزم‌های فراموشی حافظه اطلاعات حساس را با تضمین‌های حذف رمزنگاری‌شده به‌طور ایمن حذف می‌کنند، از جمله حذف کلید، بازنویسی چندباره، یا حذف ایمن مبتنی بر سخت‌افزار با گواهی‌های تأیید. |  3  | D/V |
| 8.6.5 | تأیید کنید که صحت سیستم حافظه به طور مداوم برای تغییرات یا فساد غیرمجاز از طریق بررسی چک‌سام‌ها، گزارش‌های حسابرسی و هشدارهای خودکار در صورت تغییر محتوای حافظه خارج از عملیات معمول، تحت نظارت قرار دارد.   |  3  | D/V |

---

## مراجع

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)


# امنیت حافظه C8، تعبیه‌ها و پایگاه داده برداری

## هدف کنترل

جاسازی‌ها و فروشگاه‌های برداری به‌عنوان «حافظه زنده» سیستم‌های هوش مصنوعی معاصر عمل می‌کنند، که به‌طور مداوم داده‌های ارائه شده توسط کاربر را دریافت کرده و از طریق تولید تقویت‌شده با بازیابی (RAG) آن‌ها را به زمینه‌های مدل باز می‌گردانند. اگر این حافظه بدون کنترل رها شود، ممکن است اطلاعات شناسایی شخصی (PII) را فاش کند، رضایت را نقض کند یا به صورت معکوس مورد استفاده قرار گیرد تا متن اصلی را بازسازی کند. هدف این خانواده کنترل، سخت‌سازی خطوط لوله حافظه و پایگاه‌های داده برداری است به‌طوری‌که دسترسی کمترین امتیاز لازم را داشته باشد، جاسازی‌ها حریم خصوصی را حفظ کنند، بردارهای ذخیره شده منقضی شوند یا در صورت درخواست قابل لغو باشند، و حافظه هر کاربر هرگز باعث آلودگی درخواست‌ها یا پاسخ‌های کاربر دیگر نشود.

---

## C8.1 کنترل‌های دسترسی بر حافظه و شاخص‌های RAG

اجرای کنترل‌های دسترسی دقیق و جزئی بر روی هر مجموعه برداری.

|   #   | توضیحات                                                                                                                                                                           | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.1.1 | تأیید کنید که قوانین کنترل دسترسی در سطح ردیف/فضای نام، عملیات‌های درج، حذف و پرس‌وجو را بر اساس مستاجر، مجموعه یا برچسب سند محدود می‌کنند.                                       |  1  | D/V |
| 8.1.2 | اطمینان حاصل کنید که کلیدهای API یا JWT ها شامل ادعاهای محدوده‌دار (مانند شناسه‌های مجموعه، افعال عملیاتی) هستند و حداقل هر سه ماه یکبار تعویض می‌شوند.                           |  1  | D/V |
| 8.1.3 | اطمینان حاصل کنید که تلاش‌های ارتقای دسترسی (مثلاً درخواست‌های شباهت بین فضای نام‌ها) شناسایی شده و ظرف ۵ دقیقه در یک سیستم مدیریت اطلاعات و رویدادهای امنیتی (SIEM) ثبت می‌شوند. |  2  | D/V |
| 8.1.4 | تأیید کنید که پایگاه داده برداری گزارش‌های ممیزی شامل شناسه موضوع، عملیات، شناسه بردار/فضای نام، آستانه شباهت و تعداد نتایج باشد.                                                 |  2  | D/V |
| 8.1.5 | اطمینان حاصل کنید که تصمیم‌های دسترسی هر زمان که موتور ها به‌روزرسانی می‌شوند یا قوانین تقسیم‌بندی نمایه تغییر می‌کنند، برای نقص‌های دورزدن آزمایش می‌شوند.                       |  3  |  V  |

---

## C8.2 پاکسازی و اعتبارسنجی جاسازی

متن را برای اطلاعات شناسایی شخصی (PII) پیش‌بررسی کنید، پیش از تبدیل به بردارها، آن را محرمانه یا شبه‌نام‌گذاری کنید، و به صورت اختیاری پس‌پردازش تعبیه‌ها را انجام دهید تا سیگنال‌های باقی‌مانده را حذف کنید.

|   #   | توضیحات                                                                                                                                                                                                | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 8.2.1 | اطمینان حاصل کنید که داده‌های شناسایی‌شونده شخصی (PII) و داده‌های تحت‌قانون با استفاده از طبقه‌بندهای خودکار شناسایی شده و پیش از جاسازی (embedding) به صورت ماسک‌شده، نشانه‌گذاری‌شده یا حذف شده‌اند. |  1  | D/V |
| 8.2.2 | تأیید کنید که خطوط لوله جاسازی ورودی‌هایی که حاوی کد اجرایی یا مصنوعات غیر UTF-8 هستند و ممکن است اندیس را آلوده کنند، را رد یا قرنطینه می‌کنند.                                                       |  1  |  D  |
| 8.2.3 | تأیید کنید که پاک‌سازی با حفظ حریم خصوصی موضعی یا متریکی به تعبیه‌های جمله اعمال شده است که فاصله آن‌ها با هر نشانه PII شناخته شده کمتر از یک آستانه قابل تنظیم باشد.                                  |  2  | D/V |
| 8.2.4 | تأیید کنید که اثربخشی پاک‌سازی (به عنوان مثال، بازیابی حذفی اطلاعات شناسایی شخصی، انحراف معنایی) حداقل به‌طور نیم‌سالانه بر اساس مجموعه‌های معیار ارزیابی شود.                                         |  2  |  V  |
| 8.2.5 | اطمینان حاصل شود که پیکربندی‌های پاک‌سازی تحت کنترل نسخه هستند و تغییرات تحت بازبینی همتا قرار می‌گیرند.                                                                                               |  3  | D/V |

---

## C8.3 انقضای حافظه، لغو و حذف

قانون GDPR با مفهوم «حق فراموش شدن» و قوانین مشابه نیازمند حذف به موقع داده‌ها است؛ بنابراین، فروشگاه‌های وکتور باید از قابلیت‌های TTL، حذف سخت، و ایجاد یادبود حذف (tomb-stoning) پشتیبانی کنند تا وکتورهای لغو شده قابل بازیابی یا نمایه‌سازی مجدد نباشند.

|   #   | توضیحات                                                                                                                                                   | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.3.1 | اطمینان حاصل کنید که هر بردار و رکورد متادیتا دارای TTL یا برچسب نگهداری صریحی باشد که توسط وظایف پاکسازی خودکار رعایت شود.                               |  1  | D/V |
| 8.3.2 | تأیید کنید که درخواست‌های حذف شروع‌شده توسط کاربر بردارها، فراداده‌ها، نسخه‌های کش و شاخص‌های مشتق شده را ظرف 30 روز پاک می‌کنند.                         |  1  | D/V |
| 8.3.3 | اطمینان حاصل کنید که حذف‌های منطقی با تخریب رمزنگاری شده بلوک‌های ذخیره‌سازی در صورت پشتیبانی سخت‌افزار، یا با تخریب کلید در گاوصندوق کلید دنبال می‌شوند. |  2  |  D  |
| 8.3.4 | اعتبارسنجی کنید که وکتورهای منقضی شده در کمتر از ۵۰۰ میلی‌ثانیه پس از انقضا از نتایج جستجوی نزدیک‌ترین همسایه حذف شوند.                                   |  3  | D/V |

---

## C8.4 جلوگیری از معکوس‌سازی و نشت جاسازی‌ها

دفاع‌های اخیر—مانند ترکیب نویز، شبکه‌های پروجکشن، تغییرات نورون‌های حفظ حریم خصوصی، و رمزنگاری لایه برنامه—می‌توانند نرخ معکوس‌سازی در سطح توکن را به زیر ۵٪ کاهش دهند.

|   #   | توضیحات                                                                                                                                                                       | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.4.1 | تأیید کنید که یک مدل تهدید رسمی که شامل حملات معکوس‌سازی، عضویت و استنتاج ویژگی باشد، وجود دارد و سالانه مورد بازبینی قرار می‌گیرد.                                           |  1  |  V  |
| 8.4.2 | اطمینان حاصل کنید که رمزنگاری در لایه برنامه یا رمزنگاری جستجوپذیر، بردارها را از خوانش مستقیم توسط مدیران زیرساخت یا کارکنان ابر محافظت می‌کند.                              |  2  | D/V |
| 8.4.3 | اطمینان حاصل کنید که پارامترهای دفاعی (ε برای حریم خصوصی تفاضلی، نویز σ، رتبه تصویر k) تعادل بین حفظ حریم خصوصی ≥ 99٪ حفاظت از توکن و کارایی ≤ 3٪ کاهش دقت را برقرار می‌کنند. |  3  |  V  |
| 8.4.4 | اطمینان حاصل کنید که معیارهای مقاومت در برابر وارونگی بخشی از دروازه‌های انتشار برای به‌روزرسانی‌های مدل هستند و بودجه‌های رگرسیون تعریف شده‌اند.                             |  3  | D/V |

---

## C8.5 اجرای دامنه برای حافظه مخصوص کاربر

نشت اطلاعات میان مستاجران مختلف همچنان یکی از بزرگ‌ترین ریسک‌های RAG است: پرس‌وجوهای شباهت که به درستی فیلتر نشده‌اند، ممکن است اسناد خصوصی مشتری دیگری را نمایش دهند.

|   #   | توضیحات                                                                                                                                                                    | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.5.1 | اطمینان حاصل کنید که هر پرس‌وجوی بازیابی قبل از ارسال به درخواست LLM با شناسه مستاجر/کاربر پس‌فیلتر شده است.                                                               |  1  | D/V |
| 8.5.2 | تأیید کنید که نام مجموعه‌ها یا شناسه‌های نام‌دار شده به‌صورت جداگانه برای هر کاربر یا مستأجر نمک‌دار شده‌اند تا وکتورها در دامنه‌های مختلف با یکدیگر تداخل نداشته باشند.   |  1  |  D  |
| 8.5.3 | اطمینان حاصل کنید که نتایج شباهت بالاتر از یک آستانه فاصله قابل تنظیم اما خارج از حوزه تماس گیرنده، رد شده و هشدارهای امنیتی را فعال می‌کنند.                              |  2  | D/V |
| 8.5.4 | تأیید کنید که تست‌های فشار چند مستاجره، پرس‌وجوهای خصمانه‌ای را که در تلاش برای بازیابی اسناد خارج از حوزه مجاز هستند شبیه‌سازی می‌کنند و عدم نشت اطلاعات را نشان می‌دهند. |  2  |  V  |
| 8.5.5 | تأیید کنید که کلیدهای رمزگذاری به ازای هر مستاجر تفکیک شده‌اند، به طوری که جداسازی رمزنگاری حتی در صورت اشتراک گذاری فضای ذخیره‌سازی فیزیکی تضمین شود.                     |  3  | D/V |

---

## C8.6 امنیت پیشرفته سیستم حافظه

کنترل‌های امنیتی برای معماری‌های پیچیده حافظه شامل حافظه اپیزودیک، معنایی و کاری با نیازهای خاص جداسازی و اعتبارسنجی.

|   #   | توضیحات                                                                                                                                                                                                            | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 8.6.1 | تأیید کنید که انواع مختلف حافظه (اپیزودیک، معنایی، کاری) دارای زمینه‌های امنیتی جداگانه با کنترل‌های دسترسی مبتنی بر نقش، کلیدهای رمزنگاری جداگانه و الگوهای دسترسی مستند برای هر نوع حافظه باشند.                 |  1  | D/V |
| 8.6.2 | تأیید کنید که فرایندهای تثبیت حافظه شامل اعتبارسنجی امنیتی برای جلوگیری از تزریق خاطرات مخرب از طریق پاک‌سازی محتوا، تأیید منبع و بررسی‌های صحت قبل از ذخیره‌سازی باشند.                                           |  2  | D/V |
| 8.6.3 | اطمینان حاصل کنید که پرس‌وجوهای بازیابی حافظه معتبر و پاک‌سازی شده‌اند تا از استخراج اطلاعات غیرمجاز از طریق تحلیل الگوهای پرس‌وجو، اعمال کنترل دسترسی و فیلتر کردن نتایج جلوگیری شود.                             |  2  | D/V |
| 8.6.4 | تأیید کنید که مکانیزم‌های فراموشی حافظه اطلاعات حساس را با تضمین‌های رمزنگاری شده حذف می‌کنند، از طریق حذف کلید، بازنویسی چندباره یا حذف امن مبتنی بر سخت‌افزار با گواهی‌های تأیید.                                |  3  | D/V |
| 8.6.5 | اطمینان حاصل کنید که یکپارچگی سیستم حافظه به‌طور مداوم برای تغییرات غیرمجاز یا خرابی‌ها از طریق چک‌سام‌ها، لاگ‌های حسابرسی و هشدارهای خودکار زمانی که محتوای حافظه خارج از عملیات عادی تغییر می‌کند، نظارت می‌شود. |  3  | D/V |

---

## مراجع

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)


# امنیت حافظه C8، تعبیه‌ها و پایگاه داده‌های برداری

## هدف کنترل

امبدینگ‌ها و فروشگاه‌های وکتور به‌مثابه «حافظه زنده» سیستم‌های هوش مصنوعی معاصر عمل می‌کنند و به‌طور مداوم داده‌های ارائه‌شده توسط کاربر را می‌پذیرند و از طریق تولید تقویت‌شده با بازیابی (RAG) آن‌ها را به متون مدل برمی‌گردانند. اگر این حافظه بدون کنترل باقی بماند، ممکن است اطلاعات شناسایی شخصی (PII) نشت کند، حقوق رضایت نقض شود یا متن اصلی به‌صورت معکوس بازسازی شود. هدف این مجموعه کنترل‌ها، مقاوم‌سازی خطوط انتقال حافظه و پایگاه‌های داده وکتور است به‌گونه‌ای که دسترسی، حداقل مجوز را داشته باشد، امبدینگ‌ها حفظ حریم خصوصی را تضمین کنند، وکتورهای ذخیره‌شده منقضی شوند یا به‌صورت درخواستی لغو گردند و حافظه هر کاربر، هرگز درخواست‌ها یا تکمیل‌های کاربران دیگر را آلوده نکند.

---

## C8.1 کنترل‌های دسترسی روی حافظه و شاخص‌های RAG

اعمال کنترل‌های دسترسی دقیق و جزئی بر روی هر مجموعه برداری.

|   #   | توضیحات                                                                                                                                                           | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.1.1 | تأیید کنید که قوانین کنترل دسترسی در سطح ردیف/فضای نام، عملیات درج، حذف و پرس‌وجو را برای هر مستأجر، مجموعه یا برچسب سند محدود می‌کنند.                           |  1  | D/V |
| 8.1.2 | تأیید کنید که کلیدهای API یا JWT دارای ادعاهای محدوده‌بندی شده (مانند شناسه‌های مجموعه، افعال عملیاتی) هستند و حداقل هر فصل یکبار تعویض می‌شوند.                  |  1  | D/V |
| 8.1.3 | تأیید کنید که تلاش‌های افزایش دسترسی (مانند پرس‌وجوهای شباهت بین فضای نام‌ها) در طی ۵ دقیقه شناسایی و در سیستم مدیریت اطلاعات و رویدادهای امنیتی (SIEM) ثبت شوند. |  2  | D/V |
| 8.1.4 | تأیید کنید که پایگاه داده برداری، شناسه موضوع، عملیات، شناسه/فضای نام بردار، آستانه شباهت و تعداد نتایج لاگ را بررسی می‌کند.                                      |  2  | D/V |
| 8.1.5 | اطمینان حاصل کنید که تصمیمات دسترسی برای نقص‌های دور زدن هر زمان که موتور‌ها به‌روزرسانی می‌شوند یا قوانین تقسیم‌بندی نمایه تغییر می‌کنند، آزمایش می‌شوند.        |  3  |  V  |

---

## C8.2 پاک‌سازی و اعتبارسنجی جاسازی‌ها

متن را برای اطلاعات شناسایی شخصی (PII) پیش‌پردازش کنید، قبل از بردارسازی، آن را حذف یا شبه‌نام‌گذاری کنید و به‌طور اختیاری تعبیه‌ها را پس‌پردازش کنید تا سیگنال‌های باقی‌مانده را حذف کنید.

|   #   | توضیحات                                                                                                                                                                       | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.2.1 | تأیید کنید که داده‌های PII و داده‌های تنظیم‌شده از طریق طبقه‌بندی‌کننده‌های خودکار شناسایی شده و پیش از تعبیه، ماسک شده، توکنیزه شده یا حذف می‌شوند.                          |  1  | D/V |
| 8.2.2 | اطمینان حاصل کنید که خطوط لوله تعبیه، ورودی‌هایی که حاوی کد اجرایی یا آثار غیر UTF-8 هستند و ممکن است شاخص را مسموم کنند، رد شده یا قرنطینه می‌شوند.                          |  1  |  D  |
| 8.2.3 | اطمینان حاصل کنید که تصفیه مبتنی بر حفظ حریم خصوصی محلی یا متریک به بردارهای تعبیه جمله اعمال شود که فاصله آنها تا هر نشانه PII شناخته‌شده کمتر از یک آستانه قابل تنظیم باشد. |  2  | D/V |
| 8.2.4 | تأیید کنید که اثربخشی پاک‌سازی (مانند یادآوری حذف اطلاعات شناسایی شخصی، انحراف معنایی) حداقل به صورت نیمه‌سالانه در برابر مجموعه‌های معیار مورد ارزیابی قرار می‌گیرد.         |  2  |  V  |
| 8.2.5 | اطمینان حاصل کنید که پیکربندی‌های پاک‌سازی نسخه‌بندی شده‌اند و تغییرات تحت بازبینی همتا قرار می‌گیرند.                                                                        |  3  | D/V |

---

## C8.3 انقضای حافظه، لغو و حذف

قانون GDPR «حق فراموش شدن» و قوانین مشابه نیازمند حذف به موقع داده‌ها است؛ بنابراین فروشگاه‌های برداری باید از TTLها، حذف سخت، و نشانه‌گذاری قبور پشتیبانی کنند تا بردارهای لغوشده قابل بازیابی یا بازیابی مجدد نباشند.

|   #   | توضیحات                                                                                                                                    | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 8.3.1 | اطمینان حاصل کنید که هر بردار و رکورد فراداده دارای TTL یا برچسب نگهداری صریح است که توسط وظایف پاک‌سازی خودکار رعایت می‌شود.              |  1  | D/V |
| 8.3.2 | تأیید کنید که درخواست‌های حذف مبتنی بر کاربر، بردارها، فراداده‌ها، نسخه‌های کش و شاخص‌های مشتق‌شده را ظرف 30 روز پاک می‌کنند.              |  1  | D/V |
| 8.3.3 | اطمینان حاصل کنید که حذف‌های منطقی با محو رمزنگاری بلاک‌های ذخیره‌سازی در صورت پشتیبانی سخت‌افزار، یا با تخریب کلید مخزن کلید همراه باشند. |  2  |  D  |
| 8.3.4 | تأیید کنید که بردارهای منقضی‌شده در کمتر از 500 میلی‌ثانیه پس از انقضا از نتایج جستجوی نزدیک‌ترین همسایه حذف می‌شوند.                      |  3  | D/V |

---

## C8.4 جلوگیری از وارونگی و نشت جاسازی

دفاع‌های اخیر — مانند افزودن نویز، شبکه‌های پروجکشن، اختلال در نورون‌های حریم خصوصی، و رمزنگاری در لایه کاربرد — می‌توانند نرخ‌های معکوس‌سازی در سطح توکن را به زیر ۵٪ کاهش دهند.

|   #   | توضیحات                                                                                                                                                   | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.4.1 | اطمینان حاصل کنید که یک مدل تهدید رسمی که شامل حملات معکوس، عضویت و استنتاج ویژگی‌ها است، وجود دارد و سالانه بازبینی می‌شود.                              |  1  |  V  |
| 8.4.2 | تأیید کنید که رمزنگاری در لایه برنامه یا رمزنگاری جستجوپذیر از خواندن مستقیم وکتورها توسط مدیران زیرساخت یا کارکنان ابر جلوگیری می‌کند.                   |  2  | D/V |
| 8.4.3 | تأیید کنید که پارامترهای دفاعی (ε برای DP، نویز σ، رتبه پرجکشن k) تعادل بین حفظ حریم خصوصی ≥ ۹۹٪ حفاظت از توکن و سودمندی ≤ ۳٪ کاهش دقت را برقرار می‌کنند. |  3  |  V  |
| 8.4.4 | اطمینان حاصل کنید که معیارهای مقاومت در برابر وارونگی بخشی از دروازه‌های انتشار برای به‌روزرسانی‌های مدل هستند و بودجه‌های رگرسیون تعریف شده‌اند.         |  3  | D/V |

---

## C8.5 اجرای حوزه برای حافظه مخصوص کاربر

نشت اطلاعات بین مستاجرها همچنان یک ریسک اصلی در RAG است: پرس‌وجوهای شباهت فیلتر نشده به‌درستی می‌توانند اسناد خصوصی مشتری دیگری را نشان دهند.

|   #   | توضیحات                                                                                                                                                            | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 8.5.1 | اطمینان حاصل کنید که هر پرس‌وجوی بازیابی قبل از ارسال به پرامپت LLM، توسط شناسه مستاجر/کاربر پس‌فیلتر شود.                                                         |  1  | D/V |
| 8.5.2 | تأیید کنید که نام‌های مجموعه یا شناسه‌های نام‌گذاری شده به ازای هر کاربر یا مستأجر نمک‌دار شده‌اند تا بردارها در حوزه‌های مختلف با هم تداخل نداشته باشند.          |  1  |  D  |
| 8.5.3 | اطمینان حاصل کنید که نتایج شباهت بالاتر از آستانه فاصله قابل تنظیم اما خارج از محدوده تماس‌دهنده دور ریخته شده و هشدارهای امنیتی را فعال می‌کنند.                  |  2  | D/V |
| 8.5.4 | تأیید کنید که تست‌های استرس چنداجاره‌ای پرس‌وجوهای خصمانه‌ای را که تلاش می‌کنند اسناد خارج از محدوده را بازیابی کنند، شبیه‌سازی می‌کنند و نشت صفر را نشان می‌دهند. |  2  |  V  |
| 8.5.5 | اطمینان حاصل کنید که کلیدهای رمزنگاری به ازای هر مستاجر جدا شده‌اند، به‌طوری که جداسازی رمزنگاری حتی در صورت اشتراک‌گذاری ذخیره‌سازی فیزیکی حفظ شود.               |  3  | D/V |

---

## C8.6 امنیت پیشرفته سیستم حافظه

کنترل‌های امنیتی برای معماری‌های پیشرفته حافظه شامل حافظه اپیزودیک، معنایی و کاری با نیازهای خاص ایزولاسیون و اعتبارسنجی.

|   #   | توضیحات                                                                                                                                                                                                    | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.6.1 | اطمینان حاصل کنید که انواع مختلف حافظه (اپیزودیک، معنایی، کاری) دارای زمینه‌های امنیتی جداگانه با کنترل‌های دسترسی مبتنی بر نقش، کلیدهای رمزنگاری مجزا و الگوهای دسترسی مستند شده برای هر نوع حافظه باشند. |  1  | D/V |
| 8.6.2 | تأیید کنید که فرآیندهای تثبیت حافظه شامل اعتبارسنجی امنیتی برای جلوگیری از تزریق خاطرات مخرب از طریق پاکسازی محتوا، تأیید منبع و بررسی‌های صحت قبل از ذخیره‌سازی باشد.                                     |  2  | D/V |
| 8.6.3 | تأیید کنید که پرس‌وجوهای بازیابی حافظه اعتبارسنجی و پاکسازی شده‌اند تا از استخراج اطلاعات غیرمجاز از طریق تحلیل الگوی پرس‌وجو، اعمال کنترل دسترسی و فیلتر کردن نتایج جلوگیری شود.                          |  2  | D/V |
| 8.6.4 | اطمینان حاصل کنید که مکانیزم‌های فراموشی حافظه اطلاعات حساس را با تضمین‌های حذف رمزنگاری شده به طور امن حذف می‌کنند، از طریق حذف کلید، بازنویسی چندباره یا حذف امن مبتنی بر سخت‌افزار با گواهی‌های تایید.  |  3  | D/V |
| 8.6.5 | اطمینان حاصل کنید که یکپارچگی سیستم حافظه به طور مداوم برای تغییرات غیرمجاز یا فساد از طریق چک‌سام‌ها، لاگ‌های حسابرسی، و هشدارهای خودکار هنگام تغییر محتوای حافظه خارج از عملیات عادی، رصد می‌شود.        |  3  | D/V |

---

## مراجع

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)


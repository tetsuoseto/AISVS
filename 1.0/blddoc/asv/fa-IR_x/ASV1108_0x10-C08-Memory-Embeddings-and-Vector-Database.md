# امنیت حافظه C8، امبدینگ‌ها و پایگاه داده‌های برداری

## هدف کنترل

امبدینگ‌ها و فروشگاه‌های برداری مانند «حافظه زنده» سیستم‌های معاصر هوش مصنوعی عمل می‌کنند و به‌طور مداوم داده‌های ارائه‌شده توسط کاربر را می‌پذیرند و از طریق تولید تقویت‌شده با بازیابی (RAG) آن را به زمینه‌های مدل بازمی‌گردانند. اگر این حافظه بدون کنترل رها شود، ممکن است اطلاعات شناسایی شخصی (PII) نشت کند، رضایت نقض شود یا به گونه‌ای معکوس شود که متن اصلی بازسازی شود. هدف این خانواده کنترل، سخت کردن مسیرهای حافظه و پایگاه‌های داده برداری است به طوری که دسترسی کمترین امتیاز لازم باشد، امبدینگ‌ها حفظ حریم خصوصی کنند، بردارهای ذخیره‌شده منقضی شوند یا در صورت نیاز قابل ابطال باشند، و حافظه هر کاربر هرگز باعث آلودگی درخواست‌ها یا تکمیل‌های کاربران دیگر نشود.

---

## C8.1 کنترل‌های دسترسی بر حافظه و شاخص‌های RAG

اجرای کنترل‌های دسترسی دقیق بر روی هر مجموعه برداری.

|   #   | توضیحات                                                                                                                                                                             | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.1.1 | اطمینان حاصل کنید که قوانین کنترل دسترسی در سطح ردیف/فضای نام، عملیات درج، حذف و جستجو را به ازای هر مستأجر، مجموعه یا برچسب سند محدود می‌کنند.                                     |  1  | D/V |
| 8.1.2 | تأیید کنید که کلیدهای API یا JWT شامل ادعاهای محدوده دار (مثلاً شناسه‌های مجموعه، افعال عملیاتی) باشند و حداقل هر سه ماه یکبار تعویض شوند.                                          |  1  | D/V |
| 8.1.3 | اطمینان حاصل کنید که تلاش‌های افزایش دسترسی (مانند پرس‌وجوهای مشابهت بین فضای نام‌ها) در عرض ۵ دقیقه شناسایی و به یک سامانه مدیریت اطلاعات و رویدادهای امنیتی (SIEM) گزارش می‌شوند. |  2  | D/V |
| 8.1.4 | تأیید کنید که پایگاه داده برداری گزارش‌های حسابرسی شامل شناسه موضوع، عملیات، شناسه بردار/فضای نام، آستانه شباهت و تعداد نتایج باشد.                                                 |  2  | D/V |
| 8.1.5 | اطمینان حاصل کنید که تصمیمات دسترسی هر زمان که موتور‌ها به‌روزرسانی می‌شوند یا قوانین تقسیم‌بندی شاخص تغییر می‌کنند، از نظر نقص‌های دور زدن تست می‌شوند.                            |  3  |  V  |

---

## C8.2 پاکسازی و اعتبارسنجی جاسازی

متن را برای اطلاعات شخصی قابل شناسایی (PII) پیش‌غربالگری کنید، قبل از تبدیل به بردار، آن را حذف یا شبه‌نام‌گذاری کنید، و به طور اختیاری پس‌پردازش تعبیه‌ها را برای حذف سیگنال‌های باقی‌مانده انجام دهید.

|   #   | توضیحات                                                                                                                                                                     | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.2.1 | اطمینان حاصل کنید که داده‌های شناسایی‌شدنی شخصی (PII) و داده‌های تنظیم شده از طریق طبقه‌بندهای خودکار شناسایی شده و پیش از جاسازی، ماسک شده، توکنیزه شده یا حذف می‌شوند.    |  1  | D/V |
| 8.2.2 | اطمینان حاصل کنید که خطوط لوله تعبیه شده ورودی‌هایی که شامل کد اجرایی یا آثار غیر UTF-8 هستند که ممکن است نمایه را آلوده کنند، رد یا قرنطینه می‌کنند.                       |  1  |  D  |
| 8.2.3 | تأیید کنید که ضدعفونی‌سازی با حریم خصوصی تفاضلی محلی یا متریک بر روی تعبیه‌های جمله اعمال شده است که فاصله آنها تا هر توکن شناخته‌شده PII کمتر از یک آستانه قابل تنظیم است. |  2  | D/V |
| 8.2.4 | اطمینان حاصل کنید که اثربخشی پالایش (مثلاً بازیابی حذف اطلاعات شناسایی شخصی، انحراف معنایی) حداقل به صورت نیم‌سالانه در برابر مجموعه‌های معیار ارزیابی می‌شود.              |  2  |  V  |
| 8.2.5 | اطمینان حاصل کنید که پیکربندی‌های پاکسازی تحت کنترل نسخه هستند و تغییرات زیر نظر بازبینی همکاران قرار می‌گیرند.                                                             |  3  | D/V |

---

## C8.3 انقضای حافظه، لغو و حذف

قانون GDPR "حق فراموش شدن" و قوانین مشابه نیازمند پاک‌سازی به‌موقع هستند؛ بنابراین، فروشگاه‌های وکتور باید از TTLها، حذف‌های سخت، و تامب‌استونینگ پشتیبانی کنند تا وکتورهای لغو شده قابل بازیابی یا بازنمایه‌سازی نباشند.

|   #   | توضیحات                                                                                                                                                                   | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.3.1 | بررسی کنید که هر رکورد بردار و فراداده دارای یک TTL یا برچسب نگهداری صریح باشد که توسط وظایف پاکسازی خودکار رعایت می‌شود.                                                 |  1  | D/V |
| 8.3.2 | تأیید کنید که درخواست‌های حذف آغاز شده توسط کاربر، بردارها، فراداده‌ها، نسخه‌های کش و نمایه‌های مشتق شده را در طی ۳۰ روز پاک می‌کنند.                                     |  1  | D/V |
| 8.3.3 | تأیید کنید که حذف‌های منطقی پس از آن با ردیابی رمزنگاری‌شده بلوک‌های ذخیره‌سازی در صورتی که سخت‌افزار پشتیبانی کند، یا با تخریب کلیدهای ذخیره‌شده در کیف کلید دنبال شوند. |  2  |  D  |
| 8.3.4 | تأیید کنید که بردارهای منقضی شده ظرف کمتر از 500 میلی‌ثانیه پس از انقضا از نتایج جستجوی نزدیک‌ترین همسایه حذف می‌شوند.                                                    |  3  | D/V |

---

## C8.4 جلوگیری از وارونگی و نشت جاسازی

دفاع‌های اخیر—افزودن نویز، شبکه‌های پروجکشن، اختلال نورون حریم خصوصی، و رمزنگاری لایه برنامه—می‌توانند نرخ بازگشت معکوس در سطح توکن را به زیر 5% کاهش دهند.

|   #   | توضیحات                                                                                                                                                                                   | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.4.1 | اطمینان حاصل شود که یک مدل تهدید رسمی که شامل حملات وارونگی، عضویت و استنتاج ویژگی‌ها است وجود داشته و سالیانه مورد بازبینی قرار می‌گیرد.                                                 |  1  |  V  |
| 8.4.2 | اطمینان حاصل کنید که رمزگذاری لایه برنامه یا رمزگذاری جستجوپذیر، بردارها را از خوانش مستقیم توسط مدیران زیرساخت یا کارکنان ابر محافظت می‌کند.                                             |  2  | D/V |
| 8.4.3 | اطمینان حاصل کنید که پارامترهای دفاعی (ε برای حفظ حریم خصوصی تفاضلی، نویز σ، رتبه پروجکشن k) تعادل مناسبی بین حفاظت از حریم خصوصی ≥ 99٪ توکن و کاربردی بودن ≤ 3٪ کاهش دقت برقرار می‌کنند. |  3  |  V  |
| 8.4.4 | اطمینان حاصل کنید که معیارهای مقاومت در برابر وارونگی بخشی از دروازه‌های انتشار برای به‌روزرسانی‌های مدل هستند، با تعریف بودجه‌های رگرسیون.                                               |  3  | D/V |

---

## C8.5 اجرای حوزه برای حافظه خاص کاربر

نشتی بین مستاجران همچنان یکی از بزرگ‌ترین ریسک‌های RAG است: پرس‌وجوهای تشابه به‌طور نادرست فیلتر شده می‌توانند اسناد خصوصی مشتری دیگر را آشکار کنند.

|   #   | توضیحات                                                                                                                                                                   | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.5.1 | اطمینان حاصل کنید که هر پرس‌وجوی بازیابی قبل از ارسال به پرسش LLM، بر اساس شناسه مستاجر/کاربر پس‌پردازش شده باشد.                                                         |  1  | D/V |
| 8.5.2 | اطمینان حاصل کنید که نام‌های مجموعه یا شناسه‌های نام‌گذاری شده برای هر کاربر یا مستاجر به صورت نمک‌گذاری شده باشند تا بردارها در بین حوزه‌ها تداخل نداشته باشند.          |  1  |  D  |
| 8.5.3 | تأیید کنید که نتایج شباهت بالاتر از آستانه فاصله قابل تنظیم اما خارج از حوزه تماس‌گیرنده دور ریخته شده و هشدارهای امنیتی را فعال می‌کنند.                                 |  2  | D/V |
| 8.5.4 | تأیید کنید که تست‌های فشار چند مستاجری، شبیه‌سازی پرسش‌های خصمانه‌ای هستند که تلاش می‌کنند اسناد خارج از حوزه را بازیابی کنند و نشان دهند که هیچ نشت اطلاعاتی رخ نمی‌دهد. |  2  |  V  |
| 8.5.5 | اطمینان حاصل کنید که کلیدهای رمزگذاری به ازای هر مستأجر جدا شده‌اند و جداسازی رمزنگاری حتی در صورت اشتراک‌گذاری فضای ذخیره‌سازی فیزیکی حفظ می‌شود.                        |  3  | D/V |

---

## C8.6 امنیت پیشرفته سیستم حافظه

کنترل‌های امنیتی برای معماری‌های پیچیده حافظه شامل حافظه اپیزودیک، معنایی و کاری با الزامات خاص ایزولاسیون و اعتبارسنجی.

|   #   | توضیحات                                                                                                                                                                                                            | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 8.6.1 | تأیید کنید که انواع مختلف حافظه (اپیزودیک، معنادار، کاری) دارای زمینه‌های امنیتی جداگانه با کنترل‌های دسترسی مبتنی بر نقش، کلیدهای رمزنگاری جداگانه و الگوهای دسترسی مستند برای هر نوع حافظه باشند.                |  1  | D/V |
| 8.6.2 | تأیید کنید که فرآیندهای تحکیم حافظه شامل اعتبارسنجی امنیتی برای جلوگیری از وارد کردن خاطرات مخرب از طریق پاک‌سازی محتوا، تأیید منبع، و بررسی‌های صحت قبل از ذخیره‌سازی باشند.                                      |  2  | D/V |
| 8.6.3 | اطمینان حاصل کنید که پرس‌وجوهای بازیابی حافظه بررسی و پاک‌سازی می‌شوند تا از استخراج اطلاعات غیرمجاز از طریق تحلیل الگوی پرس‌وجو، اعمال کنترل دسترسی و فیلتر کردن نتایج جلوگیری شود.                               |  2  | D/V |
| 8.6.4 | تأیید کنید که مکانیزم‌های فراموشی حافظه با تضمین‌های پاک‌سازی رمزنگاری شده، اطلاعات حساس را به صورت ایمن حذف می‌کنند، از جمله حذف کلید، بازنویسی چندباره، یا حذف ایمن مبتنی بر سخت‌افزار همراه با گواهی‌های تأیید. |  3  | D/V |
| 8.6.5 | اطمینان حاصل کنید که یکپارچگی سیستم حافظه به طور مداوم از طریق چکسام‌ها، لاگ‌های حسابرسی و هشدارهای خودکار هنگام تغییر محتوای حافظه خارج از عملیات عادی برای اصلاحات غیرمجاز یا خرابی‌ها نظارت می‌شود.             |  3  | D/V |

---

## مراجع

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)


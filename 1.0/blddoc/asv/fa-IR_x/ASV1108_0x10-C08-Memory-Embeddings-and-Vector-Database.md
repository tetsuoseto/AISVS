# C8 حافظه، تعبیه‌ها و امنیت پایگاه دادهٔ برداری

## هدف کنترل

بردهای جاسازی و مخازن برد به‌عنوان «حافظهٔ زنده» سامانه‌های هوش مصنوعی مدرن عمل می‌کنند، به‌طور مداوم داده‌هایی را که کاربر ارائه می‌کند می‌پذیرند و آن‌ها را از طریق تولید تقویت‌شده با بازیابی (RAG) به زمینه‌های مدل بازمی‌گردانند. اگر این حافظه بدون کنترل بماند، ممکن است منجر به فاش‌شدن PII، نقض رضایت یا وارونه‌سازی برای بازسازی متن اصلی شود. هدف از این خانوادهٔ کنترل، سخت‌سازی خطوط لوله حافظه و پایگاه‌های دادهٔ برد است تا دسترسی به کمترین امتیاز باشد، بردهای جاسازی از نظر حفظ حریم خصوصی امن باشند، بردهای ذخیره‌شده منقضی شوند یا به‌دلیل درخواست قابل لغو باشند، و حافظهٔ هر کاربر هرگز با پرامپت‌ها یا پاسخ‌های کاربر دیگر آلوده نشود.

---

## C8.1 کنترل‌های دسترسی به حافظه و شاخص‌های RAG

اجرای کنترل‌های دسترسی دقیق برای هر مجموعه برداری.

|   #   | شرح                                                                                                                                                   | سطح | نقش |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.1.1 | اطمینان حاصل کنید که قوانین کنترل دسترسی سطح سطر/فضای نام، عملیات درج، حذف و جستجو را برای هر مستاجر، مجموعه یا برچسب سند محدود می‌کنند.              |  1  | D/V |
| 8.1.2 | تأیید کنید که کلیدهای API یا JWTها دارای ادعاهای با دامنه هستند (مثلاً شناسه‌های مجموعه و افعال اقدام) و هر 3 ماه یکبار حداقل گردش کلید انجام می‌شود. |  1  | D/V |
| 8.1.3 | تأیید کنید که تلاش‌های ارتقاء سطح دسترسی (مثلاً کوئری‌های تشابه بین فضاهای نام مختلف) شناسایی می‌شوند و در SIEM ثبت می‌شوند در عرض 5 دقیقه.           |  2  | D/V |
| 8.1.4 | اطمینان حاصل کنید که لاگ حسابرسی پایگاه داده برداری شامل شناسه-موضوع، عملیات، شناسه بردار/فضای نام، آستانه تشابه و تعداد نتایج باشد.                  |  2  | D/V |
| 8.1.5 | اطمینان حاصل کنید که تصمیمات دسترسی برای وجود نقص‌های عبور هرگاه موتورهای به‌روزرسانی می‌شوند یا قواعد ایندکس-شاردینگ تغییر می‌کنند، آزمایش می‌شوند.  |  3  |  V  |

---

## C8.2 تعبیه، پاک‌سازی و اعتبارسنجی

قبل از بردار سازی، متن را از نظر وجود اطلاعات قابل شناسایی شخصی (PII) پیش غربال کنید، آنها را حذف یا با نام‌های مستعار جایگزین کنید، و در صورت تمایل، پس پردازش نگاشت‌های جاسازی شده را برای از بین بردن سیگنال‌های باقیمانده انجام دهید.

|   #   | شرح                                                                                                                                                                         | سطح | نقش |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.2.1 | اطمینان حاصل کنید که PII و داده‌های مشمول مقررات از طریق طبقه‌بندهای خودکار شناسایی می‌شوند و قبل از جاسازی، ماسک می‌شوند، توکن‌سازی می‌شوند یا حذف می‌شوند.                |  1  | D/V |
| 8.2.2 | تأیید کنید که خطوط لوله جاسازی ورودی‌ها، ورودی‌هایی را که حاوی کد اجرایی یا مواردی با فرمت غیر UTF-8 هستند و می‌توانند ایندکس را آلوده کنند، رد یا قرنطینه می‌کنند.         |  1  |  D  |
| 8.2.3 | تأیید کنید که پاک‌سازی با حریم خصوصی تفاضلی محلی یا متریکی به بردهای جاسازی جمله اعمال می‌شود که فاصلهٔ آن‌ها به هر توکن PII شناخته‌شده کمتر از آستانهٔ قابل پیکربندی باشد. |  2  | D/V |
| 8.2.4 | اطمینان حاصل کنید که کارایی ایمن‌سازی (مثلاً نرخ بازیابی حذف PII و انحراف معنایی) حداقل به‌صورت نیمه‌سالانه در برابر مجموعه‌های دادهٔ بنچمارک ارزیابی می‌شود.               |  2  |  V  |
| 8.2.5 | تأیید کنید که پیکربندی‌های پاک‌سازی دارای کنترل نسخه هستند و تغییرات تحت بازبینی همتا قرار می‌گیرند.                                                                        |  3  | D/V |

---

## C8.3 انقضای حافظه، ابطال و حذف

GDPR «حق فراموش‌شدن» و قوانین مشابه، حذف به‌موقع را الزامی می‌کنند؛ بنابراین انبارهای برداری باید از TTLها، حذف‌های دائمی، و tomb-stoning پشتیبانی کنند تا وکتورهای لغو‌شده قابل بازیابی یا دوباره فهرست‌بندی نشوند.

|   #   | شرح                                                                                                                                                                  | سطح | نقش |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.3.1 | بررسی کنید که هر بردار و رکورد فراداده دارای TTL یا برچسب نگهداری صریحی باشد که توسط عملیات پاکسازی خودکار رعایت گردد.                                               |  1  | D/V |
| 8.3.2 | اطمینان حاصل کنید که درخواست‌های حذف به‌دست کاربر، بردارها، فراداده‌ها، نسخه‌های کش و نمایه‌های مشتق‌شده را در عرض ۳۰ روز پاک‌سازی می‌کنند.                          |  1  | D/V |
| 8.3.3 | تأیید کنید که حذف‌های منطقی با تخریب رمزنگاری‌شدهٔ بلوک‌های ذخیره‌سازی دنبال می‌شوند، در صورت پشتیبانی سخت‌افزار از این قابلیت، یا با از بین بردن کلید در Key Vault. |  2  |  D  |
| 8.3.4 | تأیید کنید که بردارهای منقضی‌شده از نتایج جست‌جوی نزدیک‌ترین همسایه حذف می‌شوند در کمتر از 500 میلی‌ثانیه پس از انقضا.                                               |  3  | D/V |

---

## C8.4 جلوگیری از وارونگی تعبیه و نشت

دفاع‌های اخیر—هم‌پوشانی نویز، شبکه‌های پروجکشن، اختلال نورون-حریم خصوصی، و رمزگذاری در سطح لایهٔ کاربرد—می‌توانند نرخ وارون‌سازی توکن‌ها را به کمتر از 5% کاهش دهند.

|   #   | شرح                                                                                                                                                                | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 8.4.1 | تأیید کنید که یک مدل تهدید رسمی وجود دارد که حملات وارونه‌سازی، استنتاج عضویت و استنتاج ویژگی را در بر می‌گیرد و به‌طور سالانه بازنگری می‌شود.                     |  1  |  V  |
| 8.4.2 | تأیید کنید که رمزگذاری در لایهٔ اپلیکیشن یا رمزگذاری قابل جست‌وجو بردارها را از خواندن مستقیم توسط مدیران زیرساخت یا کارکنان خدمات ابری محافظت می‌کند.             |  2  | D/V |
| 8.4.3 | تأیید کنید که پارامترهای دفاعی (ε برای DP، نویز σ، رتبهٔ پروژکشن k) بین حفاظت از حریم خصوصی (≥ 99 %)، حفاظت از توکن و کارایی (افت دقت ≤ 3 %) تعادل برقرار می‌کنند. |  3  |  V  |
| 8.4.4 | تأیید کنید که معیارهای تاب‌آوری در برابر وارونگی بخشی از دروازه‌های انتشار برای به‌روزرسانی مدل‌ها هستند، با بودجه‌های رگرسیون تعریف‌شده.                          |  3  | D/V |

---

## C8.5 اجرای دامنه برای حافظهٔ مختص کاربر

نشت بین مستاجران همچنان یکی از مهم‌ترین خطرات RAG است: کوئری‌های تشابه که به درستی فیلتر نشده‌اند می‌توانند اسناد خصوصی مشتری دیگری را آشکار کنند.

|   #   | شرح                                                                                                                                                                          | سطح | نقش |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.5.1 | اطمینان حاصل کنید که هر کوئری بازیابی پس از اعمال فیلتر با شناسه مستاجر/کاربر، قبل از ارسال آن به پرامپت LLM انجام می‌شود.                                                   |  1  | D/V |
| 8.5.2 | تأیید کنید که نام‌های مجموعه یا شناسه‌های دارای فضای نام برای هر کاربر یا مستاجر با نمک‌گذاری مجزا انجام می‌شود تا بردارها در دامنه‌های مختلف با هم تداخل نداشته باشند.      |  1  |  D  |
| 8.5.3 | تأیید کنید که نتایج تشابه بالاتر از آستانه فاصله قابل تنظیم اما خارج از دامنهٔ فراخواننده از بین می‌روند و هشدارهای امنیتی را فعال می‌کنند.                                  |  2  | D/V |
| 8.5.4 | تأیید کنید که آزمایش‌های فشار چند مستاجره، درخواست‌های خصمانه را شبیه‌سازی می‌کنند که سعی در بازیابی اسناد خارج از دامنه دارند و نشان می‌دهند که هیچ نشت داده‌ای وجود ندارد. |  2  |  V  |
| 8.5.5 | تأیید کنید که کلیدهای رمزگذاری برای هر مستأجر تفکیک شده باشند تا ایزولاسیون رمزنگاری را حتی در صورت به اشتراک‌گذاری فضای ذخیره‌سازی فیزیکی تضمین کند.                        |  3  | D/V |

---

## C8.6 امنیت سیستم حافظه پیشرفته

کنترل‌های امنیتی برای معماری‌های حافظه پیشرفته که شامل حافظه اپیزودیکی، حافظه معنایی و حافظه کاری می‌شود و دارای الزامات مخصوص ایزولاسیون و اعتبارسنجی است.

|   #   | شرح                                                                                                                                                                                                                             | سطح | نقش |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.6.1 | بررسی کنید که انواع مختلف حافظه (حافظه رویدادی، حافظه معنایی، حافظه کاری) دارای زمینه‌های امنیتی جداگانه با کنترل‌های دسترسی مبتنی بر نقش، کلیدهای رمزگذاری جداگانه، و الگوهای دسترسی مستند برای هر نوع حافظه هستند.            |  1  | D/V |
| 8.6.2 | اطمینان حاصل کنید که فرایندهای تثبیت حافظه شامل اعتبارسنجی امنیتی هستند تا از تزریق خاطرات مخرب از طریق پاک‌سازی محتوا، تأیید منبع و بررسی یکپارچگی قبل از ذخیره‌سازی جلوگیری شود.                                              |  2  | D/V |
| 8.6.3 | تأیید کنید که کوئری‌های بازیابی حافظه اعتبارسنجی و پاک‌سازی می‌شوند تا از استخراج اطلاعات غیرمجاز از طریق تحلیل الگوی کوئری، اعمال کنترل دسترسی و فیلتر نتایج جلوگیری گردد.                                                     |  2  | D/V |
| 8.6.4 | تأیید کنید که مکانیزم‌های فراموش‌سازی حافظه، اطلاعات حساس را به‌طور امن حذف می‌کنند و با تضمین‌های پاک‌سازی رمزنگاری‌شده از طریق حذف کلید، بازنویسی چندباره، یا حذف امن مبتنی بر سخت‌افزار با گواهی‌های تأیید.                  |  3  | D/V |
| 8.6.5 | اطمینان حاصل کنید که یکپارچگی سیستم حافظه به صورت مداوم پایش می‌شود تا هر گونه تغییر غیرمجاز یا خرابی را تشخیص دهد، از طریق چک‌سام‌ها، لاگ‌های بازرسی و هشدارهای خودکار زمانی که محتوای حافظه خارج از عملیات عادی تغییر می‌کند. |  3  | D/V |

---

## منابع

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)


# 附錄 D：AI 助力的安全編碼治理與驗證

## 目標

本章定義在軟體開發期間安全且有效使用 AI 輔助編碼工具的基線組織控制措施，確保整個軟體開發生命週期（SDLC）的安全性與可追蹤性。

---

## AD.1 AI-協助的安全‑編碼工作流程

將 AI 工具整合到本組織的安全‑軟體‑開發生命週期（SSDLC），同時不降低現有的安全審查點。

|   #    | 描述                                                      | 等級  | 角色  |
| :----: | ------------------------------------------------------- | :-: | :-: |
| AD.1.1 | 驗證已記錄的工作流程是否描述 AI 工具在何時以及如何生成、重構或審查程式碼。                 |  1  | D/V |
| AD.1.2 | 驗證工作流程是否對應至 SSDLC 的各個階段（設計、實作、程式碼審查、測試、部署）。             |  2  |  D  |
| AD.1.3 | 驗證度量指標（例如漏洞密度、平均偵測時間）是否在 AI‑產生的程式碼上被收集，並與僅由人類建立的基準進行比較。 |  3  | D/V |

---

## AD.2 AI 工具資格認證 & 威脅建模

在採用之前，應評估 AI 編碼工具的安全能力、風險與供應‑鏈影響。

|   #    | 描述                                                           | 等級  | 角色  |
| :----: | ------------------------------------------------------------ | :-: | :-: |
| AD.2.1 | 請確認每個 AI 工具的威脅模型能識別濫用、模型反演、資料洩漏以及依賴鏈風險。                      |  1  | D/V |
| AD.2.2 | 請驗證工具評估是否包含對任何本地元件的靜態/動態分析，以及對 SaaS 端點的評估（TLS、身份驗證/授權、日誌記錄）。 |  2  |  D  |
| AD.2.3 | 驗證評估是否遵循公認的框架，並在重大版本變更後重新執行。                                 |  3  | D/V |

---

## AD.3 安全提示與上下文管理

在為 AI 模型構建提示或上下文時，防止機密資訊、專有程式碼與個人資料洩漏。

|   #    | 描述                                            | 等級  | 角色  |
| :----: | --------------------------------------------- | :-: | :-: |
| AD.3.1 | 確認書面指引是否禁止在提示中傳送機密資訊、憑證或分類資料。                 |  1  | D/V |
| AD.3.2 | 驗證技術控制（客戶端遮蔽、已批准的上下文過濾器）是否會自動移除敏感痕跡。          |  2  |  D  |
| AD.3.3 | 驗證提示與回應是否已進行令牌化、在傳輸中與靜態時已加密，以及保留期限是否符合資料分類政策。 |  3  | D/V |

---

## AD.4 AI‑Generated Code 的驗證

在代碼合併或部署之前，檢測並修復由 AI 輸出引入的漏洞。

|   #    | 描述                                                             | 等級  | 角色  |
| :----: | -------------------------------------------------------------- | :-: | :-: |
| AD.4.1 | 驗證 AI 生成的程式碼是否始終需經過人工審查。                                       |  1  | D/V |
| AD.4.2 | 確保在每個包含 AI‑產生的程式碼的拉取請求上執行自動掃描工具（SAST/IAST/DAST），並在發現嚴重問題時阻止合併。 |  2  |  D  |
| AD.4.3 | 驗證差分模糊測試或基於性質的測試能證明安全‑關鍵的行為（例如，輸入驗證、授權邏輯）。                     |  3  | D/V |

---

## AD.5 程式碼建議的可解釋性與可追溯性

讓審計人員與開發人員了解為何提出這個建議，以及它如何演變。

|   #    | 描述                                                      | 等級  | 角色  |
| :----: | ------------------------------------------------------- | :-: | :-: |
| AD.5.1 | 驗證提示/回應對是否已以提交 ID 記錄。                                   |  1  | D/V |
| AD.5.2 | 驗證開發人員是否能展現支援某個建議的模型引用（訓練片段、文件）。                        |  2  |  D  |
| AD.5.3 | 驗證可解釋性報告是否與設計工件一同儲存，並在安全審查中被引用，符合 ISO/IEC 42001 可追溯性原則。 |  3  | D/V |

---

## AD.6 持續反饋與模型微調

隨著時間的推移提升模型的安全性表現，同時防止負向漂移。

|   #    | 描述                                                                  | 等級  | 角色  |
| :----: | ------------------------------------------------------------------- | :-: | :-: |
| AD.6.1 | 驗證開發人員能對不安全或不符合規範的建議進行標記，並確保這些旗標會被追蹤。                               |  1  | D/V |
| AD.6.2 | 驗證聚合回饋是否能為定期‑微調或檢索‑增強生成提供資訊，使用經過審核的安全‑編碼語料庫（例如 OWASP Cheat Sheets）。 |  2  |  D  |
| AD.6.3 | 驗證閉環評估框架在每次微調之後執行回歸測試；部署前，安全性指標必須達到或超過先前的基準。                        |  3  | D/V |

---

### 參考文獻

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)


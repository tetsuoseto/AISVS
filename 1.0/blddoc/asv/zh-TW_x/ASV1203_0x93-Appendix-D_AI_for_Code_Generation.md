# 附錄 D：AI 輔助安全編碼治理與驗證

## 目標

本章定義了在軟體開發過程中安全且有效使用 AI 輔助編碼工具的基線組織管控措施，以確保整個軟體開發生命週期（SDLC）中的安全性和可追蹤性。

---

## AD.1 AI 輔助安全編碼工作流程

將 AI 工具整合到組織的安全軟體開發生命週期（SSDLC）中，且不削弱現有的安全防護措施。

|   #    | 描述                                                   | 層級  | 角色  |
| :----: | ---------------------------------------------------- | :-: | :-: |
| AD.1.1 | 確認已記錄的工作流程中說明何時以及如何使用 AI 工具來生成、重構或審查程式碼。             |  1  | D/V |
| AD.1.2 | 驗證工作流程是否對應到每個 SSDLC 階段（設計、實作、程式碼審查、測試、部署）。           |  2  |  D  |
| AD.1.3 | 確認度量指標（例如，漏洞密度、平均檢測時間）已針對 AI 產生的程式碼進行收集，並與純人工基準進行比較。 |  3  | D/V |

---

## AD.2 AI 工具資格認證與威脅建模

確保在採用人工智慧程式編寫工具之前，評估其安全能力、風險及供應鏈影響。

|   #    | 描述                                                        | 層級  | 角色  |
| :----: | --------------------------------------------------------- | :-: | :-: |
| AD.2.1 | 驗證每個人工智慧工具的威脅模型是否識別了誤用、模型反轉、資料洩漏及依賴鏈風險。                   |  1  | D/V |
| AD.2.2 | 驗證工具評估是否包含對任何本地組件的靜態/動態分析，以及對SaaS端點（TLS、身份驗證/授權、日誌記錄）的評估。 |  2  |  D  |
| AD.2.3 | 確認評估遵循公認的框架，並在主要版本更改後重新進行評估。                              |  3  | D/V |

---

## AD.3 安全提示與上下文管理

在為 AI 模型構建提示或上下文時，防止機密、專有代碼和個人數據洩漏。

|   #    | 描述                                    | 層級  | 角色  |
| :----: | ------------------------------------- | :-: | :-: |
| AD.3.1 | 確認書面指導明確禁止在提示中傳送機密、憑證或機密資料。           |  1  | D/V |
| AD.3.2 | 驗證技術控制（客戶端刪節、批准的上下文過濾器）是否自動剝除敏感的痕跡。   |  2  |  D  |
| AD.3.3 | 驗證提示和回應已進行分詞、在傳輸及靜態時加密，且保留期限符合資料分類政策。 |  3  | D/V |

---

## AD.4 AI生成代碼的驗證

在程式碼合併或部署之前，檢測並修復由 AI 輸出引入的漏洞。

|   #    | 描述                                                          | 層級  | 角色  |
| :----: | ----------------------------------------------------------- | :-: | :-: |
| AD.4.1 | 確保 AI 生成的程式碼始終經過人工程式碼審查。                                    |  1  | D/V |
| AD.4.2 | 確認自動掃描器（SAST/IAST/DAST）在每個包含 AI 生成代碼的拉取請求上運行，並在發現關鍵問題時阻止合併。 |  2  |  D  |
| AD.4.3 | 驗證差分模糊測試或基於屬性的測試是否證明了安全關鍵行為（例如，輸入驗證、授權邏輯）。                  |  3  | D/V |

---

## AD.5 代碼建議的可解釋性與可追溯性

為審計人員和開發人員提供有關建議原因及其演變過程的見解。

|   #    | 描述                                                        | 層級  | 角色  |
| :----: | --------------------------------------------------------- | :-: | :-: |
| AD.5.1 | 確認提示/回應對是否已使用提交 ID 紀錄。                                    |  1  | D/V |
| AD.5.2 | 確認開發人員能夠展示支援建議的模型引用（訓練片段、文件）。                             |  2  |  D  |
| AD.5.3 | 驗證可解釋性報告是否與設計工件一同存儲，並在安全性審查中引用，以符合 ISO/IEC 42001 的可追蹤性原則。 |  3  | D/V |

---

## AD.6 持續反饋與模型微調

隨著時間提升模型安全性能，同時防止負向漂移。

|   #    | 描述                                                            | 層級  | 角色  |
| :----: | ------------------------------------------------------------- | :-: | :-: |
| AD.6.1 | 驗證開發人員是否能標記不安全或不合規的建議，且這些標記是否被追蹤。                             |  1  | D/V |
| AD.6.2 | 確認彙總的反饋可用於定期微調或透過經審核的安全程式碼語料庫（例如 OWASP Cheat Sheets）進行檢索增強生成。 |  2  |  D  |
| AD.6.3 | 確認封閉迴路評估系統在每次微調後執行迴歸測試；安全指標必須達到或超過先前的基準才能部署。                  |  3  | D/V |

---

### 參考文獻

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)


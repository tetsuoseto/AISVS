# 附錄 D：人工智慧輔助安全程式碼治理與驗證

## 目標

本章定義了在軟體開發過程中安全且有效使用 AI 輔助程式碼工具的基準組織控制措施，確保整個軟體開發生命週期（SDLC）中的安全性及可追溯性。

---

## AD.1 AI 輔助安全編碼工作流程

將 AI 工具整合到組織的安全軟體開發生命週期（SSDLC）中，同時不削弱現有的安全防護門檻。

|   #    | 描述                                                  | 等級  | 角色  |
| :----: | --------------------------------------------------- | :-: | :-: |
| AD.1.1 | 確認已記錄的工作流程描述了何時以及如何使用 AI 工具來生成、重構或審查程式碼。            |  1  | D/V |
| AD.1.2 | 確認該工作流程對應到每個SSDLC階段（設計、實作、程式碼審查、測試、部署）。             |  2  |  D  |
| AD.1.3 | 驗證是否收集了 AI 產生的程式碼的指標（例如，漏洞密度、平均偵測時間），並將其與純人工基準進行比較。 |  3  | D/V |

---

## AD.2 AI 工具資格認證與威脅建模

在採用AI編碼工具之前，請確保對其安全功能、風險及供應鏈影響進行評估。

|   #    | 描述                                                       | 等級  | 角色  |
| :----: | -------------------------------------------------------- | :-: | :-: |
| AD.2.1 | 驗證每個 AI 工具的威脅模型是否識別濫用、模型反轉、資料外洩和依賴鏈風險。                   |  1  | D/V |
| AD.2.2 | 確認工具評估包含對任何本地組件的靜態/動態分析以及對 SaaS 端點（TLS、身份驗證/授權、日誌記錄）的評估。 |  2  |  D  |
| AD.2.3 | 確認評估符合公認的框架，並在重大版本變更後重新執行。                               |  3  | D/V |

---

## AD.3 安全提示與上下文管理

在構建 AI 模型的提示或上下文時，防止洩露機密、專有代碼和個人數據。

|   #    | 描述                                       | 等級  | 角色  |
| :----: | ---------------------------------------- | :-: | :-: |
| AD.3.1 | 確認書面指導禁止在提示中發送機密、憑證或機密資料。                |  1  | D/V |
| AD.3.2 | 驗證技術控制（客戶端遮蔽、已批准的上下文過濾器）是否自動剝除敏感資訊。      |  2  |  D  |
| AD.3.3 | 驗證提示和回應在傳輸及靜態狀態下皆已進行分詞和加密，且保留期限符合資料分類政策。 |  3  | D/V |

---

## AD.4 AI 生成程式碼的驗證

在代碼合併或部署之前，檢測並修復由 AI 輸出引入的漏洞。

|   #    | 描述                                                          | 等級  | 角色  |
| :----: | ----------------------------------------------------------- | :-: | :-: |
| AD.4.1 | 確保 AI 生成的程式碼始終經過人類程式碼審查。                                    |  1  | D/V |
| AD.4.2 | 驗證所有包含 AI 生成代碼的拉取請求都會執行自動掃描器（SAST/IAST/DAST），並在發現重大問題時阻止合併。 |  2  |  D  |
| AD.4.3 | 驗證微分模糊測試或基於屬性的測試是否證明關鍵安全行為（例如，輸入驗證、授權邏輯）。                   |  3  | D/V |

---

## AD.5 程式碼建議的可解釋性與可追蹤性

為審計員和開發人員提供關於建議原因及其演變過程的見解。

|   #    | 描述                                                     | 等級  | 角色  |
| :----: | ------------------------------------------------------ | :-: | :-: |
| AD.5.1 | 確認提示/回應對已記錄有提交識別碼。                                     |  1  | D/V |
| AD.5.2 | 驗證開發者是否能夠呈現支持建議的模型引用（訓練片段、文件）。                         |  2  |  D  |
| AD.5.3 | 確認可解釋性報告與設計工件一同存檔，並在安全審查中予以引用，以符合 ISO/IEC 42001 追蹤性原則。 |  3  | D/V |

---

## AD.6 持續反饋與模型微調

隨著時間推移提升模型安全性能，同時防止負向漂移。

|   #    | 描述                                                            | 等級  | 角色  |
| :----: | ------------------------------------------------------------- | :-: | :-: |
| AD.6.1 | 確認開發人員能夠標記不安全或不合規的建議，並且這些標記能被追蹤。                              |  1  | D/V |
| AD.6.2 | 確認彙總的回饋用於定期的微調或以經過審核的安全編碼語料庫（例如 OWASP Cheat Sheets）進行檢索增強式生成。 |  2  |  D  |
| AD.6.3 | 確認閉環評估框架在每次微調後執行迴歸測試；在部署前，安全指標必須達到或超過先前的基線標準。                 |  3  | D/V |

---

### 參考文獻

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)


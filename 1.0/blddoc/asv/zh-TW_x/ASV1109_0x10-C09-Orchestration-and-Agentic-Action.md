# 9 自主編排與代理性行動的安全性

## 控制目標

確保自治或多代理 AI 系統只能執行那些被明確指定、經過驗證、可審計，且在受限成本與風險閾值內的行動。這可防範包括 Autonomous-System 妥協、工具濫用、代理迴圈偵測、通訊劫持、身份偽造、群體操控，以及意圖操控等威脅。

---

## 9.1 智能體任務規劃與遞迴預算

限制遞迴計畫，並強制對特權動作設置人工審核點。

|   #   | 描述                                                  | 等級  | 角色  |
| :---: | --------------------------------------------------- | :-: | :-: |
| 9.1.1 | 驗證最大遞迴深度、廣度、實際牆鐘時間、符元數量，以及每次代理執行的金錢成本，是否集中配置且受版本控制。 |  1  | D/V |
| 9.1.2 | 確認特權或不可逆的操作（例如程式碼提交、資金轉移）在執行之前必須透過可審計的通道取得明確的人類審批。  |  1  | D/V |
| 9.1.3 | 驗證實時資源監控在任何預算閾值被超過時，是否會觸發斷路器中斷，從而停止進一步任務擴展。         |  2  |  D  |
| 9.1.4 | 請確認斷路器事件已被記錄，內容包含代理 ID、觸發條件，以及捕捉到的計畫狀態，以供法證審查。      |  2  | D/V |
| 9.1.5 | 驗證安全測試是否涵蓋預算耗竭與失控計畫情境，確保在不造成資料遺失的情況下安全停止。           |  3  |  V  |
| 9.1.6 | 確保預算政策以策略即代碼的形式表達，並在 CI/CD 中被強制執行，以阻止配置漂移。          |  3  |  D  |

---

## 9.2 工具 插件 沙箱化

隔離工具互動，以防止未經授權的系統存取或程式碼執行。

|   #   | 描述                                                                                              | 等級  | 角色  |
| :---: | ----------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.2.1 | 驗證每個工具/插件是否在 OS、容器或 WASM-level 沙箱中執行，並具備 least-privilege file-system、network，以及 system-call 政策。 |  1  | D/V |
| 9.2.2 | 驗證沙箱資源配額（CPU、記憶體、磁碟、網路流出量）以及執行超時是否已被實施並被記錄。                                                     |  1  | D/V |
| 9.2.3 | 驗證工具二進位檔或描述符是否已數位簽名；在載入之前必須先驗證簽名。                                                               |  2  | D/V |
| 9.2.4 | 驗證沙箱遙測是否串流至 SIEM；異常（例如，嘗試的外發連線）會觸發警報。                                                           |  2  |  V  |
| 9.2.5 | 確保高風險插件在投入生產部署之前經過安全審查與滲透測試。                                                                    |  3  |  V  |
| 9.2.6 | 驗證沙箱逃逸嘗試是否會自動被阻止，並將有問題的插件隔離以待調查。                                                                |  3  | D/V |

---

## 9.3 自主迴圈與成本邊界

檢測並阻止失控的代理-代理遞迴與成本暴增。

|   #   | 描述                                            | 等級  | 角色  |
| :---: | --------------------------------------------- | :-: | :-: |
| 9.3.1 | 驗證 inter-agent 呼叫是否包含 跳數限制 或 TTL，執行階段遞減並強制執行。 |  1  | D/V |
| 9.3.2 | 驗證代理是否維持唯一的調用圖識別碼，以便檢測自我調用或循環模式。              |  2  |  D  |
| 9.3.3 | 驗證累計的計算單位與花費計數器是否在每個請求鏈中被追蹤；一旦超過限制，該鏈就會中止。    |  2  | D/V |
| 9.3.4 | 驗證形式分析或模型檢查是否能顯示代理人協議中不存在無界遞迴。                |  3  |  V  |
| 9.3.5 | 驗證迴圈中止事件是否會觸發警報，並為持續改進指標提供數據。                 |  3  |  D  |

---

## 9.4 協議層級濫用防護

在代理與外部系統之間建立安全的通訊通道，以防止被劫持或被操控。

|   #   | 描述                                                        | 等級  | 角色  |
| :---: | --------------------------------------------------------- | :-: | :-: |
| 9.4.1 | 確保所有代理與工具之間的訊息，以及代理之間的訊息，均經過認證（例如雙向 TLS 或 JWT），並且實現端到端加密。 |  1  | D/V |
| 9.4.2 | 確保模式被嚴格驗證；未知欄位或格式不正確的訊息將被拒絕。                              |  1  |  D  |
| 9.4.3 | 請驗證完整性檢查（MAC 或數位簽章）是否覆蓋整個訊息有效載荷，包括工具參數。                   |  2  | D/V |
| 9.4.4 | 在協議層實施重放保護（使用一次性隨機數（nonce）或時間戳窗口）。                        |  2  |  D  |
| 9.4.5 | 驗證協議實作是否經過模糊測試與靜態分析，以檢測注入漏洞或反序列化漏洞。                       |  3  |  V  |

---

## 9.5 代理身份與防篡改證據

確保行為可追溯且修改可被偵測。

|   #   | 描述                                  | 等級  | 角色  |
| :---: | ----------------------------------- | :-: | :-: |
| 9.5.1 | 驗證每個代理實例是否擁有唯一的密碼學身份（金鑰對或硬體根憑證）。    |  1  | D/V |
| 9.5.2 | 驗證所有代理行為均已簽名並標註時間戳；日誌應包含簽名以確保不可否認性。 |  2  | D/V |
| 9.5.3 | 驗證防篡改日誌是否儲存在追加式媒介或一次寫入媒介中。          |  2  |  V  |
| 9.5.4 | 驗證身分密鑰是否依照既定時間表定期輪換，並在出現妥協跡象時進行輪換。  |  3  |  D  |
| 9.5.5 | 確認偽裝攻擊或金鑰衝突嘗試會立即對受影響的代理實體進行隔離。      |  3  | D/V |

---

## 9.6 多智能體-蜂群風險降低

降低集體行為所造成的風險，透過隔離與形式化安全建模。

|   #   | 描述                                        | 等級  | 角色  |
| :---: | ----------------------------------------- | :-: | :-: |
| 9.6.1 | 驗證位於不同安全域的代理是否在彼此隔離的執行時沙箱或網路分段中執行。        |  1  | D/V |
| 9.6.2 | 在部署之前，確認群體行為已建模，並經過形式化驗證，以確保其存活性與安全性。     |  3  |  V  |
| 9.6.3 | 驗證執行時監控是否能偵測出新出現的不安全模式（例如，振盪、死鎖），並啟動糾正措施。 |  3  |  D  |

---

## 9.7 使用者與工具的認證 / 授權

對每個由代理觸發的動作實施嚴密的訪問控制。

|   #   | 描述                                      | 等級  | 角色  |
| :---: | --------------------------------------- | :-: | :-: |
| 9.7.1 | 驗證代理是否以一級主體身分向下游系統進行認證，且絕不重複使用最終使用者的憑證。 |  1  | D/V |
| 9.7.2 | 驗證細粒度授權策略是否限制代理可調用的工具以及可提供的參數。          |  2  |  D  |
| 9.7.3 | 驗證在每次呼叫時都重新執行權限檢查（持續授權），而非只在會話開始時。      |  2  |  V  |
| 9.7.4 | 驗證委派權限是否會自動過期，並在逾時或範圍變更後需要重新取得同意。       |  3  |  D  |

---

## 9.8 代理-代理 通訊安全

對所有 inter-agent 訊息進行加密與完整性保護，以防止窺聽與竄改。

|   #   | 描述                                       | 等級  | 角色  |
| :---: | ---------------------------------------- | :-: | :-: |
| 9.8.1 | 確保代理通道必須採用雙向認證與具備完美前向保密性的加密（例如 TLS 1.3）。 |  1  | D/V |
| 9.8.2 | 在處理之前，請確保訊息完整性與來源已被驗證；若驗證失敗，將發出警報並丟棄該訊息。 |  1  |  D  |
| 9.8.3 | 驗證通訊元資料（時間戳、序列號）是否已被記錄，以支援取證重建。          |  2  | D/V |
| 9.8.4 | 驗證是否透過形式驗證或模型檢驗能證實協議狀態機不會被推入不安全的狀態。      |  3  |  V  |

---

## 9.9 意圖驗證與約束執行

驗證代理行動是否與用戶所述的意圖及系統約束相符。

|   #   | 描述                                            | 等級  | 角色  |
| :---: | --------------------------------------------- | :-: | :-: |
| 9.9.1 | 驗證執行前的約束求解器是否根據硬編碼的安全與政策規則檢查提出的行動。            |  1  |  D  |
| 9.9.2 | 請驗證高影響力的操作（財務、破壞性、隱私敏感）是否需要由發起該操作的使用者明確表達其意圖。 |  2  | D/V |
| 9.9.3 | 驗證後置條件檢查，確認已完成的動作是否達成預期效果且沒有副作用；若出現差異，將觸發回滾。  |  2  |  V  |
| 9.9.4 | 驗證形式化方法（例如模型檢查、定理證明）或屬性測試，證明代理計畫符合所有已宣告的約束。   |  3  |  V  |
| 9.9.5 | 驗證意圖不匹配或約束違反事件能促成持續改進循環與威脅情報共享。               |  3  |  D  |

---

## 9.10 代理 推理 策略 安全性

安全地選擇並執行不同的推理策略，包括 ReAct、Chain-of-Thought 與 Tree-of-Thoughts 方法。

|   #    | 描述                                                                                   | 等級  | 角色  |
| :----: | ------------------------------------------------------------------------------------ | :-: | :-: |
| 9.10.1 | 驗證推理策略的選擇是否使用確定性準則（輸入複雜度、任務類型、安全上下文），並且在相同的安全上下文中，相同的輸入會產生相同的推理策略選擇。                 |  1  | D/V |
| 9.10.2 | 驗證每種推理策略（ReAct、Chain-of-Thought、Tree-of-Thoughts）是否具備專用的輸入驗證、輸出淨化，以及依其認知方法而定的執行時間限制。 |  1  | D/V |
| 9.10.3 | 驗證推理策略轉換是否已完整記錄，內容包含輸入特性、選擇條件值與執行元資料，以利審計軌跡重建。                                       |  2  | D/V |
| 9.10.4 | 驗證 Tree-of-Thoughts 推理是否包含分支修剪機制，並在檢測到策略違規、資源限制或安全邊界時終止探索。                           |  2  | D/V |
| 9.10.5 | 驗證 ReAct（Reason-Act-Observe）循環在每個階段都包含驗證檢查點：推理步驟驗證、行動授權，以及在繼續之前對觀察結果進行淨化。            |  2  | D/V |
| 9.10.6 | 確保推理策略的性能指標（執行時間、資源使用量、輸出品質）在指標偏離設定閾值時，會透過自動警報進行監控。                                  |  3  | D/V |
| 9.10.7 | 驗證結合多種策略的混合式推理方法，是否能在不繞過任何安全控制的前提下，維護所有組成策略的輸入驗證與輸出約束。                               |  3  | D/V |
| 9.10.8 | 請確認推理策略的安全性測試是否包含對格式錯誤輸入的模糊測試、旨在強制切換策略的對抗性提示，以及對每種認知方法的邊界條件測試。                       |  3  | D/V |

---

## 9.11 代理生命週期狀態管理與安全性

具備加密審計痕跡與已定義的恢復程序的安全代理初始化、狀態轉換與終止。

|   #    | 描述                                                                                | 等級  | 角色  |
| :----: | --------------------------------------------------------------------------------- | :-: | :-: |
| 9.11.1 | 驗證代理初始化是否包含以硬體背書的憑證進行的密碼學身份建立，以及不可變的啟動審計日誌，其內容包括代理 ID、時間戳、配置雜湊值與初始化參數。            |  1  | D/V |
| 9.11.2 | 驗證代理的狀態轉換是否經過密碼學簽名、附上時間戳，並完整記錄上下文，包括觸發事件、前一狀態雜湊值、新狀態雜湊值，以及所執行之安全性驗證。              |  2  | D/V |
| 9.11.3 | 核實代理關閉流程是否包含使用密碼學擦除或多次覆寫來安全清除記憶體、憑證撤銷並通知證書授權機構，以及生成防篡改的終止憑證。                      |  2  | D/V |
| 9.11.4 | 驗證代理恢復機制是否使用密碼學雜湊值（至少 SHA-256）來驗證狀態完整性，並在偵測到損壞時回滾至已知良好狀態，同時具備自動警報與人工審核要求。         |  3  | D/V |
| 9.11.5 | 驗證代理持久化機制是否使用每個代理各自的 AES-256 金鑰對敏感狀態資料進行加密，並在可配置的排程上實現安全的密鑰輪換（最多 90 天），同時實現零停機部署。 |  3  | D/V |

---

## 9.12 工具整合安全框架

動態工具載入、執行與結果驗證之安全控制，具備定義的風險評估與批准流程。

|   #    | 描述                                                                                     | 等級  | 角色  |
| :----: | -------------------------------------------------------------------------------------- | :-: | :-: |
| 9.12.1 | 驗證工具描述符是否包含安全性元資料，該元資料指示所需特權（讀取/寫入/執行）、風險等級（低/中/高）、資源限制（CPU、記憶體、網路），以及在工具清單檔案中記錄的驗證需求。 |  1  | D/V |
| 9.12.2 | 驗證工具執行結果在整合前是否符合預期的架構（JSON Schema、XML Schema）以及安全性政策（輸出淨化、資料分類），並具備逾時限制與錯誤處理程序。        |  1  | D/V |
| 9.12.3 | 驗證工具互動日誌是否包含詳盡的安全上下文，包括特權使用、資料存取模式、執行時間、資源消耗與返回碼，並採用結構化日誌以利 SIEM 整合。                   |  2  | D/V |
| 9.12.4 | 驗證動態工具載入機制是否使用公鑰基礎設施（PKI）驗證數位簽章，並實作具沙箱隔離的安全載入協定，在執行前進行權限驗證。                            |  2  | D/V |
| 9.12.5 | 確保新版本的工具安全評估會自動觸發，並具強制性審核門檻，該門檻包括靜態分析、動態測試，以及安全團隊審查，同時具備書面的審核標準與 SLA 要求。               |  3  | D/V |

---

### 參考文獻

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)


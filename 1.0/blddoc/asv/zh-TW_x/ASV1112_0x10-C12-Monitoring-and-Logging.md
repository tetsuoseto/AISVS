# C12 監控、日誌記錄與異常檢測

## 控制目標

本節提供了對模型及其他人工智慧元件所見、所做及所回傳內容的即時與取證能見度要求，以便能夠偵測、分流並從威脅中學習。

## C12.1 請求與回應記錄

|   #    | 描述                                                                | 等級  | 角色  |
| :----: | ----------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | 確認所有用戶提示和模型回應均已記錄並附有適當的元資料（例如時間戳記、用戶 ID、會話 ID、模型版本）。              |  1  | D/V |
| 12.1.2 | 確認日誌存儲在具有適當保留政策和備份程序的安全且受訪問控制的存儲庫中。                               |  1  | D/V |
| 12.1.3 | 確認日誌存儲系統在靜態和傳輸過程中均實施加密，以保護日誌中包含的敏感信息。                             |  1  | D/V |
| 12.1.4 | 驗證提示和輸出中的敏感數據在記錄之前是否會自動進行遮蔽或隱藏，並且對於個人身份信息（PII）、憑證和專有信息具有可配置的遮蔽規則。 |  1  | D/V |
| 12.1.5 | 確認政策決策和安全篩選行動有足夠詳盡的日誌記錄，以便進行內容審核系統的審計和除錯。                         |  2  | D/V |
| 12.1.6 | 驗證日誌完整性是否受到保護，例如通過密碼學簽名或僅寫存儲。                                     |  2  | D/V |

---

## C12.2 濫用檢測與警報

|   #    | 描述                                                 | 等級  | 角色  |
| :----: | -------------------------------------------------- | :-: | :-: |
| 12.2.1 | 驗證系統是否透過基於特徵碼的檢測來偵測並警報已知的越獄模式、提示注入嘗試和對抗性輸入。        |  1  | D/V |
| 12.2.2 | 確認系統使用標準日誌格式和協議與現有的安全資訊與事件管理（SIEM）平台進行整合。          |  1  | D/V |
| 12.2.3 | 驗證已增強的安全事件是否包含 AI 特定的上下文，例如模型識別碼、置信度分數和安全過濾決策。     |  2  | D/V |
| 12.2.4 | 確認行為異常偵測可識別不尋常的對話模式、過度重試嘗試或系統性探測行為。                |  2  | D/V |
| 12.2.5 | 驗證即時警報機制在偵測到潛在的政策違反或攻擊嘗試時，是否會通知安全團隊。               |  2  | D/V |
| 12.2.6 | 驗證是否包含自訂規則以檢測特定於人工智慧的威脅模式，包括協調的越獄嘗試、提示注入活動及模型擷取攻擊。 |  2  | D/V |
| 12.2.7 | 驗證自動化事件回應工作流程能夠隔離受損模型、阻止惡意使用者，並升級重要的安全事件。          |  3  | D/V |

---

## C12.3 模型漂移檢測

|   #    | 描述                                                | 等級  | 角色  |
| :----: | ------------------------------------------------- | :-: | :-: |
| 12.3.1 | 確認系統能追蹤基本性能指標，例如準確率、信心分數、延遲時間以及錯誤率，涵蓋不同模型版本及時間區段。 |  1  | D/V |
| 12.3.2 | 驗證自動警報是否在性能指標超過預設的退化閾值或明顯偏離基準時觸發。                 |  2  | D/V |
| 12.3.3 | 驗證幻覺檢測監控器是否能識別並標記模型輸出中包含事實錯誤、不一致或捏造資訊的情況。         |  2  | D/V |

---

## C12.4 性能與行為遙測

|   #    | 描述                                             | 等級  | 角色  |
| :----: | ---------------------------------------------- | :-: | :-: |
| 12.4.1 | 確認操作指標包括請求延遲、令牌消耗、記憶體使用率和吞吐量是否持續被收集和監控。        |  1  | D/V |
| 12.4.2 | 確認成功率和失敗率是否有分類追蹤錯誤類型及其根本原因。                    |  1  | D/V |
| 12.4.3 | 確認資源使用監控包含 GPU/CPU 使用率、記憶體消耗及儲存需求，並在閾值違反時發出警報。 |  2  | D/V |

---

## C12.5 人工智慧事件響應計畫與執行

|   #    | 描述                                           | 等級  | 角色  |
| :----: | -------------------------------------------- | :-: | :-: |
| 12.5.1 | 確認事故應對計劃明確涵蓋與 AI 相關的安全事件，包括模型被攻擊、數據投毒和對抗性攻擊。 |  1  | D/V |
| 12.5.2 | 確認事件回應團隊能夠取得專門針對人工智慧的鑑識工具和專業知識，以調查模型行為和攻擊向量。 |  2  | D/V |
| 12.5.3 | 驗證事故後分析是否包含模型再訓練的考量、安全過濾器的更新，以及將經驗教訓整合進安全控制。 |  3  | D/V |

---

## C12.5 AI 性能退化檢測

監控並檢測 AI 模型性能與品質隨時間的退化情況。

|   #    | 描述                                     | 等級  | 角色  |
| :----: | -------------------------------------- | :-: | :-: |
| 12.5.1 | 確認模型的準確率、精確率、召回率和F1分數持續被監控並與基線閾值進行比較。  |  1  | D/V |
| 12.5.2 | 驗證資料漂移偵測是否監控可能影響模型效能的輸入分布變化。           |  1  | D/V |
| 12.5.3 | 驗證概念漂移檢測是否能夠識別輸入與預期輸出之間關係的變化。          |  2  | D/V |
| 12.5.4 | 驗證性能下降是否會觸發自動警報並啟動模型重新訓練或替換工作流程。       |  2  | D/V |
| 12.5.5 | 驗證退化根本原因分析是否將性能下降與資料變更、基礎設施問題或外部因素相關聯。 |  3  |  V  |

---

## C12.6 有向無環圖 (DAG) 視覺化與工作流程安全

保護工作流程視覺化系統免於資訊外洩和操控攻擊。

|   #    | 描述                                          | 等級  | 角色  |
| :----: | ------------------------------------------- | :-: | :-: |
| 12.6.1 | 驗證DAG視覺化數據已進行清理，以在存儲或傳輸前移除敏感信息。             |  1  | D/V |
| 12.6.2 | 驗證工作流程可視化存取控制，確保只有授權使用者能查看代理的決策路徑和推理痕跡。     |  1  | D/V |
| 12.6.3 | 驗證DAG數據完整性是否通過加密簽名和防篡改存儲機制得到保護。             |  2  | D/V |
| 12.6.4 | 驗證工作流程視覺化系統是否實施輸入驗證，以防止通過精心製作的節點或邊數據進行注入攻擊。 |  2  | D/V |
| 12.6.5 | 驗證即時 DAG 更新是否受到速率限制並經過驗證，以防止對視覺化系統的拒絕服務攻擊。  |  3  | D/V |

---

## C12.7 主動安全行為監控

透過主動代理行為分析進行安全威脅的偵測與預防。

|   #    | 描述                                   | 等級  | 角色  |
| :----: | ------------------------------------ | :-: | :-: |
| 12.7.1 | 在執行之前，透過風險評估整合驗證主動代理行為的安全性。          |  1  | D/V |
| 12.7.2 | 確認自動主動觸發器包含安全上下文評估和威脅態勢評估。           |  2  | D/V |
| 12.7.3 | 確認主動行為模式是否已被分析，以評估其潛在的安全影響及意外後果。     |  2  | D/V |
| 12.7.4 | 驗證安全關鍵的主動行動需要明確的批准鏈和審計追蹤。            |  3  | D/V |
| 12.7.5 | 驗證行為異常檢測能夠識別主動代理模式中的偏差，這些偏差可能表示遭到入侵。 |  3  | D/V |

---

## 參考文獻

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


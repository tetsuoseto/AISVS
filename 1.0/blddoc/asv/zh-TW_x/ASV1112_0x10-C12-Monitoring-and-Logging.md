# C12 監控、日誌紀錄與異常偵測

## 控制目標

本節提供實時與取證層級的可視性需求，涵蓋模型與其他 AI 元件所見、所作及所回傳之內容，以便威脅能被偵測、分級評估，並由此學習。

## C12.1 請求與回應日誌

|   #    | 描述                                                                   | 等級  | 角色  |
| :----: | -------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | 確認所有使用者提示與模型回應皆已被記錄，並附有適當的元資料（例如時間戳、使用者 ID、會話 ID、模型版本）。              |  1  | D/V |
| 12.1.2 | 驗證日誌是否存放於安全、存取受控的儲存庫中，並具備適當的保留期限政策與備份程序。                             |  1  | D/V |
| 12.1.3 | 驗證日誌存儲系統是否實現靜態加密與傳輸中加密，以保護日誌中所包含的敏感資訊。                               |  1  | D/V |
| 12.1.4 | 確保在記錄日誌之前，提示與輸出中的敏感資料會自動被遮蔽或脫敏，並提供可配置的遮蔽規則，適用於 PII（個人可識別資訊）、憑證與專有資訊。 |  1  | D/V |
| 12.1.5 | 確保政策決定與安全過濾動作已被記錄為具足夠詳實的細節，以便對內容審核系統進行審計與除錯。                         |  2  | D/V |
| 12.1.6 | 驗證日誌完整性是否受到保護，例如透過密碼學簽名或寫入一次性儲存。                                     |  2  | D/V |

---

## C12.2 濫用偵測與告警

|   #    | 描述                                                  | 等級  | 角色  |
| :----: | --------------------------------------------------- | :-: | :-: |
| 12.2.1 | 驗證系統是否能以簽名式偵測為基礎，偵測並對已知的越獄模式、提示注入攻擊與對抗性輸入發出警報。      |  1  | D/V |
| 12.2.2 | 驗證該系統是否能與現有的安全資訊與事件管理（SIEM）平台整合，並使用標準日誌格式與協議。       |  1  | D/V |
| 12.2.3 | 驗證增強的安全事件是否包含人工智能相關上下文，例如模型標識符、置信度分數以及安全過濾決策。       |  2  | D/V |
| 12.2.4 | 驗證行為異常偵測是否能識別不尋常的對話模式、過度的重試次數或系統性探測行為。              |  2  | D/V |
| 12.2.5 | 確保實時告警機制在偵測到潛在的政策違規或攻擊嘗試時，能通知安全團隊。                  |  2  | D/V |
| 12.2.6 | 驗證是否已包含自訂規則，以偵測與 AI 相關的威脅模式，包括協同越獄嘗試、提示注入攻擊與模型提取攻擊。 |  2  | D/V |
| 12.2.7 | 驗證自動化事件回應工作流程是否能隔離遭妥協的模型、阻止惡意使用者，並對重大安全事件進行升級。      |  3  | D/V |

---

## C12.3 模型漂移偵測

|   #    | 描述                                             | 等級  | 角色  |
| :----: | ---------------------------------------------- | :-: | :-: |
| 12.3.1 | 驗證系統是否能在跨模型版本與時間期間追蹤基本性能指標，例如準確率、置信度分數、延遲和錯誤率。 |  1  | D/V |
| 12.3.2 | 驗證當性能指標超過預定的降解閾值或與基準值顯著偏離時，會觸發自動告警。            |  2  | D/V |
| 12.3.3 | 驗證幻覺偵測監控是否能識別並標示當模型輸出包含事實上不正確、不一致或捏造資訊的情況。     |  2  | D/V |

---

## C12.4 性能與行為遙測

|   #    | 描述                                                 | 等級  | 角色  |
| :----: | -------------------------------------------------- | :-: | :-: |
| 12.4.1 | 驗證包括請求延遲、令牌消耗、記憶體使用量和吞吐量等運作指標是否被持續收集與監控。           |  1  | D/V |
| 12.4.2 | 確認成功率與失敗率是否在追蹤時，依錯誤類型及其根本原因進行分類。                   |  1  | D/V |
| 12.4.3 | 驗證資源使用監控是否包含 GPU/CPU 使用量、記憶體使用量以及儲存需求，並在閾值突破時發出警報。 |  2  | D/V |

---

## C12.5 人工智慧 事件回應 規劃與執行

|   #    | 描述                                                | 等級  | 角色  |
| :----: | ------------------------------------------------- | :-: | :-: |
| 12.5.1 | 請確認事件回應計畫是否專門涵蓋與人工智慧相關的安全事件，包括模型被妥協、資料污染，以及對抗性攻擊。 |  1  | D/V |
| 12.5.2 | 確保事件回應團隊能取得人工智能專用的數位鑑識工具與專業知識，以調查模型行為與攻擊向量。       |  2  | D/V |
| 12.5.3 | 驗證事後分析是否包含模型再訓練的考慮因素、安全過濾器更新，以及將經驗教訓整合到安全控制中的措施。  |  3  | D/V |

---

## C12.5 AI 性能退化檢測

監控並偵測 AI 模型效能與品質隨時間的退化。

|   #    | 描述                                          | 等級  | 角色  |
| :----: | ------------------------------------------- | :-: | :-: |
| 12.5.1 | 驗證模型的準確度、精確度、召回率與 F1 分數是否持續受到監控，並與基線閾值進行比較。 |  1  | D/V |
| 12.5.2 | 驗證 資料漂移偵測 是否 能 監測 可能 影響 模型 效能 的 輸入 分佈 變化。   |  1  | D/V |
| 12.5.3 | 驗證概念漂移偵測是否能識別輸入與預期輸出之關係的變化。                 |  2  | D/V |
| 12.5.4 | 驗證性能下降是否會觸發自動警報，並啟動模型再訓練或替換工作流程。            |  2  | D/V |
| 12.5.5 | 驗證降級的根本原因分析是否能將性能下降與資料變更、基礎設施問題或外部因素相關聯。    |  3  |  V  |

---

## C12.6 有向無環圖可視化與工作流程安全

保護工作流程可視化系統，防止資訊洩漏與篡改攻擊。

|   #    | 描述                                             | 等級  | 角色  |
| :----: | ---------------------------------------------- | :-: | :-: |
| 12.6.1 | 驗證 DAG 視覺化資料在存儲或傳輸之前已去除敏感資訊。                   |  1  | D/V |
| 12.6.2 | 驗證工作流可視化的存取控制，確保只有經授權的使用者能查看代理的決策路徑與推理痕跡。      |  1  | D/V |
| 12.6.3 | 驗證 DAG 資料完整性是否透過密碼學簽名與防篡改儲存機制來保護。              |  2  | D/V |
| 12.6.4 | 請驗證工作流程可視化系統是否實作輸入驗證，以防止透過精心設計的節點或邊資料而造成的注入攻擊。 |  2  | D/V |
| 12.6.5 | 驗證實時有向無循環圖更新是否已實施速率限制並經過驗證，以防止對可視化系統的拒絕服務攻擊。   |  3  | D/V |

---

## C12.7 主動式安全行為監控

透過主動代理行為分析來偵測與防範安全威脅。

|   #    | 描述                                      | 等級  | 角色  |
| :----: | --------------------------------------- | :-: | :-: |
| 12.7.1 | 驗證在執行之前，主動代理行為已通過安全性驗證，並與風險評估整合。        |  1  | D/V |
| 12.7.2 | 驗證自主觸發機制是否包含安全情境評估與威脅態勢評估。              |  2  | D/V |
| 12.7.3 | 驗證前瞻性行為模式是否已進行分析，以評估潛在的安全影響與非預期後果。      |  2  | D/V |
| 12.7.4 | 驗證對安全至關重要的前瞻性行動是否需要具備明確的批准鏈與審計痕跡。       |  3  | D/V |
| 12.7.5 | 驗證行為異常檢測是否能識別主動代理模式中的偏差，這些偏差可能表示系統已被妥協。 |  3  | D/V |

---

## 參考文獻

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


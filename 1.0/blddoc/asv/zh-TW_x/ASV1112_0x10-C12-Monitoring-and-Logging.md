# C12 監控、日誌記錄與異常檢測

## 控制目標

本節提供了對模型及其他 AI 組件所見、所行及所回傳內容進行即時和取證可視化的需求，以便能夠偵測、分級處理威脅並從中學習。

## C12.1 請求與回應記錄

|   #    | 描述                                                             | 層級  | 角色  |
| :----: | -------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | 驗證所有使用者提示和模型回應是否均已記錄適當的元資料（例如：時間戳記、使用者識別碼、會話識別碼、模型版本）。         |  1  | D/V |
| 12.1.2 | 確認日誌存儲在安全的、具存取控制的存儲庫中，並具備適當的保留政策和備份程序。                         |  1  | D/V |
| 12.1.3 | 驗證日誌存儲系統是否實施靜態加密和傳輸加密，以保護日誌中包含的敏感信息。                           |  1  | D/V |
| 12.1.4 | 驗證提示和輸出中的敏感資料在記錄之前是否會自動刪除或遮罩，並且具備可配置的個人身份信息（PII）、憑證和專有資訊的刪除規則。 |  1  | D/V |
| 12.1.5 | 確認政策決策和安全過濾措施的記錄具有足夠的細節，以便對內容審核系統進行審計和除錯。                      |  2  | D/V |
| 12.1.6 | 確認日誌完整性透過例如加密簽章或唯寫存儲得到保護。                                      |  2  | D/V |

---

## C12.2 濫用偵測與警示

|   #    | 描述                                                  | 層級  | 角色  |
| :----: | --------------------------------------------------- | :-: | :-: |
| 12.2.1 | 驗證系統是否能透過基於特徵碼的檢測，偵測並警示已知的越獄模式、提示注入嘗試及對抗性輸入。        |  1  | D/V |
| 12.2.2 | 驗證系統是否使用標準日誌格式和協定與現有的安全資訊與事件管理（SIEM）平台整合。           |  1  | D/V |
| 12.2.3 | 驗證增強的安全事件是否包含 AI 特定的上下文，例如模型識別碼、信心分數以及安全過濾器決策。      |  2  | D/V |
| 12.2.4 | 驗證行為異常檢測是否能識別不尋常的對話模式、過度重試嘗試或系統性探測行為。               |  2  | D/V |
| 12.2.5 | 驗證即時警報機制是否在偵測到潛在政策違規或攻擊嘗試時通知安全團隊。                   |  2  | D/V |
| 12.2.6 | 驗證是否包含用於檢測特定於人工智慧的威脅模式的自訂規則，包括協同越獄嘗試、提示注入活動和模型擷取攻擊。 |  2  | D/V |
| 12.2.7 | 驗證自動化事件回應工作流程是否能夠隔離遭入侵的模型、阻止惡意使用者，並升級關鍵安全事件。        |  3  | D/V |

---

## C12.3 模型漂移檢測

|   #    | 描述                                              | 層級  | 角色  |
| :----: | ----------------------------------------------- | :-: | :-: |
| 12.3.1 | 驗證系統是否追蹤基本效能指標，如準確率、自信分數、延遲和錯誤率，並涵蓋不同模型版本及時間區段。 |  1  | D/V |
| 12.3.2 | 驗證當效能指標超過預定的下降閾值或顯著偏離基準時，自動警報是否會觸發。             |  2  | D/V |
| 12.3.3 | 驗證幻覺檢測監控是否能識別並標記模型輸出中包含事實錯誤、不一致或虛構信息的情況。        |  2  | D/V |

---

## C12.4 性能與行為遙測

|   #    | 描述                                             | 層級  | 角色  |
| :----: | ---------------------------------------------- | :-: | :-: |
| 12.4.1 | 確認持續收集和監控包括請求延遲、令牌消耗、記憶體使用率和吞吐量在內的運行指標。        |  1  | D/V |
| 12.4.2 | 確認成功率和失敗率是否有被追蹤，並且有分類錯誤類型及其根本原因。               |  1  | D/V |
| 12.4.3 | 確認資源使用監控包含 GPU/CPU 使用率、記憶體消耗和儲存需求，並在閾值違反時發出警報。 |  2  | D/V |

---

## C12.5 AI 事件響應規劃與執行

|   #    | 描述                                          | 層級  | 角色  |
| :----: | ------------------------------------------- | :-: | :-: |
| 12.5.1 | 確認事件響應計劃明確針對與 AI 相關的安全事件，包括模型妥協、數據中毒和對抗性攻擊。 |  1  | D/V |
| 12.5.2 | 確認事件應對團隊擁有 AI 專用的取證工具和專業知識，以調查模型行為和攻擊向量。    |  2  | D/V |
| 12.5.3 | 確認事故後分析包括模型再訓練的考量、安全過濾器的更新，以及將經驗教訓整合到安全控制中。 |  3  | D/V |

---

## C12.5 人工智慧效能退化偵測

監控並檢測 AI 模型性能與品質隨時間的退化情況。

|   #    | 描述                                      | 層級  | 角色  |
| :----: | --------------------------------------- | :-: | :-: |
| 12.5.1 | 確保模型的準確率、精確度、召回率和 F1 分數持續被監控並與基準門檻進行比較。 |  1  | D/V |
| 12.5.2 | 驗證資料漂移檢測是否監控可能影響模型效能的輸入分佈變化。            |  1  | D/V |
| 12.5.3 | 驗證概念漂移檢測是否能識別輸入與預期輸出之間關係的變化。            |  2  | D/V |
| 12.5.4 | 驗證性能下降是否會觸發自動警報並啟動模型再訓練或替換工作流程。         |  2  | D/V |
| 12.5.5 | 驗證退化根本原因分析是否將效能下降與資料變更、基礎設施問題或外部因素相關聯。  |  3  |  V  |

---

## C12.6 DAG 視覺化與工作流程安全

保護工作流程視覺化系統免受資訊外洩和操控攻擊。

|   #    | 描述                                        | 層級  | 角色  |
| :----: | ----------------------------------------- | :-: | :-: |
| 12.6.1 | 驗證DAG視覺化數據是否已經進行清理，以在儲存或傳輸前移除敏感資訊。        |  1  | D/V |
| 12.6.2 | 驗證工作流程視覺化存取控制，以確保只有授權用戶能查看代理決策路徑和推理痕跡。    |  1  | D/V |
| 12.6.3 | 驗證 DAG 資料完整性是否透過加密簽章和防篡改儲存機制獲得保護。         |  2  | D/V |
| 12.6.4 | 確認工作流程視覺化系統實施輸入驗證，以防止透過精心製作的節點或邊資料進行注入攻擊。 |  2  | D/V |
| 12.6.5 | 驗證即時 DAG 更新是否設有限速且經過驗證，以防止對可視化系統的拒絕服務攻擊。  |  3  | D/V |

---

## C12.7 主動安全行為監控

通過主動代理行為分析來檢測和防止安全威脅。

|   #    | 描述                                       | 層級  | 角色  |
| :----: | ---------------------------------------- | :-: | :-: |
| 12.7.1 | 在執行之前，通過風險評估整合驗證主動代理行為的安全性。              |  1  | D/V |
| 12.7.2 | 驗證自主行動觸發條件是否包含安全上下文評估和威脅態勢評估。            |  2  | D/V |
| 12.7.3 | 驗證主動行為模式是否已被分析其潛在的安全影響及意外後果。             |  2  | D/V |
| 12.7.4 | 驗證安全關鍵的主動行動需要明確的批准鏈和審計追蹤。                |  3  | D/V |
| 12.7.5 | 驗證行為異常檢測是否能識別出主動代理模式中的偏差，這些偏差可能表明系統遭到入侵。 |  3  | D/V |

---

## 參考文獻

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


# C5 AI元件與使用者之存取控制與身份管理

## 控制目標

對於人工智慧系統而言，有效的存取控制需要強健的身份管理、情境感知授權，以及遵循零信任原則的執行時強制措施。這些控制機制確保人類、服務和自主代理僅在明確授權的範圍內與模型、資料和計算資源互動，並具備持續驗證與稽核能力。

---

## C5.1 身份管理與認證

為所有實體建立由密碼學支持的身份，並針對特權操作實施多因素身份驗證。

|   #   | 描述                                                                               | 層級  | 角色  |
| :---: | -------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | 驗證所有人類用戶和服務主體皆透過集中式企業身份提供者（IdP）使用 OIDC/SAML 協議進行身份驗證，並且具有唯一的身份到令牌映射（不使用共用帳戶或憑證）。 |  1  | D/V |
| 5.1.2 | 驗證高風險操作（模型部署、權重匯出、訓練數據存取、產品配置變更）是否需要多因素身份驗證或具有會話重新驗證的升級身份驗證。                     |  1  | D/V |
| 5.1.3 | 確認新的主要人員在獲得生產系統訪問權限之前，已進行符合NIST 800-63-3 IAL-2或等效標準的身份驗證。                        |  2  |  D  |
| 5.1.4 | 確認存取審查每季度進行，並具備自動偵測閒置帳戶、憑證輪替強制執行及取消配發工作流程。                                       |  2  |  V  |
| 5.1.5 | 確認聯邦 AI 代理透過具簽章的 JWT 聲明進行驗證，該聲明具有最多 24 小時的有效期限，並包含來源的密碼學證明。                      |  3  | D/V |

---

## C5.2 資源授權與最小特權

為所有人工智慧資源實施細緻的存取控制，採用明確的權限模型與審計軌跡。

|   #   | 描述                                                                   | 層級  | 角色  |
| :---: | -------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | 驗證每個 AI 資源（數據集、模型、端點、向量集合、嵌入索引、計算實例）是否實施基於角色的存取控制，並具備明確的允許清單及預設拒絕政策。 |  1  | D/V |
| 5.2.2 | 確認服務帳戶預設執行最小權限原則，從只讀權限開始，並且寫入權限需有文件化的業務理由。                           |  1  | D/V |
| 5.2.3 | 驗證所有存取控制的修改均已連結至核准的變更請求，並以不可變方式記錄，包括時間戳記、操作人身份、資源識別碼及權限差異。           |  1  |  V  |
| 5.2.4 | 驗證資料分類標籤（PII、PHI、受出口管制、專有）是否自動傳播到衍生資源（嵌入、提示快取、模型輸出），並保持一致的政策執行。      |  2  |  D  |
| 5.2.5 | 驗證未經授權的訪問嘗試和權限提升事件是否在5分鐘內觸發包含上下文元資料的即時警報並發送至 SIEM 系統。                |  2  | D/V |

---

## C5.3 動態政策評估

部署基於屬性的存取控制（ABAC）引擎，以進行具備審計功能的情境感知授權決策。

|   #   | 描述                                                            | 層級  | 角色  |
| :---: | ------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | 驗證授權決策是否已外部化至可經由具加密完整性保護的驗證 API 存取之專用政策引擎（如 OPA、Cedar 或同等系統）。 |  1  | D/V |
| 5.3.2 | 驗證政策在執行時評估動態屬性，包括使用者許可等級、資源敏感性分類、請求上下文、租戶隔離及時間限制。             |  1  | D/V |
| 5.3.3 | 確認政策定義在正式部署到生產環境前，已經受到版本控制、同儕審查，並且通過 CI/CD 管線中的自動化測試驗證。       |  2  |  D  |
| 5.3.4 | 驗證政策評估結果是否包含結構化的決策理由，並且是否傳送至 SIEM 系統以進行關聯分析和合規報告。             |  2  |  V  |
| 5.3.5 | 驗證政策快取的存活時間（TTL）值對於高敏感度資源不超過5分鐘，對於具備快取失效能力的標準資源不超過1小時。        |  3  | D/V |

---

## C5.4 查詢時安全性執行

實施資料庫層的安全控制，包含強制過濾和列級安全政策。

|   #   | 描述                                                                               | 層級  | 角色  |
| :---: | -------------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | 驗證所有向量資料庫和 SQL 查詢均包含強制性的安全過濾條件（租戶 ID、敏感度標籤、使用者範圍），且這些過濾條件在資料庫引擎層級強制執行，而非在應用程式碼中。 |  1  | D/V |
| 5.4.2 | 驗證所有向量資料庫、搜索索引和訓練數據集是否啟用了具有策略繼承的列級安全性（RLS）政策和欄位級遮罩。                              |  1  | D/V |
| 5.4.3 | 驗證失敗的授權評估將通過立即中止查詢並返回明確的授權錯誤代碼，而非返回空結果集，從而防止「混淆代理攻擊」。                            |  2  |  D  |
| 5.4.4 | 確認政策評估延遲是否持續被監控，並且針對可能導致授權繞過的逾時狀況設有自動警示。                                         |  2  |  V  |
| 5.4.5 | 驗證查詢重試機制是否會重新評估授權政策，以考慮活躍用戶會話中動態權限的變更。                                           |  3  | D/V |

---

## C5.5 輸出篩選與資料外洩防護

部署後處理控制以防止未授權的數據泄露於AI生成的內容中。

|   #   | 描述                                                          | 層級  | 角色  |
| :---: | ----------------------------------------------------------- | :-: | :-: |
| 5.5.1 | 驗證推理後過濾機制能夠在向請求者交付內容之前掃描並刪除未授權的個人識別信息(PII)、機密信息和專有數據。       |  1  | D/V |
| 5.5.2 | 驗證模型輸出中的引用、參考文獻和來源歸屬是否符合調用者的授權，若發現未經授權的存取，則將其移除。            |  1  | D/V |
| 5.5.3 | 根據用戶權限等級和數據分類，驗證輸出格式限制（經過淨化的 PDF、去除元數據的圖像、批准的文件類型）是否得到強制執行。 |  2  |  D  |
| 5.5.4 | 確保遮蔽演算法具有決定性、版本控制，並且維護稽核日誌以支援合規調查與司法鑑識分析。                   |  2  |  V  |
| 5.5.5 | 驗證高風險的資訊遮蔽事件是否會產生包含原始內容加密雜湊的自適應日誌，以便在不暴露資料的情況下進行取證檢索。       |  3  |  V  |

---

## C5.6 多租戶隔離

確保共用 AI 基礎設施中租戶之間的加密與邏輯隔離。

|   #   | 描述                                                      | 層級  | 角色  |
| :---: | ------------------------------------------------------- | :-: | :-: |
| 5.6.1 | 確認記憶體空間、嵌入存儲、快取項目及暫存檔案是否依租戶進行命名空間分隔，並在租戶刪除或會話終止時進行安全清除。 |  1  | D/V |
| 5.6.2 | 驗證每個 API 請求是否包含經過認證的租戶識別碼，該識別碼需經過與會話上下文及用戶權限的密碼學驗證。     |  1  | D/V |
| 5.6.3 | 驗證網路策略是否在服務網格和容器編排平台中對跨租戶通信實施預設拒絕規則。                    |  2  |  D  |
| 5.6.4 | 驗證每個租戶的加密金鑰是否唯一，並支援客戶管理金鑰 (CMK) 以及租戶資料庫之間的密碼學隔離。        |  3  |  D  |

---

## C5.7 自主代理授權

透過範圍限定的能力權杖和持續授權來控制人工智慧代理和自主系統的權限。

|   #   | 描述                                                              | 層級  | 角色  |
| :---: | --------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | 驗證自主代理獲得具有範圍限制的能力令牌，該令牌明確列出允許的操作、可訪問的資源、時間界限及操作約束條件。            |  1  | D/V |
| 5.7.2 | 驗證高風險功能（檔案系統存取、程式碼執行、外部 API 呼叫、金融交易）是否預設被禁用，並且啟用時需具備明確授權及具業務理由。 |  1  | D/V |
| 5.7.3 | 驗證能力令牌是否綁定於使用者會話中，包含密碼學完整性保護，並確保其無法在離線情況下被持久保存或重複使用。            |  2  |  D  |
| 5.7.4 | 確認代理人啟動的操作透過 ABAC 政策引擎進行次級授權，並且包含完整的上下文評估及審計日誌。                 |  2  |  V  |
| 5.7.5 | 驗證代理錯誤條件和異常處理是否包含能力範圍資訊，以支援事件分析和取證調查。                           |  3  |  V  |

---

## 參考文獻

### 標準與架構

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### 實作指南

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### 人工智慧專用安全性

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


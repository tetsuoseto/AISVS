# C5 人工智慧元件與使用者的存取控制與身份管理

## 控制目標

對於 AI 系統，有效的存取控制需要強健的身份管理、情境感知的授權，以及遵循零信任原則的執行時強制措施。這些控制確保人員、服務和自主代理僅在明確授權的範圍內與模型、資料及計算資源互動，並具備持續驗證和審計的能力。

---

## C5.1 身份管理與認證

為所有實體建立以密碼學支持的身份，並對特權操作使用多因素身份驗證。

|   #   | 描述                                                                              | 等級  | 角色  |
| :---: | ------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | 驗證所有人類使用者和服務主體皆透過集中式企業身份提供者（IdP）使用 OIDC/SAML 協議進行認證，並且採用唯一的身份至令牌映射（不使用共用帳號或憑證）。 |  1  | D/V |
| 5.1.2 | 確認高風險操作（模型部署、權重匯出、訓練數據存取、生產環境配置變更）需使用多重身份驗證或逐步驗證並重新驗證會話。                        |  1  | D/V |
| 5.1.3 | 確認新任負責人在獲得生產系統存取權限之前，已進行與 NIST 800-63-3 IAL-2 或同等標準相符的身分驗證程序。                   |  2  |  D  |
| 5.1.4 | 確認存取審查每季度進行一次，並配合自動偵測閒置帳戶、執行憑證輪替以及解除配置工作流程。                                     |  2  |  V  |
| 5.1.5 | 驗證聯邦 AI 代理通過簽名的 JWT 斷言進行身份驗證，該斷言的最大有效期限為 24 小時，並包含來源的加密證明。                      |  3  | D/V |

---

## C5.2 資源授權與最小權限

對所有 AI 資源實施細粒度的存取控制，並採用明確的權限模型及稽核追蹤。

|   #   | 描述                                                                    | 等級  | 角色  |
| :---: | --------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | 驗證每個 AI 資源（數據集、模型、端點、向量集合、嵌入索引、計算實例）是否實施基於角色的存取控制，並且具有明確的允許清單和預設拒絕策略。 |  1  | D/V |
| 5.2.2 | 驗證服務帳戶預設執行最小權限原則，從唯讀權限開始，且需有書面業務正當理由方可授予寫入權限。                         |  1  | D/V |
| 5.2.3 | 驗證所有存取控制的修改皆與核准的變更請求相關聯，並以不可變更的方式記錄時間戳記、執行者身份、資源識別碼及權限差異。             |  1  |  V  |
| 5.2.4 | 驗證資料分類標籤（PII、PHI、出口管制、專有）是否能自動傳播到衍生資源（嵌入向量、提示緩存、模型輸出），並且執行一致的政策管理。    |  2  |  D  |
| 5.2.5 | 驗證未經授權的存取嘗試和權限提升事件是否在 5 分鐘內觸發包含上下文元資料的即時警報並發送至 SIEM 系統。               |  2  | D/V |

---

## C5.3 動態政策評估

部署基於屬性的存取控制（ABAC）引擎，以實現具審計功能的情境感知授權決策。

|   #   | 描述                                                                   | 等級  | 角色  |
| :---: | -------------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | 驗證授權決策是否外部化至專門的政策引擎（如 OPA、Cedar 或同等系統），並能通過帶有加密完整性保護的經過身份驗證的 API 存取。 |  1  | D/V |
| 5.3.2 | 驗證政策在執行時動態評估屬性，包括使用者安全等級、資源敏感性分類、請求上下文、租戶隔離及時間限制。                    |  1  | D/V |
| 5.3.3 | 確保政策定義在生產部署前經過版本控制、同儕審查，並通過 CI/CD 管線中的自動化測試驗證。                       |  2  |  D  |
| 5.3.4 | 驗證政策評估結果包含結構化的決策理由，並傳送至 SIEM 系統以進行關聯分析與合規報告。                         |  2  |  V  |
| 5.3.5 | 驗證政策快取存活時間（TTL）值是否不超過高敏感資源的 5 分鐘及具快取失效能力的標準資源的 1 小時。                 |  3  | D/V |

---

## C5.4 查詢時安全強制執行

實施資料庫層級的安全控制，包括強制過濾和列級安全政策。

|   #   | 描述                                                                            | 等級  | 角色  |
| :---: | ----------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | 確認所有向量資料庫和 SQL 查詢均包含強制性的安全過濾條件（租戶 ID、敏感性標籤、用戶範圍），且該過濾是在資料庫引擎層級強制執行，而非應用程序代碼中。 |  1  | D/V |
| 5.4.2 | 驗證所有向量資料庫、搜尋索引和訓練資料集是否啟用具有政策繼承的列級安全性（RLS）策略及欄位層級遮罩功能。                         |  1  | D/V |
| 5.4.3 | 驗證失敗的授權評估將透過立即中止查詢並返回明確的授權錯誤代碼，而非返回空的結果集，從而防止「混淆代理攻擊」。                        |  2  |  D  |
| 5.4.4 | 驗證政策評估延遲是否持續監控，並設有自動警報以偵測可能導致授權繞過的逾時條件。                                       |  2  |  V  |
| 5.4.5 | 驗證查詢重試機制是否會重新評估授權策略，以考慮在活躍使用者會話中的動態權限變更。                                      |  3  | D/V |

---

## C5.5 輸出篩選與資料遺失防護

部署後處理控制以防止未經授權的數據洩露於人工智慧生成內容中。

|   #   | 描述                                                         | 等級  | 角色  |
| :---: | ---------------------------------------------------------- | :-: | :-: |
| 5.5.1 | 確認推理後過濾機制在向請求者傳遞內容之前，掃描並刪除未經授權的個人可識別信息（PII）、機密信息及專有數據。     |  1  | D/V |
| 5.5.2 | 驗證模型輸出中的引文、參考文獻和來源歸屬是否符合呼叫者權限，若發現未授權訪問則予以移除。               |  1  | D/V |
| 5.5.3 | 根據使用者權限等級和資料分類，驗證是否強制執行輸出格式限制（經過清理的 PDF、剝除元資料的影像、批准的檔案類型）。 |  2  |  D  |
| 5.5.4 | 驗證遮蔽演算法是確定性的、有版本控制的，並且維護審計日誌以支持合規調查和取證分析。                  |  2  |  V  |
| 5.5.5 | 驗證高風險塗黑事件是否生成包含原始內容加密散列的自適應日誌，以便在不暴露數據的情況下進行取證檢索。          |  3  |  V  |

---

## C5.6 多租戶隔離

確保共用 AI 基礎設施中租戶之間的密碼學及邏輯隔離。

|   #   | 描述                                                      | 等級  | 角色  |
| :---: | ------------------------------------------------------- | :-: | :-: |
| 5.6.1 | 確認記憶體空間、嵌入存儲、快取項目和臨時檔案均依租戶進行命名空間分隔，並在租戶刪除或會話終止時進行安全清除。  |  1  | D/V |
| 5.6.2 | 驗證每個 API 請求皆包含經過身份驗證的租戶識別碼，且該識別碼經過與會話上下文及用戶授權相對應的密碼學驗證。 |  1  | D/V |
| 5.6.3 | 驗證網路政策是否在服務網格和容器編排平台中針對跨租戶通信實施預設拒絕規則。                   |  2  |  D  |
| 5.6.4 | 驗證加密金鑰在每個租戶中皆唯一，並支援客戶管理金鑰（CMK）及租戶資料存放間的加密隔離。            |  3  |  D  |

---

## C5.7 自主代理授權

透過範圍能力權杖和持續授權來控制 AI 代理和自主系統的權限。

|   #   | 描述                                                            | 等級  | 角色  |
| :---: | ------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | 確認自動代理接收範圍限定的能力令牌，明確列出允許的行動、可存取的資源、時間界限及操作限制。                 |  1  | D/V |
| 5.7.2 | 驗證高風險功能（檔案系統存取、程式碼執行、外部 API 呼叫、財務交易）預設為停用，並且啟用時需具備明確授權及業務合理性。 |  1  | D/V |
| 5.7.3 | 驗證能力令牌是否綁定於使用者會話，包含密碼學完整性保護，並確保它們無法在離線情況下被持久化或重複使用。           |  2  |  D  |
| 5.7.4 | 驗證代理發起的行動是否通過帶有完整上下文評估和審計日誌的 ABAC 政策引擎進行二次授權。                 |  2  |  V  |
| 5.7.5 | 驗證代理錯誤條件和異常處理是否包含能力範圍信息，以支持事件分析和取證調查。                         |  3  |  V  |

---

## 參考文獻

### 標準與框架

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### 實作指南

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### 人工智慧專用安全性

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


# C5 AI 元件與使用者的存取控制與身分識別

## 控制目標

AI 系統的有效存取控制需要健全的身份管理、具情境感知的授權，以及執行階段的強制執行，遵循零信任原則。這些控管確保人類、服務與自主代理僅在明確授權的範圍內與模型、資料與計算資源互動，並具備持續的驗證與審計能力。

---

## C5.1 身份管理與認證

為所有實體建立以密碼學為基礎的身分識別，並對特權操作實施多因素認證。

|   #   | 描述                                                                             | 等級  | 角色  |
| :---: | ------------------------------------------------------------------------------ | :-: | :-: |
| 5.1.1 | 驗證所有人類使用者與服務主體是否透過集中式企業身份提供者（IdP）使用 OIDC/SAML 協議進行認證，且具有唯一的身份到令牌映射（不得共用帳戶或憑證）。 |  1  | D/V |
| 5.1.2 | 驗證高風險操作（模型部署、權重匯出、訓練資料存取、生產配置變更）是否需要多因素驗證，或在會話重新驗證時實施階梯式驗證。                    |  1  | D/V |
| 5.1.3 | 在新主體取得生產系統存取權限之前，必須確保其身分驗證符合 NIST SP 800-63-3 IAL-2（身分驗證等級 2）或同等標準。            |  2  |  D  |
| 5.1.4 | 驗證存取審查按季進行，具備自動偵測休眠帳戶的能力、憑證輪換的強制執行，以及撤銷存取權限的工作流程。                              |  2  |  V  |
| 5.1.5 | 驗證聯邦式 AI 代理是否透過簽名的 JWT 聲明進行身份驗證，該聲明的最大有效期為 24 小時，並包含來源的密碼學證明。                  |  3  | D/V |

---

## C5.2 資源授權與最小特權原則

為所有 AI 資源實施細粒度的存取控制，並具備明確的權限模型與審計追蹤。

|   #   | 描述                                                                   | 等級  | 角色  |
| :---: | -------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | 驗證每個 AI 資源（資料集、模型、端點、向量集合、嵌入索引、計算實例）是否實施基於角色的存取控制，並具備明確的允許清單與預設拒絕策略。 |  1  | D/V |
| 5.2.2 | 驗證預設情況下是否強制執行最小特權原則，服務帳戶以唯讀權限為起點，且寫入存取必須具備書面的商業正當理由並已紀錄。             |  1  | D/V |
| 5.2.3 | 驗證所有存取控制變更是否與已核准的變更請求相關聯，並以不可變的方式記錄，包含時間戳、執行者身分、資源識別符，以及權限變動量。       |  1  |  V  |
| 5.2.4 | 驗證資料分類標籤 （PII、PHI、出口管制、專有）是否會自動傳播至衍生資源（嵌入向量、提示快取、模型輸出），並實施一致的政策。     |  2  |  D  |
| 5.2.5 | 驗證 未經授權 存取 嘗試 以及 特權 提升 事件 在 5 分鐘 內 觸發 即時 警報，並 附帶 上下文 元數據 至 SIEM 系統。  |  2  | D/V |

---

## C5.3 動態策略評估

部署基於屬性的存取控制（ABAC）引擎，以實現具情境感知的授權決策，並具審計功能。

|   #   | 描述                                                                  | 等級  | 角色  |
| :---: | ------------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | 驗證授權決策是否外部化至專用策略引擎（OPA、Cedar 或同等者），並透過經過身分驗證的 API 存取，且具備密碼學完整性保護機制。 |  1  | D/V |
| 5.3.2 | 驗證策略在執行時是否會評估動態屬性，包括使用者清除級別、資源敏感性分類、請求上下文、租戶隔離，以及時間限制。              |  1  | D/V |
| 5.3.3 | 確保策略定義在投入生產部署之前，已具備版本控制、同行評審，並透過自動化測試在 CI/CD 管道中驗證。                 |  2  |  D  |
| 5.3.4 | 驗證政策評估結果是否包含結構化的決策理據，並將其傳送至 SIEM 系統，以進行相關性分析與合規性報告。                 |  2  |  V  |
| 5.3.5 | 驗證策略快取 TTL（Time-to-Live）值在高敏感資源上不超過 5 分鐘；在具備快取失效機制的標準資源上不超過 1 小時。   |  3  | D/V |

---

## C5.4 查詢時的安全強制

實施資料庫層級安全控制，包含強制過濾機制與行級安全策略。

|   #   | 描述                                                                         | 等級  | 角色  |
| :---: | -------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | 驗證所有向量資料庫與 SQL 查詢都包含強制性的安全過濾條件（租戶 ID、敏感性標籤、使用者範圍），須在資料庫引擎層級強制執行，而非在應用程式碼中。 |  1  | D/V |
| 5.4.2 | 請確認所有向量資料庫、搜尋索引與訓練資料集均已啟用行級安全（RLS）策略與欄位級遮罩，並具備策略繼承。                        |  1  | D/V |
| 5.4.3 | 驗證失敗的授權評估是否能透過立即中止查詢並返回明確的授權錯誤碼，而不是返回空的結果集，以防止「混淆代理人攻擊」。                   |  2  |  D  |
| 5.4.4 | 驗證策略評估延遲是否受到持續監控，且設有自動警報，以在可能導致授權繞過的逾時條件發生時通知。                             |  2  |  V  |
| 5.4.5 | 驗證查詢重試機制是否會重新評估授權政策，以考慮在活躍用戶會話中的動態權限變化。                                    |  3  | D/V |

---

## C5.5 輸出過濾與資料外洩防護

部署 後處理 控制 以 防止 未經 授權 的 資料 洩露 在 AI 生成 的 內容 中。

|   #   | 描述                                                           | 等級  | 角色  |
| :---: | ------------------------------------------------------------ | :-: | :-: |
| 5.5.1 | 驗證推論後過濾機制在向請求者交付內容之前，掃描並遮蔽未經授權的 PII（個人可識別信息）、機密信息以及專有數據。     |  1  | D/V |
| 5.5.2 | 驗證模型輸出中的引文、參考資料與來源歸屬，是否已依呼叫方的權限進行驗證；若偵測到未經授權的存取，則將其移除。       |  1  | D/V |
| 5.5.3 | 驗證輸出格式限制（經過淨化的 PDF、移除元資料的影像、已核准的檔案類型）是否根據使用者權限等級與資料分類而被強制執行。 |  2  |  D  |
| 5.5.4 | 驗證去識別化算法是否具確定性、版本控制能力，並維護審計日誌，以支援合規調查與鑑識分析。                  |  2  |  V  |
| 5.5.5 | 驗證高風險遮蔽事件是否會生成自適應日誌，這些日誌應包含原始內容的加密雜湊值，以便進行法證檢索且不暴露資料內容。      |  3  |  V  |

---

## C5.6 多租戶隔離

確保在共享的人工智慧基礎設施中，租戶之間的密碼學與邏輯隔離。

|   #   | 描述                                                           | 等級  | 角色  |
| :---: | ------------------------------------------------------------ | :-: | :-: |
| 5.6.1 | 驗證記憶體空間、嵌入向量存儲、快取條目與暫存檔案是否以租戶為單位進行命名空間隔離，並在租戶刪除或會話終止時實施安全抹除。 |  1  | D/V |
| 5.6.2 | 驗證每個 API 請求是否包含經過身份驗證的租戶識別碼，且該識別碼必須以密碼學方式與會話上下文及使用者存取權限相互驗證。 |  1  | D/V |
| 5.6.3 | 驗證網路策略是否在服務網格與容器編排平台中實現跨租戶通信的預設拒絕規則。                         |  2  |  D  |
| 5.6.4 | 驗證加密金鑰在每個租戶中是否唯一，並支援客戶管理金鑰（CMK），以及在租戶資料儲存區之間實現密碼學隔離。         |  3  |  D  |

---

## C5.7 自主代理授權

透過具範圍的能力令牌與持續授權，對 AI 代理與自治系統的權限進行管控。

|   #   | 描述                                                                  | 等級  | 角色  |
| :---: | ------------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | 驗證自主代理是否收到具範圍限制的能力令牌，該令牌能明確列舉允許的動作、可存取的資源、時間界限以及運作約束。               |  1  | D/V |
| 5.7.2 | 驗證高風險能力（檔案系統存取、程式碼執行、外部 API 呼叫、金融交易）在預設情況下被停用，並且在啟用時需要以商業理由取得明確的授權。 |  1  | D/V |
| 5.7.3 | 驗證能力令牌是否綁定到使用者會話，包含密碼學完整性保護，並確保它們不能在離線情境下被持久化或重新使用。                 |  2  |  D  |
| 5.7.4 | 驗證由代理人啟動的動作是否透過 ABAC 策略引擎進行二次授權，並進行完整情境評估與審計日誌記錄。                   |  2  |  V  |
| 5.7.5 | 驗證代理程式的錯誤條件與例外處理是否包含能力範圍資訊，以支援事件分析與取證調查。                            |  3  |  V  |

---

## 參考文獻

### 標準與框架

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### 實作指南

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### 人工智慧-專用安全

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


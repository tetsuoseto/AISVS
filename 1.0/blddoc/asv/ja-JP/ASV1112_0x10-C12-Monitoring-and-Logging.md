# C12 監視、ログ記録、および異常検知

## 制御目標

このセクションでは、モデルやその他のAIコンポーネントが何を見て、何をし、何を返すかについてリアルタイムおよびフォレンジックの可視性を提供するための要件を示しており、これにより脅威を検出、識別、学習することができます。

## C12.1 要求および応答のログ記録

|   #    | 説明                                                                                      | レベル | 役割  |
| :----: | --------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | すべてのユーザープロンプトとモデルの応答が、適切なメタデータ（例：タイムスタンプ、ユーザーID、セッションID、モデルバージョン）と共に記録されていることを確認してください。 |  1  | D/V |
| 12.1.2 | ログが適切な保持ポリシーおよびバックアップ手順を備えた、安全でアクセス制御されたリポジトリに保存されていることを確認してください。                       |  1  | D/V |
| 12.1.3 | ログストレージシステムが、ログに含まれる機密情報を保護するために保存時および転送時の暗号化を実装していることを確認してください。                        |  1  | D/V |
| 12.1.4 | プロンプトおよび出力内の機密データがログ記録前に自動的に編集またはマスクされることを確認し、PII、認証情報、および機密情報に対する設定可能な編集ルールを適用してください。  |  1  | D/V |
| 12.1.5 | ポリシー決定および安全性フィルタリングの操作が、コンテンツモデレーションシステムの監査およびデバッグを可能にする十分な詳細で記録されていることを検証してください。       |  2  | D/V |
| 12.1.6 | ログの完全性が暗号署名や書き込み専用ストレージなどによって保護されていることを確認してください。                                        |  2  | D/V |

---

## C12.2 悪用検出および警告

|   #    | 説明                                                                                              | レベル | 役割  |
| :----: | ----------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | システムが既知のジャイルブレイクパターン、プロンプトインジェクションの試み、および署名ベースの検出を用いた敵対的入力を検出し、警告を発することを検証してください。               |  1  | D/V |
| 12.2.2 | システムが標準のログ形式およびプロトコルを使用して、既存のセキュリティ情報およびイベント管理（SIEM）プラットフォームと統合されていることを検証してください。                |  1  | D/V |
| 12.2.3 | 強化されたセキュリティイベントに、モデル識別子、信頼度スコア、安全フィルタの判断など、AI特有のコンテキストが含まれていることを確認してください。                       |  2  | D/V |
| 12.2.4 | 行動異常検出が、異常な会話パターン、過剰な再試行試行、または体系的な探査行動を特定することを検証してください。                                         |  2  | D/V |
| 12.2.5 | 潜在的なポリシー違反や攻撃試行が検出されたときに、リアルタイムのアラート機構がセキュリティチームに通知することを検証してください。                               |  2  | D/V |
| 12.2.6 | カスタムルールが、協調されたジャイルブレイク試行、プロンプトインジェクションキャンペーン、およびモデル抽出攻撃を含むAI特有の脅威パターンを検出するために含まれていることを確認してください。 |  2  | D/V |
| 12.2.7 | 自動化されたインシデント対応ワークフローが、侵害されたモデルを隔離し、悪意のあるユーザーをブロックし、重要なセキュリティイベントをエスカレーションできることを検証してください。        |  3  | D/V |

---

## C12.3 モデルドリフト検出

|   #    | 説明                                                                                  | レベル | 役割  |
| :----: | ----------------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | システムがモデルのバージョンおよび時間経過にわたって精度、信頼スコア、レイテンシ、およびエラー率などの基本的なパフォーマンス指標を追跡していることを確認してください。 |  1  | D/V |
| 12.3.2 | 性能指標が事前に定義された劣化閾値を超えるか、ベースラインから大きく逸脱した場合に自動アラートがトリガーされることを確認してください。                 |  2  | D/V |
| 12.3.3 | モデル出力に事実誤認、一貫性のない情報、または虚構の情報が含まれている場合に、幻覚検出モニターがそれらの事例を識別してフラグを立てることを確認してください。      |  2  | D/V |

---

## C12.4 パフォーマンスおよび動作のテレメトリ

|   #    | 説明                                                                      | レベル | 役割  |
| :----: | ----------------------------------------------------------------------- | :-: | :-: |
| 12.4.1 | リクエストの遅延、トークン消費量、メモリ使用量、スループットを含む運用指標が継続的に収集および監視されていることを確認してください。      |  1  | D/V |
| 12.4.2 | 成功率と失敗率が、エラータイプとその根本原因の分類とともに追跡されていることを確認してください。                        |  1  | D/V |
| 12.4.3 | リソース利用状況の監視にGPU/CPU使用率、メモリ消費、ストレージ要件が含まれ、しきい値を超えた場合のアラートがあることを確認してください。 |  2  | D/V |

---

## C12.5 AI インシデント対応計画および実行

|   #    | 説明                                                                         | レベル | 役割  |
| :----: | -------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | インシデント対応計画が、モデルの損害、データポイズニング、敵対的攻撃を含むAI関連のセキュリティ事象に具体的に対応していることを確認してください。  |  1  | D/V |
| 12.5.2 | インシデント対応チームが、モデルの挙動や攻撃ベクターを調査するためのAI特有のフォレンジックツールと専門知識にアクセスできることを確認してください。 |  2  | D/V |
| 12.5.3 | インシデント後の分析に、モデル再訓練の検討、安全フィルターの更新、および教訓のセキュリティ管理への統合が含まれていることを確認してください。     |  3  | D/V |

---

## C12.6 AIパフォーマンス劣化検出

AIモデルの性能と品質の劣化を時間経過で監視し検出する。

|   #    | 説明                                                               | レベル | 役割  |
| :----: | ---------------------------------------------------------------- | :-: | :-: |
| 12.6.1 | モデルの精度、適合率、再現率、およびF1スコアが継続的に監視され、ベースラインの閾値と比較されていることを確認してください。   |  1  | D/V |
| 12.6.2 | データドリフト検出がモデルの性能に影響を与える可能性のある入力分布の変化を監視することを確認してください。            |  1  | D/V |
| 12.6.3 | コンセプトドリフト検出が、入力と期待される出力の関係の変化を識別することを確認してください。                   |  2  | D/V |
| 12.6.4 | パフォーマンスの低下が自動アラートをトリガーし、モデルの再トレーニングまたは置換ワークフローを開始することを確認してください。  |  2  | D/V |
| 12.6.5 | 劣化の根本原因分析が、性能低下をデータの変更、インフラストラクチャの問題、または外部要因と関連付けていることを確認してください。 |  3  |  V  |

---

## C12.7 DAG 可視化とワークフローセキュリティ

ワークフロービジュアライゼーションシステムを情報漏洩および改ざん攻撃から保護する。

|   #    | 説明                                                                                  | レベル | 役割  |
| :----: | ----------------------------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | DAGの可視化データが保存または送信される前に、機密情報が除去されていることを確認してください。                                    |  1  | D/V |
| 12.7.2 | ワークフローの可視化アクセス制御が、許可されたユーザーのみがエージェントの意思決定経路および推論のトレースを閲覧できることを確認してください。             |  1  | D/V |
| 12.7.3 | DAGデータの整合性が暗号署名および改ざん検知ストレージ機構によって保護されていることを検証します。                                  |  2  | D/V |
| 12.7.4 | ワークフロービジュアライゼーションシステムが、細工されたノードまたはエッジデータを介したインジェクション攻撃を防ぐために入力検証を実装していることを確認してください。 |  2  | D/V |
| 12.7.5 | リアルタイムのDAG更新がレート制限され、可視化システムへのサービス拒否攻撃を防ぐために検証されていることを確認してください。                     |  3  | D/V |

---

## C12.8 プロアクティブなセキュリティ行動モニタリング

プロアクティブなエージェント行動分析によるセキュリティ脅威の検出と防止。

|   #    | 説明                                                            | レベル | 役割  |
| :----: | ------------------------------------------------------------- | :-: | :-: |
| 12.8.1 | リスク評価の統合とともに、プロアクティブなエージェントの動作が実行前にセキュリティ検証されていることを確認してください。  |  1  | D/V |
| 12.8.2 | 自律的イニシアティブのトリガーには、セキュリティコンテキストの評価と脅威の状況分析が含まれていることを確認してください。  |  2  | D/V |
| 12.8.3 | 潜在的なセキュリティへの影響や意図しない結果について、プロアクティブな行動パターンが分析されていることを確認してください。 |  2  | D/V |
| 12.8.4 | セキュリティに重要な先制的な行動は、監査履歴を伴う明示的な承認チェーンを必要とすることを確認してください。         |  3  | D/V |
| 12.8.5 | 行動異常検知が、妥協を示す可能性のあるプロアクティブエージェントのパターンの逸脱を識別することを検証する。         |  3  | D/V |

---

## 参考文献

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)


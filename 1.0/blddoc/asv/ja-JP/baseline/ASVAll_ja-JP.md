## 口絵

### 標準について

人工知能セキュリティ検証標準（AISVS）は、データサイエンティスト、MLOpsエンジニア、ソフトウェアアーキテクト、開発者、テスター、セキュリティ専門家、ツールベンダー、規制当局、および消費者が、信頼性のあるAI対応システムおよびアプリケーションを設計、構築、テスト、検証するために使用できる、コミュニティ主導のセキュリティ要件カタログです。これは、データ収集やモデル開発から展開および継続的な監視に至るAIライフサイクル全体でのセキュリティコントロールを指定する共通言語を提供し、組織がAIソリューションのレジリエンス、プライバシー、および安全性を測定・向上させることを可能にします。

### 著作権とライセンス

バージョン 0.1（最初の公開ドラフト - 作業中）, 2025  

![license](images/license.png)
著作権© 2025 The AISVS Project。  

以下の条件でリリースされていますCreative Commons Attribution‑ShareAlike 4.0 International License.
この作品の再利用や配布を行う場合は、必ずそのライセンス条件を他者に明確に伝えなければなりません。

### プロジェクトリーダー

ジム・マニコ
アラス “ラス” メミシャジチ

### 寄稿者およびレビュー担当者

https://github.com/ottosulin
https://github.com/mbhatt1
https://github.com/vineethsai
https://github.com/cciprofm
https://github.com/deepakrpandey12


---

AISVSは、人工知能システムの特有のセキュリティ課題に対応するために特別に作成された全く新しい標準です。広範なセキュリティのベストプラクティスから着想を得ていますが、AISVSのすべての要件はAIの脅威環境を反映し、組織がより安全で強靭なAIソリューションを構築できるように、一から開発されています。

## 序文

人工知能セキュリティ検証基準（AISVS）バージョン1.0へようこそ！

### はじめに

AISVSは2025年に共同コミュニティの取り組みとして設立され、最新のAIモデル、パイプライン、AI対応サービスの設計、開発、展開、および運用時に考慮すべきセキュリティ要件を定義しています。

AISVS v1.0は、AIシステムのセキュリティを確保するための実用的でテスト可能な基準を作成するために、プロジェクトリード、作業グループ、および広範なコミュニティ貢献者の協働による成果を表しています。

このリリースの目的は、AISVSを簡単に導入できるようにするとともに、その定義された範囲に厳密に集中し、AI特有の急速に変化するリスク環境に対応することです。

### AISVS バージョン1.0の主な目的

バージョン1.0は、いくつかの指針となる原則に基づいて作成されます。

#### 明確に定義された範囲

各要件はAISVSの名称と使命に沿っている必要があります：

人工知能 – コントロールはAI/MLレイヤー（データ、モデル、パイプライン、または推論）で動作し、AI実務者の責任です。
セキュリティ – 要件は特定されたセキュリティ、プライバシー、または安全リスクを直接的に軽減します。
検証 – 言語は準拠性を客観的に検証できるように記述されています。
標準 – セクションは一貫した構造と用語を用いて、一貫性のある参照を形成します。
​
---

AISVSに従うことで、組織はAIソリューションのセキュリティ体制を体系的に評価・強化し、安全なAIエンジニアリングの文化を促進することができます。

## AISVSを使用して

人工知能セキュリティ検証標準（AISVS）は、最新のAIアプリケーションおよびサービスに対するセキュリティ要件を定義しており、アプリケーション開発者の管理下にある側面に焦点を当てています。

AISVSは、開発者、アーキテクト、セキュリティエンジニア、監査人を含む、AIアプリケーションのセキュリティを開発または評価するすべての人を対象としています。この章では、AISVSの構造と使用方法、検証レベルおよび想定される使用ケースについて紹介します。

### 人工知能セキュリティ検証レベル

AISVSは、セキュリティ検証の3つの上昇レベルを定義しています。各レベルは深さと複雑さを増し、組織がAIシステムのリスクレベルに応じてセキュリティ態勢を調整できるようにします。

組織はレベル1から開始し、セキュリティの成熟度と脅威への露出が増加するにつれて、段階的により高いレベルを採用していくことができます。

#### レベルの定義

AISVS v1.0の各要件は、以下のいずれかのレベルに割り当てられます：

 レベル1の要件

レベル1には、最も重要で基本的なセキュリティ要件が含まれます。これらは、他の前提条件や脆弱性に依存しない一般的な攻撃を防ぐことに重点を置いています。ほとんどのレベル1のコントロールは、実装が比較的簡単であるか、労力をかける価値が十分にある必須のものです。

 レベル 2 要件

レベル2は、より高度またはあまり一般的でない攻撃、および広範な脅威に対する多層防御に対応します。これらの要件は、より複雑なロジックを含む場合や特定の攻撃前提条件を対象とする場合があります。

 レベル3の要件

レベル3には、通常、実装がより困難であるか適用が状況依存のコントロールが含まれます。これらはしばしば、多層防御のメカニズムや、ニッチで標的を絞った、または高い複雑性を持つ攻撃に対する緩和策を表しています。

#### 役割 (D/V)

各AISVS要件は、主な対象者に応じてマークされています:

D – 開発者向け要件
V – 検証者/監査者向け要件
D/V – 開発者および検証者の両方に関連する

## C1 トレーニングデータガバナンスとバイアスマネジメント

### 管理目標

トレーニングデータは、出所、セキュリティ、品質、公平性を保持する方法で取得、取り扱い、管理されなければなりません。これにより、法的義務を果たし、トレーニング中に発生し得るバイアス、汚染、プライバシー侵害のリスクを減らし、それがAIの全ライフサイクルに影響を与える可能性を低減します。

---

### C1.1 トレーニングデータの出所

すべてのデータセットの検証可能なインベントリを維持し、信頼できるソースのみを受け入れ、監査可能性のためにすべての変更を記録してください。

 #1.1.1    レベル: 1    役割: D/V
 すべてのトレーニングデータソース（出所、管理者/所有者、ライセンス、収集方法、使用目的の制約、および処理履歴）の最新のインベントリが維持されていることを確認してください。
 #1.1.2    レベル: 1    役割: D/V
 トレーニングデータの処理が、不要な特徴、属性、またはフィールド（例：未使用のメタデータ、機微な個人識別情報（PII）、漏洩したテストデータ）を除外していることを検証してください。
 #1.1.3    レベル: 2    役割: D/V
 すべてのデータセットの変更が記録された承認ワークフローの対象であることを確認してください。
 #1.1.4    レベル: 3    役割: D/V
 データセットまたはサブセットが可能な場合にはウォーターマークやフィンガープリントが施されていることを確認してください。

---

### C1.2 トレーニングデータのセキュリティと完全性

トレーニングデータへのアクセスを制限し、保管時および転送時に暗号化し、改ざん、盗難、またはデータポイズニングを防ぐためにその整合性を検証します。

 #1.2.1    レベル: 1    役割: D/V
 トレーニングデータの保存およびパイプラインがアクセス制御によって保護されていることを検証する。
 #1.2.2    レベル: 2    役割: D/V
 トレーニングデータへのすべてのアクセスが、ユーザー、時間、アクションを含めて記録されていることを確認してください。
 #1.2.3    レベル: 2    役割: D/V
 トレーニングデータセットが、業界標準の暗号アルゴリズムおよびキー管理手法を用いて、転送中および保存時に暗号化されていることを検証してください。
 #1.2.4    レベル: 2    役割: D/V
 トレーニングデータの保存および転送時にデータの整合性を確保するために、暗号学的ハッシュやデジタル署名が使用されていることを確認してください。
 #1.2.5    レベル: 2    役割: D/V
 トレーニングデータの不正な改変や破損を防ぐために、自動検出技術が適用されていることを確認してください。
 #1.2.6    レベル: 2    役割: D/V
 不要な訓練データが安全に消去または匿名化されていることを確認してください。
 #1.2.7    レベル: 3    役割: D/V
 すべてのトレーニングデータセットのバージョンが一意に識別され、不変に保存され、ロールバックおよびフォレンジック分析をサポートするために監査可能であることを確認してください。

---

### C1.3 トレーニングデータのラベリング品質、整合性、およびセキュリティ

ラベルを保護し、重要なデータに対しては技術的なレビューを必須とします。

 #1.3.1    レベル: 2    役割: D/V
 ラベルアーティファクトの完全性と真正性を確保するために、暗号学的ハッシュまたはデジタル署名が適用されていることを確認してください。
 #1.3.2    レベル: 2    役割: D/V
 ラベリングインターフェースおよびプラットフォームが強力なアクセス制御を実施し、すべてのラベリング活動の改ざん検知可能な監査ログを維持し、不正な変更から保護していることを確認してください。
 #1.3.3    レベル: 3    役割: D/V
 ラベル内の機密情報が、保存時および転送時のデータフィールドレベルで削除、匿名化、または暗号化されていることを確認してください。

---

### C1.4 トレーニングデータの品質およびセキュリティ保証

自動検証、手動スポットチェック、および記録された修正を組み合わせて、データセットの信頼性を保証します。

 #1.4.1    レベル: 1    役割: D
 自動テストが、すべての取り込みまたは重要なデータ変換時にフォーマットエラーやヌル値を検出することを検証してください。
 #1.4.2    レベル: 2    役割: D/V
 LLMのトレーニングおよびファインチューニングパイプラインが、ポイズニング検出およびデータの整合性検証（例えば、統計的手法、異常値検出、埋め込み分析）を実装し、潜在的なポイズニング攻撃（例えば、ラベル反転、バックドアトリガー挿入、役割切り替えコマンド、影響力のあるインスタンス攻撃）やトレーニングデータの意図しないデータ破損を特定できることを検証してください。
 #1.4.3    レベル: 3    役割: D/V
 リスク評価に基づいて、生成された敵対的サンプルを用いた敵対的トレーニング、摂動を加えた入力によるデータ増強、または堅牢な最適化技術などの適切な防御策が、関連するモデルに対して実装され調整されていることを確認してください。
 #1.4.4    レベル: 2    役割: D/V
 自動生成されたラベル（例：LLMや弱い教師あり学習によるもの）が、誤認識、誤解を招くラベル、または信頼度の低いラベルを検出するために、信頼度の閾値および一貫性チェックの対象となっていることを確認する。
 #1.4.5    レベル: 3    役割: D
 自動化テストが、すべてのデータ取り込みや重要なデータ変換の際にラベルのズレを検出することを確認してください。

---

### C1.5 データ系譜とトレーサビリティ

監査対応およびインシデント対応のために、各データポイントの元データからモデル入力までの完全な経路を追跡します。

 #1.5.1    レベル: 2    役割: D/V
 各データポイントの系譜が、すべての変換、拡張、およびマージを含めて記録されており、再構築可能であることを確認します。
 #1.5.2    レベル: 2    役割: D/V
 系統記録が不変であり、安全に保存され、監査のためにアクセス可能であることを検証してください。
 #1.5.3    レベル: 2    役割: D/V
 系統追跡がプライバシー保護や生成技術によって生成された合成データを対象としていることを確認し、すべての合成データがパイプライン全体で明確にラベル付けされ、本物のデータと区別可能であることを確認してください。

---

### 参考文献

NIST AI Risk Management Framework
EU AI Act – Article 10: Data & Data Governance
MITRE ATLAS: Adversary Tactics for AI
Survey of ML Bias Mitigation Techniques – MDPI
Data Provenance & Lineage Best Practices – Nightfall AI
Data Labeling Quality Standards – LabelYourData
Training Data Poisoning Guide – Lakera.ai
CISA Advisory: Securing Data for AI Systems
ISO/IEC 23053: AI Management Systems Framework
IBM: What is AI Governance?
Google AI Principles
GDPR & AI Training Data – DataProtectionReport
Supply-Chain Security for AI Data – AppSOC
OpenAI Privacy Center – Data Deletion Controls
Adversarial ML Dataset – Kaggle

## C2 ユーザー入力検証

### 管理目標

ユーザー入力の堅牢な検証は、AIシステムに対する最も致命的な攻撃のいくつかに対する第一の防御線です。プロンプトインジェクション攻撃は、システムの指示を上書きしたり、機密データを漏洩させたり、モデルを許可されていない行動へと誘導したりする可能性があります。専用のフィルターや指示の階層構造が整っていない限り、研究によれば非常に長いコンテキストウィンドウを悪用する「マルチショット」 jailbreak が効果的であることが示されています。また、ホモグリフ置換やリートスピークのような微妙な敵対的摂動攻撃は、モデルの判断を静かに変更することがあります。

---

### C2.1 プロンプトインジェクション防御

プロンプトインジェクションは、AIシステムにおける主要なリスクの一つです。この手法に対する防御は、静的パターンフィルター、動的分類器、および指示階層の強制の組み合わせを用いて行われます。

 #2.1.1    レベル: 1    役割: D/V
 ユーザー入力が、継続的に更新される既知のプロンプトインジェクションパターン（脱獄キーワード、「前を無視」、ロールプレイチェーン、間接的なHTML/URL攻撃）に対して検査されていることを確認してください。
 #2.1.2    レベル: 1    役割: D/V
 システムが、コンテキストウィンドウの拡張後でも、システムまたは開発者メッセージがユーザーの指示を上書きする指示階層を強制していることを確認してください。
 #2.1.3    レベル: 2    役割: D/V
 敵対的評価テスト（例：Red Teamの「多ショット」プロンプト）が、各モデルまたはプロンプトテンプレートのリリース前に実行されていることを確認し、成功率の閾値と回帰に対する自動ブロッカーを設けること。
 #2.1.4    レベル: 2    役割: D
 サードパーティのコンテンツ（ウェブページ、PDF、電子メール）から発生するプロンプトが、メインプロンプトに連結される前に、分離された解析コンテキスト内で適切にサニタイズされていることを確認してください。
 #2.1.5    レベル: 3    役割: D/V
 すべてのプロンプトフィルタールールの更新、分類器モデルのバージョンおよびブロックリストの変更がバージョン管理され、監査可能であることを確認してください。

---

### C2.2 敵対的サンプル耐性

自然言語処理（NLP）モデルは、人間が見落としがちな微妙な文字や単語レベルの摂動に依然として脆弱であり、モデルはそれを誤分類しやすいです。

 #2.2.1    レベル: 1    役割: D
 基本的な入力正規化手順（Unicode NFC、類似文字のマッピング、空白のトリミング）がトークン化の前に実行されることを確認してください。
 #2.2.2    レベル: 2    役割: D/V
 統計的異常検出が、言語の標準から著しく高い編集距離、不自然に繰り返されるトークン、または異常な埋め込み距離を持つ入力を正しく検出することを確認してください。
 #2.2.3    レベル: 2    役割: D
 推論パイプラインが、高リスクのエンドポイント向けにオプションの敵対的トレーニング強化モデルバリアントや防御層（例：ランダム化、防御的蒸留）をサポートしていることを確認してください。
 #2.2.4    レベル: 2    役割: V
 疑わしい敵対的入力が隔離され、完全なペイロード（個人識別情報の削除後）とともにログ記録されていることを確認してください。
 #2.2.5    レベル: 3    役割: D/V
 既知の攻撃スイートの成功率などのロバストネスメトリクスが時間経過で追跡されており、リグレッションがリリース阻止要因を引き起こすことを確認してください。

---

### C2.3 スキーマ、タイプおよび長さの検証

不正な形式または過剰なサイズの入力を特徴とするAI攻撃は、パースエラー、フィールド間でのプロンプトの漏れ、およびリソースの枯渇を引き起こす可能性があります。決定論的なツール呼び出しを行う際には、厳格なスキーマの適用も前提条件となります。

 #2.3.1    レベル: 1    役割: D
 すべてのAPIまたは関数呼び出しエンドポイントが明示的な入力スキーマ（JSON Schema、Protobuf、またはマルチモーダルの同等物）を定義しており、入力がプロンプト組み立て前に検証されていることを確認してください。
 #2.3.2    レベル: 1    役割: D/V
 最大トークン数またはバイト数の制限を超える入力が、安全なエラーで拒否され、決して無言で切り捨てられないことを確認してください。
 #2.3.3    レベル: 2    役割: D/V
 タイプチェック（例：数値範囲、列挙型の値、画像/音声のMIMEタイプ）がクライアントコードだけでなく、サーバー側でも適用されていることを確認してください。
 #2.3.4    レベル: 2    役割: D
 意味的バリデーター（例：JSON Schema）が定数時間で実行され、アルゴリズム的DoSを防止することを検証してください。
 #2.3.5    レベル: 3    役割: V
 検証の失敗が、マスキングされたペイロードの断片と明確なエラーコードとともに記録され、セキュリティのトリアージを支援することを確認してください。

---

### C2.4 コンテンツおよびポリシースクリーニング

開発者は、禁止されている内容（違法な指示、ヘイトスピーチ、著作権で保護されたテキストなど）を要求する構文的に有効なプロンプトを検出し、それが拡散するのを防止できるようにする必要があります。

 #2.4.1    レベル: 1    役割: D
 コンテンツ分類器（ゼロショットまたはファインチューニング済み）が、暴力、自傷、ヘイト、性的コンテンツ、および違法なリクエストについてすべての入力をスコアリングし、設定可能な閾値を備えていることを検証します。
 #2.4.2    レベル: 1    役割: D/V
 ポリシーに違反する入力が標準化された拒否応答または安全な完了応答を受け取り、下流の大規模言語モデル（LLM）呼び出しに伝播しないことを確認してください。
 #2.4.3    レベル: 2    役割: D
 スクリーニングモデルまたはルールセットが少なくとも四半期ごとに再訓練／更新され、新たに観察されたジャイルブレイクまたはポリシーバイパスのパターンが取り込まれていることを確認してください。
 #2.4.4    レベル: 2    役割: D
 リクエスト時に解決される属性ベースのルールを通じて、ユーザー固有のポリシー（年齢、地域の法的制約）が遵守されていることを検証します。
 #2.4.5    レベル: 3    役割: V
 スクリーニングログに、SOC相関および将来のレッドチーム再生のための分類器の信頼度スコアとポリシーカテゴリタグが含まれていることを確認してください。

---

### C2.5 入力レート制限および不正使用防止

開発者は、入力レートを制限し、異常な使用パターンを検出することで、AIシステムに対する悪用、リソースの枯渇、および自動化攻撃を防止する必要があります。

 #2.5.1    レベル: 1    役割: D/V
 すべての入力エンドポイントに対して、ユーザーごと、IPごと、およびAPIキーごとのレート制限が適用されていることを確認してください。
 #2.5.2    レベル: 2    役割: D/V
 バーストおよび持続的なレート制限がDoS攻撃およびブルートフォース攻撃を防ぐように適切に調整されていることを確認してください。
 #2.5.3    レベル: 2    役割: D/V
 異常な使用パターン（例：短時間での連続リクエスト、入力洪水）が自動的なブロックまたはエスカレーションを引き起こすことを確認してください。
 #2.5.4    レベル: 3    役割: V
 悪用防止ログが保持され、新たな攻撃パターンのためにレビューされていることを確認してください。

---

### C2.6 マルチモーダル入力検証

AIシステムは、注入、回避、またはリソース乱用を防ぐために、非テキスト入力（画像、音声、ファイル）に対する堅牢な検証を含めるべきです。

 #2.6.1    レベル: 1    役割: D
 すべての非テキスト入力（画像、音声、ファイル）が処理前に種類、サイズ、およびフォーマットの検証を受けていることを確認してください。
 #2.6.2    レベル: 2    役割: D/V
 取り込み前にファイルがマルウェアおよびステガノグラフィックペイロードのスキャンを受けていることを確認してください。
 #2.6.3    レベル: 2    役割: D/V
 画像/音声入力が敵対的摂動や既知の攻撃パターンに対して検査されていることを確認してください。
 #2.6.4    レベル: 3    役割: V
 マルチモーダル入力検証の失敗が記録され、調査のためのアラートが発生することを確認してください。

---

### C2.7 入力の出所と帰属

AIシステムは、すべてのユーザー入力の起源を監視およびタグ付けすることで、監査、悪用追跡、およびコンプライアンスをサポートする必要があります。

 #2.7.1    レベル: 1    役割: D/V
 すべてのユーザー入力が取り込み時にメタデータ（ユーザーID、セッション、ソース、タイムスタンプ、IPアドレス）でタグ付けされていることを検証してください。
 #2.7.2    レベル: 2    役割: D/V
 処理されたすべての入力に対して、来歴メタデータが保持され、監査可能であることを確認してください。
 #2.7.3    レベル: 2    役割: D/V
 異常または信頼されていない入力ソースが検出され、強化された精査やブロックの対象となることを確認してください。

---

### C2.8 リアルタイム適応型脅威検出

開発者は、新しい攻撃パターンに適応し、コンパイルされたパターンマッチングによるリアルタイム保護を提供する高度なAI用脅威検出システムを採用すべきです。

 #2.8.1    レベル: 1    役割: D/V
 脅威検出パターンが、高性能なリアルタイムフィルタリングのために最適化された正規表現エンジンにコンパイルされており、レイテンシへの影響が最小限であることを検証してください。
 #2.8.2    レベル: 1    役割: D/V
 脅威検出システムが異なる脅威カテゴリ（プロンプトインジェクション、有害コンテンツ、機密データ、システムコマンド）ごとに別々のパターンライブラリを保持していることを確認してください。
 #2.8.3    レベル: 2    役割: D/V
 適応型脅威検出が、攻撃の頻度と成功率に基づいて脅威の感度を更新する機械学習モデルを組み込んでいることを確認してください。
 #2.8.4    レベル: 2    役割: D/V
 リアルタイムの脅威インテリジェンスフィードが、新しい攻撃シグネチャおよびIOC（侵害の指標）でパターンライブラリを自動的に更新することを確認してください。
 #2.8.5    レベル: 3    役割: D/V
 脅威検出の誤検知率が継続的に監視され、パターンの特異性が正当な利用ケースの干渉を最小限に抑えるよう自動的に調整されていることを確認してください。
 #2.8.6    レベル: 3    役割: D/V
 コンテキストベースの脅威分析が、検出精度を向上させるために入力ソース、ユーザーの行動パターン、セッション履歴を考慮していることを確認してください。
 #2.8.7    レベル: 3    役割: D/V
 脅威検出のパフォーマンス指標（検出率、処理遅延、リソース利用率）がリアルタイムで監視され、最適化されていることを確認してください。

---

### C2.9 マルチモーダルセキュリティ検証パイプライン

開発者は、特定の種類の脅威検出およびリソース分離を用いて、テキスト、画像、音声、その他のAI入力モードに対するセキュリティ検証を提供する必要があります。

 #2.9.1    レベル: 1    役割: D/V
 各入力モダリティに対して、ドキュメント化された脅威パターン（テキスト：プロンプトインジェクション、画像：ステガノグラフィー、オーディオ：スペクトログラム攻撃）および検出閾値を備えた専用のセキュリティバリデータがあることを検証してください。
 #2.9.2    レベル: 2    役割: D/V
 マルチモーダル入力が、各モダリティタイプに特有の定義されたリソース制限（メモリ、CPU、処理時間）を持つ分離されたサンドボックス内で処理されていることを確認し、それがセキュリティポリシーに文書化されていることを確認してください。
 #2.9.3    レベル: 2    役割: D/V
 クロスモーダル攻撃検出が、複数の入力タイプにまたがる協調攻撃（例：画像内のステガノグラフィックペイロードとテキスト内のプロンプトインジェクションの組み合わせ）を相関ルールとアラート生成によって識別することを検証してください。
 #2.9.4    レベル: 3    役割: D/V
 マルチモーダル検証の失敗が、すべての入力モダリティ、検証結果、脅威スコア、および相関分析を含む詳細なログ記録をトリガーし、SIEM統合のための構造化ログ形式であることを確認してください。
 #2.9.5    レベル: 3    役割: D/V
 モダリティ固有のコンテンツ分類器が、文書化されたスケジュール（最低でも四半期ごと）に従って、新しい脅威パターン、敵対的サンプル、およびベースライン閾値以上に維持されるパフォーマンスベンチマークで更新されていることを検証してください。

---

### 参考文献

LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security
Generative AI's Biggest Security Flaw Is Not Easy to Fix
Many-shot jailbreaking \ Anthropic
$PDF$ OpenAI GPT-4.5 System Card
Notebook for the CheckThat Lab at CLEF 2024
Mitigate jailbreaks and prompt injections – Anthropic
Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis
OWASP Top 10 for LLM Applications 2025 – WorldTech IT
OWASP Machine Learning Security Top Ten
Few words about AI Security – Jussi Metso
How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry
Easily enforcing valid JSON schema following – API
AI Safety + Cybersecurity R\&D Tracker – Fairly AI
Anthropic makes 'jailbreak' advance to stop AI models producing harmful results
Pattern matching filter rules - IBM
Real-time Threat Detection

## C3 モデルライフサイクル管理および変更管理

### 管理目標

AIシステムは、許可されていないまたは安全でないモデルの変更が本番環境に反映されるのを防ぐ変更管理プロセスを実装しなければなりません。この管理は、開発から展開、廃止に至るまでのライフサイクル全体を通じてモデルの整合性を保証し、迅速なインシデント対応を可能にし、すべての変更に対する責任を維持します。

コアセキュリティ目標：整合性、トレーサビリティ、およびリカバリ性を維持する管理されたプロセスを採用することにより、認可され、検証されたモデルのみが本番環境に到達すること。

---

### C3.1 モデルの認可と整合性

検証済みの整合性を持つ認可モデルのみが本番環境に到達します。

 #3.1.1    レベル: 1    役割: D/V
 展開前に、すべてのモデルアーティファクト（重み、設定、トークナイザー）が認可されたエンティティによって暗号的に署名されていることを検証してください。
 #3.1.2    レベル: 1    役割: D/V
 モデルの整合性が展開時に検証され、署名検証の失敗がモデルの読み込みを防止することを確認してください。
 #3.1.3    レベル: 2    役割: D/V
 モデルの起源記録に、承認機関の識別情報、トレーニングデータのチェックサム、合否状態を含む検証テスト結果、および作成日時が含まれていることを確認してください。
 #3.1.4    レベル: 2    役割: D/V
 すべてのモデルアーティファクトがセマンティックバージョニング（MAJOR.MINOR.PATCH）を使用していること、および各バージョンコンポーネントがどのような条件で増分されるかを文書化した基準があることを確認してください。
 #3.1.5    レベル: 2    役割: V
 依存関係の追跡がリアルタイムのインベントリを維持し、すべての利用システムを迅速に特定できることを検証してください。

---

### C3.2 モデルの検証およびテスト

モデルは展開前に定義されたセキュリティおよび安全性の検証をクリアしなければなりません。

 #3.2.1    レベル: 1    役割: D/V
 モデルが展開前に、事前に合意された組織の合格/不合格基準を含む入力検証、出力のサニタイズ、および安全性評価を含む自動化されたセキュリティテストを受けていることを確認してください。
 #3.2.2    レベル: 1    役割: D/V
 検証の失敗が、事前に指定された権限者による明示的なオーバーライド承認と文書化された業務上の正当化があった場合でも、自動的にモデルの展開をブロックすることを確認してください。
 #3.2.3    レベル: 2    役割: V
 テスト結果が暗号的に署名され、検証対象の特定モデルバージョンハッシュに不変的にリンクされていることを確認してください。
 #3.2.4    レベル: 2    役割: D/V
 緊急展開には、事前に合意された期間内に文書化されたセキュリティリスク評価と、あらかじめ指定されたセキュリティ権限者からの承認が必要であることを確認する。

---

### C3.3 制御された展開とロールバック

モデルのデプロイメントは管理され、監視され、かつ元に戻せるものでなければなりません。

 #3.3.1    レベル: 1    役割: D
 本番環境へのデプロイメントが、事前に合意されたエラー率、レイテンシー閾値、またはセキュリティアラート基準に基づく自動ロールバックトリガーを備えた段階的ロールアウトメカニズム（カナリーリリース、ブルーグリーンデプロイメント）を実装していることを確認してください。
 #3.3.2    レベル: 1    役割: D/V
 ロールバック機能が、事前に定められた組織の時間枠内でモデルの状態（重み、設定、依存関係）を完全にかつ原子的に復元することを確認してください。
 #3.3.3    レベル: 2    役割: D/V
 展開プロセスがモデルの起動前に暗号署名を検証し、整合性チェックサムを計算していることを確認し、不一致があった場合は展開を失敗させるようにしてください。
 #3.3.4    レベル: 2    役割: D/V
 緊急モデルシャットダウン機能が、自動回路遮断器または手動キルスイッチを通じて、定義済みの応答時間内にモデルエンドポイントを無効化できることを検証する。
 #3.3.5    レベル: 2    役割: V
 ロールバック用のアーティファクト（以前のモデルバージョン、構成、依存関係）が、インシデント対応のため組織のポリシーに従って、不変ストレージで保持されていることを確認してください。

---

### C3.4 変更の説明責任と監査

すべてのモデルライフサイクルの変更は、追跡可能かつ監査可能でなければなりません。

 #3.4.1    レベル: 1    役割: V
 すべてのモデル変更（展開、構成、廃止）が、タイムスタンプ、認証された実行者のID、変更タイプ、および変更前後の状態を含む不変の監査記録を生成することを確認してください。
 #3.4.2    レベル: 2    役割: D/V
 監査ログへのアクセスには適切な認可が必要であり、すべてのアクセス試行はユーザーの識別情報とタイムスタンプとともに記録されることを確認してください。
 #3.4.3    レベル: 2    役割: D/V
 プロンプトテンプレートおよびシステムメッセージが、必須のコードレビューと指定されたレビュアーからの承認を経てからデプロイされることを条件として、gitリポジトリでバージョン管理されていることを確認してください。
 #3.4.4    レベル: 2    役割: V
 監査記録に、保持期間内の任意のタイムスタンプにおけるモデル状態を完全に再構築できるように、モデルハッシュ、構成スナップショット、依存関係のバージョンなどの十分な詳細が含まれていることを確認してください。

---

### C3.5 セキュア開発プラクティス

モデルの開発およびトレーニングプロセスは、妥協を防ぐために安全な手順に従わなければなりません。

 #3.5.1    レベル: 1    役割: D
 モデル開発、テスト、および本番環境が物理的または論理的に分離されていることを確認してください。これらは共通のインフラストラクチャを共有せず、異なるアクセス制御が適用され、データストアも分離されています。
 #3.5.2    レベル: 1    役割: D
 モデルのトレーニングおよびファインチューニングが、ネットワークアクセスが制御された隔離環境で行われることを確認してください。
 #3.5.3    レベル: 1    役割: D/V
 トレーニングデータソースが整合性チェックによって検証され、モデル開発に使用される前に文書化された管理履歴を伴う信頼できるソースによって認証されていることを確認してください。
 #3.5.4    レベル: 2    役割: D
 モデル開発の成果物（ハイパーパラメータ、トレーニングスクリプト、設定ファイル）がバージョン管理に保存され、トレーニングでの使用前に同僚のレビュー承認が必要であることを確認してください。

---

### C3.6 モデル廃止と退役

モデルは、もはや必要でない場合やセキュリティ上の問題が特定された場合には、安全に廃止されなければなりません。

 #3.6.1    レベル: 1    役割: D
 モデルの廃止プロセスが依存関係グラフを自動的にスキャンし、すべての消費システムを特定し、廃止前に事前合意された通知期間を提供することを確認してください。
 #3.6.2    レベル: 1    役割: D/V
 退役したモデルアーティファクトが、文書化されたデータ保持ポリシーに従い、暗号消去または複数回の上書きにより安全に消去されていることを検証し、検証済みの破棄証明書を確認してください。
 #3.6.3    レベル: 2    役割: V
 モデルの廃止イベントがタイムスタンプと実行者の識別情報と共にログに記録されていること、またモデルの署名が再利用を防ぐために取り消されていることを確認してください。
 #3.6.4    レベル: 2    役割: D/V
 緊急モデル退役が、重要なセキュリティ脆弱性が発見された場合に、自動キルスイッチを通じて事前に設定された緊急対応時間内にモデルへのアクセスを無効化できることを検証してください。

---

### 参考文献

MLOps Principles
Securing AI/ML Ops – Cisco.com
Audit logs security: cryptographically signed tamper-proof logs
Machine Learning Model Versioning: Top Tools & Best Practices
AI Hygiene Starts with Models and Data Loaders – SEI Blog
How to handle versioning and rollback of a deployed ML model?
Reinforcement fine-tuning – OpenAI API
Auditing Machine Learning models: Governance, Data Security and …
Adversarial Training to Improve Model Robustness
What is AI adversarial robustness? – IBM Research
Exploring Data Provenance: Ensuring Data Integrity and Authenticity
MITRE ATLAS
AWS Prescriptive Guidance – Best practices for retiring applications …

## C4 インフラストラクチャ、構成および展開のセキュリティ

### 管理目標

AIインフラストラクチャは、特権昇格、サプライチェーンの改ざん、横移動に対して、セキュアな構成、ランタイム分離、信頼されたデプロイメントパイプライン、および包括的な監視を通じて強化されなければなりません。認可され検証されたインフラストラクチャコンポーネントと構成のみが、セキュリティ、整合性、および監査可能性を維持する管理されたプロセスを介して本番環境に到達します。

コアセキュリティ目標：暗号的に署名され、脆弱性スキャンを受けたインフラストラクチャコンポーネントのみが、セキュリティポリシーを強制し、不変の監査トレイルを維持する自動検証パイプラインを通じて本番環境に到達すること。

---

### C4.1 実行環境の分離

カーネルレベルの分離プリミティブと必須アクセス制御を通じて、コンテナの脱出および特権の昇格を防止します。

 #4.1.1    レベル: 1    役割: D/V
 すべてのAIコンテナが、CAP_SETUID、CAP_SETGID、およびセキュリティベースラインに記載された明示的に必要な権限を除き、すべてのLinux権限を削除していることを確認してください。
 #4.1.2    レベル: 1    役割: D/V
 seccompプロファイルが、事前に承認された許可リスト内のシステムコール以外のすべてのシステムコールをブロックし、違反があった場合はコンテナを終了させてセキュリティアラートを生成することを検証してください。
 #4.1.3    レベル: 2    役割: D/V
 AIワークロードが読み取り専用のルートファイルシステム、テンポラリデータ用のtmpfs、および実行不可（noexec）マウントオプションが適用された永続データ用の名前付きボリュームで実行されていることを検証してください。
 #4.1.4    レベル: 2    役割: D/V
 eBPFベースのランタイム監視（Falco、Tetragon、または同等のツール）が特権昇格の試みを検出し、組織の応答時間要件内で違反プロセスを自動的に終了することを検証してください。
 #4.1.5    レベル: 3    役割: D/V
 ハイリスクなAIワークロードが、証明検証を伴うハードウェア分離環境（Intel TXT、AMD SVM、または専用のベアメタルノード）で実行されていることを確認してください。

---

### C4.2 セキュアビルドおよびデプロイメントパイプライン

再現可能なビルドと署名付きアーティファクトによって、暗号学的整合性とサプライチェーンのセキュリティを確保します。

 #4.2.1    レベル: 1    役割: D/V
 インフラストラクチャ・アズ・コードが、すべてのコミットでツール（tfsec、Checkov、またはTerrascan）を用いてスキャンされていることを検証し、CRITICALまたはHIGHの重大度の検出結果がある場合はマージをブロックしてください。
 #4.2.2    レベル: 1    役割: D/V
 コンテナビルドがビルド間で同一のSHA256ハッシュで再現可能であることを検証し、Sigstoreで署名されたSLSAレベル3のプロビナンス認証を生成します。
 #4.2.3    レベル: 2    役割: D/V
 コンテナイメージがCycloneDXまたはSPDX SBOMを埋め込み、Cosignで署名されていることを検証し、署名されていないイメージはデプロイ時に拒否すること。
 #4.2.4    レベル: 2    役割: D/V
 CI/CDパイプラインが、HashiCorp Vault、AWS IAMロール、またはAzure Managed IdentityからのOIDCトークンを使用しており、その有効期間が組織のセキュリティポリシーの制限を超えていないことを確認してください。
 #4.2.5    レベル: 2    役割: D/V
 Cosign署名およびSLSA生成物がコンテナ実行前のデプロイプロセス中に検証され、検証エラーが発生した場合はデプロイが失敗することを確認してください。
 #4.2.6    レベル: 2    役割: D/V
 ビルド環境が一時的なコンテナまたはVMで実行され、永続的なストレージがなく、プロダクションVPCからのネットワーク分離が確保されていることを検証してください。

---

### C4.3 ネットワークセキュリティとアクセス制御

デフォルト拒否ポリシーと暗号化通信を用いてゼロトラストネットワーキングを実装する。

 #4.3.1    レベル: 1    役割: D/V
 KubernetesのNetworkPoliciesまたは同等の機能が、必要なポート（443、8080など）に対する明示的な許可ルールを持つデフォルト拒否（ingress/egress）を実装していることを確認してください。
 #4.3.2    レベル: 1    役割: D/V
 SSH（ポート22）、RDP（ポート3389）、およびクラウドメタデータエンドポイント（169.254.169.254）がブロックされているか、証明書ベースの認証が必要であることを確認してください。
 #4.3.3    レベル: 2    役割: D/V
 出口トラフィックがHTTP/HTTPSプロキシ（Squid、Istio、またはクラウドNATゲートウェイ）を通じてフィルタリングされており、ドメイン許可リストが設定され、ブロックされたリクエストがログに記録されていることを確認してください。
 #4.3.4    レベル: 2    役割: D/V
 インターサービス通信が相互TLSを使用し、証明書が組織のポリシーに従ってローテーションされていること、および証明書検証が強制されていること（スキップ検証フラグなし）を確認してください。
 #4.3.5    レベル: 2    役割: D/V
 AIインフラストラクチャが専用のVPC/VNetで稼働し、直接のインターネットアクセスがなく、NATゲートウェイまたはバスチオンホストのみを介して通信していることを確認してください。

---

### C4.4 シークレットおよび暗号鍵管理

ゼロトラストアクセスとハードウェア対応ストレージおよび自動ローテーションによって資格情報を保護します。

 #4.4.1    レベル: 1    役割: D/V
 秘密がHashiCorp Vault、AWS Secrets Manager、Azure Key Vault、またはGoogle Secret Managerに保存されており、AES-256を使用した保存時の暗号化が行われていることを確認してください。
 #4.4.2    レベル: 1    役割: D/V
 暗号鍵が組織の暗号ポリシーに従ったキー回転と共に、FIPS 140-2レベル2のHSM（AWS CloudHSM、Azure Dedicated HSM）で生成されていることを検証する。
 #4.4.3    レベル: 2    役割: D/V
 秘密情報のローテーションがゼロダウンタイムでのデプロイメントと自動化されており、かつ人事異動やセキュリティインシデントによって即時にローテーションがトリガーされることを確認してください。
 #4.4.4    レベル: 2    役割: D/V
 コンテナイメージがツール（GitLeaks、TruffleHog、またはdetect-secrets）でスキャンされ、APIキー、パスワード、または証明書を含むビルドがブロックされることを確認してください。
 #4.4.5    レベル: 2    役割: D/V
 本番環境の秘匿アクセスにはハードウェアトークン（YubiKey、FIDO2）を用いたMFAが必須であることを確認し、ユーザー識別情報とタイムスタンプを含む改ざん不可能な監査ログに記録されていることを検証してください。
 #4.4.6    レベル: 2    役割: D/V
 Kubernetesシークレット、マウントされたボリューム、またはinitコンテナを通じてシークレットが注入されていることを確認し、シークレットが環境変数やイメージに埋め込まれないようにしてください。

---

### C4.5 AI ワークロードのサンドボックス化と検証

包括的な行動分析を備えた安全なサンドボックスで信頼できないAIモデルを分離します。

 #4.5.1    レベル: 1    役割: D/V
 外部AIモデルがgVisor、FirecrackerやCrossVMなどのmicroVM、または--security-opt=no-new-privilegesおよび--read-onlyフラグ付きのDockerコンテナ内で実行されていることを確認してください。
 #4.5.2    レベル: 1    役割: D/V
 サンドボックス環境がネットワーク接続なし（--network=none）であるか、またはローカルホストのアクセスのみ許可され、すべての外部リクエストがiptablesルールによってブロックされていることを確認してください。
 #4.5.3    レベル: 2    役割: D/V
 AIモデルの検証に、組織的に定義されたテスト範囲と行動分析を用いたバックドア検出のための自動化されたレッドチームテストが含まれていることを確認してください。
 #4.5.4    レベル: 2    役割: D/V
 AIモデルが本番環境に昇格する前に、そのサンドボックスの結果が認可されたセキュリティ担当者によって暗号的に署名され、不変の監査ログに保存されていることを確認してください。
 #4.5.5    レベル: 2    役割: D/V
 評価間で完全なファイルシステムおよびメモリのクリーンアップを行い、サンドボックス環境がゴールデンイメージから破棄および再作成されていることを確認してください。

---

### C4.6 インフラストラクチャセキュリティモニタリング

インフラストラクチャを継続的にスキャンおよび監視し、自動修復とリアルタイムアラートを実施します。

 #4.6.1    レベル: 1    役割: D/V
 組織のスケジュールに従ってコンテナイメージがスキャンされていることを確認し、組織のリスク閾値に基づいてCRITICALな脆弱性がある場合はデプロイをブロックする。
 #4.6.2    レベル: 1    役割: D/V
 組織で定義されたコンプライアンス閾値および失敗したチェックの自動修復とともに、インフラストラクチャがCISベンチマークまたはNIST 800-53管理基準を満たしていることを検証します。
 #4.6.3    レベル: 2    役割: D/V
 組織のリスク管理タイムラインに従って、HIGH重大度の脆弱性が修正されていることを確認し、積極的に悪用されているCVEに対しては緊急対応手順を実施すること。
 #4.6.4    レベル: 2    役割: V
 セキュリティアラートがCEFまたはSTIX/TAXII形式を使用し、自動エンリッチメントを伴ってSIEMプラットフォーム（Splunk、Elastic、またはSentinel）と統合されていることを確認してください。
 #4.6.5    レベル: 3    役割: V
 インフラストラクチャのメトリクスがSLAダッシュボードおよびエグゼクティブレポートとともに監視システム（Prometheus、DataDog）にエクスポートされていることを確認してください。
 #4.6.6    レベル: 2    役割: D/V
 組織の監視要件に従い、設定のドリフトがツール（Chef InSpec、AWS Config）を使用して検出され、許可されていない変更に対して自動ロールバックが行われることを確認します。

---

### C4.7 AIインフラストラクチャリソース管理

リソース枯渇攻撃を防止し、クォータおよび監視を通じて公平なリソース割り当てを確保します。

 #4.7.1    レベル: 1    役割: D/V
 GPU/TPUの利用状況が監視されており、組織で定められた閾値でアラートが発生し、容量管理ポリシーに基づいて自動スケーリングまたは負荷分散が有効化されることを確認してください。
 #4.7.2    レベル: 1    役割: D/V
 AIのワークロード指標（推論レイテンシ、スループット、エラー率）が組織の監視要件に従って収集され、インフラ利用状況と相関していることを検証する。
 #4.7.3    レベル: 2    役割: D/V
 KubernetesのResourceQuotasまたは同等の機能が、組織のリソース配分ポリシーに基づいて個々のワークロードを制限し、ハードリミットを適用していることを検証してください。
 #4.7.4    レベル: 2    役割: V
 コスト監視が、組織の予算しきい値に基づくアラートおよび予算超過に対する自動制御とともに、ワークロード／テナントごとの支出を追跡していることを確認してください。
 #4.7.5    レベル: 3    役割: V
 容量計画が、組織で定義された予測期間に基づく過去のデータを使用し、需要パターンに基づく自動リソースプロビジョニングを行っていることを確認してください。
 #4.7.6    レベル: 2    役割: D/V
 リソース枯渇が、容量ポリシーに基づくレート制限やワークロードの分離を含む組織の対応要件に従ってサーキットブレーカーを作動させることを検証する。

---

### C4.8 環境分離およびプロモーション管理

自動化された昇格ゲートとセキュリティ検証により、厳格な環境境界を強制します。

 #4.8.1    レベル: 1    役割: D/V
 dev/test/prod 環境がそれぞれ別の VPC/VNet 上で動作しており、IAM ロール、セキュリティグループ、ネットワーク接続が共有されていないことを確認してください。
 #4.8.2    レベル: 1    役割: D/V
 環境のプロモーションには、組織的に定義された認可された担当者による暗号署名と変更不可能な監査証跡を伴う承認が必要であることを検証してください。
 #4.8.3    レベル: 2    役割: D/V
 本番環境がSSHアクセスをブロックし、デバッグエンドポイントを無効にし、緊急時を除き組織の事前通知要件を伴う変更要求を必須としていることを確認してください。
 #4.8.4    レベル: 2    役割: D/V
 インフラストラクチャ・アズ・コードの変更がメインブランチにマージされる前に、ピアレビューと自動テストおよびセキュリティスキャンを必須とすることを確認してください。
 #4.8.5    レベル: 2    役割: D/V
 非本番データが組織のプライバシー要件に従って匿名化されていること、合成データの生成、または個人識別情報（PII）の削除による完全なデータマスキングが検証されていることを確認してください。
 #4.8.6    レベル: 2    役割: D/V
 プロモーションゲートに自動化されたセキュリティテスト（SAST、DAST、コンテナスキャン）が含まれており、承認には重大な（CRITICAL）所見がゼロであることを確認してください。

---

### C4.9 インフラストラクチャ バックアップ＆リカバリー

自動化されたバックアップ、テスト済みの復旧手順、および災害復旧機能を通じてインフラストラクチャの回復力を確保します。

 #4.9.1    レベル: 1    役割: D/V
 インフラストラクチャの構成が、組織のバックアップスケジュールに従って、3-2-1バックアップ戦略を実装し、地理的に分散した地域にバックアップされていることを確認してください。
 #4.9.2    レベル: 2    役割: D/V
 ランサムウェア対策として、バックアップシステムが別個のネットワーク上で、別々の認証情報とエアギャップされたストレージを使用して稼働していることを検証してください。
 #4.9.3    レベル: 2    役割: V
 回復手順が組織のスケジュールに従って、自動テストにより検証および確認されていることを、かつRTOおよびRPOの目標が組織の要件を満たしていることを確認する。
 #4.9.4    レベル: 3    役割: V
 災害復旧にモデル重みの復元、GPUクラスターの再構築、サービス依存関係のマッピングを含むAI専用のランブックが含まれていることを確認してください。

---

### C4.10 インフラストラクチャのコンプライアンスとガバナンス

継続的な評価、文書化、および自動化されたコントロールを通じて規制遵守を維持します。

 #4.10.1    レベル: 2    役割: D/V
 SOC 2、ISO 27001、または FedRAMP コントロールに基づき、組織のスケジュールに従ってインフラストラクチャのコンプライアンスが評価され、自動化された証拠収集が行われていることを検証します。
 #4.10.2    レベル: 2    役割: V
 インフラストラクチャのドキュメントに、ネットワーク図、データフローマップ、および組織の変更管理要件に従って更新された脅威モデルが含まれていることを確認してください。
 #4.10.3    レベル: 3    役割: D/V
 インフラストラクチャの変更が、自動化されたコンプライアンス影響評価を経て、高リスクの変更には規制承認のワークフローが適用されることを確認してください。

---

### C4.11 AI ハードウェアセキュリティ

GPU、TPU、および専用のAIアクセラレータを含む、AI専用のハードウェアコンポーネントを保護する。

 #4.11.1    レベル: 2    役割: D/V
 AIアクセラレータのファームウェア（GPU BIOS、TPUファームウェア）が暗号署名で検証され、組織のパッチ管理スケジュールに従って更新されていることを確認してください。
 #4.11.2    レベル: 2    役割: D/V
 ワークロード実行前に、AIアクセラレータの整合性がTPM 2.0、Intel TXT、またはAMD SVMを使用したハードウェア認証によって検証されていることを確認してください。
 #4.11.3    レベル: 2    役割: D/V
 SR-IOV、MIG（マルチインスタンスGPU）、または同等のハードウェアパーティショニングを使用して、ジョブ間でメモリのサニタイズを行い、ワークロード間でGPUメモリが分離されていることを検証してください。
 #4.11.4    レベル: 3    役割: V
 AIハードウェアのサプライチェーンが、製造元の証明書による出所確認と改ざん検知包装の検証を含んでいることを確認してください。
 #4.11.5    レベル: 3    役割: D/V
 ハードウェアセキュリティモジュール（HSM）が、FIPS 140-2 レベル 3 または Common Criteria EAL4+ 認証を取得して、AIモデルの重みおよび暗号鍵を保護していることを確認してください。

---

### C4.12 エッジ＆分散AIインフラストラクチャ

エッジコンピューティング、フェデレーテッドラーニング、およびマルチサイトアーキテクチャを含む安全な分散AI展開。

 #4.12.1    レベル: 2    役割: D/V
 エッジAIデバイスが、組織の証明書管理ポリシーに従って証明書をローテーションしながら、デバイス証明書を用いて相互TLSで中央インフラストラクチャに認証することを検証してください。
 #4.12.2    レベル: 2    役割: D/V
 エッジデバイスが検証済み署名によるセキュアブートと、ファームウェアのダウングレード攻撃を防ぐロールバック保護を実装していることを確認する。
 #4.12.3    レベル: 3    役割: D/V
 分散AIの調整が、参加者の検証および悪意のあるノードの検出を伴うビザンチン障害耐性のコンセンサスアルゴリズムを使用していることを検証してください。
 #4.12.4    レベル: 3    役割: D/V
 エッジからクラウドへの通信が、帯域幅制限、データ圧縮、および安全なローカルストレージを備えたオフライン操作機能を含んでいることを確認してください。

---

### C4.13 マルチクラウド＆ハイブリッドインフラストラクチャセキュリティ

複数のクラウドプロバイダーおよびハイブリッドクラウド・オンプレミス展開にわたるAIワークロードを安全に保護します。

 #4.13.1    レベル: 2    役割: D/V
 マルチクラウドAI展開が、プロバイダー間での集中管理ポリシーと共に、クラウド非依存のアイデンティティフェデレーション（OIDC、SAML）を使用していることを確認してください。
 #4.13.2    レベル: 2    役割: D/V
 クロスクラウドデータ転送がエンドツーエンド暗号化を使用し、顧客管理のキーおよび法域ごとに強制されるデータ居住制御を適用していることを確認してください。
 #4.13.3    レベル: 2    役割: D/V
 ハイブリッドクラウドAIワークロードが、オンプレミス環境とクラウド環境の両方で一貫したセキュリティポリシーを実装し、統合された監視とアラート機能を備えていることを検証します。
 #4.13.4    レベル: 3    役割: V
 クラウドベンダーロックイン防止には、ポータブルなインフラストラクチャ・アズ・コード、標準化されたAPI、およびフォーマット変換ツールを備えたデータエクスポート機能が含まれていることを確認してください。
 #4.13.5    レベル: 3    役割: V
 マルチクラウドのコスト最適化には、リソースの過剰展開を防ぐセキュリティコントロールや、不正なクラウド間データ転送料金を防止する仕組みが含まれていることを確認してください。

---

### C4.14 インフラストラクチャ自動化とGitOpsセキュリティ

AIインフラ管理のためのセキュアなインフラストラクチャ自動化パイプラインとGitOpsワークフロー。

 #4.14.1    レベル: 2    役割: D/V
 GitOpsリポジトリがGPGキーによる署名済みコミットを必要とし、メインブランチへの直接プッシュを防ぐブランチ保護ルールを設定していることを確認してください。
 #4.14.2    レベル: 2    役割: D/V
 インフラストラクチャの自動化には、不正な変更に対する組織の対応要件に基づいてトリガーされる自動修復およびロールバック機能を備えたドリフト検知が含まれていることを検証してください。
 #4.14.3    レベル: 2    役割: D/V
 自動化されたインフラストラクチャのプロビジョニングにおいて、非準拠の構成に対して展開をブロックするセキュリティポリシー検証が含まれていることを確認してください。
 #4.14.4    レベル: 2    役割: D/V
 インフラストラクチャ自動化のシークレットが、自動ローテーション機能を備えた外部シークレットオペレーター（External Secrets Operator、Bank-Vaultsなど）を通じて管理されていることを確認してください。
 #4.14.5    レベル: 3    役割: V
 セルフヒーリングインフラストラクチャが、セキュリティイベントの相関分析と自動化されたインシデント対応およびステークホルダーへの通知ワークフローを含んでいることを確認してください。

---

### C4.15 量子耐性インフラストラクチャセキュリティ

ポスト量子暗号および量子安全プロトコルを通じて、量子コンピューティングの脅威に備えたAIインフラストラクチャを準備する。

 #4.15.1    レベル: 3    役割: D/V
 AIインフラストラクチャが、鍵交換およびデジタル署名のためにNIST承認のポスト量子暗号アルゴリズム（CRYSTALS-Kyber、CRYSTALS-Dilithium、SPHINCS+）を実装していることを確認してください。
 #4.15.2    レベル: 3    役割: D/V
 量子安全な鍵管理プロトコルを用いて、高セキュリティのAI通信のために量子鍵配送（QKD）システムが実装されていることを検証してください。
 #4.15.3    レベル: 3    役割: D/V
 暗号アジリティフレームワークが、自動化された証明書および鍵のローテーションによって新しいポスト量子アルゴリズムへの迅速な移行を可能にすることを検証してください。
 #4.15.4    レベル: 3    役割: V
 量子脅威モデリングが、文書化された移行タイムラインおよびリスク評価とともに、量子攻撃に対するAIインフラストラクチャの脆弱性を評価していることを検証してください。
 #4.15.5    レベル: 3    役割: D/V
 ハイブリッド古典量子暗号システムが、量子移行期間中に多層防御を提供し、性能監視を行うことを検証してください。

---

### C4.16 機密計算とセキュアエンクレーブ

ハードウェアベースの信頼実行環境および機密計算技術を使用して、AIワークロードとモデルの重みを保護します。

 #4.16.1    レベル: 3    役割: D/V
 機密性の高いAIモデルが、Intel SGXエンクレーブ、AMD SEV-SNP、またはARM TrustZone内で、暗号化メモリおよび認証検証を伴って実行されることを確認してください。
 #4.16.2    レベル: 3    役割: D/V
 機密コンテナ（Kata Containers、機密コンピューティングを使用した gVisor）がハードウェアで強制されるメモリ暗号化によりAIワークロードを分離していることを検証してください。
 #4.16.3    レベル: 3    役割: D/V
 リモート認証が、AIモデルをロードする前に、実行環境の真正性を証明する暗号学的証拠を用いてエンクレーブの完全性を検証することを確認してください。
 #4.16.4    レベル: 3    役割: D/V
 秘密の AI 推論サービスが、暗号化された計算、封印されたモデルの重み、および保護された実行を通じてモデル抽出を防止することを検証します。
 #4.16.5    レベル: 3    役割: D/V
 信頼された実行環境のオーケストレーションが、リモート認証および暗号化通信チャネルを用いてセキュアエンクレーブのライフサイクルを管理していることを検証する。
 #4.16.6    レベル: 3    役割: D/V
 安全なマルチパーティ計算（SMPC）が、個々のデータセットやモデルパラメータを公開することなく共同でAIトレーニングを可能にすることを検証してください。

---

### C4.17 ゼロ知識インフラストラクチャ

機密情報を明かさずに、プライバシー保護型AIの検証および認証のためのゼロ知識証明システムを実装する。

 #4.17.1    レベル: 3    役割: D/V
 ゼロ知識証明（ZK-SNARKs、ZK-STARKs）が、モデルの重みや訓練データを公開することなく、AIモデルの整合性および訓練の由来を検証することを確認します。
 #4.17.2    レベル: 3    役割: D/V
 ZKベースの認証システムは、身元に関する情報を明かすことなく、プライバシーを保護しながらAIサービスのユーザー認証を可能にすることを検証してください。
 #4.17.3    レベル: 3    役割: D/V
 プライベートセットインターセクション（PSI）プロトコルが、個々のデータセットを公開することなく連合AIのための安全なデータ照合を可能にすることを検証してください。
 #4.17.4    レベル: 3    役割: D/V
 ゼロ知識機械学習（ZKML）システムが、正しい計算の暗号学的証明によって検証可能なAI推論を可能にすることを確認してください。
 #4.17.5    レベル: 3    役割: D/V
 ZK-rollupsがバッチ検証と計算負荷の軽減により、スケーラブルでプライバシーを保護するAIトランザクション処理を提供することを検証する。

---

### C4.18 サイドチャネル攻撃防止

タイミング、電力、電磁気、およびキャッシュに基づくサイドチャネル攻撃からAIインフラストラクチャを保護し、機密情報の漏洩を防ぎます。

 #4.18.1    レベル: 3    役割: D/V
 AI推論のタイミングが一定時間アルゴリズムとパディングを用いて正規化されており、タイミングに基づくモデル抽出攻撃を防いでいることを検証してください。
 #4.18.2    レベル: 3    役割: D/V
 パワー解析保護には、ノイズ注入、電源ラインフィルタリング、およびランダム化された実行パターンが含まれていることを確認してください。
 #4.18.3    レベル: 3    役割: D/V
 キャッシュベースのサイドチャネル緩和策が、情報漏洩を防ぐためにキャッシュのパーティショニング、ランダム化、およびフラッシュ命令を使用していることを検証してください。
 #4.18.4    レベル: 3    役割: D/V
 電磁波放射保護には、TEMPESTスタイルの攻撃を防ぐために、シールド、信号フィルタリング、およびランダム化処理が含まれていることを確認してください。
 #4.18.5    レベル: 3    役割: D/V
 マイクロアーキテクチャのサイドチャネル防御には、投機的実行制御とメモリアクセスパターンの難読化が含まれていることを確認してください。

---

### C4.19 ニューロモルフィックおよび特殊AIハードウェアセキュリティ

ニューラルモルフィックチップ、FPGA、カスタムASIC、光学計算システムを含む、新興のAIハードウェアアーキテクチャのセキュリティを確保する。

 #4.19.1    レベル: 3    役割: D/V
 ニューロモルフィックチップのセキュリティには、スパイクパターンの暗号化、シナプス重みの保護、およびハードウェアベースの学習ルールの検証が含まれていることを確認してください。
 #4.19.2    レベル: 3    役割: D/V
 FPGAベースのAIアクセラレータがビットストリーム暗号化、改ざん防止機構、および認証されたアップデートによる安全な構成読み込みを実装していることを検証してください。
 #4.19.3    レベル: 3    役割: D/V
 カスタムASICセキュリティには、オンチップセキュリティプロセッサ、ハードウェアルートオブトラスト、およびタンパー検知機能を備えた安全な鍵保管が含まれていることを確認してください。
 #4.19.4    レベル: 3    役割: D/V
 光学計算システムが量子耐性の光暗号化、安全なフォトニック・スイッチング、および保護された光信号処理を実装していることを検証してください。
 #4.19.5    レベル: 3    役割: D/V
 ハイブリッドアナログ-デジタルAIチップには、セキュアなアナログ計算、保護された重みの保存、認証されたアナログ-デジタル変換が含まれていることを確認してください。

---

### C4.20 プライバシー保護型コンピュートインフラストラクチャ

AI処理および分析中に機密データを保護するために、プライバシー保護計算のためのインフラ制御を実装する。

 #4.20.1    レベル: 3    役割: D/V
 同型暗号基盤が、暗号学的整合性検証およびパフォーマンス監視を伴う機密性の高いAIワークロード上での暗号化計算を可能にしていることを検証する。
 #4.20.2    レベル: 3    役割: D/V
 プライベート情報検索システムが、アクセスパターンの暗号化によってクエリパターンを明らかにすることなくデータベースクエリを可能にすることを検証する。
 #4.20.3    レベル: 3    役割: D/V
 安全なマルチパーティ計算プロトコルが、個々の入力や中間計算を公開することなく、プライバシーを保護したAI推論を可能にすることを検証してください。
 #4.20.4    レベル: 3    役割: D/V
 プライバシー保護型キー管理には、分散キー生成、しきい値暗号技術、およびハードウェアに裏付けられた保護を伴う安全なキー回転が含まれていることを検証してください。
 #4.20.5    レベル: 3    役割: D/V
 プライバシー保護型コンピュートの性能が、暗号学的セキュリティ保証を維持しながら、バッチ処理、キャッシュ、およびハードウェアアクセラレーションによって最適化されていることを検証する。

---

### C4.15 エージェントフレームワーク クラウド統合セキュリティおよびハイブリッド展開

ハイブリッドなオンプレミス/クラウドアーキテクチャを持つクラウド統合エージェントフレームワークのためのセキュリティコントロール。

 #4.15.1    レベル: 1    役割: D/V
 エージェント制御のキー管理を用いたエンドツーエンド暗号化がクラウドストレージ統合で使用されていることを検証してください。
 #4.15.2    レベル: 2    役割: D/V
 ハイブリッド展開のセキュリティ境界が明確に定義され、通信チャネルが暗号化されていることを確認してください。
 #4.15.3    レベル: 2    役割: D/V
 クラウドリソースへのアクセスが継続的な認証を伴うゼロトラスト検証を含んでいることを確認してください。
 #4.15.4    レベル: 3    役割: D/V
 データの所在地要件が、保存場所の暗号学的証明によって強制されていることを検証します。
 #4.15.5    レベル: 3    役割: D/V
 クラウドプロバイダーのセキュリティ評価にエージェント固有の脅威モデリングとリスク評価が含まれていることを確認してください。

---

### 参考文献

NIST Cybersecurity Framework 2.0
CIS Controls v8
OWASP Container Security Verification Standard
Kubernetes Security Best Practices
SLSA Supply Chain Security Framework
NIST SP 800-190: Application Container Security Guide
Cloud Security Alliance: Cloud Controls Matrix
ENISA: Secure Infrastructure Design
NIST SP 800-53: Security Controls for Federal Information Systems
ISO 27001:2022 Information Security Management
NIST AI Risk Management Framework
CIS Kubernetes Benchmark
FIPS 140-2 Security Requirements
NIST SP 800-207: Zero Trust Architecture
IEEE 2857: Privacy Engineering for AI Systems
NIST SP 800-161: Cybersecurity Supply Chain Risk Management
NIST Post-Quantum Cryptography Standards
Intel SGX Developer Guide
AMD SEV-SNP White Paper
ARM TrustZone Technology
ZK-SNARKs: A Gentle Introduction
NIST SP 800-57: Cryptographic Key Management
Side-Channel Attack Countermeasures
Neuromorphic Computing Security Challenges
FPGA Security: Fundamentals, Evaluation, and Countermeasures
Microsoft SEAL: Homomorphic Encryption Library
HElib: Homomorphic Encryption Library
PALISADE Lattice Cryptography Library
Differential Privacy: A Survey of Results
Secure Aggregation for Federated Learning
Private Information Retrieval: Concepts and Constructions

## C5 AIコンポーネントおよびユーザーのためのアクセス制御とアイデンティティ

### 管理目標

AIシステムにおける効果的なアクセス制御には、堅牢なアイデンティティ管理、コンテキスト認識型の認可、およびゼロトラスト原則に基づく実行時の強制が必要です。これらの制御により、人間、サービス、自律エージェントは、明示的に許可された範囲内のモデル、データ、計算資源とのみやり取りし、継続的な検証と監査機能が確保されます。

---

### C5.1 アイデンティティ管理と認証

特権操作のために多要素認証を用いて、すべてのエンティティに暗号的に裏付けられたアイデンティティを確立する。

 #5.1.1    レベル: 1    役割: D/V
 すべての人間ユーザーおよびサービスプリンシパルが、固有のIDからトークンへのマッピング（共有アカウントや資格情報なし）を用いて、OIDC/SAMLプロトコルを使用し、中央集権型のエンタープライズアイデンティティプロバイダー（IdP）を介して認証されていることを検証してください。
 #5.1.2    レベル: 1    役割: D/V
 高リスク操作（モデルのデプロイ、重みのエクスポート、トレーニングデータへのアクセス、本番環境の設定変更）が、多要素認証またはセッション再検証を伴うステップアップ認証を必要とすることを確認してください。
 #5.1.3    レベル: 2    役割: D
 新しいプリンシパルが本番システムアクセスを受ける前に、NIST 800-63-3 IAL-2または同等の基準に準拠した本人確認を受けていることを検証してください。
 #5.1.4    レベル: 2    役割: V
 アクセスレビューが四半期ごとに実施されていることを確認し、休眠アカウントの自動検出、資格情報のローテーション強制、および提供解除のワークフローが行われていることを確認してください。
 #5.1.5    レベル: 3    役割: D/V
 フェデレーテッドAIエージェントが、最大有効期限が24時間で、起源の暗号証明を含む署名付きJWTアサーションを介して認証されることを検証してください。

---

### C5.2 リソース認可と最小権限

明確な許可モデルと監査記録を備えたすべてのAIリソースに対して、細粒度のアクセス制御を実装してください。

 #5.2.1    レベル: 1    役割: D/V
 すべてのAIリソース（データセット、モデル、エンドポイント、ベクターコレクション、埋め込みインデックス、コンピュートインスタンス）が、明示的な許可リストおよびデフォルト拒否ポリシーを用いた役割ベースのアクセス制御を適用していることを検証してください。
 #5.2.2    レベル: 1    役割: D/V
 サービスアカウントに対しては、最小権限の原則がデフォルトで適用されることを検証し、読み取り専用の権限から開始し、書き込みアクセスには文書化された業務上の正当な理由が必要であることを確認してください。
 #5.2.3    レベル: 1    役割: V
 すべてのアクセス制御の変更が承認された変更要求に紐づけられており、タイムスタンプ、操作主体の識別情報、リソース識別子、および許可の差分とともに不変に記録されていることを検証してください。
 #5.2.4    レベル: 2    役割: D
 データ分類ラベル（PII、PHI、輸出管理対象、専有情報）が派生リソース（埋め込み、プロンプトキャッシュ、モデル出力）に自動的に伝播し、一貫したポリシー適用が行われることを検証してください。
 #5.2.5    レベル: 2    役割: D/V
 未承認のアクセス試行および特権昇格イベントが、コンテキスト付きメタデータとともに5分以内にSIEMシステムへリアルタイムアラートをトリガーすることを検証してください。

---

### C5.3 動的ポリシー評価

コンテキスト認識の認可判断と監査機能を備えた属性ベースアクセス制御（ABAC）エンジンを展開します。

 #5.3.1    レベル: 1    役割: D/V
 認可の決定が、認証されたAPIを介してアクセス可能で、暗号的完全性保護が施された専用のポリシーエンジン（OPA、Cedar、または同等のもの）に外部委任されていることを確認してください。
 #5.3.2    レベル: 1    役割: D/V
 ポリシーが、ユーザーの承認レベル、リソースの機密性分類、リクエストコンテキスト、テナントの分離、および時間的制約などの動的属性を実行時に評価することを検証してください。
 #5.3.3    レベル: 2    役割: D
 ポリシー定義がバージョン管理され、ピアレビューを経て、プロダクション展開前にCI/CDパイプラインで自動テストを通じて検証されていることを確認してください。
 #5.3.4    レベル: 2    役割: V
 ポリシー評価結果に構造化された意思決定の根拠が含まれており、相関分析およびコンプライアンス報告のためにSIEMシステムに送信されていることを確認してください。
 #5.3.5    レベル: 3    役割: D/V
 高感度リソースに対してポリシーキャッシュの有効期間（TTL）が5分を超えず、キャッシュ無効化機能を持つ標準リソースに対しては1時間を超えないことを確認してください。

---

### C5.4 クエリ時のセキュリティ強制

必須フィルタリングおよび行レベルのセキュリティポリシーを用いて、データベース層のセキュリティ制御を実装します。

 #5.4.1    レベル: 1    役割: D/V
 すべてのベクターデータベースおよびSQLクエリに、必須のセキュリティフィルター（テナントID、感度ラベル、ユーザースコープ）が含まれていることを確認し、これらがアプリケーションコードではなくデータベースエンジンレベルで強制されていることを検証してください。
 #5.4.2    レベル: 1    役割: D/V
 すべてのベクターデータベース、検索インデックス、およびトレーニングデータセットに対して、ポリシー継承を使用した行レベルセキュリティ（RLS）ポリシーおよびフィールドレベルマスキングが有効になっていることを確認してください。
 #5.4.3    レベル: 2    役割: D
 失敗した認証評価が、クエリを直ちに中止し、空の結果セットを返すのではなく明示的な認証エラーコードを返すことで、「混乱した代理攻撃」を防ぐことを確認してください。
 #5.4.4    レベル: 2    役割: V
 ポリシー評価の遅延が継続的に監視され、認可のバイパスを可能にするタイムアウト条件に対して自動アラートが設定されていることを確認してください。
 #5.4.5    レベル: 3    役割: D/V
 クエリの再試行メカニズムが、アクティブなユーザーセッション内の動的な権限変更を考慮して認可ポリシーを再評価することを検証してください。

---

### C5.5 出力フィルタリングとデータ漏えい防止

AI生成コンテンツにおける不正なデータ漏洩を防ぐために、ポストプロセッシング制御を展開する。

 #5.5.1    レベル: 1    役割: D/V
 推論後のフィルタリング機構が、要求者にコンテンツを提供する前に、未承認の個人識別情報（PII）、機密情報、および専有データをスキャンし、検閲することを検証してください。
 #5.5.2    レベル: 1    役割: D/V
 モデル出力における引用、参考文献、および情報源の帰属を、呼び出し元の権限に基づいて検証し、不正アクセスが検出された場合は削除することを確認してください。
 #5.5.3    レベル: 2    役割: D
 ユーザーの権限レベルとデータ分類に基づいて、出力フォーマットの制限（サニタイズされたPDF、メタデータが削除された画像、承認されたファイルタイプ）が適用されていることを検証する。
 #5.5.4    レベル: 2    役割: V
 検閲アルゴリズムが決定論的であり、バージョン管理されており、コンプライアンス調査およびフォレンジック分析をサポートするために監査ログを維持していることを確認してください。
 #5.5.5    レベル: 3    役割: V
 高リスクな編集イベントが、データの露出を防ぎつつ、元のコンテンツの暗号化ハッシュを含む適応ログを生成し、鑑識調査のための検索を可能にすることを検証してください。

---

### C5.6 マルチテナント分離

共有されたAIインフラストラクチャにおいて、テナント間の暗号的および論理的な分離を確保する。

 #5.6.1    レベル: 1    役割: D/V
 メモリースペース、埋め込みストア、キャッシュエントリ、および一時ファイルがテナントごとに名前空間で分離されており、テナントの削除またはセッション終了時に安全に消去されることを確認してください。
 #5.6.2    レベル: 1    役割: D/V
 すべてのAPIリクエストに対して、認証されたテナント識別子が含まれており、それがセッションコンテキストおよびユーザーの権限に対して暗号学的に検証されていることを確認してください。
 #5.6.3    レベル: 2    役割: D
 サービスメッシュおよびコンテナオーケストレーションプラットフォーム内でのテナント間通信に対して、ネットワークポリシーがデフォルト拒否ルールを実装していることを検証してください。
 #5.6.4    レベル: 3    役割: D
 カスタマー管理キー（CMK）サポートとテナントデータストア間の暗号学的分離を備えた、テナントごとに一意の暗号鍵であることを検証してください。

---

### C5.7 自律エージェントの認可

スコープ付き能力トークンと継続的認証を通じて、AIエージェントおよび自律システムの制御権限を管理します。

 #5.7.1    レベル: 1    役割: D/V
 自律エージェントが許可されたアクション、アクセス可能なリソース、時間的制限、および運用上の制約を明示的に列挙したスコープ付きの能力トークンを受け取ることを確認してください。
 #5.7.2    レベル: 1    役割: D/V
 高リスクな機能（ファイルシステムアクセス、コード実行、外部APIコール、金融取引）がデフォルトで無効化されており、有効化には業務上の正当な理由を伴う明示的な承認が必要であることを確認してください。
 #5.7.3    レベル: 2    役割: D
 能力トークンがユーザーセッションに紐付けられていることを検証し、暗号学的な完全性保護が含まれていることを確認し、オフライン環境での永続化や再利用ができないようにします。
 #5.7.4    レベル: 2    役割: V
 エージェントが開始するアクションが、完全なコンテキスト評価および監査ログ記録を伴うABACポリシーエンジンによる二次承認を受けることを検証してください。
 #5.7.5    レベル: 3    役割: V
 エージェントのエラー条件および例外処理に、インシデント分析および法医学調査をサポートするための能力範囲情報が含まれていることを検証してください。

---

### 参考文献

#### 標準とフレームワーク

NIST SP 800-63-3: Digital Identity Guidelines
Zero Trust Architecture – NIST SP 800-207
OWASP Application Security Verification Standard (AISVS)
​
#### 実装ガイド

Identity and Access Management in the AI Era: 2025 Guide – IDSA
Attribute-Based Access Control with OPA – Permify
How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS
​
#### AI特有のセキュリティ

Row Level Security in Vector DBs for RAG – Bluetuple.ai
Tenant Isolation in Multi-Tenant Systems – WorkOS
Handling AI Agent Permissions – Stytch
OWASP Top 10 for Large Language Model Applications

## モデル、フレームワーク、およびデータのためのC6サプライチェーンセキュリティ

### 管理目標

AIのサプライチェーン攻撃は、サードパーティのモデル、フレームワーク、またはデータセットを悪用してバックドア、バイアス、または悪用可能なコードを埋め込みます。これらのコントロールは、エンドツーエンドの出所管理、脆弱性管理、および監視を提供し、モデルのライフサイクル全体を保護します。

---

### C6.1 事前学習済みモデルの審査と出自確認

ファインチューニングや展開の前に、サードパーティモデルの出所、ライセンス、隠れた挙動を評価および認証してください。

 #6.1.1    レベル: 1    役割: D/V
 すべてのサードパーティモデルアーティファクトに、ソースリポジトリとコミットハッシュを特定する署名付きの由来記録が含まれていることを検証してください。
 #6.1.2    レベル: 1    役割: D/V
 モデルをインポートする前に、自動化ツールを使用して悪意のあるレイヤーやトロイの木馬トリガーがスキャンされていることを確認してください。
 #6.1.3    レベル: 2    役割: D
 転移学習のファインチューニングが隠れた挙動を検出するための敵対的評価に合格することを検証してください。
 #6.1.4    レベル: 2    役割: V
 モデルライセンス、輸出管理タグ、およびデータ起源ステートメントがML-BOMエントリに記録されていることを確認してください。
 #6.1.5    レベル: 3    役割: D/V
 高リスクモデル（公開された重み、未確認のクリエイター）が人間によるレビューと承認まで隔離されたままであることを確認してください。

---

### C6.2 フレームワーク＆ライブラリスキャン

実行時スタックを安全に保つために、MLフレームワークとライブラリを継続的にスキャンし、CVEや悪意のあるコードを検出します。

 #6.2.1    レベル: 1    役割: D/V
 CIパイプラインがAIフレームワークおよび重要なライブラリに対して依存関係スキャナーを実行していることを確認してください。
 #6.2.2    レベル: 1    役割: D/V
 重大な脆弱性（CVSS ≥ 7.0）が本番用イメージへの昇格をブロックすることを確認してください。
 #6.2.3    レベル: 2    役割: D
 フォークまたはベンダー化されたMLライブラリで静的コード解析が実行されることを確認してください。
 #6.2.4    レベル: 2    役割: V
 フレームワークのアップグレード提案には、公開されているCVEフィードを参照したセキュリティ影響評価が含まれていることを確認してください。
 #6.2.5    レベル: 3    役割: V
 署名されたSBOMから逸脱した予期しない動的ライブラリのロードに対して、ランタイムセンサーが警告を発することを確認してください。

---

### C6.3 依存関係のピニングと検証

すべての依存関係を不変のダイジェストに固定し、ビルドを再現して同一で改ざんのないアーティファクトを保証します。

 #6.3.1    レベル: 1    役割: D/V
 すべてのパッケージマネージャーがロックファイルを介してバージョン固定を強制していることを確認してください。
 #6.3.2    レベル: 1    役割: D/V
 コンテナ参照において、変更可能なタグの代わりに変更不可能なダイジェストが使用されていることを確認してください。
 #6.3.3    レベル: 2    役割: D
 再現可能ビルドチェックがCI実行間でハッシュを比較し、同一の出力を保証していることを確認してください。
 #6.3.4    レベル: 2    役割: V
 監査の追跡可能性のために、ビルドの証明書が18か月間保存されていることを確認してください。
 #6.3.5    レベル: 3    役割: D
 期限切れの依存関係が自動プルリクエストをトリガーして、固定されたバージョンの更新またはフォークを行うことを確認してください。

---

### C6.4 信頼されたソースの強制適用

暗号的に検証され、組織が承認したソースからのアーティファクトのダウンロードのみを許可し、それ以外はすべてブロックします。

 #6.4.1    レベル: 1    役割: D/V
 モデルの重み、データセット、およびコンテナが、承認されたドメインまたは内部レジストリからのみダウンロードされていることを確認してください。
 #6.4.2    レベル: 1    役割: D/V
 Sigstore/Cosignの署名が、成果物がローカルにキャッシュされる前に発行者の身元を検証することを確認してください。
 #6.4.3    レベル: 2    役割: D
 egress プロキシが認証されていないアーティファクトのダウンロードをブロックし、信頼できるソースポリシーを強制していることを確認してください。
 #6.4.4    レベル: 2    役割: V
 リポジトリの許可リストが四半期ごとにレビューされており、各エントリについてビジネス上の正当な理由の証拠があることを確認してください。
 #6.4.5    レベル: 3    役割: V
 ポリシー違反がアーティファクトの隔離および依存するパイプライン実行のロールバックをトリガーすることを検証してください。

---

### C6.5 サードパーティデータセットのリスク評価

外部データセットを毒性、バイアス、法的遵守について評価し、そのライフサイクルを通じて監視します。

 #6.5.1    レベル: 1    役割: D/V
 外部データセットがポイズニングリスクのスコアリング（例：データフィンガープリンティング、異常値検出）を受けることを確認してください。
 #6.5.2    レベル: 1    役割: D
 バイアスメトリクス（人口統計的均等性、機会均等）がデータセット承認前に計算されていることを確認してください。
 #6.5.3    レベル: 2    役割: V
 データセットの出所およびライセンス条件がML-BOMエントリに記録されていることを確認してください。
 #6.5.4    レベル: 2    役割: V
 ホストされているデータセットのドリフトや破損を定期的な監視で検出できることを確認してください。
 #6.5.5    レベル: 3    役割: D
 トレーニング前に、許可されていないコンテンツ（著作権、個人識別情報）が自動スクラビングによって削除されていることを確認してください。

---

### C6.6 サプライチェーン攻撃監視

CVEフィード、監査ログ分析、およびレッドチームシミュレーションを通じてサプライチェーンの脅威を早期に検出します。

 #6.6.1    レベル: 1    役割: V
 CI/CDの監査ログが異常なパッケージプルや改ざんされたビルドステップの検出のためにSIEMにストリームされていることを確認してください。
 #6.6.2    レベル: 2    役割: D
 インシデント対応プレイブックに、侵害されたモデルやライブラリのロールバック手順が含まれていることを確認してください。
 #6.6.3    レベル: 3    役割: V
 脅威インテリジェンスの強化がアラートトリアージにおいてML特有の指標（例：モデル汚染のIoC）にタグ付けされていることを検証してください。

---

### C6.7 モデルアーティファクトのためのML-BOM

詳細なML特有のSBOM（ML-BOM）を生成して署名し、下流の利用者が展開時にコンポーネントの整合性を検証できるようにします。

 #6.7.1    レベル: 1    役割: D/V
 すべてのモデルアーティファクトが、データセット、重み、ハイパーパラメータ、およびライセンスを一覧表示するML-BOMを公開していることを確認してください。
 #6.7.2    レベル: 1    役割: D/V
 ML-BOMの生成とCosign署名がCIで自動化されており、マージに必須であることを確認してください。
 #6.7.3    レベル: 2    役割: D
 コンポーネントのメタデータ（ハッシュ、ライセンス）が欠落している場合、ML-BOM完全性チェックがビルドを失敗させることを検証してください。
 #6.7.4    レベル: 2    役割: V
 ダウンストリームの利用者が、デプロイ時にインポートされたモデルを検証するために、APIを通じてML-BOMをクエリできることを確認する。
 #6.7.5    レベル: 3    役割: V
 ML-BOMがバージョン管理されており、不正な変更を検出するために差分が取られていることを確認してください。

---

### 参考文献

ML Supply Chain Compromise – MITRE ATLAS
Supply‑chain Levels for Software Artifacts (SLSA)
CycloneDX – Machine Learning Bill of Materials
What is Data Poisoning? – SentinelOne
Transfer Learning Attack – OWASP ML Security Top 10
AI Data Security Best Practices – CISA
Secure CI/CD Supply Chain – Sumo Logic
AI & Transparency: Protect ML Models – ReversingLabs
SBOM Overview – CISA
Training Data Poisoning Guide – Lakera.ai
Dependency Pinning for Reproducible Python – Medium

## C7 モデルの挙動、出力制御、および安全性保証

### 管理目標

モデルの出力は、構造化され、信頼性が高く、安全で、説明可能であり、生産環境で継続的に監視される必要があります。これにより、幻覚、プライバシー漏えい、有害なコンテンツ、暴走行動が減少し、ユーザーの信頼と規制遵守が向上します。

---

### C7.1 出力フォーマットの強制

厳格なスキーマ、制約付きデコーディング、および下流の検証により、不正な形式や悪意のあるコンテンツが拡散する前に阻止します。

 #7.1.1    レベル: 1    役割: D/V
 応答スキーマ（例：JSONスキーマ）がシステムプロンプト内で提供されていることを確認し、すべての出力が自動的に検証されるようにします。規格に合わない出力は修正または拒否されます。
 #7.1.2    レベル: 1    役割: D/V
 オーバーフローやプロンプトインジェクションのサイドチャネルを防ぐために、制約付きデコーディング（停止トークン、正規表現、最大トークン数）が有効になっていることを確認してください。
 #7.1.3    レベル: 2    役割: D/V
 下流コンポーネントが出力を信頼できないものとして扱い、スキーマやインジェクション安全なデシリアライザに対して検証していることを確認してください。
 #7.1.4    レベル: 3    役割: V
 不適切な出力イベントがログに記録され、レート制限され、監視に表示されることを確認してください。

---

### C7.2 幻覚検出と緩和

不確実性の推定とフォールバック戦略は、捏造された回答を抑制します。

 #7.2.1    レベル: 1    役割: D/V
 トークンレベルの対数確率、アンサンブル自己一貫性、または微調整された幻覚検出器が各回答に対して信頼度スコアを割り当てることを検証してください。
 #7.2.2    レベル: 1    役割: D/V
 設定可能な信頼度閾値を下回る応答がフォールバックワークフロー（例：リトリーバル補強生成、二次モデル、または人間のレビュー）をトリガーすることを検証してください。
 #7.2.3    レベル: 2    役割: D/V
 幻覚の発生がルート原因のメタデータでタグ付けされ、ポストモーテムおよびファインチューニングパイプラインに入力されていることを確認してください。
 #7.2.4    レベル: 3    役割: D/V
 主要なモデルまたはナレッジベースの更新後に、しきい値および検出器が再調整されていることを確認します。
 #7.2.5    レベル: 3    役割: V
 ダッシュボードのビジュアライゼーションが幻覚発生率を追跡していることを確認してください。

---

### C7.3 出力の安全性およびプライバシーフィルタリング

ポリシーフィルターとレッドチームのカバレッジは、ユーザーと機密データを保護します。

 #7.3.1    レベル: 1    役割: D/V
 ポリシーに沿ったヘイト、嫌がらせ、自傷行為、過激派、および性的に露骨なコンテンツを事前および事後生成分類器がブロックすることを確認してください。
 #7.3.2    レベル: 1    役割: D/V
 PII/PCI検出と自動修正がすべての応答で実行されることを確認してください。違反があった場合はプライバシーインシデントとして報告されます。
 #7.3.3    レベル: 2    役割: D
 機密性タグ（例：企業秘密）がモダリティ間で伝播し、テキスト、画像、コードにおける情報漏洩を防止することを検証する。
 #7.3.4    レベル: 3    役割: D/V
 フィルターバイパスの試行や高リスク分類が二次承認またはユーザーの再認証を必要とすることを確認してください。
 #7.3.5    レベル: 3    役割: D/V
 フィルタリングの閾値が法的管轄区域およびユーザーの年齢/役割のコンテキストを反映していることを確認してください。

---

### C7.4 出力およびアクション制限

レート制限と承認ゲートは、悪用や過度の自律性を防ぎます。

 #7.4.1    レベル: 1    役割: D
 429エラー発生時に指数的バックオフを用いて、ユーザーごとおよびAPIキーごとのクォータがリクエスト数、トークン数、およびコストを制限していることを検証してください。
 #7.4.2    レベル: 1    役割: D/V
 特権操作（ファイル書き込み、コード実行、ネットワーク呼び出し）がポリシーベースの承認または人間の介入を必要とすることを確認してください。
 #7.4.3    レベル: 2    役割: D/V
 クロスモーダル整合性チェックにより、同じリクエストに対して生成された画像、コード、およびテキストが悪意のあるコンテンツの密輸に使用できないことを検証します。
 #7.4.4    レベル: 2    役割: D
 エージェントの委任深度、再帰の制限、および許可されたツールリストが明示的に設定されていることを確認してください。
 #7.4.5    レベル: 3    役割: V
 制限違反がSIEM取り込み用の構造化されたセキュリティイベントを発行することを検証してください。

---

### C7.5 出力説明可能性

透明なシグナルはユーザーの信頼と内部デバッグを向上させます。

 #7.5.1    レベル: 2    役割: D/V
 リスク評価が適切と判断した場合に、ユーザー向けの信頼度スコアや簡潔な理由付けの要約が表示されることを確認してください。
 #7.5.2    レベル: 2    役割: D/V
 生成された説明が機密のシステムプロンプトや独自のデータを明かさないことを確認してください。
 #7.5.3    レベル: 3    役割: D
 システムがトークンレベルの対数確率またはアテンションマップをキャプチャし、それらを許可された検査のために保存していることを確認してください。
 #7.5.4    レベル: 3    役割: V
 説明可能性の成果物が監査可能性のためにモデルリリースとともにバージョン管理されていることを確認してください。

---

### C7.6 監視統合

リアルタイムの可観測性は、開発と本番環境の間のループを閉じます。

 #7.6.1    レベル: 1    役割: D
 メトリクス（スキーマ違反、幻覚率、有害性、PII漏洩、レイテンシ、コスト）が中央監視プラットフォームにストリーミングされることを検証してください。
 #7.6.2    レベル: 1    役割: V
 各安全指標に対してアラート閾値が定義されており、オンコールエスカレーションパスが設定されていることを確認してください。
 #7.6.3    レベル: 2    役割: V
 ダッシュボードが出力の異常をモデル/バージョン、機能フラグ、および上流データの変更と相関付けていることを確認してください。
 #7.6.4    レベル: 2    役割: D/V
 監視データが、文書化されたMLOpsワークフロー内で再学習、ファインチューニング、またはルール更新にフィードバックされていることを確認してください。
 #7.6.5    レベル: 3    役割: V
 モニタリングパイプラインがペネトレーションテストされており、機密ログの漏洩を防ぐためにアクセス制御されていることを確認してください。

---

### 7.7 生成メディアの安全対策

AIシステムが違法、有害、または無許可のメディアコンテンツを生成しないように、ポリシー制約、出力の検証、および追跡可能性を強化してください。

 #7.7.1    レベル: 1    役割: D/V
 システムプロンプトとユーザー指示が、違法、有害、または非同意のディープフェイクメディア（例：画像、動画、音声）の生成を明示的に禁止していることを確認してください。
 #7.7.2    レベル: 2    役割: D/V
 プロンプトがなりすましの生成、性的に露骨なディープフェイク、または本人の同意なしに実在する個人を描写するメディアの作成を試みているかどうかをフィルタリングしていることを確認してください。
 #7.7.3    レベル: 2    役割: V
 システムが不正な著作権保護媒体の複製を防止するために、知覚ハッシュ、ウォーターマーク検出、またはフィンガープリンティングを使用していることを検証してください。
 #7.7.4    レベル: 3    役割: D/V
 生成されたすべてのメディアが、下流での追跡可能性のために暗号署名されているか、ウォーターマークが付けられているか、改ざん耐性のあるプロビナンスメタデータが埋め込まれていることを確認してください。
 #7.7.5    レベル: 3    役割: V
 バイパス試行（例：プロンプトの難読化、スラング、敵対的な表現）が検出され、記録され、レート制限されることを確認する。繰り返される悪用は監視システムに報告される。

### 参考文献

NIST AI Risk Management Framework
ISO/IEC 42001:2023 – AI Management System
OWASP Top-10 for Large Language Model Applications (2025)
Improper Output Handling – OWASP LLM05:2025
Practical Techniques to Constrain LLM Output
Dataiku – Structured Text Generation Guide
VL-Uncertainty: Detecting Hallucinations
HaDeMiF: Hallucination Detection & Mitigation
Building Confidence in LLM Outputs
Explainable AI & LLMs
LLM Red-Teaming Guide
Sensitive Information Disclosure in LLMs
LangChain – Chat Model Rate Limiting
OpenAI Rate-Limit & Exponential Back-off
Arize AI – LLM Observability Platform

## C8 メモリ、埋め込み、およびベクトルデータベースのセキュリティ

### 管理目標

埋め込み（Embeddings）とベクターストアは、現代のAIシステムの「ライブメモリ」として機能し、ユーザーから提供されたデータを継続的に受け入れ、Retrieval-Augmented Generation（RAG）を介してモデルのコンテキストに再反映します。これが無管理のままだと、個人識別情報（PII）が漏洩したり、同意違反が発生したり、逆に元のテキストを再構築されるリスクがあります。このコントロールファミリーの目的は、メモリパイプラインとベクトルデータベースを強固にし、アクセスを最小権限に制限し、埋め込みがプライバシーを保護し、保存されたベクトルが期限切れになったり要求に応じて取り消し可能であり、またユーザーごとのメモリが他のユーザーのプロンプトや補完に混入しないようにすることです。

---

### C8.1 メモリおよびRAGインデックスに対するアクセス制御

すべてのベクターコレクションに対して詳細なアクセス制御を強制します。

 #8.1.1    レベル: 1    役割: D/V
 テナント、コレクション、またはドキュメントタグごとに、行/名前空間レベルのアクセス制御ルールが挿入、削除、およびクエリ操作を制限していることを確認してください。
 #8.1.2    レベル: 1    役割: D/V
 APIキーまたはJWTがスコープ付きクレーム（例：コレクションID、アクション動詞）を含んでいることを確認し、少なくとも四半期ごとにローテーションされていることを検証してください。
 #8.1.3    レベル: 2    役割: D/V
 特権昇格の試み（例：クロスネームスペース類似性クエリ）が検出され、5分以内にSIEMに記録されることを確認してください。
 #8.1.4    レベル: 2    役割: D/V
 ベクターデータベースが監査ログにサブジェクト識別子、操作、ベクターID/ネームスペース、類似度閾値、および結果数を記録していることを確認してください。
 #8.1.5    レベル: 3    役割: V
 エンジンがアップグレードされたりインデックス・シャーディングルールが変更されたりするたびに、アクセス決定がバイパスの欠陥についてテストされていることを確認してください。

---

### C8.2 埋め込みのサニタイズと検証

ベクトル化の前にテキストをPII（個人を特定できる情報）で事前スクリーニングし、伏字化または仮名化を行い、必要に応じて埋め込み後処理で残留信号を除去します。

 #8.2.1    レベル: 1    役割: D/V
 PIIおよび規制対象データが自動分類器によって検出され、埋め込み前にマスク処理、トークン化、または削除されていることを検証してください。
 #8.2.2    レベル: 1    役割: D
 埋め込みパイプラインが、インデックスを汚染する可能性のある実行可能なコードや非UTF-8のアーティファクトを含む入力を拒否または隔離することを検証してください。
 #8.2.3    レベル: 2    役割: D/V
 既知のPIIトークンからの距離が設定可能な閾値を下回る文センテンス埋め込みに対して、局所的またはメトリックな差分プライバシーのサニタイズが適用されていることを検証します。
 #8.2.4    レベル: 2    役割: V
 サニタイズの有効性（例：個人識別情報の削除の再現率、意味の変移）が、ベンチマークコーパスに対して少なくとも年に2回は検証されていることを確認してください。
 #8.2.5    レベル: 3    役割: D/V
 サニタイズ設定がバージョン管理されており、変更がピアレビューを経ていることを確認してください。

---

### C8.3 メモリの有効期限切れ、失効および削除

GDPRの「消去権」および類似の法律は、適時の消去を要求するため、ベクターストアはTTL、ハードデリート、トゥームストーニングをサポートし、取り消されたベクターが回復または再インデックスされないようにする必要があります。

 #8.3.1    レベル: 1    役割: D/V
 すべてのベクターおよびメタデータレコードがTTLまたは自動クリーンアップジョブによって遵守される明示的な保持ラベルを持っていることを確認してください。
 #8.3.2    レベル: 1    役割: D/V
 ユーザーが開始した削除リクエストが、30日以内にベクトル、メタデータ、キャッシュコピー、および派生インデックスを完全に削除することを確認してください。
 #8.3.3    レベル: 2    役割: D
 論理削除の後に、ハードウェアが対応している場合はストレージブロックの暗号的なシュレッディング、またはキーボールトの鍵破棄が続くことを確認してください。
 #8.3.4    レベル: 3    役割: D/V
 期限切れのベクトルが期限切れ後500 ms以内に最近傍探索の結果から除外されることを検証してください。

---

### C8.4 埋め込みの逆転と漏洩の防止

最近の防御策—ノイズ重畳、射影ネットワーク、プライバシーニューロン摂動、アプリケーション層暗号化—は、トークンレベルの逆転率を5%未満に削減できます。

 #8.4.1    レベル: 1    役割: V
 反転攻撃、メンバーシップ攻撃、および属性推測攻撃を網羅する正式な脅威モデルが存在し、毎年レビューされていることを確認してください。
 #8.4.2    レベル: 2    役割: D/V
 アプリケーション層の暗号化または検索可能な暗号化が、インフラ管理者やクラウドスタッフによるベクトルの直接読み取りから保護していることを確認してください。
 #8.4.3    レベル: 3    役割: V
 防御パラメータ（DPのε、ノイズσ、射影ランクk）が、プライバシー ≧ 99%のトークン保護とユーティリティ ≦ 3%の精度損失を両立していることを検証してください。
 #8.4.4    レベル: 3    役割: D/V
 モデル更新のリリースゲートの一部として反転耐性メトリクスが含まれていることを確認し、回帰予算が定義されていることを確認する。

---

### C8.5 ユーザー固有メモリのスコープ強制

クロステナントリークは依然として主要なRAGリスクです：不適切にフィルタリングされた類似度クエリにより、他の顧客のプライベートドキュメントが表出する可能性があります。

 #8.5.1    レベル: 1    役割: D/V
 すべての検索クエリがLLMプロンプトに渡される前に、テナント/ユーザーIDによって後処理されていることを確認してください。
 #8.5.2    レベル: 1    役割: D
 コレクション名や名前空間付きIDがユーザーまたはテナントごとにソルトされていることを確認し、ベクトルがスコープ間で衝突しないようにします。
 #8.5.3    レベル: 2    役割: D/V
 構成可能な距離しきい値を超え、かつ呼び出し元のスコープ外にある類似性の結果が破棄され、セキュリティアラートがトリガーされることを確認してください。
 #8.5.4    レベル: 2    役割: V
 マルチテナントのストレステストが、範囲外のドキュメントを取得しようとする敵対的なクエリをシミュレートし、情報漏洩が全くないことを実証していることを確認してください。
 #8.5.5    レベル: 3    役割: D/V
 暗号化キーがテナントごとに分離されていることを検証し、物理的なストレージが共有されている場合でも暗号的な分離が確保されていることを確認してください。

---

### C8.6 高度なメモリシステムセキュリティ

エピソード記憶、意味記憶、作業記憶を含む高度なメモリアーキテクチャに対する、特定の分離および検証要件を備えたセキュリティ制御。

 #8.6.1    レベル: 1    役割: D/V
 異なるメモリタイプ（エピソード記憶、意味記憶、作業記憶）が、役割ベースのアクセス制御、個別の暗号化キー、および各メモリタイプのアクセスパターンを文書化した分離されたセキュリティコンテキストを持っていることを検証してください。
 #8.6.2    レベル: 2    役割: D/V
 メモリ統合プロセスが、コンテンツのサニタイズ、ソースの検証、および保存前の整合性チェックを通じて悪意のあるメモリの注入を防止するためのセキュリティ検証を含んでいることを確認してください。
 #8.6.3    レベル: 2    役割: D/V
 メモリ取得クエリが検証およびサニタイズされ、不正アクセス情報の抽出を防ぐために、クエリパターンの分析、アクセス制御の強制、および結果のフィルタリングが行われていることを確認してください。
 #8.6.4    レベル: 3    役割: D/V
 メモリの忘却メカニズムが、鍵削除、マルチパス上書き、または検証証明書付きのハードウェアベースの安全な削除を用いて、暗号的消去保証により機密情報を安全に削除していることを検証する。
 #8.6.5    レベル: 3    役割: D/V
 メモリシステムの整合性が、チェックサム、監査ログ、および通常の操作外でメモリ内容が変更された場合の自動アラートを通じて、不正な変更や破損が継続的に監視されていることを確認してください。

---

### 参考文献

Vector database security: Pinecone – IronCore Labs
Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera
Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances
Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv
DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview
Art. 17 GDPR – Right to Erasure
Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai
PII Identification and Removal – NVIDIA NeMo Docs
De-identifying Sensitive Data – Google Cloud DLP
Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails
Think Your RAG Is Secure? Think Again – Medium
Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn
Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog

## 9 自律的オーケストレーションとエージェント的行動セキュリティ

### 管理目標

自律型またはマルチエージェントAIシステムが、明示的に意図され、認証され、監査可能であり、かつ制限されたコストおよびリスクの閾値内でのみ行動を実行できるようにします。これにより、自律システムの乗っ取り、ツールの誤使用、エージェントループ検出、通信のハイジャック、アイデンティティのなりすまし、群れの操作、意図の操作といった脅威から保護されます。

---

### 9.1 エージェントのタスク計画と再帰予算

権限のある操作に対して再帰的な計画を制限し、必ず人間のチェックポイントを設ける。

 #9.1.1    レベル: 1    役割: D/V
 最大再帰深度、幅、実時間、トークン、およびエージェント実行ごとの金銭的コストが中央で設定され、バージョン管理されていることを確認してください。
 #9.1.2    レベル: 1    役割: D/V
 特権的または取り消し不可能な操作（例：コードのコミット、資金の移動）は、実行前に監査可能なチャネルを通じて明示的な人間の承認を必要とすることを確認してください。
 #9.1.3    レベル: 2    役割: D
 リアルタイムのリソースモニターが、いずれかの予算閾値を超えた場合にサーキットブレーカーの中断をトリガーし、さらなるタスクの拡張を停止することを確認してください。
 #9.1.4    レベル: 2    役割: D/V
 回路遮断器のイベントが、エージェントID、発動条件、および捕捉されたプラン状態と共に記録されていることを検証し、フォレンジックレビュー用に確認してください。
 #9.1.5    レベル: 3    役割: V
 セキュリティテストが予算枯渇および実行計画逸脱のシナリオを網羅し、データ損失なく安全に停止することを確認してください。
 #9.1.6    レベル: 3    役割: D
 予算ポリシーがポリシー・アズ・コードとして表現され、構成のドリフトを防ぐためにCI/CDで強制されていることを確認してください。

---

### 9.2 ツールプラグインのサンドボックス化

ツールの相互作用を分離して、不正なシステムアクセスやコード実行を防止します。

 #9.2.1    レベル: 1    役割: D/V
 すべてのツール/プラグインが、最小権限のファイルシステム、ネットワーク、およびシステムコールポリシーを備えたOS、コンテナ、またはWASMレベルのサンドボックス内で実行されることを検証してください。
 #9.2.2    レベル: 1    役割: D/V
 サンドボックスのリソース割当量（CPU、メモリ、ディスク、ネットワーク送信）および実行タイムアウトが適用され、ログに記録されていることを確認してください。
 #9.2.3    レベル: 2    役割: D/V
 ツールのバイナリまたはディスクリプタがデジタル署名されていることを確認し、ロード前に署名の検証を行います。
 #9.2.4    レベル: 2    役割: V
 サンドボックスのテレメトリがSIEMにストリーミングされていることを確認し、異常（例：試みられたアウトバウンド接続）がアラートを発することを検証してください。
 #9.2.5    レベル: 3    役割: V
 高リスクプラグインが本番環境に展開される前に、セキュリティレビューとペネトレーションテストを受けていることを確認してください。
 #9.2.6    レベル: 3    役割: D/V
 サンドボックス脱出の試みが自動的にブロックされ、問題のあるプラグインが調査待ちの隔離状態になることを確認してください。

---

### 9.3 自律ループとコスト制限

エージェント間の制御されていない再帰およびコストの爆発を検出して停止します。

 #9.3.1    レベル: 1    役割: D/V
 インターエージェント呼び出しに、ランタイムが減算および適用するホップ制限またはTTLが含まれていることを確認します。
 #9.3.2    レベル: 2    役割: D
 エージェントが自己呼び出しや循環パターンを検出するために、一意の呼び出しグラフIDを維持していることを確認してください。
 #9.3.3    レベル: 2    役割: D/V
 累積の計算ユニットおよび支出カウンターがリクエストチェーンごとに追跡されていることを確認してください；制限を超えるとチェーンが中止されます。
 #9.3.4    レベル: 3    役割: V
 形式解析またはモデル検査がエージェントプロトコルにおける無限再帰の不在を示していることを検証してください。
 #9.3.5    レベル: 3    役割: D
 ループ中断イベントがアラートを生成し、継続的改善の指標にフィードバックされることを検証する。

---

### 9.4 プロトコルレベルの誤使用防止

乗っ取りや改ざんを防ぐために、エージェントと外部システム間の通信チャネルを安全に保つ。

 #9.4.1    レベル: 1    役割: D/V
 すべてのエージェント間およびエージェントとツール間のメッセージが認証されていること（例：相互TLSまたはJWT）およびエンドツーエンドで暗号化されていることを確認してください。
 #9.4.2    レベル: 1    役割: D
 スキーマが厳密に検証されていることを確認し、未知のフィールドや不正なメッセージが拒否されるようにしてください。
 #9.4.3    レベル: 2    役割: D/V
 完全なメッセージペイロード（ツールパラメータを含む）を対象に、整合性チェック（MACやデジタル署名）が行われていることを確認してください。
 #9.4.4    レベル: 2    役割: D
 リプレイ攻撃防止（ノンスまたはタイムスタンプウィンドウ）がプロトコル層で適用されていることを確認してください。
 #9.4.5    レベル: 3    役割: V
 プロトコル実装が注入や逆シリアル化の脆弱性に対してファジングおよび静的解析を受けていることを確認してください。

---

### 9.5 エージェントのアイデンティティと改ざん検知

操作が特定可能であり、変更が検出可能であることを確保してください。

 #9.5.1    レベル: 1    役割: D/V
 各エージェントインスタンスがユニークな暗号学的アイデンティティ（鍵ペアまたはハードウェアルートの認証情報）を保持していることを検証します。
 #9.5.2    レベル: 2    役割: D/V
 すべてのエージェントのアクションが署名およびタイムスタンプ付きであることを確認する。ログには否認防止のための署名が含まれていること。
 #9.5.3    レベル: 2    役割: V
 改ざん検知ログが追記専用または書き込み一回限りの媒体に保存されていることを確認してください。
 #9.5.4    レベル: 3    役割: D
 アイデンティティキーが定められたスケジュールおよび侵害の指標に基づいてローテーションされることを検証する。
 #9.5.5    レベル: 3    役割: D/V
 なりすましやキーの競合試行が発生した場合、影響を受けたエージェントが即座に隔離されることを確認してください。

---

### 9.6 マルチエージェント群知能リスク削減

集団行動の危険を分離と正式な安全モデル化によって軽減する。

 #9.6.1    レベル: 1    役割: D/V
 異なるセキュリティドメインで動作するエージェントが、分離されたランタイムサンドボックスまたはネットワークセグメント内で実行されることを確認してください。
 #9.6.2    レベル: 3    役割: V
 スウォーム行動がモデル化され、展開前に生存性と安全性について形式的に検証されていることを確認してください。
 #9.6.3    レベル: 3    役割: D
 ランタイムモニターが緊急かつ安全でないパターン（例えば、振動、デッドロック）を検出し、是正措置を開始することを検証する。

---

### 9.7 ユーザーおよびツールの認証／認可

すべてのエージェントが起動するアクションに対して堅牢なアクセス制御を実装してください。

 #9.7.1    レベル: 1    役割: D/V
 エージェントがダウンストリームシステムに対して第一級プリンシパルとして認証し、エンドユーザーの資格情報を再利用しないことを確認してください。
 #9.7.2    レベル: 2    役割: D
 詳細な認可ポリシーが、エージェントが呼び出せるツールと提供できるパラメーターを制限していることを検証してください。
 #9.7.3    レベル: 2    役割: V
 権限チェックがセッション開始時だけでなく、すべての呼び出し時に再評価されること（継続的認可）を確認してください。
 #9.7.4    レベル: 3    役割: D
 委任された権限が自動的に期限切れとなり、タイムアウトまたはスコープの変更後に再同意が必要であることを確認してください。

---

### 9.8 エージェント間通信のセキュリティ

盗聴や改ざんを防ぐために、すべてのエージェント間メッセージを暗号化し、完全性を保護してください。

 #9.8.1    レベル: 1    役割: D/V
 エージェントチャネルにおいて、相互認証および完全前方秘匿性暗号化（例えば、TLS 1.3）が必須であることを検証してください。
 #9.8.2    レベル: 1    役割: D
 メッセージの整合性と送信元が処理前に検証されることを確認してください。検証に失敗した場合はアラートを発し、メッセージを破棄します。
 #9.8.3    レベル: 2    役割: D/V
 通信のメタデータ（タイムスタンプ、シーケンス番号）が記録され、フォレンジック再構築を支援することを確認してください。
 #9.8.4    レベル: 3    役割: V
 形式的検証またはモデル検査が、プロトコル状態機械が安全でない状態に駆動されないことを確認する。

---

### 9.9 意図の検証と制約の強制

エージェントの行動がユーザーの明示された意図およびシステムの制約に沿っていることを検証する。

 #9.9.1    レベル: 1    役割: D
 事前実行制約ソルバーが提案されたアクションをハードコーディングされた安全およびポリシールールと照合していることを検証してください。
 #9.9.2    レベル: 2    役割: D/V
 高影響のアクション（財務関連、破壊的、プライバシーに関わるもの）には、実行者ユーザーからの明示的な意図確認が必要であることを検証してください。
 #9.9.3    レベル: 2    役割: V
 完了したアクションが意図した効果を副作用なしに達成したことを検証するために事後条件のチェックを行い、不整合があればロールバックをトリガーします。
 #9.9.4    レベル: 3    役割: V
 形式手法（例：モデル検査、定理証明）またはプロパティベーステストが、エージェントの計画がすべての宣言された制約を満たしていることを示していることを確認してください。
 #9.9.5    レベル: 3    役割: D
 インテントの不一致や制約違反のインシデントが、継続的改善サイクルおよび脅威インテリジェンス共有に反映されることを検証してください。

---

### 9.10 エージェント推論戦略のセキュリティ

ReAct、Chain-of-Thought、および Tree-of-Thoughts アプローチを含むさまざまな推論戦略の安全な選択と実行。

 #9.10.1    レベル: 1    役割: D/V
 推論戦略の選択が決定論的基準（入力の複雑さ、タスクの種類、セキュリティコンテキスト）を使用していること、および同一のセキュリティコンテキスト内で同一の入力が同一の戦略選択を生み出すことを検証する。
 #9.10.2    レベル: 1    役割: D/V
 各推論戦略（ReAct、Chain-of-Thought、Tree-of-Thoughts）には、それぞれの認知アプローチに特化した入力検証、出力サニタイズ、および実行時間制限が専用に設けられていることを確認してください。
 #9.10.3    レベル: 2    役割: D/V
 推論戦略の移行が、入力特性、選択基準値、および実行メタデータを含む完全なコンテキストとともに記録されていることを確認し、監査トレイルの再構築を可能にします。
 #9.10.4    レベル: 2    役割: D/V
 Tree-of-Thoughts 推論には、ポリシー違反、リソース制限、または安全境界が検出された場合に探索を終了する枝刈りメカニズムが含まれていることを確認してください。
 #9.10.5    レベル: 2    役割: D/V
 ReAct（Reason-Act-Observe）サイクルには、各フェーズで検証チェックポイントが含まれていることを確認してください：推論ステップの検証、行動の承認、および次に進む前の観察のサニタイズ。
 #9.10.6    レベル: 3    役割: D/V
 推論戦略のパフォーマンス指標（実行時間、リソース使用量、出力品質）が、設定された閾値を超えて逸脱した場合に自動アラートで監視されていることを確認してください。
 #9.10.7    レベル: 3    役割: D/V
 複数の戦略を組み合わせたハイブリッド推論アプローチが、すべての構成戦略の入力バリデーションおよび出力制約を維持し、いかなるセキュリティコントロールも迂回しないことを検証してください。
 #9.10.8    レベル: 3    役割: D/V
 推論戦略のセキュリティテストには、不正な入力によるファジング、戦略の切り替えを強制するために設計された敵対的プロンプト、および各認知アプローチに対する境界条件テストが含まれていることを確認してください。

---

### 9.11 エージェントライフサイクル状態管理とセキュリティ

暗号学的監査証跡と定義された回復手順を用いた安全なエージェントの初期化、状態遷移、および終了。

 #9.11.1    レベル: 1    役割: D/V
 エージェントの初期化には、ハードウェアに裏付けられた認証情報による暗号的アイデンティティの確立、およびエージェントID、タイムスタンプ、構成ハッシュ、初期化パラメーターを含む変更不可能な起動監査ログが含まれていることを確認してください。
 #9.11.2    レベル: 2    役割: D/V
 エージェントの状態遷移が暗号的に署名され、タイムスタンプが付けられ、トリガーイベント、前の状態ハッシュ、新しい状態ハッシュ、および実行されたセキュリティ検証を含む完全なコンテキストでログに記録されていることを確認してください。
 #9.11.3    レベル: 2    役割: D/V
 エージェントのシャットダウン手順に、暗号消去または複数回上書きを使用した安全なメモリ消去、証明書機関への通知を伴う資格情報の失効、および改ざん検出可能な終了証明書の生成が含まれていることを確認してください。
 #9.11.4    レベル: 3    役割: D/V
 エージェントのリカバリ機構が、状態の整合性を暗号学的チェックサム（最低でもSHA-256）を用いて検証し、破損が検出された場合に既知の正常な状態にロールバックし、自動アラートおよび手動承認の要件を伴うことを確認してください。
 #9.11.5    レベル: 3    役割: D/V
 エージェントの永続化メカニズムが、エージェントごとのAES-256鍵で機密状態データを暗号化し、最大90日間の設定可能なスケジュールで安全な鍵ローテーションを実装し、ゼロダウンタイムでの展開を行っていることを検証してください。

---

### 9.12 ツール統合セキュリティフレームワーク

定義されたリスク評価および承認プロセスを伴う、動的ツールのロード、実行、および結果検証のためのセキュリティコントロール。

 #9.12.1    レベル: 1    役割: D/V
 ツール記述子に、必要な権限（読み取り/書き込み/実行）、リスクレベル（低/中/高）、リソース制限（CPU、メモリ、ネットワーク）、およびツールマニフェストに記載された検証要件を指定するセキュリティメタデータが含まれていることを確認してください。
 #9.12.2    レベル: 1    役割: D/V
 ツールの実行結果が、統合前に期待されるスキーマ（JSONスキーマ、XMLスキーマ）およびセキュリティポリシー（出力のサニタイズ、データ分類）に対して検証され、タイムアウト制限およびエラーハンドリング手順が適用されていることを確認してください。
 #9.12.3    レベル: 2    役割: D/V
 ツールの操作ログに、特権使用状況、データアクセスパターン、実行時間、リソース消費、戻りコードなどの詳細なセキュリティコンテキストが含まれ、SIEM統合のための構造化ログが記録されていることを検証してください。
 #9.12.4    レベル: 2    役割: D/V
 動的ツール読み込みメカニズムがPKIインフラストラクチャを使用してデジタル署名を検証し、実行前にサンドボックス分離と権限検証を伴う安全な読み込みプロトコルを実装していることを確認してください。
 #9.12.5    レベル: 3    役割: D/V
 新しいバージョンに対して、静的解析、動的テスト、およびセキュリティチームのレビューを含む必須の承認ゲートがあり、文書化された承認基準とSLA要件を伴うツールのセキュリティ評価が自動的にトリガーされることを確認してください。

---

#### 参考文献

MITRE ATLAS tactics ML09
Circuit-breaker research for AI agents — Zou et al., 2024
Trend Micro analysis of sandbox escapes in AI agents — Park, 2025
Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025
Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025
Rapid7 fundamentals on spoofing attack prevention — 2024
Imperial College verification of swarm systems — Lomuscio et al.
NIST AI Risk Management Framework 1.0, 2023
WIRED security briefing on encryption best practices, 2024
OWASP Top 10 for LLM Applications, 2025
Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS
[How Is LLM Reasoning Distracted by Irrelevant Context?
An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
Large Language Model Sentinel: LLM Agent for Adversarial Purification
Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents

## 10 敵対的ロバストネスとプライバシー防御

### 管理目標

回避、推論、抽出、または毒性攻撃に直面した際に、AIモデルが信頼性を保ち、プライバシーを保護し、不正利用に強い状態を維持することを保証してください。

---

### 10.1 モデルの整合性と安全性

有害またはポリシー違反の出力を防止します。

 #10.1.1    レベル: 1    役割: D/V
 アラインメントテストスイート（レッドチームプロンプト、ジャイルブレイクプローブ、許可されていないコンテンツ）がバージョン管理されており、すべてのモデルリリースで実行されていることを確認してください。
 #10.1.2    レベル: 1    役割: D
 拒否および安全完了のガードレールが適用されていることを確認してください。
 #10.1.3    レベル: 2    役割: D/V
 自動評価器が有害コンテンツ率を測定し、設定された閾値を超える劣化を検出することを検証する。
 #10.1.4    レベル: 2    役割: D
 カウンタージェイルブレイクトレーニングが文書化されており、再現可能であることを確認してください。
 #10.1.5    レベル: 3    役割: V
 正式なポリシー準拠の証明または認証された監視が重要な領域をカバーしていることを確認してください。

---

### 10.2 敵対的事例の強化

操作された入力に対する耐性を高める。堅牢な敵対的学習とベンチマーク評価が現在のベストプラクティスである。

 #10.2.1    レベル: 1    役割: D
 プロジェクトのリポジトリに再現可能なシードを用いた敵対的トレーニングの設定が含まれていることを確認してください。
 #10.2.2    レベル: 2    役割: D/V
 本番パイプラインで敵対的サンプル検出がブロッキングアラートを発生させることを検証してください。
 #10.2.4    レベル: 3    役割: V
 認定された堅牢性証明または区間境界証明書が、少なくとも主要な重要クラスを網羅していることを確認してください。
 #10.2.5    レベル: 3    役割: V
 回帰テストが適応攻撃を使用して、計測可能な耐性低下がないことを確認していることを検証してください。

---

### 10.3 メンバーシップ推論の緩和

レコードが訓練データに含まれていたかどうかを判断する能力を制限します。差分プライバシーと信頼度スコアのマスキングは、依然として最も効果的に知られている防御策です。

 #10.3.1    レベル: 1    役割: D
 クエリごとのエントロピー正則化または温度スケーリングが過度に自信のある予測を減少させることを検証してください。
 #10.3.2    レベル: 2    役割: D
 機微なデータセットに対して、訓練がε-制限付き差分プライベート最適化を採用していることを検証してください。
 #10.3.3    レベル: 2    役割: V
 攻撃シミュレーション（シャドウモデルまたはブラックボックス）がホールドアウトデータに対して攻撃AUC ≤ 0.60を示すことを確認してください。

---

### 10.4 モデル反転耐性

プライベート属性の再構築を防止する。最近の調査では、出力の切り捨てと差分プライバシー（DP）の保証が実用的な防御策として強調されている。

 #10.4.1    レベル: 1    役割: D
 機微な属性が直接出力されないことを検証する。必要に応じて、バケットや一方向変換を使用する。
 #10.4.2    レベル: 1    役割: D/V
 同じ主体からの繰り返される適応的クエリがクエリレート制限によって制御されていることを確認してください。
 #10.4.3    レベル: 2    役割: D
 モデルがプライバシー保護のノイズでトレーニングされていることを確認してください。

---

### 10.5 モデル抽出防御

不正な複製を検出および抑止します。ウォーターマーキングとクエリパターン分析が推奨されます。

 #10.5.1    レベル: 1    役割: D
 推論ゲートウェイが、モデルの記憶閾値に合わせて調整されたグローバルおよびAPIキーごとのレート制限を適用していることを検証してください。
 #10.5.2    レベル: 2    役割: D/V
 クエリエントロピーと入力複数性の統計が自動抽出検出器に入力されることを確認してください。
 #10.5.3    レベル: 2    役割: V
 壊れやすいまたは確率的なウォーターマークが、疑わしいクローンに対して1000回以下の問い合わせでp < 0.01の証明が可能であることを検証してください。
 #10.5.4    レベル: 3    役割: D
 ウォーターマークキーとトリガーセットがハードウェアセキュリティモジュールに保存され、毎年ローテーションされていることを確認してください。
 #10.5.5    レベル: 3    役割: V
 抽出アラートイベントに問題となるクエリが含まれており、インシデント対応プレイブックと統合されていることを確認してください。

---

### 10.6 推論時の毒データ検出

バックドアや汚染された入力を特定して無効化します。

 #10.6.1    レベル: 1    役割: D
 モデル推論の前に、入力が異常検出器（例：STRIP、一貫性スコアリング）を通過することを確認してください。
 #10.6.2    レベル: 1    役割: V
 検出器の閾値が、5%未満の誤検知率を達成するために、クリーンおよび毒性のある検証セットで調整されていることを確認してください。
 #10.6.3    レベル: 2    役割: D
 毒されたとマークされた入力がソフトブロックおよび人間によるレビューのワークフローを引き起こすことを確認してください。
 #10.6.4    レベル: 2    役割: V
 検出器が適応型のトリガーレスバックドア攻撃でストレステストされていることを確認してください。
 #10.6.5    レベル: 3    役割: D
 検出効率の指標が記録され、新しい脅威インテリジェンスを用いて定期的に再評価されていることを確認してください。

---

### 10.7 動的セキュリティポリシー適応

脅威インテリジェンスと行動分析に基づくリアルタイムのセキュリティポリシー更新。

 #10.7.1    レベル: 1    役割: D/V
 エージェントの再起動なしでセキュリティポリシーが動的に更新できることを確認し、ポリシーのバージョン整合性が維持されていることを検証する。
 #10.7.2    レベル: 2    役割: D/V
 ポリシーの更新が権限のあるセキュリティ担当者によって暗号的に署名され、適用前に検証されていることを確認してください。
 #10.7.3    レベル: 2    役割: D/V
 動的ポリシーの変更が、正当化、承認チェーン、およびロールバック手順を含む完全な監査証跡で記録されていることを確認してください。
 #10.7.4    レベル: 3    役割: D/V
 適応型セキュリティメカニズムがリスクコンテキストと行動パターンに基づいて脅威検出の感度を調整することを検証してください。
 #10.7.5    レベル: 3    役割: D/V
 ポリシー適応の決定が説明可能であり、セキュリティチームのレビューのための証拠のトレイルを含んでいることを検証してください。

---

### 10.8 リフレクションベースのセキュリティ分析

エージェントの自己反省とメタ認知分析を通じたセキュリティ検証。

 #10.8.1    レベル: 1    役割: D/V
 エージェントのリフレクションメカニズムに、意思決定および行動のセキュリティに焦点を当てた自己評価が含まれていることを確認してください。
 #10.8.2    レベル: 2    役割: D/V
 自己評価メカニズムの操作を防ぐために、反映出力が検証されていることを確認してください。
 #10.8.3    レベル: 2    役割: D/V
 メタ認知的セキュリティ分析がエージェントの推論プロセスにおける潜在的なバイアス、操作、または妥協を特定することを検証してください。
 #10.8.4    レベル: 3    役割: D/V
 リフレクションベースのセキュリティ警告が強化された監視および潜在的な人間の介入ワークフローを引き起こすことを検証してください。
 #10.8.5    レベル: 3    役割: D/V
 セキュリティの振り返りからの継続的な学習が、正当な機能を損なうことなく脅威検出を向上させることを検証する。

---

### 10.9 進化と自己改善のセキュリティ

自己修正および進化が可能なエージェントシステムのためのセキュリティ制御。

 #10.9.1    レベル: 1    役割: D/V
 自己改変能力が指定された安全領域内に制限されており、正式な検証境界が設けられていることを確認してください。
 #10.9.2    レベル: 2    役割: D/V
 進化提案が実装前にセキュリティ影響評価を受けることを確認してください。
 #10.9.3    レベル: 2    役割: D/V
 自己改善メカニズムが、整合性検証を伴うロールバック機能を含むことを確認してください。
 #10.9.4    レベル: 3    役割: D/V
 メタラーニングのセキュリティが、改善アルゴリズムへの敵対的操作を防止することを検証する。
 #10.9.5    レベル: 3    役割: D/V
 再帰的自己改善が収束の数学的証明を伴う形式的安全制約によって制限されていることを検証する。

---

#### 参考文献

MITRE ATLAS adversary tactics for ML
NIST AI Risk Management Framework 1.0, 2023
OWASP Top 10 for LLM Applications, 2025
Adversarial Training: A Survey — Zhao et al., 2024
RobustBench adversarial-robustness benchmark
Membership-Inference & Model-Inversion Risk Survey, 2025
PURIFIER: Confidence-Score Defense against MI Attacks — AAAI 2023
Model-Inversion Attacks & Defenses Survey — AI Review, 2025
Comprehensive Defense Framework Against Model Extraction — IEEE TDSC 2024
Fragile Model Watermarking Survey — 2025
Data Poisoning in Deep Learning: A Survey — Zhao et al., 2025
BDetCLIP: Multimodal Prompting Backdoor Detection — Niu et al., 2024

## 11 プライバシー保護と個人データ管理

### 管理目標

AIのライフサイクル全体—収集、トレーニング、推論、インシデント対応—を通じて厳格なプライバシー保証を維持し、個人データが明確な同意、最小限の必要範囲、証明可能な消去、および正式なプライバシー保証のもとでのみ処理されるようにします。

---

### 11.1 匿名化とデータ最小化

 #11.1.1    レベル: 1    役割: D/V
 直接識別子および準識別子が削除またはハッシュ化されていることを確認してください。
 #11.1.2    レベル: 2    役割: D/V
 自動監査がk-匿名性/l-多様性を測定し、しきい値がポリシーを下回った場合に警告を出すことを確認してください。
 #11.1.3    レベル: 2    役割: V
 モデルの特徴重要度レポートが、識別子リークがε = 0.01の相互情報量を超えないことを証明していることを検証してください。
 #11.1.4    レベル: 3    役割: V
 形式的な証明や合成データ認証によって、リンク攻撃下でも再識別リスクが0.05以下であることを検証してください。

---

### 11.2 忘れられる権利と削除の強制 enforcement

 #11.2.1    レベル: 1    役割: D/V
 データ主体の削除要求が、30日未満のサービスレベル合意内で、生データセット、チェックポイント、埋め込み、ログ、およびバックアップに伝播することを検証してください。
 #11.2.2    レベル: 2    役割: D
 「マシン・アンラーニング」ルーチンが、認証されたアンラーニングアルゴリズムを用いて物理的に再訓練または除去の近似を行うことを検証してください。
 #11.2.3    レベル: 2    役割: V
 シャドウモデル評価により、忘却後の出力に対する忘却対象レコードの影響が1％未満であることを検証してください。
 #11.2.4    レベル: 3    役割: V
 削除イベントが不変に記録され、規制当局によって監査可能であることを確認します。

---

### 11.3 差分プライバシー保護措置

 #11.3.1    レベル: 2    役割: D/V
 累積εがポリシーの閾値を超えた場合に、プライバシー損失アカウンティングダッシュボードがアラートを出すことを確認してください。
 #11.3.2    レベル: 2    役割: V
 ブラックボックスプライバシー監査が宣言された値の10％以内でε̂を推定していることを検証する。
 #11.3.3    レベル: 3    役割: V
 形式的証明がすべての事後トレーニングのファインチューニングと埋め込みを網羅していることを確認してください。

---

### 11.4 目的の限定および範囲の膨張防止

 #11.4.1    レベル: 1    役割: D
 すべてのデータセットおよびモデルチェックポイントに、元の同意に沿った機械可読の目的タグが付されていることを確認してください。
 #11.4.2    レベル: 1    役割: D/V
 ランタイムモニターが宣言された目的と矛盾するクエリを検出し、ソフト拒否をトリガーすることを検証してください。
 #11.4.3    レベル: 3    役割: D
 ポリシー・アズ・コードのゲートが、DPIAレビューなしでモデルの新しいドメインへの再展開をブロックすることを確認してください。
 #11.4.4    レベル: 3    役割: V
 正式なトレーサビリティ証明が、すべての個人データのライフサイクルが同意された範囲内に留まっていることを示していることを検証します。

---

### 11.5 同意管理と法的根拠に基づくトラッキング

 #11.5.1    レベル: 1    役割: D/V
 同意管理プラットフォーム（CMP）が、データ主体ごとにオプトインの状態、目的、および保持期間を記録していることを検証してください。
 #11.5.2    レベル: 2    役割: D
 APIが同意トークンを公開していることを確認し、モデルは推論前にトークンスコープを検証する必要があります。
 #11.5.3    レベル: 2    役割: D/V
 拒否または撤回された同意が24時間以内に処理パイプラインを停止することを確認してください。

---

### 11.6 プライバシー制御を備えたフェデレーテッドラーニング

 #11.6.1    レベル: 1    役割: D
 クライアントの更新が集計前にローカル差分プライバシーのノイズ付加を使用していることを検証してください。
 #11.6.2    レベル: 2    役割: D/V
 トレーニングメトリクスが差分プライバシーを保持しており、単一クライアントの損失を決して明らかにしないことを検証してください。
 #11.6.3    レベル: 2    役割: V
 毒性耐性集約（例：Krum/Trimmed-Mean）が有効になっていることを確認してください。
 #11.6.4    レベル: 3    役割: V
 形式的な証明が、全体のε予算がユーティリティ損失5未満であることを示していることを検証する。

---

#### 参考文献

GDPR & AI Compliance Best Practices
EU Parliament Study on GDPR & AI, 2020
ISO 31700-1:2023 — Privacy by Design for Consumer Products
NIST Privacy Framework 1.1 (2025 Draft)
Machine Unlearning: Right-to-Be-Forgotten Techniques
A Survey of Machine Unlearning, 2024
Auditing DP-SGD — ArXiv 2024
DP-SGD Explained — PyTorch Blog
Purpose-Limitation for AI — IJLIT 2025
Data-Protection Considerations for AI — URM Consulting
Top Consent-Management Platforms, 2025
Secure Aggregation in DP Federated Learning — ArXiv 2024

## C12 モニタリング、ログ記録、および異常検知

### 管理目標

このセクションでは、モデルおよびその他のAIコンポーネントが何を見て、何を行い、何を返すかをリアルタイムおよびフォレンジックで可視化するための要件を提供し、脅威を検出、トリアージ、および学習できるようにします。

### C12.1 リクエストおよびレスポンスのログ記録

 #12.1.1    レベル: 1    役割: D/V
 すべてのユーザープロンプトとモデルの応答が、適切なメタデータ（例：タイムスタンプ、ユーザーID、セッションID、モデルバージョン）とともにログに記録されていることを確認してください。
 #12.1.2    レベル: 1    役割: D/V
 ログが適切な保持ポリシーおよびバックアップ手順を備えた、安全でアクセス制御されたリポジトリに保存されていることを確認してください。
 #12.1.3    レベル: 1    役割: D/V
 ログストレージシステムが、ログに含まれる機密情報を保護するために、保存時と転送時の両方で暗号化を実装していることを確認してください。
 #12.1.4    レベル: 1    役割: D/V
 プロンプトおよび出力内の機密データがログ記録前に自動的に削除またはマスクされることを確認し、PII、認証情報、および独自情報に対する構成可能な削除ルールを備えていることを検証してください。
 #12.1.5    レベル: 2    役割: D/V
 ポリシー決定および安全フィルタリングの操作が、コンテンツモデレーションシステムの監査とデバッグを可能にする十分な詳細でログに記録されていることを確認してください。
 #12.1.6    レベル: 2    役割: D/V
 ログの完全性が暗号署名や書き込み専用ストレージなどによって保護されていることを確認してください。

---

### C12.2 悪用検出とアラート通知

 #12.2.1    レベル: 1    役割: D/V
 システムが署名ベースの検出を使用して、既知の脱獄パターン、プロンプトインジェクションの試み、および敵対的入力を検出し、警告を出すことを確認してください。
 #12.2.2    レベル: 1    役割: D/V
 システムが標準のログ形式およびプロトコルを使用して、既存のセキュリティ情報イベント管理（SIEM）プラットフォームと統合されていることを確認してください。
 #12.2.3    レベル: 2    役割: D/V
 強化されたセキュリティイベントに、モデル識別子、信頼度スコア、安全フィルターの判定などのAI固有のコンテキストが含まれていることを検証してください。
 #12.2.4    レベル: 2    役割: D/V
 行動異常検知が、異常な会話パターン、過剰な再試行回数、または体系的な探査行動を特定することを確認してください。
 #12.2.5    レベル: 2    役割: D/V
 リアルタイムのアラート機構が、潜在的なポリシー違反や攻撃試行が検出された際にセキュリティチームに通知することを確認してください。
 #12.2.6    レベル: 2    役割: D/V
 カスタムルールが、協調的なジャイルブレイク試行、プロンプトインジェクションキャンペーン、およびモデル抽出攻撃を含むAI特有の脅威パターンを検出するために含まれていることを確認してください。
 #12.2.7    レベル: 3    役割: D/V
 自動化されたインシデント対応ワークフローが、侵害されたモデルを隔離し、悪意のあるユーザーをブロックし、重要なセキュリティイベントをエスカレーションできることを検証します。

---

### C12.3 モデルドリフト検出

 #12.3.1    レベル: 1    役割: D/V
 システムがモデルのバージョンおよび期間を通じて、精度、信頼度スコア、レイテンシ、およびエラー率などの基本的なパフォーマンス指標を追跡していることを検証してください。
 #12.3.2    レベル: 2    役割: D/V
 パフォーマンス指標が事前に定められた劣化閾値を超えた場合、またはベースラインから大幅に逸脱した場合に、自動アラートが作動することを確認してください。
 #12.3.3    レベル: 2    役割: D/V
 モデルの出力に事実と異なる、不整合な、または捏造された情報が含まれている場合に、それを特定しフラグを立てることができるかどうか、幻覚検出モニターを検証してください。

---

### C12.4 パフォーマンスおよび動作テレメトリ

 #12.4.1    レベル: 1    役割: D/V
 リクエスト遅延、トークン消費、メモリ使用量、スループットを含む運用指標が継続的に収集および監視されていることを確認してください。
 #12.4.2    レベル: 1    役割: D/V
 成功率と失敗率が、エラータイプおよびその根本原因の分類とともに追跡されていることを確認してください。
 #12.4.3    レベル: 2    役割: D/V
 リソース使用状況の監視にGPU/CPU使用率、メモリ消費量、ストレージ要件が含まれており、閾値を超えた場合にアラートが発生することを確認してください。

---

### C12.5 AI インシデント対応計画と実行

 #12.5.1    レベル: 1    役割: D/V
 インシデント対応計画が、モデルの侵害、データポイズニング、敵対的攻撃を含むAI関連のセキュリティイベントに特に対応していることを確認してください。
 #12.5.2    レベル: 2    役割: D/V
 インシデント対応チームが、モデルの挙動や攻撃ベクトルを調査するためのAI特有のフォレンジックツールと専門知識にアクセスできることを確認してください。
 #12.5.3    レベル: 3    役割: D/V
 事後分析にモデルの再訓練の考慮、安全フィルターの更新、および教訓のセキュリティ制御への統合が含まれていることを確認してください。

---

### C12.5 AIパフォーマンス劣化検出

AIモデルの性能と品質の経時的な劣化を監視し検出する。

 #12.5.1    レベル: 1    役割: D/V
 モデルの精度、適合率、再現率、およびF1スコアが継続的に監視され、ベースラインの閾値と比較されていることを確認してください。
 #12.5.2    レベル: 1    役割: D/V
 データドリフト検出がモデルのパフォーマンスに影響を与える可能性のある入力分布の変化を監視していることを確認してください。
 #12.5.3    レベル: 2    役割: D/V
 概念ドリフト検出が、入力と期待される出力との関係の変化を識別することを確認してください。
 #12.5.4    レベル: 2    役割: D/V
 パフォーマンスの低下が自動アラートをトリガーし、モデルの再訓練または置換のワークフローを開始することを確認してください。
 #12.5.5    レベル: 3    役割: V
 劣化の根本原因分析が、性能低下とデータの変化、インフラストラクチャの問題、または外部要因と相関していることを確認してください。

---

### C12.6 DAG可視化とワークフローセキュリティ

ワークフロー可視化システムを情報漏洩や改ざん攻撃から保護する。

 #12.6.1    レベル: 1    役割: D/V
 保存または送信前に、DAG可視化データが機密情報を除去するように適切にサニタイズされていることを確認してください。
 #12.6.2    レベル: 1    役割: D/V
 ワークフローの可視化アクセス制御が、許可されたユーザーのみがエージェントの意思決定経路および推論過程を閲覧できるようにしていることを確認してください。
 #12.6.3    レベル: 2    役割: D/V
 DAGのデータ整合性が暗号署名および改ざん検知ストレージ機構によって保護されていることを確認してください。
 #12.6.4    レベル: 2    役割: D/V
 ワークフロー可視化システムが、細工されたノードまたはエッジデータを通じたインジェクション攻撃を防ぐために、入力検証を実装していることを確認してください。
 #12.6.5    レベル: 3    役割: D/V
 リアルタイムDAG更新がレート制限されており、可視化システムに対するサービス拒否攻撃を防ぐために検証されていることを確認してください。

---

### C12.7 プロアクティブなセキュリティ行動モニタリング

プロアクティブなエージェントの行動分析によるセキュリティ脅威の検出と防止。

 #12.7.1    レベル: 1    役割: D/V
 リスク評価の統合を用いて、実行前にプロアクティブエージェントの動作がセキュリティ検証されていることを確認してください。
 #12.7.2    レベル: 2    役割: D/V
 自律的なイニシアチブのトリガーには、セキュリティコンテキストの評価と脅威状況の評価が含まれていることを確認してください。
 #12.7.3    レベル: 2    役割: D/V
 積極的な行動パターンが潜在的なセキュリティ上の影響や意図しない結果について分析されていることを確認する。
 #12.7.4    レベル: 3    役割: D/V
 セキュリティに重要なプロアクティブな行動には、監査証跡のある明示的な承認チェーンが必要であることを確認してください。
 #12.7.5    レベル: 3    役割: D/V
 行動異常検知が、侵害を示す可能性のあるプロアクティブエージェントのパターンの逸脱を識別することを検証してください。

---

### 参考文献

NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3
ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6
EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping

## C13 人間の監督、責任、およびガバナンス

### 管理目標

この章は、AIシステムにおける人間の監督と明確な責任の連鎖を維持するための要件を提供し、AIライフサイクル全体にわたる説明責任、透明性、および倫理的管理を確保します。

---

### C13.1 キルスイッチ & オーバーライドメカニズム

AIシステムの安全でない動作が観察された場合に、シャットダウンまたはロールバックのパスを提供してください。

 #13.1.1    レベル: 1    役割: D/V
 AIモデルの推論と出力を直ちに停止するための手動のキルスイッチ機構が存在することを確認してください。
 #13.1.2    レベル: 1    役割: D
 オーバーライド制御が認可された担当者のみにアクセス可能であることを確認してください。
 #13.1.3    レベル: 3    役割: D/V
 ロールバック手順が以前のモデルバージョンまたはセーフモード操作に戻すことができることを確認してください。
 #13.1.4    レベル: 3    役割: V
 オーバーライドメカニズムが定期的にテストされていることを確認してください。

---

### C13.2 人間関与型意思決定チェックポイント

リスクの事前定義された閾値を超えた場合は、人間の承認を必須とする。

 #13.2.1    レベル: 1    役割: D/V
 高リスクのAI判断は実行前に明示的な人間の承認を必要とすることを確認してください。
 #13.2.2    レベル: 1    役割: D
 リスク閾値が明確に定義されており、自動的に人間によるレビューのワークフローを開始することを確認してください。
 #13.2.3    レベル: 2    役割: D
 人間の承認が必要な時間内に得られない場合に備えて、時間に敏感な決定には代替手順があることを確認してください。
 #13.2.4    レベル: 3    役割: D/V
 適用可能な場合、エスカレーション手順が異なる意思決定の種類やリスクカテゴリーに対して明確な権限レベルを定義していることを確認してください。

---

### C13.3 責任の連鎖と監査可能性

オペレーターの操作とモデルの決定をログに記録します。

 #13.3.1    レベル: 1    役割: D/V
 すべてのAIシステムの意思決定および人間による介入が、タイムスタンプ、ユーザー識別情報、および意思決定の根拠とともに記録されていることを確認してください。
 #13.3.2    レベル: 2    役割: D
 監査ログが改ざんできないことを確認し、整合性検証機構を含めてください。

---

### C13.4 説明可能なAI技術

表面特徴の重要性、反事実、局所的説明。

 #13.4.1    レベル: 1    役割: D/V
 AIシステムが意思決定に関する基本的な説明を人間が理解できる形式で提供していることを確認してください。
 #13.4.2    レベル: 2    役割: V
 説明の品質が人間による評価研究および指標を通じて検証されていることを確認する。
 #13.4.3    レベル: 3    役割: D/V
 重要な意思決定に対して、特徴量重要度スコアや説明手法（SHAP、LIMEなど）が利用可能であることを確認してください。
 #13.4.4    レベル: 3    役割: V
 反事実説明が、ユースケースおよびドメインに適用可能な場合に、結果を変えるために入力をどのように変更できるかを示していることを確認してください。

---

### C13.5 モデルカードと使用開示

意図された使用法、性能指標、および倫理的考慮事項についてモデルカードを維持する。

 #13.5.1    レベル: 1    役割: D
 モデルカードに意図された使用例、制限事項、および既知の失敗モードが記載されていることを確認してください。
 #13.5.2    レベル: 1    役割: D/V
 異なる適用可能なユースケースにおけるパフォーマンス指標が開示されていることを確認してください。
 #13.5.3    レベル: 2    役割: D
 倫理的考慮事項、バイアス評価、公平性評価、トレーニングデータの特性、および既知のトレーニングデータの制限が文書化され、定期的に更新されていることを確認してください。
 #13.5.4    レベル: 2    役割: D/V
 モデルカードがバージョン管理され、変更追跡とともにモデルライフサイクルを通じて維持されていることを確認してください。

---

### C13.6 不確かさの定量化

レスポンスにおける信頼度スコアやエントロピー測度を伝播させる。

 #13.6.1    レベル: 1    役割: D
 AIシステムが出力と共に信頼度スコアまたは不確実性の指標を提供していることを確認してください。
 #13.6.2    レベル: 2    役割: D/V
 不確実性の閾値が追加の人間によるレビューや代替の意思決定経路を引き起こすことを確認してください。
 #13.6.3    レベル: 2    役割: V
 不確実性定量化手法が実際の真値データに対して較正および検証されていることを確認する。
 #13.6.4    レベル: 3    役割: D/V
 多段階のAIワークフローを通じて不確実性の伝播が維持されていることを検証する。

---

### C13.7 ユーザー向け透明性レポート

インシデント、ドリフト、およびデータ使用状況に関する定期的な開示を行うこと。

 #13.7.1    レベル: 1    役割: D/V
 データ使用ポリシーおよびユーザー同意管理の実施方法が関係者に明確に伝えられていることを確認してください。
 #13.7.2    レベル: 2    役割: D/V
 AIの影響評価が実施され、その結果が報告に含まれていることを確認してください。
 #13.7.3    レベル: 2    役割: D/V
 透明性レポートが定期的に公開され、AIのインシデントおよび運用指標が適切な詳細で開示されていることを確認してください。

#### 参考文献

EU Artificial Intelligence Act — Regulation (EU) 2024/1689 (Official Journal, 12 July 2024)
ISO/IEC 23894:2023 — Artificial Intelligence — Guidance on Risk Management
ISO/IEC 42001:2023 — AI Management Systems Requirements
NIST AI Risk Management Framework 1.0
NIST SP 800-53 Revision 5 — Security and Privacy Controls
A Unified Approach to Interpreting Model Predictions (SHAP, ICML 2017)
Model Cards for Model Reporting (Mitchell et al., 2018)
Dropout as a Bayesian Approximation: Representing Model Uncertainty in Deep Learning (Gal & Ghahramani, 2016)
ISO/IEC 24029-2:2023 — Robustness of Neural Networks — Methodology for Formal Methods
IEEE 7001-2021 — Transparency of Autonomous Systems
GDPR — Article 5 "Transparency Principle" (Regulation (EU) 2016/679)
Human Oversight under Article 14 of the EU AI Act (Fink, 2025)

## 付録A：用語集

この包括的な用語集は、AISVS全体で使用される主要なAI、ML、およびセキュリティ用語の定義を提供し、明確さと共通理解を確保します。

敵対的サンプル：AIモデルに誤りを引き起こさせるために意図的に作成された入力であり、人間には知覚できない微細な摂動を加えることが多い。
​
敵対的ロバストネス – AIにおける敵対的ロバストネスとは、モデルがその性能を維持し、意図的に作成された悪意のある入力による誤動作や操作に抵抗する能力を指します。
​
エージェント – AIエージェントは、ユーザーに代わって目標を追求しタスクを完了するためにAIを利用するソフトウェアシステムです。彼らは推論、計画、記憶を示し、意思決定、学習、適応を行うための一定の自律性を持っています。
​
エージェンティックAI：ある程度の自律性を持って目標を達成できるAIシステムであり、多くの場合、直接的な人間の介入なしに意思決定や行動を行う。
​
属性ベースアクセス制御（ABAC）：ユーザー、リソース、アクション、および環境の属性に基づいて認可決定を行い、クエリ時に評価されるアクセス制御のパラダイム。
​
バックドア攻撃：特定のトリガーに対して特定の反応を示すようにモデルが訓練され、それ以外は通常通りに動作するデータポイズニング攻撃の一種。
​
バイアス：特定のグループや特定の文脈において、不公平または差別的な結果をもたらす可能性のある、AIモデルの出力における体系的な誤り。
​
バイアス悪用：AIモデルに存在する既知のバイアスを利用して、出力や結果を操作する攻撃手法。
​
Cedar：AIシステムのABAC（属性ベースアクセス制御）実装に使用される、きめ細かい権限管理のためのAmazonのポリシー言語およびエンジン。
​
Chain of Thought（思考の連鎖）：最終的な回答を生成する前に、中間の推論ステップを生成することで言語モデルの推論能力を向上させる技法。
​
サーキットブレーカー: 特定のリスク閾値を超えた場合に、AIシステムの稼働を自動的に停止するメカニズム。
​
データリーク：AIモデルの出力や挙動を通じて、機密情報が意図せず露出すること。
​
データポイズニング：モデルの完全性を損なうために、トレーニングデータを意図的に破損させること。これにはバックドアを仕込むことや性能を低下させることが含まれる。
​
差分プライバシー – 差分プライバシーは、個々のデータ主体のプライバシーを保護しながら、データセットに関する統計情報を公開するための数学的に厳密なフレームワークです。これにより、データ保有者は特定の個人に関する情報の漏えいを制限しつつ、グループ全体の集約パターンを共有することが可能になります。
​
埋め込み：データ（テキスト、画像など）の密なベクトル表現で、高次元空間における意味的な意味を捉えるもの。
​
説明可能性 – AIにおける説明可能性とは、AIシステムがその決定や予測に対して人間が理解できる理由を提供し、その内部の動作についての洞察を示す能力のことです。
​
説明可能なAI（XAI）：さまざまな技術やフレームワークを通じて、判断や行動に対して人間が理解できる説明を提供するように設計されたAIシステム。
​
フェデレーテッドラーニング：モデルがローカルデータサンプルを保持する複数の分散デバイス上でトレーニングされる機械学習の手法であり、データ自体を交換することはありません。
​
ガードレール：AIシステムが有害、偏った、またはその他の望ましくない出力を生成するのを防ぐために実施される制約。
​
幻覚 – AIの幻覚とは、AIモデルがトレーニングデータや事実に基づかない誤った、または誤解を招く情報を生成する現象を指します。
​
ヒューマン・イン・ザ・ループ（HITL）：重要な意思決定ポイントでの人間の監督、検証、または介入を必要とするように設計されたシステム。
​
インフラストラクチャ・アズ・コード（IaC）：手動プロセスの代わりにコードを通じてインフラストラクチャを管理およびプロビジョニングし、セキュリティスキャンと一貫したデプロイメントを可能にすること。
​
Jailbreak：AIシステム、特に大規模言語モデルにおける安全ガードレールを回避し、禁止されたコンテンツを生成するために使用される技術。
​
最小特権：ユーザーおよびプロセスに対して必要最小限のアクセス権のみを付与するセキュリティ原則。
​
LIME（ローカル解釈可能モデル非依存説明）：任意の機械学習分類器の予測を、解釈可能なモデルで局所的に近似することによって説明する手法。
​
メンバーシップ推論攻撃：特定のデータポイントが機械学習モデルの訓練に使用されたかどうかを判定することを目的とした攻撃。
​
MITRE ATLAS：人工知能システムに対する敵対的脅威の全体像；AIシステムに対する敵対的戦術と技術のナレッジベース。
​
モデルカード – モデルカードは、AIモデルの性能、制限、意図された用途、および倫理的配慮に関する標準化された情報を提供する文書であり、透明性と責任あるAI開発の促進を目的としています。
​
モデル抽出：攻撃者が対象モデルに繰り返し問い合わせを行い、許可なく機能的に類似したコピーを作成する攻撃手法。
​
モデルインバージョン：モデルの出力を分析することでトレーニングデータを再構築しようとする攻撃。
​
モデルライフサイクル管理 – AIモデルライフサイクル管理とは、AIモデルの設計、開発、導入、監視、保守、および最終的な廃止を含むすべての段階を監督し、その有効性を維持し、目標と整合させるプロセスです。
​
モデルポイズニング：トレーニングプロセス中にモデルに直接脆弱性やバックドアを導入すること。
​
モデル窃盗/盗用：繰り返しのクエリを通じて、専有モデルのコピーまたは近似を抽出すること。
​
マルチエージェントシステム：異なる能力や目標を持つ複数のAIエージェントが相互に作用するシステム。
​
OPA（Open Policy Agent）：スタック全体で統一されたポリシー適用を可能にするオープンソースのポリシーエンジン。
​
プライバシー保護機械学習（PPML）：トレーニングデータのプライバシーを保護しながら機械学習モデルをトレーニングおよび展開するための技術と方法。
​
プロンプトインジェクション：モデルの意図された動作を上書きするために悪意のある命令が入力に埋め込まれる攻撃。
​
RAG（Retrieval-Augmented Generation）: 応答を生成する前に外部の知識ソースから関連情報を検索することで、大規模言語モデルを強化する手法。
​
レッドチーミング：脆弱性を特定するために敵対的な攻撃を模擬してAIシステムを積極的にテストする手法。
​
SBOM（ソフトウェア部品表）：ソフトウェアやAIモデルの構築に使用されるさまざまなコンポーネントの詳細およびサプライチェーンの関係を含む正式な記録。
​
SHAP（SHapley Additive exPlanations）：各特徴量の予測への寄与を計算することで、任意の機械学習モデルの出力を説明するゲーム理論的手法。
​
サプライチェーン攻撃：サードパーティのライブラリ、データセット、または事前学習済みモデルなど、セキュリティが比較的低いサプライチェーンの要素を狙うことでシステムを侵害すること。
​
転移学習：あるタスクのために開発されたモデルを、別のタスクのモデルの出発点として再利用する技術。
​
ベクトルデータベース：高次元ベクトル（埋め込み）を保存し、効率的な類似検索を実行するために設計された専門データベース。
​
脆弱性スキャン：AIフレームワークや依存関係を含むソフトウェアコンポーネントの既知のセキュリティ脆弱性を特定する自動化ツール。
​
ウォーターマーキング：AI生成コンテンツに透過的なマーカーを埋め込み、その起源を追跡したりAIによる生成を検出したりする技術。
​
ゼロデイ脆弱性：開発者がパッチを作成・展開する前に攻撃者が悪用できる、これまで知られていなかった脆弱性。

## 付録B：参考文献

### TODO

## 付録C：AIセキュリティガバナンスと文書管理

### 目的

この付録は、システムライフサイクル全体にわたるAIセキュリティの管理のための組織構造、ポリシー、およびプロセスを確立するための基本要件を提供します。

---

### AC.1 AIリスク管理フレームワークの導入

システムライフサイクル全体にわたって、AI特有のリスクを特定し、評価し、軽減するための正式な枠組みを提供する。

 #AC.1.1    レベル: 1    役割: D/V
 AI特有のリスク評価方法論が文書化され、実施されていることを確認してください。
 #AC.1.2    レベル: 2    役割: D
 AIライフサイクルの重要なポイントおよび重大な変更の前に、リスク評価が実施されていることを確認してください。
 #AC.1.3    レベル: 3    役割: D/V
 リスク管理フレームワークが確立された基準（例：NIST AI RMF）と整合していることを検証する。

---

### AC.2 AIセキュリティポリシーおよび手順

安全なAIの開発、展開、および運用に関する組織基準を定義し、遵守を徹底する。

 #AC.2.1    レベル: 1    役割: D/V
 文書化されたAIセキュリティポリシーが存在することを確認してください。
 #AC.2.2    レベル: 2    役割: D
 ポリシーが少なくとも年に一度、および重大な脅威の状況変化後に見直され、更新されていることを確認してください。
 #AC.2.3    レベル: 3    役割: D/V
 ポリシーがすべてのAISVSカテゴリおよび適用される規制要件を網羅していることを確認してください。

---

### AC.3 AIセキュリティにおける役割と責任

組織全体でAIセキュリティに対する明確な責任を確立する。

 #AC.3.1    レベル: 1    役割: D/V
 AIのセキュリティの役割と責任が文書化されていることを確認してください。
 #AC.3.2    レベル: 2    役割: D
 責任者が適切なセキュリティ専門知識を有していることを確認する。
 #AC.3.3    レベル: 3    役割: D/V
 高リスクAIシステムのためにAI倫理委員会またはガバナンス委員会が設置されていることを確認してください。

---

### AC.4 倫理的なAIガイドラインの施行

AIシステムが確立された倫理原則に従って運用されることを保証する。

 #AC.4.1    レベル: 1    役割: D/V
 AIの開発および展開に関する倫理ガイドラインが存在することを確認してください。
 #AC.4.2    レベル: 2    役割: D
 倫理違反を検出し報告するための仕組みが整っていることを確認してください。
 #AC.4.3    レベル: 3    役割: D/V
 展開されたAIシステムに対して定期的な倫理レビューが実施されていることを確認してください。

---

### AC.5 AI 規制遵守モニタリング

進化するAI規制に対する認識と遵守を維持してください。

 #AC.5.1    レベル: 1    役割: D/V
 適用されるAI規制を特定するためのプロセスが存在することを確認する。
 #AC.5.2    レベル: 2    役割: D
 すべての規制要件への適合性が評価されていることを確認してください。
 #AC.5.3    レベル: 3    役割: D/V
 規制の変更がAIシステムの適時なレビューおよび更新を引き起こすことを確認する。

### AC.6 トレーニングデータのガバナンス、ドキュメンテーションおよびプロセス

 #1.1.2    レベル: 1    役割: D/V
 品質、代表性、倫理的調達、およびライセンス遵守が確認されたデータセットのみを許可し、データ汚染、埋め込みバイアス、知的財産権侵害のリスクを軽減することを検証します。
 #1.1.5    レベル: 2    役割: D/V
 ラベリング／注釈の品質がレビュアー間の相互チェックまたはコンセンサスによって確保されていることを確認してください。
 #1.1.6    レベル: 2    役割: D/V
 重要なトレーニングデータセットについては、「データカード」または「データセットのデータシート」が維持されていることを確認し、特徴、目的、構成、収集プロセス、前処理、および推奨される/推奨されない使用方法を詳細に記載してください。
 #1.3.2    レベル: 2    役割: D/V
 特定されたバイアスが、再バランス、ターゲットデータ拡張、アルゴリズム調整（例：前処理、処理中、後処理技術）、または再重み付けなどの文書化された戦略を通じて軽減されていることを検証し、その軽減策が公平性およびモデル全体の性能に与える影響が評価されていることを確認する。
 #1.3.3    レベル: 2    役割: D/V
 ポストトレーニングの公平性指標が評価され、文書化されていることを確認してください。
 #1.3.4    レベル: 3    役割: D/V
 ライフサイクルのバイアスマネジメントポリシーが、責任者とレビューの頻度を割り当てていることを確認してください。
 #1.4.1    レベル: 2    役割: D/V
 ラベリング/アノテーションの品質が、明確なガイドライン、レビュアー間の相互チェック、合意形成メカニズム（例：アノテーター間一致率のモニタリング）、および不一致を解決するための定義されたプロセスを通じて確保されていることを検証してください。
 #1.4.4    レベル: 3    役割: D/V
 安全性、セキュリティ、または公平性にとって重要なラベル（例：有害コンテンツの識別、重要な医療所見）が必須の独立した二重レビューまたは同等の堅牢な検証を受けることを確認してください。
 #1.4.6    レベル: 2    役割: D/V
 ラベリングガイドと指示が包括的で、バージョン管理され、ピアレビューを受けていることを確認してください。
 #1.4.6    レベル: 2    役割: D/V
 ラベルのデータスキーマが明確に定義され、バージョン管理されていることを確認してください。
 #1.3.1    レベル: 1    役割: D/V
 データセットが、法的に保護された属性（例：人種、性別、年齢）およびモデルの適用領域に関連するその他の倫理的に敏感な特性（例：社会経済的地位、所在地）にわたる表現の不均衡および潜在的なバイアスについてプロファイリングされていることを検証してください。
 #1.5.3    レベル: 2    役割: V
 ドメイン専門家による手動のスポットチェックが、統計的に有意なサンプル（例えば、≥1%または1,000サンプルのいずれか大きい方、もしくはリスク評価により決定されたサンプル数）を対象として行われ、自動化では検出されない微妙な品質問題を特定していることを確認する。
 #1.8.4    レベル: 2    役割: D/V
 アウトソーシングまたはクラウドソーシングされたラベリングのワークフローには、データの機密性、完全性、ラベル品質を確保し、データ漏洩を防止するための技術的および手続き上の安全対策が含まれていることを確認してください。
 #1.5.4    レベル: 2    役割: D/V
 修復手順が出所記録に追加されていることを確認してください。
 #1.6.2    レベル: 2    役割: D/V
 フラグが立てられたサンプルがトレーニング前に手動レビューをトリガーすることを確認してください。
 #1.6.3    レベル: 2    役割: V
 結果がモデルのセキュリティドシエに反映され、継続的な脅威インテリジェンスに情報を提供していることを確認してください。
 #1.6.4    レベル: 3    役割: D/V
 検出ロジックが新しい脅威インテリジェンスで更新されていることを確認してください。
 #1.6.5    レベル: 3    役割: D/V
 オンライン学習パイプラインが分布の変動を監視していることを確認してください。
 #1.7.1    レベル: 1    役割: D/V
 トレーニングデータ削除のワークフローが一次データおよび派生データを完全に削除し、モデルへの影響を評価していること、さらに影響を受けたモデルに対して必要に応じて再トレーニングや再調整などの対応が行われていることを確認してください。
 #1.7.2    レベル: 2    役割: D
 トレーニングに使用されるデータのユーザー同意（および撤回）の範囲と状況を追跡し尊重するためのメカニズムが設けられていることを確認し、新しいトレーニングプロセスや重要なモデルの更新にデータを組み込む前に同意が検証されることを確認してください。
 #1.7.3    レベル: 2    役割: V
 ワークフローが毎年テストされ、ログに記録されていることを確認してください。
 #1.8.1    レベル: 2    役割: D/V
 事前にトレーニングされたモデルの提供者や外部データセットのサプライヤーを含む第三者のデータ供給者が、そのデータやモデルが統合される前に、セキュリティ、プライバシー、倫理的調達、およびデータ品質のデューデリジェンスを受けることを確認してください。
 #1.8.2    レベル: 1    役割: D
 外部転送がTLS/認証および整合性チェックを使用していることを確認してください。
 #1.8.3    レベル: 2    役割: D/V
 高リスクのデータソース（例：出所不明のオープンソースデータセット、未審査の供給元）については、機密性の高いアプリケーションで使用する前に、サンドボックス分析、徹底的な品質・バイアスチェック、及び標的型毒性検出などの強化された精査が行われることを確認してください。
 #1.8.4    レベル: 3    役割: D/V
 第三者から取得した事前学習モデルは、ファインチューニングや展開の前に、埋め込まれたバイアス、潜在的なバックドア、アーキテクチャの完全性、および元のトレーニングデータの由来について評価されていることを確認してください。
 #1.5.3    レベル: 2    役割: D/V
 敵対的トレーニングが使用されている場合、敵対的データセットの生成、管理、およびバージョン管理が文書化され、制御されていることを確認してください。
 #1.5.3    レベル: 3    役割: D/V
 敵対的堅牢性トレーニングがモデルの性能（クリーン入力および敵対的入力の両方に対して）および公平性指標に与える影響が評価され、文書化され、監視されていることを確認する。
 #1.5.4    レベル: 3    役割: D/V
 敵対的トレーニングと堅牢性の戦略が、進化する敵対的攻撃手法に対抗するために定期的に見直され、更新されていることを確認してください。
 #1.4.2    レベル: 2    役割: D/V
 失敗したデータセットが監査証跡とともに隔離されていることを確認してください。
 #1.4.3    レベル: 2    役割: D/V
 品質ゲートが例外が承認されない限り、基準を満たさないデータセットをブロックすることを確認してください。
 #1.11.2    レベル: 2    役割: D/V
 生成プロセス、パラメータ、および合成データの意図された使用目的が文書化されていることを確認してください。
 #1.11.3    レベル: 2    役割: D/V
 合成データをトレーニングに使用する前に、バイアス、プライバシー漏洩、および表現に関する問題についてリスク評価されていることを確認してください。
 #1.12.3    レベル: 2    役割: D/V
 疑わしいアクセスイベントに対して警告が生成され、迅速に調査されていることを確認してください。
 #1.13.1    レベル: 1    役割: D/V
 すべてのトレーニングデータセットに対して明示的な保持期間が定義されていることを確認してください。
 #1.13.2    レベル: 2    役割: D/V
 データセットがライフサイクルの終了時に自動的に期限切れとなり、削除されるか、削除のためにレビューされることを確認してください。
 #1.13.3    レベル: 2    役割: D/V
 保持および削除の操作が記録され、監査可能であることを確認してください。
 #1.14.1    レベル: 2    役割: D/V
 すべてのデータセットに対して、データ居住要件および国境を越える転送要件が特定され、遵守されていることを確認してください。
 #1.14.2    レベル: 2    役割: D/V
 セクター別の規制（例：医療、金融）が特定され、データ処理において対応されていることを確認してください。
 #1.14.3    レベル: 2    役割: D/V
 関連するプライバシー法（例：GDPR、CCPA）への準拠が文書化され、定期的にレビューされていることを確認してください。
 #1.16.1    レベル: 2    役割: D/V
 データ主体からのアクセス、訂正、制限、または異議申し立ての要求に対応するための仕組みが存在することを確認してください。
 #1.16.2    レベル: 2    役割: D/V
 リクエストが法的に義務付けられた期間内に記録され、追跡され、履行されていることを確認してください。
 #1.16.3    レベル: 2    役割: D/V
 データ主体の権利プロセスが効果的かつ定期的にテストおよびレビューされていることを検証してください。
 #1.17.1    レベル: 2    役割: D/V
 モデルのパフォーマンス、公平性、およびコンプライアンスを網羅し、データセットのバージョンを更新または置き換える前にインパクト分析が実施されていることを確認してください。
 #1.17.2    レベル: 2    役割: D/V
 影響分析の結果が文書化され、関連する利害関係者によってレビューされていることを確認してください。
 #1.17.3    レベル: 2    役割: D/V
 新しいバージョンが受け入れがたいリスクや回帰をもたらした場合に備え、ロールバックプランが存在することを確認してください。
 #1.18.1    レベル: 2    役割: D/V
 データ注釈に関与するすべての担当者が、バックグラウンドチェックを受け、データセキュリティおよびプライバシーについての訓練を受けていることを確認してください。
 #1.18.2    レベル: 2    役割: D/V
 すべてのアノテーション担当者が機密保持および秘密保持契約に署名していることを確認してください。
 #1.18.3    レベル: 2    役割: D/V
 注釈プラットフォームがアクセス制御を適用し、内部脅威を監視していることを検証してください。

#### 参考文献

NIST AI Risk Management Framework 1.0
ISO/IEC 42001:2023 — AI Management Systems Requirements
ISO/IEC 23894:2023 — Artificial Intelligence — Guidance on Risk Management
EU Artificial Intelligence Act — Regulation (EU) 2024/1689
ISO/IEC 24029‑2:2023 — Robustness of Neural Networks — Methodology for Formal Methods

## 付録D：AI支援による安全なコーディングのガバナンスと検証

### 目的

この章では、ソフトウェア開発中にAI支援コード作成ツールを安全かつ効果的に使用するための基本的な組織的管理策を定義し、SDLC全体でのセキュリティとトレーサビリティを確保します。

---

### AD.1 AI支援のセキュアコーディングワークフロー

既存のセキュリティゲートを弱めることなく、組織のセキュアソフトウェア開発ライフサイクル（SSDLC）にAIツールを統合する。

 #AD.1.1    レベル: 1    役割: D/V
 文書化されたワークフローが、AIツールがコードを生成、リファクタリング、またはレビューするタイミングと方法を説明していることを確認してください。
 #AD.1.2    レベル: 2    役割: D
 ワークフローが各SSDLCフェーズ（設計、実装、コードレビュー、テスト、デプロイメント）に対応していることを確認してください。
 #AD.1.3    レベル: 3    役割: D/V
 AI生成コードに対してメトリクス（例：脆弱性密度、検出までの平均時間）が収集され、人間のみのベースラインと比較されていることを確認してください。

---

### AD.2 AIツールの資格認定と脅威モデリング

AIコーディングツールは採用前に、セキュリティ機能、リスク、およびサプライチェーンへの影響について評価を行うことを確実にしてください。

 #AD.2.1    レベル: 1    役割: D/V
 各AIツールの脅威モデルが、不正使用、モデル反転、データ漏洩、および依存チェーンのリスクを特定していることを確認してください。
 #AD.2.2    レベル: 2    役割: D
 ツール評価には、ローカルコンポーネントの静的/動的解析およびSaaSエンドポイント（TLS、認証/認可、ログ記録）の評価が含まれていることを確認してください。
 #AD.2.3    レベル: 3    役割: D/V
 評価が認識されたフレームワークに従っていることを確認し、主要なバージョン変更後に再実施されることを確認してください。

---

### AD.3 セキュアプロンプト＆コンテキスト管理

AIモデルのプロンプトやコンテキストを構築する際に、秘密情報、専有コード、および個人データの漏洩を防止してください。

 #AD.3.1    レベル: 1    役割: D/V
 書面による指導で、プロンプトに秘密情報、認証情報、または機密データを送信することを禁止していることを確認してください。
 #AD.3.2    レベル: 2    役割: D
 技術的な制御（クライアント側の編集、承認済みのコンテキストフィルター）が自動的に機密情報を除去することを検証してください。
 #AD.3.3    レベル: 3    役割: D/V
 プロンプトと応答がトークン化され、送信中および保存中に暗号化されていること、ならびに保持期間がデータ分類ポリシーに準拠していることを確認してください。

---

### AD.4 AI生成コードの検証

コードがマージまたはデプロイされる前に、AI出力によって導入された脆弱性を検出して修正します。

 #AD.4.1    レベル: 1    役割: D/V
 AI生成コードは常に人間によるコードレビューを受けることを確認してください。
 #AD.4.2    レベル: 2    役割: D
 自動スキャナー（SAST/IAST/DAST）がAI生成コードを含むすべてのプルリクエストで実行され、重大な検出結果がある場合はマージをブロックすることを確認してください。
 #AD.4.3    レベル: 3    役割: D/V
 差分ファズテストまたはプロパティベーステストがセキュリティクリティカルな動作（例：入力検証、認可ロジック）を証明することを確認してください。

---

### AD.5 コード提案の説明可能性とトレーサビリティ

監査人と開発者に対して、なぜ提案がなされたのか、そしてそれがどのように進化したのかについての洞察を提供します。

 #AD.5.1    レベル: 1    役割: D/V
 プロンプト/レスポンスのペアがコミットIDとともに記録されていることを確認してください。
 #AD.5.2    レベル: 2    役割: D
 開発者が提案をサポートするモデルの引用（トレーニングスニペット、ドキュメント）を表示できることを確認してください。
 #AD.5.3    レベル: 3    役割: D/V
 説明可能性レポートが設計成果物とともに保存され、セキュリティレビューで参照されていることを確認し、ISO/IEC 42001のトレーサビリティ原則を満たしていることを検証してください。

---

### AD.6 継続的なフィードバックとモデルのファインチューニング

モデルのセキュリティパフォーマンスを時間とともに向上させつつ、ネガティブドリフトを防止する。

 #AD.6.1    レベル: 1    役割: D/V
 開発者が安全でない、または準拠していない提案にフラグを立てることができ、そのフラグが追跡されていることを確認してください。
 #AD.6.2    レベル: 2    役割: D
 集約されたフィードバックが、検証済みのセキュアコーディングコーパス（例：OWASP チートシート）を用いた定期的なファインチューニングまたはリトリーバル拡張生成に反映されていることを検証してください。
 #AD.6.3    レベル: 3    役割: D/V
 閉ループ評価ハーネスが各ファインチューニング後に回帰テストを実行することを確認してください。セキュリティメトリクスは、展開前に以前のベースラインを満たすかそれを上回っている必要があります。

---

#### 参考文献

NIST AI Risk Management Framework 1.0
ISO/IEC 42001:2023 — AI Management Systems Requirements
OWASP Secure Coding Practices — Quick Reference Guide

## 付録E: 例示ツールとフレームワーク

### 目的

この章では、特定のAISVS要件の実装や達成を支援するツールやフレームワークの例を示します。これらはAISVSチームやOWASP GenAIセキュリティプロジェクトによる推奨や支持と見なされるものではありません。

---

### AE.1 トレーニングデータガバナンスとバイアス管理

データ分析、ガバナンス、およびバイアスマネジメントに使用されるツール。

 #AE.1.1    セクション: 1.1
 データインベントリツール: データインベントリ管理ツールのような...
 #AE.1.2    セクション: 1.2
 転送中の暗号化 HTTPSベースのアプリケーションには、openSSLやpythonのようなツールを使用してTLSを利用してください。`ssl`ライブラリ。

---

### AE.2 ユーザー入力検証

ユーザー入力を処理および検証するためのツール。

 #AE.2.1    セクション: 2.1
 プロンプトインジェクション防御ツール：NVIDIAのNeMoやGuardrails AIのようなガードレールツールを使用してください。

---


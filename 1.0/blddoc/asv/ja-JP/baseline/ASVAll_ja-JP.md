## 扉絵

### 標準について

人工知能セキュリティ検証標準（AISVS）は、データサイエンティスト、MLOpsエンジニア、ソフトウェアアーキテクト、開発者、テスター、セキュリティ専門家、ツールベンダー、規制当局、消費者が信頼できるAI対応システムおよびアプリケーションの設計、構築、テスト、および検証に使用できるコミュニティ主導のセキュリティ要件カタログです。これは、AIライフサイクル全体（データ収集やモデル開発から展開および継続的な監視まで）にわたりセキュリティ制御を指定するための共通言語を提供し、組織がAIソリューションのレジリエンス、プライバシー、安全性を測定し改善できるようにします。

### 著作権およびライセンス

バージョン 0.1（最初の公開ドラフト - 作業進行中）、2025  

![license](images/license.png)
著作権 © 2025 The AISVS Project.  

次の条件で公開されていますCreative Commons Attribution‑ShareAlike 4.0 International License.
この作品の再利用や配布を行う際には、そのライセンス条件を他者に明確に伝える必要があります。

### プロジェクトリード

ジム・マニコ
Aras “Russ” Memisyazici

### 寄稿者およびレビュー担当者

https://github.com/ottosulin
https://github.com/mbhatt1
https://github.com/vineethsai
https://github.com/cciprofm
https://github.com/deepakrpandey12


---

AISVSは、人工知能システムの独自のセキュリティ課題に対応するために特別に作成された全く新しい標準です。より広範なセキュリティのベストプラクティスから着想を得ていますが、AISVSのすべての要件はAIの脅威環境を反映し、組織がより安全で回復力のあるAIソリューションを構築できるように、基礎から開発されています。

## 序文

人工知能セキュリティ検証標準（AISVS）バージョン1.0へようこそ！

### はじめに

2025年に共同コミュニティの努力によって設立されたAISVSは、現代のAIモデル、パイプライン、およびAI対応サービスの設計、開発、展開、および運用時に考慮すべきセキュリティ要件を定義します。

AISVS v1.0は、プロジェクトリーダー、作業グループ、および広範なコミュニティ寄稿者による共同作業の成果であり、AIシステムの安全性を確保するための実用的かつテスト可能なベースラインを提供します。

このリリースの目標は、AISVSを簡単に導入できるようにするとともに、その定義された範囲にレーザーフォーカスを当て、AI特有の急速に変化するリスク環境に対応することです。

### AISVSバージョン1.0の主な目標

バージョン1.0は、いくつかの指針となる原則に基づいて作成されます。

#### 明確に定義されたスコープ

各要件はAISVSの名称と使命に沿っている必要があります:

人工知能 – コントロールはAI/MLレイヤー（データ、モデル、パイプライン、または推論）で動作し、AI実践者の責任です。
セキュリティ – 要件は、特定されたセキュリティ、プライバシー、または安全性のリスクを直接軽減します。
検証 – 言語は適合性を客観的に検証できるように記述されています。
標準 – セクションは一貫した構造と用語を用いて、一貫性のある参照を形成します。
​
---

AISVSに従うことで、組織はAIソリューションのセキュリティ体制を体系的に評価・強化し、安全なAIエンジニアリングの文化を促進することができます。

## AISVSの使用

人工知能セキュリティ検証標準（AISVS）は、現代のAIアプリケーションとサービスに対するセキュリティ要件を定義しており、アプリケーション開発者の管理下にある側面に重点を置いています。

AISVSは、開発者、アーキテクト、セキュリティエンジニア、監査人など、AIアプリケーションのセキュリティを開発または評価するすべての人を対象としています。本章では、AISVSの構造と使用方法、検証レベルおよび想定される使用ケースについて紹介します。

### 人工知能セキュリティ検証レベル

AISVSは3つの上昇するセキュリティ検証レベルを定義しています。各レベルは深さと複雑さを増し、組織がAIシステムのリスクレベルに応じてセキュリティ態勢を調整できるようにします。

組織はレベル1から開始し、安全性の成熟度と脅威の露出が増加するにつれて段階的により高いレベルを採用することができます。

#### レベルの定義

AISVS v1.0の各要件は、以下のいずれかのレベルに割り当てられます：

 レベル1の要件

レベル1には、最も重要で基本的なセキュリティ要件が含まれています。これらは、他の前提条件や脆弱性に依存しない一般的な攻撃を防ぐことに重点を置いています。ほとんどのレベル1のコントロールは、実装が簡単であるか、努力に見合うほど重要なものです。

 レベル 2 要件

レベル2は、より高度またはあまり一般的でない攻撃に対処するとともに、広範な脅威に対する多層防御を含みます。これらの要件は、より複雑なロジックを必要とする場合や、特定の攻撃前提条件を対象とする場合があります。

 レベル3の要件

レベル3には、通常実装が難しいか、適用が状況に依存するコントロールが含まれます。これらは多くの場合、防御の多層化メカニズムや、ニッチで標的を絞った、または高い複雑性を持つ攻撃に対する緩和策を表しています。

#### 役割（D/V）

各AISVS要件は、主な対象読者に応じてマークされています：

D – 開発者向け要件
V – 検証者/監査者向け要件
D/V – 開発者および検証者の両方に関連する

## C1 トレーニングデータガバナンスとバイアスマネジメント

### 管理目標

トレーニングデータは、出所、セキュリティ、品質、公平性を保持する方法で調達、取り扱い、維持されなければなりません。これを行うことで法的義務を果たし、トレーニング中に発生し得るバイアス、ポイズニング、プライバシー侵害のリスクを軽減し、AIのライフサイクル全体に影響を与える可能性を減らします。

---

### C1.1 トレーニングデータの由来

すべてのデータセットの検証可能なインベントリを維持し、信頼できるソースのみを受け入れ、監査可能性のためにすべての変更を記録してください。

 #1.1.1    レベル: 1    役割: D/V
 すべてのトレーニングデータソース（出所、管理者／所有者、ライセンス、収集方法、意図された使用制約、および処理履歴）について、最新のインベントリが維持されていることを確認してください。
 #1.1.2    レベル: 1    役割: D/V
 トレーニングデータの処理が、不必要な特徴、属性、またはフィールド（例：未使用のメタデータ、機微な個人識別情報（PII）、漏洩したテストデータ）を除外していることを確認してください。
 #1.1.3    レベル: 2    役割: D/V
 すべてのデータセットの変更が記録された承認ワークフローの対象となっていることを確認してください。
 #1.1.4    レベル: 3    役割: D/V
 可能な場合は、データセットまたはサブセットに透かしやフィンガープリントが施されていることを確認してください。

---

### C1.2 トレーニングデータのセキュリティと完全性

トレーニングデータへのアクセスを制限し、保存時および転送時に暗号化し、改ざん、盗難、またはデータポイズニングを防ぐためにその整合性を検証します。

 #1.2.1    レベル: 1    役割: D/V
 トレーニングデータの保存およびパイプラインがアクセス制御によって保護されていることを確認してください。
 #1.2.2    レベル: 2    役割: D/V
 トレーニングデータへのすべてのアクセスが記録されていることを確認してください。記録には、ユーザー、時間、および操作が含まれる必要があります。
 #1.2.3    レベル: 2    役割: D/V
 トレーニングデータセットが、業界標準の暗号アルゴリズムおよび鍵管理手法を用いて、転送中および保存中に暗号化されていることを検証してください。
 #1.2.4    レベル: 2    役割: D/V
 トレーニングデータの保存および転送時にデータの完全性を確保するために、暗号化ハッシュまたはデジタル署名が使用されていることを確認してください。
 #1.2.5    レベル: 2    役割: D/V
 トレーニングデータの不正な改変や破損を防ぐために、自動検出技術が適用されていることを確認してください。
 #1.2.6    レベル: 2    役割: D/V
 古いトレーニングデータが安全に消去または匿名化されていることを確認してください。
 #1.2.7    レベル: 3    役割: D/V
 すべてのトレーニングデータセットのバージョンが一意に識別され、不変的に保存され、ロールバックおよびフォレンジック分析をサポートするために監査可能であることを検証してください。

---

### C1.3 トレーニングデータのラベリング品質、整合性、およびセキュリティ

重要なデータに対してはラベルを保護し、技術的なレビューを必須としてください。

 #1.3.1    レベル: 2    役割: D/V
 暗号学的ハッシュまたはデジタル署名がラベルアーティファクトに適用されていることを確認し、その完全性と真正性を保証します。
 #1.3.2    レベル: 2    役割: D/V
 ラベリングインターフェースおよびプラットフォームが強力なアクセス制御を実施し、すべてのラベリング活動の改ざん検知可能な監査ログを保持し、不正な改変から保護していることを確認してください。
 #1.3.3    レベル: 3    役割: D/V
 ラベル内の機密情報が、保存時および転送時のデータフィールドレベルで消去、匿名化、または暗号化されていることを検証してください。

---

### C1.4 トレーニングデータの品質とセキュリティ保証

自動化された検証、手動のスポットチェック、および記録された修正を組み合わせて、データセットの信頼性を保証します。

 #1.4.1    レベル: 1    役割: D
 自動化テストが、すべての取り込みまたは重要なデータ変換時にフォーマットエラーおよびnull値を検出することを確認してください。
 #1.4.2    レベル: 2    役割: D/V
 LLMのトレーニングおよびファインチューニングパイプラインが、潜在的なポイズニング攻撃（例：ラベルの反転、バックドアトリガーの挿入、役割切り替えコマンド、影響力のあるインスタンス攻撃）やトレーニングデータの意図しない破損を検出するために、ポイズニング検出およびデータ整合性検証（例：統計的方法、異常値検出、埋め込み分析）を実装していることを確認してください。
 #1.4.3    レベル: 3    役割: D/V
 適切な防御策（生成された敵対的事例を使用した敵対的トレーニング、摂動入力を用いたデータ拡張、またはロバスト最適化技術など）が、リスク評価に基づいて関連モデルに実装され、調整されていることを確認してください。
 #1.4.4    レベル: 2    役割: D/V
 自動生成されたラベル（例：LLMや弱い監督によるもの）が、幻覚的、誤解を招く、または低信頼度のラベルを検出するために信頼度の閾値および一貫性チェックの対象となっていることを確認してください。
 #1.4.5    レベル: 3    役割: D
 自動化テストが、すべてのデータ取り込みや重要なデータ変換時にラベルのずれを検出することを確認してください。

---

### C1.5 データ系譜とトレーサビリティ

監査可能性とインシデント対応のために、各データポイントの全行程をソースからモデル入力まで追跡してください。

 #1.5.1    レベル: 2    役割: D/V
 各データポイントの系譜が、すべての変換、拡張、およびマージを含めて記録されており、再構築可能であることを確認してください。
 #1.5.2    レベル: 2    役割: D/V
 系譜記録が不変であり、安全に保存されていて、監査のためにアクセス可能であることを検証してください。
 #1.5.3    レベル: 2    役割: D/V
 系統全体を通じて、プライバシー保護技術や生成技術を用いて生成された合成データについて系譜追跡が行われていることを確認し、すべての合成データが明確にラベル付けされ、本物のデータと区別可能であることを保証してください。

---

### 参考文献

NIST AI Risk Management Framework
EU AI Act – Article 10: Data & Data Governance
MITRE ATLAS: Adversary Tactics for AI
Survey of ML Bias Mitigation Techniques – MDPI
Data Provenance & Lineage Best Practices – Nightfall AI
Data Labeling Quality Standards – LabelYourData
Training Data Poisoning Guide – Lakera.ai
CISA Advisory: Securing Data for AI Systems
ISO/IEC 23053: AI Management Systems Framework
IBM: What is AI Governance?
Google AI Principles
GDPR & AI Training Data – DataProtectionReport
Supply-Chain Security for AI Data – AppSOC
OpenAI Privacy Center – Data Deletion Controls
Adversarial ML Dataset – Kaggle

## C2 ユーザー入力検証

### 管理目標

ユーザー入力の堅牢な検証は、AIシステムに対する最も破壊的な攻撃に対する第一防衛線です。プロンプトインジェクション攻撃は、システムの指示を上書きしたり、機密データを漏洩させたり、モデルを許可されていない挙動へ誘導したりする可能性があります。専用のフィルターや指示階層が整備されていない限り、非常に長いコンテキストウィンドウを利用する「マルチショット」 jailbreak 攻撃が効果的であることが研究で示されています。また、ホモグリフ置換やリートスピークのような微妙な敵対的摂動攻撃は、モデルの判断を静かに変えてしまうことがあります。

---

### C2.1 プロンプトインジェクション防御

プロンプトインジェクションはAIシステムにおける最大のリスクの一つです。これに対する防御策は、静的パターンフィルター、動的分類器、および指示階層の強制を組み合わせて用います。

 #2.1.1    レベル: 1    役割: D/V
 ユーザーの入力が、既知のプロンプトインジェクションパターン（脱獄キーワード、「前回を無視」、ロールプレイチェーン、間接的なHTML/URL攻撃）で構成された継続的に更新されるライブラリに対してスクリーニングされていることを検証してください。
 #2.1.2    レベル: 1    役割: D/V
 システムまたは開発者のメッセージがユーザーの指示に優先して適用される、コンテキストウィンドウの拡張後でも指示の階層をシステムが強制していることを検証してください。
 #2.1.3    レベル: 2    役割: D/V
 敵対的評価テスト（例：レッドチームの「多ショット」プロンプト）が、すべてのモデルまたはプロンプトテンプレートのリリース前に実行され、成功率の閾値および回帰の自動ブロッカーが設定されていることを確認してください。
 #2.1.4    レベル: 2    役割: D
 サードパーティのコンテンツ（ウェブページ、PDF、メール）からのプロンプトが、メインのプロンプトに連結される前に、分離されたパースコンテキストでサニタイズされていることを確認してください。
 #2.1.5    レベル: 3    役割: D/V
 すべてのプロンプトフィルタールールの更新、分類器モデルのバージョン、およびブロックリストの変更がバージョン管理され、監査可能であることを確認してください。

---

### C2.2 敵対的事例耐性

自然言語処理（NLP）モデルは、しばしば人間が見逃す微妙な文字や単語レベルの摂動に対して依然として脆弱であり、モデルはそれを誤分類しやすいです。

 #2.2.1    レベル: 1    役割: D
 基本的な入力正規化ステップ（Unicode NFC、ホモグリフマッピング、空白のトリミング）がトークン化の前に実行されることを確認してください。
 #2.2.2    レベル: 2    役割: D/V
 統計的な異常検知が、言語の規範から異常に高い編集距離を持つ入力、過剰に繰り返されるトークン、または異常な埋め込み距離を持つ入力を正しく検出することを確認してください。
 #2.2.3    レベル: 2    役割: D
 推論パイプラインが、ハイリスクエンドポイント向けにオプションの敵対的トレーニングで強化されたモデルバリアントや防御層（例：ランダム化、防御的蒸留）をサポートしていることを検証してください。
 #2.2.4    レベル: 2    役割: V
 疑わしい敵対的入力が隔離され、PII（個人識別情報）削除後の完全なペイロードとともに記録されていることを確認してください。
 #2.2.5    レベル: 3    役割: D/V
 堅牢性メトリクス（既知の攻撃スイートの成功率）が時間経過とともに追跡され、回帰がリリースブロッカーを引き起こすことを確認してください。

---

### C2.3 スキーマ、タイプおよび長さの検証

不正な形式や過大な入力を伴うAI攻撃は、パースエラー、フィールド間でのプロンプトの漏出、リソース枯渇を引き起こす可能性があります。決定的なツール呼び出しを行う際には、厳格なスキーマの強制適用も前提条件となります。

 #2.3.1    レベル: 1    役割: D
 すべてのAPIまたは関数呼び出しエンドポイントが明確な入力スキーマ（JSON Schema、Protobuf、またはマルチモーダルの同等物）を定義しており、プロンプトの組み立て前に入力が検証されていることを確認してください。
 #2.3.2    レベル: 1    役割: D/V
 最大トークン数またはバイト数の制限を超える入力が、安全なエラーで拒否され、決して静かに切り捨てられないことを確認してください。
 #2.3.3    レベル: 2    役割: D/V
 タイプチェック（例：数値範囲、列挙型の値、画像/音声のMIMEタイプなど）がクライアントコードだけでなく、サーバー側でも強制されていることを確認してください。
 #2.3.4    レベル: 2    役割: D
 意味的バリデータ（例：JSON Schema）がアルゴリズム的DoSを防ぐために一定時間で動作することを検証してください。
 #2.3.5    レベル: 3    役割: V
 検証失敗が、セキュリティトリアージを支援するために、編集済みのペイロードスニペットと明確なエラーコードとともにログに記録されていることを確認してください。

---

### C2.4 コンテンツ＆ポリシースクリーニング

開発者は、不正な指示、ヘイトスピーチ、著作権で保護されたテキストなどの禁止されたコンテンツを要求する構文的に有効なプロンプトを検出し、それらが広まるのを防止できるようにするべきです。

 #2.4.1    レベル: 1    役割: D
 コンテンツ分類器（ゼロショットまたはファインチューニング済み）が、暴力、自傷、ヘイト、性的コンテンツ、違法なリクエストについて、すべての入力をスコアリングし、閾値を設定可能であることを検証します。
 #2.4.2    レベル: 1    役割: D/V
 ポリシーに違反する入力が、下流のLLM呼び出しに伝播しないように、標準化された拒否または安全な完了を受け取ることを検証します。
 #2.4.3    レベル: 2    役割: D
 スクリーニングモデルまたはルールセットが少なくとも四半期ごとに再学習/更新され、新たに観測されたジャイルブレイクやポリシーバイパスのパターンが組み込まれていることを確認してください。
 #2.4.4    レベル: 2    役割: D
 リクエスト時に解決される属性ベースのルールを通じて、ユーザー固有のポリシー（年齢、地域の法的制約）を順守していることを確認します。
 #2.4.5    レベル: 3    役割: V
 スクリーニングログに、SOC相関および将来のレッドチーム再生用のための分類器の信頼度スコアとポリシーカテゴリタグが含まれていることを確認してください。

---

### C2.5 入力レート制限および悪用防止

開発者は、入力レートを制限し、異常な使用パターンを検出することで、AIシステムに対する悪用、リソース枯渇、および自動化された攻撃を防止する必要があります。

 #2.5.1    レベル: 1    役割: D/V
 すべての入力エンドポイントに対して、ユーザーごと、IPごと、およびAPIキーごとのレート制限が適用されていることを確認してください。
 #2.5.2    レベル: 2    役割: D/V
 DoS（サービス拒否）攻撃およびブルートフォース攻撃を防ぐために、バーストおよび持続的なレート制限が適切に調整されていることを確認してください。
 #2.5.3    レベル: 2    役割: D/V
 異常な使用パターン（例：連続リクエスト、入力の過剰送信）が自動ブロックまたはエスカレーションを引き起こすことを確認してください。
 #2.5.4    レベル: 3    役割: V
 悪用防止ログが保持され、新たな攻撃パターンの検出のためにレビューされていることを確認してください。

---

### C2.6 マルチモーダル入力検証

AIシステムは、注入、回避、またはリソースの乱用を防ぐために、非テキスト入力（画像、音声、ファイル）に対して堅牢な検証を含めるべきです。

 #2.6.1    レベル: 1    役割: D
 すべての非テキスト入力（画像、音声、ファイル）が処理前にタイプ、サイズ、およびフォーマットについて検証されていることを確認してください。
 #2.6.2    レベル: 2    役割: D/V
 ファイルが取り込み前にマルウェアおよびステガノグラフィックペイロードのスキャンを受けていることを確認してください。
 #2.6.3    レベル: 2    役割: D/V
 画像/音声入力が敵対的摂動や既知の攻撃パターンについて検査されていることを確認してください。
 #2.6.4    レベル: 3    役割: V
 マルチモーダル入力検証の失敗がログに記録され、調査のためのアラートが発生することを確認してください。

---

### C2.7 入力の発信元と帰属

AIシステムは、すべてのユーザー入力の起源を監視およびタグ付けすることで、監査、悪用追跡、およびコンプライアンスを支援すべきです。

 #2.7.1    レベル: 1    役割: D/V
 すべてのユーザー入力が取り込み時にメタデータ（ユーザーID、セッション、ソース、タイムスタンプ、IPアドレス）でタグ付けされていることを確認してください。
 #2.7.2    レベル: 2    役割: D/V
 処理されたすべての入力に対して、出所のメタデータが保持され監査可能であることを検証してください。
 #2.7.3    レベル: 2    役割: D/V
 異常または信頼できない入力ソースがフラグ付けされ、強化された精査またはブロックの対象となることを確認してください。

---

### C2.8 リアルタイム適応型脅威検出

開発者は、新しい攻撃パターンに適応し、コンパイルされたパターンマッチングによるリアルタイム保護を提供する、AI向けの高度な脅威検出システムを採用すべきです。

 #2.8.1    レベル: 1    役割: D/V
 脅威検出パターンが、レイテンシの影響を最小限に抑えつつ高性能なリアルタイムフィルタリングのために最適化された正規表現エンジンにコンパイルされていることを検証してください。
 #2.8.2    レベル: 1    役割: D/V
 脅威検出システムが、異なる脅威カテゴリ（プロンプトインジェクション、有害コンテンツ、機微データ、システムコマンド）ごとに別々のパターンライブラリを保持していることを確認してください。
 #2.8.3    レベル: 2    役割: D/V
 適応型脅威検知が、攻撃頻度と成功率に基づいて脅威感度を更新する機械学習モデルを組み込んでいることを確認してください。
 #2.8.4    レベル: 2    役割: D/V
 リアルタイムの脅威インテリジェンスフィードが、新しい攻撃シグネチャやIOC（侵害の指標）をパターンライブラリに自動的に更新することを確認してください。
 #2.8.5    レベル: 3    役割: D/V
 脅威検出の誤検知率が継続的に監視されていることを確認し、正当なユースケースへの影響を最小限に抑えるためにパターンの特異性が自動的に調整されていることを確認してください。
 #2.8.6    レベル: 3    役割: D/V
 コンテキスト脅威分析が、検出精度を向上させるために入力元、ユーザー行動パターン、およびセッション履歴を考慮していることを確認してください。
 #2.8.7    レベル: 3    役割: D/V
 脅威検出のパフォーマンス指標（検出率、処理遅延、リソース利用率）がリアルタイムで監視および最適化されていることを確認してください。

---

### C2.9 マルチモーダルセキュリティ検証パイプライン

開発者は、特定の種類の脅威検出とリソース隔離を伴うテキスト、画像、音声、およびその他のAI入力モダリティに対してセキュリティ検証を提供する必要があります。

 #2.9.1    レベル: 1    役割: D/V
 各入力モダリティに対して、専用のセキュリティバリデータが存在し、脅威パターン（テキスト：プロンプトインジェクション、画像：ステガノグラフィー、音声：スペクトログラム攻撃）および検出閾値が文書化されていることを確認してください。
 #2.9.2    レベル: 2    役割: D/V
 マルチモーダル入力が、それぞれのモダリティタイプに特有のリソース制限（メモリ、CPU、処理時間）が設定された分離されたサンドボックス内で処理されていることを確認し、それらがセキュリティポリシーに文書化されていることを検証してください。
 #2.9.3    レベル: 2    役割: D/V
 クロスモーダル攻撃検出が、複数の入力タイプにまたがる協調攻撃（例：画像内のステガノグラフィックペイロードとテキスト内のプロンプトインジェクションの組み合わせ）を相関ルールとアラート生成によって識別することを検証する。
 #2.9.4    レベル: 3    役割: D/V
 マルチモーダル検証の失敗が、すべての入力モダリティ、検証結果、脅威スコア、および相関分析を含む詳細なログ記録をトリガーし、SIEM統合のための構造化ログ形式であることを確認してください。
 #2.9.5    レベル: 3    役割: D/V
 モダリティ固有のコンテンツ分類器が、文書化されたスケジュール（最低でも四半期ごと）に従って、新しい脅威パターン、敵対的事例、およびベースライン閾値を上回る性能ベンチマークとともに更新されていることを検証する。

---

### 参考文献

LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security
Generative AI's Biggest Security Flaw Is Not Easy to Fix
Many-shot jailbreaking \ Anthropic
$PDF$ OpenAI GPT-4.5 System Card
Notebook for the CheckThat Lab at CLEF 2024
Mitigate jailbreaks and prompt injections – Anthropic
Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis
OWASP Top 10 for LLM Applications 2025 – WorldTech IT
OWASP Machine Learning Security Top Ten
Few words about AI Security – Jussi Metso
How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry
Easily enforcing valid JSON schema following – API
AI Safety + Cybersecurity R\&D Tracker – Fairly AI
Anthropic makes 'jailbreak' advance to stop AI models producing harmful results
Pattern matching filter rules - IBM
Real-time Threat Detection

## C3モデルライフサイクル管理および変更管理

### 管理目標

AIシステムは、許可されていないまたは安全でないモデル変更が本番環境に到達するのを防ぐ変更管理プロセスを実装しなければなりません。この管理は、開発から展開、廃止に至るまでのライフサイクル全体を通じてモデルの完全性を保証し、迅速なインシデント対応を可能にし、すべての変更に対する責任を維持します。

コアセキュリティ目標：完全性、追跡可能性、および復元可能性を維持する管理されたプロセスを採用することで、許可され検証されたモデルのみが本番環境に到達すること。

---

### C3.1 モデル認証と整合性

検証済みの完全性を持つ認可されたモデルのみが、本番環境に到達します。

 #3.1.1    レベル: 1    役割: D/V
 展開前に、すべてのモデルアーティファクト（重み、設定、トークナイザー）が認可されたエンティティによって暗号的に署名されていることを検証してください。
 #3.1.2    レベル: 1    役割: D/V
 モデルの整合性が展開時に検証され、署名検証の失敗がモデルの読み込みを防ぐことを確認してください。
 #3.1.3    レベル: 2    役割: D/V
 モデルの出所記録に、承認する主体の身元、トレーニングデータのチェックサム、合否ステータスを含む検証テスト結果、および作成タイムスタンプが含まれていることを確認してください。
 #3.1.4    レベル: 2    役割: D/V
 すべてのモデルアーティファクトがセマンティックバージョニング（MAJOR.MINOR.PATCH）を使用しており、各バージョンコンポーネントがどのような基準で増分されるかが文書化されていることを確認してください。
 #3.1.5    レベル: 2    役割: V
 依存関係の追跡がリアルタイムのインベントリを維持し、すべての消費システムを迅速に特定できることを確認してください。

---

### C3.2 モデルの検証とテスト

モデルは、展開前に定義されたセキュリティおよび安全性の検証をクリアしなければなりません。

 #3.2.1    レベル: 1    役割: D/V
 モデルが展開前に、事前に合意された組織の合格/不合格基準を用いて、入力の検証、出力のサニタイズ、安全性評価を含む自動化されたセキュリティテストを受けることを確認してください。
 #3.2.2    レベル: 1    役割: D/V
 検証失敗が、事前に指定された承認権限者からの明示的なオーバーライド承認および文書化された業務上の正当化がある場合にのみ、モデルの展開を自動的にブロックすることを確認してください。
 #3.2.3    レベル: 2    役割: V
 テスト結果が暗号的に署名され、検証対象の特定のモデルバージョンハッシュに不変的にリンクされていることを確認してください。
 #3.2.4    レベル: 2    役割: D/V
 緊急展開には、事前に合意された期間内に文書化されたセキュリティリスク評価と、事前に指定されたセキュリティ権限者からの承認が必要であることを確認してください。

---

### C3.3 管理された展開とロールバック

モデルのデプロイメントは制御され、監視され、かつ元に戻せるものでなければなりません。

 #3.3.1    レベル: 1    役割: D
 本番展開が段階的なロールアウトメカニズム（カナリア展開、ブルーグリーン展開）を実装し、事前に合意されたエラー率、遅延閾値、またはセキュリティアラート基準に基づく自動ロールバックトリガーを備えていることを確認してください。
 #3.3.2    レベル: 1    役割: D/V
 ロールバック機能が、あらかじめ定められた組織の時間枠内で、モデルの状態（重み、設定、依存関係）を完全かつ原子的に復元することを検証してください。
 #3.3.3    レベル: 2    役割: D/V
 展開プロセスがモデルの有効化前に暗号署名を検証し、整合性チェックサムを計算していることを確認し、不一致があった場合には展開を失敗させること。
 #3.3.4    レベル: 2    役割: D/V
 緊急モデルシャットダウン機能が、自動回路遮断器または手動キルスイッチを介して、事前定義された応答時間内にモデルエンドポイントを無効にできることを確認する。
 #3.3.5    レベル: 2    役割: V
 ロールバック用のアーティファクト（以前のモデルバージョン、設定、依存関係）が、インシデント対応のために組織のポリシーに従い、不変ストレージに保持されていることを検証してください。

---

### C3.4 変更の説明責任と監査

すべてのモデルライフサイクルの変更は追跡可能で監査可能でなければなりません。

 #3.4.1    レベル: 1    役割: V
 すべてのモデル変更（展開、構成、廃止）がタイムスタンプ、認証されたアクターの身元、変更タイプ、および変更前後の状態を含む不変の監査記録を生成することを確認してください。
 #3.4.2    レベル: 2    役割: D/V
 監査ログへのアクセスには適切な認可が必要であることを確認し、すべてのアクセス試行がユーザーの識別情報とタイムスタンプとともに記録されていることを確認してください。
 #3.4.3    レベル: 2    役割: D/V
 プロンプトテンプレートとシステムメッセージが、必須のコードレビューおよび指定されたレビュアーからの承認を経て、gitリポジトリでバージョン管理されていることを確認してください。
 #3.4.4    レベル: 2    役割: V
 監査記録に対して、保持期間内の任意のタイムスタンプでモデルの状態を完全に再構築できるよう、十分な詳細（モデルハッシュ、構成スナップショット、依存関係のバージョン）が含まれていることを検証してください。

---

### C3.5 セキュア開発プラクティス

モデルの開発およびトレーニングプロセスは、侵害を防ぐために安全な手順に従わなければなりません。

 #3.5.1    レベル: 1    役割: D
 モデルの開発、テスト、および本番環境が物理的または論理的に分離されていることを確認してください。これらは共有インフラストラクチャを持たず、異なるアクセス制御を持ち、データストアも分離されている必要があります。
 #3.5.2    レベル: 1    役割: D
 モデルのトレーニングとファインチューニングが、ネットワークアクセスを制御された隔離環境で行われていることを確認してください。
 #3.5.3    レベル: 1    役割: D/V
 トレーニングデータソースがモデル開発に使用される前に、整合性チェックを通じて検証され、信頼できるソースによって認証され、文書化されたチェーンオブカストディがあることを確認してください。
 #3.5.4    レベル: 2    役割: D
 モデル開発の成果物（ハイパーパラメータ、トレーニングスクリプト、設定ファイル）がバージョン管理に保存され、トレーニングに使用する前にピアレビューの承認が必要であることを確認してください。

---

### C3.6 モデルのリタイアメントおよび廃止

モデルは、もはや必要がない場合やセキュリティ問題が特定された場合に、安全に廃止されなければなりません。

 #3.6.1    レベル: 1    役割: D
 モデルの廃止プロセスが依存関係グラフを自動的にスキャンし、すべての利用システムを特定し、廃止前に事前合意された通知期間を提供することを確認してください。
 #3.6.2    レベル: 1    役割: D/V
 廃止されたモデルのアーティファクトが、文書化されたデータ保持ポリシーに従い、暗号消去または複数回上書きによって安全に消去されていることを、検証済みの破棄証明書を用いて確認してください。
 #3.6.3    レベル: 2    役割: V
 モデルの退役イベントがタイムスタンプと操作担当者の識別情報とともに記録され、モデルの署名が再利用を防ぐために取り消されていることを確認してください。
 #3.6.4    レベル: 2    役割: D/V
 緊急モデル退役が、自動キルスイッチを通じて重要なセキュリティ脆弱性が発見された場合に、事前に定められた緊急対応時間内にモデルへのアクセスを無効化できることを検証する。

---

### 参考文献

MLOps Principles
Securing AI/ML Ops – Cisco.com
Audit logs security: cryptographically signed tamper-proof logs
Machine Learning Model Versioning: Top Tools & Best Practices
AI Hygiene Starts with Models and Data Loaders – SEI Blog
How to handle versioning and rollback of a deployed ML model?
Reinforcement fine-tuning – OpenAI API
Auditing Machine Learning models: Governance, Data Security and …
Adversarial Training to Improve Model Robustness
What is AI adversarial robustness? – IBM Research
Exploring Data Provenance: Ensuring Data Integrity and Authenticity
MITRE ATLAS
AWS Prescriptive Guidance – Best practices for retiring applications …

## C4 インフラストラクチャ、構成およびデプロイメントセキュリティ

### 管理目標

AIインフラストラクチャは、権限昇格、サプライチェーンの改ざん、および横展開に対して、セキュアな構成、ランタイム分離、信頼されたデプロイパイプライン、および包括的な監視を通じて強化されなければなりません。認可され、検証されたインフラストラクチャのコンポーネントと構成のみが、セキュリティ、完全性、および監査可能性を維持する管理されたプロセスを経て本番環境に到達します。

コアセキュリティ目標：暗号的に署名され、脆弱性スキャンを通過したインフラストラクチャコンポーネントのみが、セキュリティポリシーを強制し、不変の監査証跡を維持する自動化検証パイプラインを経て本番環境に到達すること。

---

### C4.1 ランタイム環境の分離

カーネルレベルの分離プリミティブと必須アクセス制御を通じて、コンテナの脱出および特権昇格を防止します。

 #4.1.1    レベル: 1    役割: D/V
 すべてのAIコンテナが、CAP_SETUID、CAP_SETGID、およびセキュリティベースラインに明示的に記載された必須の権限を除き、すべてのLinuxケーパビリティを削除していることを確認してください。
 #4.1.2    レベル: 1    役割: D/V
 seccompプロファイルが事前承認された許可リストに含まれるシステムコール以外をすべてブロックし、違反が発生した場合はコンテナを終了させてセキュリティアラートを生成することを検証してください。
 #4.1.3    レベル: 2    役割: D/V
 AIワークロードが読み取り専用のルートファイルシステム、一時データ用のtmpfs、およびnoexecマウントオプションが適用された永続データ用の名前付きボリュームで実行されていることを確認してください。
 #4.1.4    レベル: 2    役割: D/V
 eBPFベースのランタイム監視（Falco、Tetragon、または同等のもの）が特権昇格の試みを検出し、組織の対応時間要件内で違反プロセスを自動的に終了することを検証してください。
 #4.1.5    レベル: 3    役割: D/V
 高リスクのAIワークロードが、認証検証付きでハードウェア分離環境（Intel TXT、AMD SVM、または専用のベアメタルノード）で実行されることを確認してください。

---

### C4.2 セキュアなビルドおよびデプロイメントパイプライン

再現可能なビルドと署名付きアーティファクトを通じて、暗号学的整合性とサプライチェーンのセキュリティを確保します。

 #4.2.1    レベル: 1    役割: D/V
 インフラストラクチャ・アズ・コードが、すべてのコミットでツール（tfsec、Checkov、またはTerrascan）によってスキャンされ、CRITICALまたはHIGHの重大度の問題がある場合はマージをブロックすることを確認してください。
 #4.2.2    レベル: 1    役割: D/V
 コンテナビルドが同一のSHA256ハッシュで再現可能であることを検証し、Sigstoreで署名されたSLSAレベル3のプロビナンス証明を生成します。
 #4.2.3    レベル: 2    役割: D/V
 コンテナイメージがCycloneDXまたはSPDXのSBOMを埋め込み、Cosignで署名されていることを検証し、署名されていないイメージはデプロイ前に拒否されるようにします。
 #4.2.4    レベル: 2    役割: D/V
 CI/CDパイプラインが、HashiCorp Vault、AWS IAMロール、またはAzureマネージドアイデンティティから発行されたOIDCトークンを使用しており、その有効期間が組織のセキュリティポリシーの制限を超えていないことを検証してください。
 #4.2.5    レベル: 2    役割: D/V
 Cosign署名およびSLSAプロヴェナンスがコンテナ実行前のデプロイメントプロセス中に検証され、検証エラーが発生した場合にはデプロイメントが失敗することを確認してください。
 #4.2.6    レベル: 2    役割: D/V
 ビルド環境が一時的なコンテナまたは永続的なストレージを持たないVMで実行され、プロダクションVPCからネットワーク的に隔離されていることを確認してください。

---

### C4.3 ネットワークセキュリティとアクセス制御

デフォルト拒否ポリシーと暗号化通信を用いてゼロトラストネットワーキングを実装する。

 #4.3.1    レベル: 1    役割: D/V
 Kubernetesネットワークポリシーまたは同等のもので、デフォルト拒否のインバウンド/アウトバウンドを実装し、必要なポート（443、8080など）に対して明示的な許可ルールを設定していることを確認してください。
 #4.3.2    レベル: 1    役割: D/V
 SSH（ポート22）、RDP（ポート3389）、およびクラウドメタデータエンドポイント（169.254.169.254）がブロックされているか、または証明書ベースの認証を必要としていることを確認してください。
 #4.3.3    レベル: 2    役割: D/V
 egress トラフィックが HTTP/HTTPS プロキシ（Squid、Istio、またはクラウド NAT ゲートウェイ）を通じてフィルタリングされており、ドメイン許可リストを使用し、ブロックされたリクエストがログ記録されていることを確認してください。
 #4.3.4    レベル: 2    役割: D/V
 サービス間通信が相互TLSを使用し、証明書が組織のポリシーに従ってローテーションされており、証明書検証が強制されていること（skip-verifyフラグが使用されていないこと）を確認してください。
 #4.3.5    レベル: 2    役割: D/V
 AIインフラストラクチャが専用のVPC/VNetで稼働し、直接インターネットアクセスがなく、NATゲートウェイまたはバスチオンホストを介してのみ通信していることを確認してください。

---

### C4.4 シークレットおよび暗号鍵管理

ハードウェア対応ストレージとゼロトラストアクセスによる自動ローテーションで資格情報を保護します。

 #4.4.1    レベル: 1    役割: D/V
 シークレットがHashiCorp Vault、AWS Secrets Manager、Azure Key Vault、またはGoogle Secret Managerに保存されており、AES-256を使用した静止データの暗号化が適用されていることを確認してください。
 #4.4.2    レベル: 1    役割: D/V
 暗号鍵が組織の暗号ポリシーに従ってキー回転を行い、FIPS 140-2 レベル 2 の HSM（AWS CloudHSM、Azure Dedicated HSM）で生成されていることを検証してください。
 #4.4.3    レベル: 2    役割: D/V
 シークレットのローテーションがゼロダウンタイムのデプロイメントで自動化されており、かつ人事異動やセキュリティインシデントによって即時にローテーションがトリガーされることを確認してください。
 #4.4.4    レベル: 2    役割: D/V
 コンテナイメージがツール（GitLeaks、TruffleHog、またはdetect-secrets）でスキャンされ、APIキー、パスワード、または証明書を含むビルドがブロックされることを確認してください。
 #4.4.5    レベル: 2    役割: D/V
 本番環境のシークレットアクセスにはハードウェアトークン（YubiKey、FIDO2）を使用した多要素認証（MFA）が必要であり、ユーザーの識別情報とタイムスタンプを含む不変の監査ログによって記録されることを確認してください。
 #4.4.6    レベル: 2    役割: D/V
 Kubernetesのシークレット、マウントされたボリューム、またはinitコンテナを介してシークレットが注入されていることを確認し、シークレットが環境変数やイメージに埋め込まれることがないようにしてください。

---

### C4.5 AI ワークロード サンドボックスおよび検証

包括的な振る舞い分析を伴う安全なサンドボックス内で信頼できないAIモデルを分離します。

 #4.5.1    レベル: 1    役割: D/V
 外部AIモデルがgVisor、microVM（Firecracker、CrossVMなど）、または--security-opt=no-new-privilegesおよび--read-onlyフラグを使用したDockerコンテナ内で実行されることを確認してください。
 #4.5.2    レベル: 1    役割: D/V
 サンドボックス環境がネットワーク接続なし（--network=none）であるか、またはすべての外部リクエストがiptablesルールによってブロックされたローカルホストアクセスのみであることを確認してください。
 #4.5.3    レベル: 2    役割: D/V
 AIモデルの検証には、組織で定義されたテストカバレッジおよびバックドア検出のための行動分析を伴う自動化されたレッドチームテストが含まれていることを確認してください。
 #4.5.4    レベル: 2    役割: D/V
 AIモデルが本番環境に昇格される前に、そのサンドボックス結果が認可されたセキュリティ担当者によって暗号的に署名され、不変の監査ログに保存されていることを確認してください。
 #4.5.5    レベル: 2    役割: D/V
 サンドボックス環境が評価の間にゴールデンイメージから破棄され再作成され、ファイルシステムとメモリが完全にクリーンアップされていることを検証してください。

---

### C4.6 インフラストラクチャ セキュリティ監視

インフラストラクチャを継続的にスキャンおよび監視し、自動修復とリアルタイムアラートを実施します。

 #4.6.1    レベル: 1    役割: D/V
 コンテナイメージが組織のスケジュールに従ってスキャンされていることを確認し、組織のリスク閾値に基づいて重大な脆弱性が展開をブロックするようにしてください。
 #4.6.2    レベル: 1    役割: D/V
 インフラストラクチャが組織で定義されたコンプライアンス閾値および失敗したチェックに対する自動修復を伴い、CISベンチマークまたはNIST 800-53コントロールに合格していることを検証します。
 #4.6.3    レベル: 2    役割: D/V
 HIGH重大度の脆弱性が、組織のリスク管理タイムラインに従ってパッチ適用されていることを確認し、積極的に悪用されているCVEに対しては緊急対応手順を実施すること。
 #4.6.4    レベル: 2    役割: V
 セキュリティアラートがCEFまたはSTIX/TAXIIフォーマットを使用して、Splunk、Elastic、またはSentinelなどのSIEMプラットフォームと自動的な情報拡充と共に連携することを検証してください。
 #4.6.5    レベル: 3    役割: V
 インフラストラクチャのメトリクスがSLAダッシュボードおよびエグゼクティブレポートと共に、監視システム（Prometheus、DataDog）にエクスポートされていることを検証してください。
 #4.6.6    レベル: 2    役割: D/V
 組織の監視要件に従い、ツール（Chef InSpec、AWS Config）を使用して構成のドリフトが検出され、許可されていない変更に対して自動ロールバックが行われることを確認します。

---

### C4.7 AIインフラストラクチャリソース管理

リソース枯渇攻撃を防止し、クォータと監視を通じて公平なリソース配分を確保します。

 #4.7.1    レベル: 1    役割: D/V
 GPU/TPUの利用率が監視されており、組織で定義された閾値でアラートが発動され、容量管理ポリシーに基づいて自動スケーリングまたは負荷分散が有効化されていることを確認してください。
 #4.7.2    レベル: 1    役割: D/V
 AIワークロードの指標（推論レイテンシ、スループット、エラー率）が組織の監視要件に従って収集され、インフラストラクチャの利用状況と相関されていることを確認する。
 #4.7.3    レベル: 2    役割: D/V
 Kubernetes ResourceQuotas または同等の機能が、組織のリソース割り当てポリシーに従って個々のワークロードを制限し、ハードリミットが強制されていることを検証してください。
 #4.7.4    レベル: 2    役割: V
 コストモニタリングが、組織の予算閾値に基づくアラートおよび予算超過に対する自動制御とともに、ワークロード/テナントごとの支出を追跡していることを確認してください。
 #4.7.5    レベル: 3    役割: V
 キャパシティプランニングが、組織で定義された予測期間の過去のデータを使用し、需要パターンに基づく自動リソースプロビジョニングを行っていることを確認してください。
 #4.7.6    レベル: 2    役割: D/V
 リソース枯渇が、容量ポリシーに基づくレート制限やワークロードの分離を含む組織の対応要件に従ってサーキットブレーカーをトリガーすることを検証する。

---

### C4.8 環境の分離とプロモーション管理

自動化されたプロモーションゲートおよびセキュリティ検証によって厳格な環境境界を適用します。

 #4.8.1    レベル: 1    役割: D/V
 dev/test/prod 環境が共有の IAM ロール、セキュリティグループ、ネットワーク接続なしで、別々の VPC/VNet 上で実行されていることを確認してください。
 #4.8.2    レベル: 1    役割: D/V
 環境の昇格が、組織的に定義された承認権限者による暗号署名および改ざん不可能な監査証跡を伴う承認を必要とすることを確認してください。
 #4.8.3    レベル: 2    役割: D/V
 本番環境ではSSHアクセスをブロックし、デバッグエンドポイントを無効化し、緊急時を除いて組織の事前通知要件を含む変更要求を必須とすることを検証してください。
 #4.8.4    レベル: 2    役割: D/V
 インフラストラクチャー・アズ・コードの変更が、メインブランチにマージされる前に、ピアレビューと自動テストおよびセキュリティスキャンを必須とすることを検証してください。
 #4.8.5    レベル: 2    役割: D/V
 非本番データが組織のプライバシー要件に従って匿名化されていること、合成データ生成が行われていること、または完全なデータマスキングとPII（個人識別情報）の削除が検証されていることを確認してください。
 #4.8.6    レベル: 2    役割: D/V
 昇進ゲートには、自動化されたセキュリティテスト（SAST、DAST、コンテナスキャン）が含まれており、承認にはクリティカルな問題がゼロであることが必要であることを確認してください。

---

### C4.9 インフラストラクチャのバックアップおよびリカバリー

自動バックアップ、検証済みの復旧手順、およびディザスタリカバリ機能を通じてインフラストラクチャの回復力を確保します。

 #4.9.1    レベル: 1    役割: D/V
 インフラストラクチャの構成が、組織のバックアップスケジュールに従って、3-2-1バックアップ戦略を実装し、地理的に分散したリージョンにバックアップされていることを確認してください。
 #4.9.2    レベル: 2    役割: D/V
 バックアップシステムが、ランサムウェア対策のために、分離されたネットワークで別の資格情報を使用し、エアギャップされたストレージで動作していることを確認してください。
 #4.9.3    レベル: 2    役割: V
 回復手順が、組織のスケジュールに従ってRTOおよびRPO目標を満たし、組織の要件に適合していることを、自動テストを通じて検証および確認されていることを確認する。
 #4.9.4    レベル: 3    役割: V
 災害復旧に、モデルウェイトの復元、GPUクラスターの再構築、サービス依存関係マッピングを含むAI特有のランブックが含まれていることを確認してください。

---

### C4.10 インフラストラクチャーコンプライアンスとガバナンス

継続的な評価、文書化、および自動化された制御を通じて規制遵守を維持します。

 #4.10.1    レベル: 2    役割: D/V
 インフラストラクチャのコンプライアンスが、SOC 2、ISO 27001、または FedRAMP コントロールに対して組織のスケジュールに従って評価され、自動化された証拠収集が行われていることを確認してください。
 #4.10.2    レベル: 2    役割: V
 インフラストラクチャのドキュメントに、ネットワーク図、データフローマップ、および組織の変更管理要件に基づいて更新された脅威モデルが含まれていることを確認してください。
 #4.10.3    レベル: 3    役割: D/V
 インフラストラクチャの変更が、高リスクの修正に対する規制承認ワークフローを伴う自動化されたコンプライアンス影響評価を受けることを確認してください。

---

### C4.11 AI ハードウェアセキュリティ

GPU、TPU、および専用のAIアクセラレーターを含む、AI専用のハードウェアコンポーネントを保護する。

 #4.11.1    レベル: 2    役割: D/V
 AIアクセラレータのファームウェア（GPU BIOS、TPUファームウェア）が暗号署名で検証され、組織のパッチ管理スケジュールに従って更新されていることを確認してください。
 #4.11.2    レベル: 2    役割: D/V
 ワークロードの実行前に、TPM 2.0、Intel TXT、または AMD SVM を使用したハードウェア認証により AI アクセラレータの整合性が検証されることを確認してください。
 #4.11.3    レベル: 2    役割: D/V
 SR-IOV、MIG（マルチインスタンスGPU）、または同等のハードウェアパーティショニングを使用して、ワークロード間でGPUメモリが分離されていることを検証し、ジョブ間でのメモリサニタイズを行ってください。
 #4.11.4    レベル: 3    役割: V
 AIハードウェアのサプライチェーンに、製造業者の証明書による来歴確認と改ざん防止包装の検証が含まれていることを確認してください。
 #4.11.5    レベル: 3    役割: D/V
 ハードウェアセキュリティモジュール（HSM）が、FIPS 140-2 レベル3またはCommon Criteria EAL4+認証を持つことで、AIモデルの重みや暗号化キーを保護していることを確認してください。

---

### C4.12 エッジ＆分散AIインフラストラクチャ

エッジコンピューティング、フェデレーテッドラーニング、マルチサイトアーキテクチャを含む安全な分散AI展開。

 #4.12.1    レベル: 2    役割: D/V
 エッジAIデバイスが、組織の証明書管理ポリシーに従って更新されるデバイス証明書を使用して、相互TLSによって中央インフラストラクチャに認証されることを確認してください。
 #4.12.2    レベル: 2    役割: D/V
 エッジデバイスが、署名の検証によるセキュアブートと、ファームウェアのダウングレード攻撃を防ぐロールバック保護を実装していることを確認してください。
 #4.12.3    レベル: 3    役割: D/V
 分散AIの調整が、参加者の検証と悪意のあるノードの検出を含むビザンチン障害耐性コンセンサスアルゴリズムを使用していることを検証してください。
 #4.12.4    レベル: 3    役割: D/V
 エッジからクラウドへの通信が、帯域幅制限、データ圧縮、および安全なローカルストレージを備えたオフライン操作機能を含んでいることを検証してください。

---

### C4.13 マルチクラウド＆ハイブリッドインフラストラクチャセキュリティ

複数のクラウドプロバイダーおよびハイブリッドクラウド・オンプレミス展開にわたるAIワークロードをセキュアに保護します。

 #4.13.1    レベル: 2    役割: D/V
 マルチクラウドAI展開がクラウドに依存しないアイデンティティフェデレーション（OIDC、SAML）を使用し、プロバイダー間で中央集約型のポリシー管理を行っていることを確認してください。
 #4.13.2    レベル: 2    役割: D/V
 クロスクラウドデータ転送が、顧客管理キーを使用したエンドツーエンド暗号化および法域ごとに強制されるデータ所在地制御を利用していることを確認してください。
 #4.13.3    レベル: 2    役割: D/V
 ハイブリッドクラウドAIワークロードがオンプレミス環境とクラウド環境の両方で一貫したセキュリティポリシーを実装し、統一された監視とアラート機能を備えていることを検証します。
 #4.13.4    レベル: 3    役割: V
 クラウドベンダーロックイン防止には、ポータブルなインフラストラクチャ・アズ・コード、標準化されたAPI、およびフォーマット変換ツールを備えたデータエクスポート機能が含まれていることを確認してください。
 #4.13.5    レベル: 3    役割: V
 マルチクラウドのコスト最適化には、リソースの無秩序な拡大を防ぐセキュリティコントロールや、不正なクロスクラウドデータ転送に関する料金の防止が含まれていることを確認してください。

---

### C4.14 インフラストラクチャ自動化とGitOpsセキュリティ

AIインフラストラクチャ管理のための安全なインフラ自動化パイプラインとGitOpsワークフロー。

 #4.14.1    レベル: 2    役割: D/V
 GitOpsリポジトリがGPGキーによる署名付きコミットを必須とし、mainブランチへの直接プッシュを防止するブランチ保護ルールを設けていることを確認してください。
 #4.14.2    レベル: 2    役割: D/V
 インフラストラクチャの自動化には、組織の対応要件に基づいてトリガーされる、不正な変更に対する自動修復およびロールバック機能を備えたドリフト検出が含まれていることを確認してください。
 #4.14.3    レベル: 2    役割: D/V
 自動化されたインフラストラクチャプロビジョニングが、準拠しない構成に対して展開をブロックするセキュリティポリシーの検証を含んでいることを確認してください。
 #4.14.4    レベル: 2    役割: D/V
 インフラストラクチャ自動化のシークレットが、外部シークレットオペレーター（External Secrets Operator、Bank-Vaults）を介して管理され、自動ローテーションが行われていることを確認してください。
 #4.14.5    レベル: 3    役割: V
 セルフヒーリングインフラストラクチャには、セキュリティイベントの相関分析、インシデント対応の自動化、および関係者通知のワークフローが含まれていることを確認してください。

---

### C4.15 量子耐性インフラストラクチャセキュリティ

ポスト量子暗号と量子安全プロトコルを通じて、量子コンピューティングの脅威に備えたAIインフラストラクチャを準備する。

 #4.15.1    レベル: 3    役割: D/V
 AIインフラストラクチャが鍵交換およびデジタル署名のためにNIST承認のポスト量子暗号アルゴリズム（CRYSTALS-Kyber、CRYSTALS-Dilithium、SPHINCS+）を実装していることを確認してください。
 #4.15.2    レベル: 3    役割: D/V
 量子安全な鍵管理プロトコルを用いて、高度なセキュリティが求められるAI通信向けに量子鍵配送（QKD）システムが実装されていることを検証する。
 #4.15.3    レベル: 3    役割: D/V
 暗号アジリティフレームワークが、自動化された証明書および鍵のローテーションを用いて、新しいポスト量子アルゴリズムへの迅速な移行を可能にすることを検証してください。
 #4.15.4    レベル: 3    役割: V
 量子脅威モデリングが、記録された移行スケジュールとリスク評価を用いて量子攻撃に対するAIインフラストラクチャの脆弱性を評価していることを検証してください。
 #4.15.5    レベル: 3    役割: D/V
 ハイブリッド古典-量子暗号システムが量子移行期間中に多層防御（ディフェンスインデプス）を提供し、パフォーマンスの監視を行っていることを検証する。

---

### C4.16 機密コンピューティングおよびセキュアエンクレーブ

ハードウェアベースの信頼実行環境および機密コンピューティング技術を使用して、AIワークロードとモデルの重みを保護します。

 #4.16.1    レベル: 3    役割: D/V
 機密性の高いAIモデルが、暗号化されたメモリと認証検証を備えたIntel SGXエンクレーブ、AMD SEV-SNP、またはARM TrustZone内で実行されていることを検証します。
 #4.16.2    レベル: 3    役割: D/V
 機密コンテナ（Kata Containers、機密コンピューティング対応のgVisor）がハードウェアによって強制されるメモリ暗号化でAIワークロードを分離していることを検証してください。
 #4.16.3    レベル: 3    役割: D/V
 リモート認証が、実行環境の真正性に関する暗号学的証明を用いてエンクレーブの完全性を検証し、AIモデルのロード前にそれを確認することを検証してください。
 #4.16.4    レベル: 3    役割: D/V
 機密性の高いAI推論サービスが、暗号化計算によるモデル抽出を、防御された実行環境と封印されたモデル重みを用いて防止していることを検証してください。
 #4.16.5    レベル: 3    役割: D/V
 信頼された実行環境のオーケストレーションが、リモート認証および暗号化通信チャネルを用いてセキュアエンクレーブのライフサイクルを管理していることを検証してください。
 #4.16.6    レベル: 3    役割: D/V
 セキュアマルチパーティ計算（SMPC）が、個々のデータセットやモデルパラメータを公開することなく協調的なAIトレーニングを可能にすることを検証してください。

---

### C4.17 ゼロ知識インフラストラクチャ

機密情報を明かさずに、プライバシー保護されたAIの検証および認証のためのゼロ知識証明システムを実装する。

 #4.17.1    レベル: 3    役割: D/V
 ゼロ知識証明（ZK-SNARKs、ZK-STARKs）が、モデルの重みやトレーニングデータを公開することなく、AIモデルの整合性およびトレーニングの出所を検証することを確認します。
 #4.17.2    レベル: 3    役割: D/V
 ZKベースの認証システムが、AIサービスにおいて識別情報を明らかにすることなくプライバシーを保護したユーザー認証を可能にすることを検証します。
 #4.17.3    レベル: 3    役割: D/V
 プライベートセットインターセクション（PSI）プロトコルが、個々のデータセットを露出することなく、フェデレーテッドAIのための安全なデータマッチングを可能にすることを検証してください。
 #4.17.4    レベル: 3    役割: D/V
 ゼロ知識機械学習（ZKML）システムが、正確な計算の暗号学的証明を用いて検証可能なAI推論を可能にすることを検証してください。
 #4.17.5    レベル: 3    役割: D/V
 ZK-rollupsは、バッチ検証と計算負荷の軽減により、スケーラブルでプライバシー保護されたAIトランザクション処理を提供することを検証してください。

---

### C4.18 サイドチャネル攻撃防止

タイミング攻撃、電力攻撃、電磁攻撃、およびキャッシュベースのサイドチャネル攻撃からAIインフラストラクチャを保護し、機密情報の漏洩を防ぎます。

 #4.18.1    レベル: 3    役割: D/V
 AI推論のタイミングが、タイミングベースのモデル抽出攻撃を防ぐために、定数時間アルゴリズムとパディングを用いて正規化されていることを確認してください。
 #4.18.2    レベル: 3    役割: D/V
 電力解析防御には、ノイズ注入、電源ラインのフィルタリング、およびランダム化された実行パターンが含まれていることを確認してください。
 #4.18.3    レベル: 3    役割: D/V
 キャッシュベースのサイドチャネル緩和は、情報漏洩を防ぐためにキャッシュのパーティショニング、ランダム化、およびフラッシュ命令を使用することを検証します。
 #4.18.4    レベル: 3    役割: D/V
 電磁放射保護には、TEMPESTスタイルの攻撃を防ぐためのシールド、信号フィルタリング、およびランダム化処理が含まれていることを確認してください。
 #4.18.5    レベル: 3    役割: D/V
 マイクロアーキテクチャのサイドチャネル防御には、投機的実行の制御およびメモリアクセスパターンの難読化が含まれていることを確認してください。

---

### C4.19 ニューロモルフィック＆特殊AIハードウェアセキュリティ

ニューロモルフィックチップ、FPGA、カスタムASIC、および光コンピューティングシステムを含む新興のAIハードウェアアーキテクチャのセキュリティを確保する。

 #4.19.1    レベル: 3    役割: D/V
 ニューロモルフィックチップのセキュリティには、スパイクパターンの暗号化、シナプス重みの保護、およびハードウェアベースの学習ルール検証が含まれていることを確認してください。
 #4.19.2    レベル: 3    役割: D/V
 FPGAベースのAIアクセラレータがビットストリーム暗号化、改ざん防止機構、および認証されたアップデートによる安全な構成読み込みを実装していることを検証してください。
 #4.19.3    レベル: 3    役割: D/V
 カスタムASICのセキュリティには、オンチップのセキュリティプロセッサ、ハードウェアルートオブトラスト、および改ざん検出機能付きの安全なキー保管が含まれていることを確認してください。
 #4.19.4    レベル: 3    役割: D/V
 光学計算システムが量子安全な光学暗号化、セキュアなフォトニックスイッチング、および保護された光信号処理を実装していることを確認してください。
 #4.19.5    レベル: 3    役割: D/V
 ハイブリッドアナログ-デジタルAIチップが、安全なアナログ計算、保護された重み保存、および認証されたアナログ-デジタル変換を含むことを検証してください。

---

### C4.20 プライバシー保護型コンピュートインフラストラクチャ

AI処理および分析中に機微なデータを保護するためのプライバシー保護計算のためのインフラストラクチャ制御を実装する。

 #4.20.1    レベル: 3    役割: D/V
 ホモモルフィック暗号基盤が、暗号的整合性検証およびパフォーマンス監視を備えた、機密性の高いAIワークロードに対する暗号化計算を可能にすることを検証する。
 #4.20.2    レベル: 3    役割: D/V
 プライベート情報検索システムが、アクセスパターンの暗号保護によりクエリパターンを明らかにすることなくデータベースクエリを可能にすることを検証する。
 #4.20.3    レベル: 3    役割: D/V
 安全なマルチパーティ計算プロトコルが、個々の入力や中間計算結果を公開することなくプライバシーを保護するAI推論を可能にすることを検証する。
 #4.20.4    レベル: 3    役割: D/V
 プライバシー保護型の鍵管理が、分散鍵生成、しきい値暗号、およびハードウェア支援保護を用いた安全な鍵ローテーションを含んでいることを検証してください。
 #4.20.5    レベル: 3    役割: D/V
 バッチ処理、キャッシュ、およびハードウェアアクセラレーションを通じてプライバシー保護計算の性能が最適化されていることを検証しつつ、暗号学的なセキュリティ保証を維持する。

---

### C4.15 エージェントフレームワーク クラウド統合セキュリティおよびハイブリッド展開

ハイブリッドオンプレミス／クラウドアーキテクチャを持つクラウド統合エージェントフレームワークのセキュリティコントロール。

 #4.15.1    レベル: 1    役割: D/V
 クラウドストレージ統合がエージェント管理のキー管理を用いたエンドツーエンド暗号化を使用していることを確認してください。
 #4.15.2    レベル: 2    役割: D/V
 ハイブリッド展開のセキュリティ境界が明確に定義されており、通信チャネルが暗号化されていることを確認してください。
 #4.15.3    レベル: 2    役割: D/V
 クラウドリソースへのアクセスが、継続的な認証を伴うゼロトラスト検証を含んでいることを確認してください。
 #4.15.4    レベル: 3    役割: D/V
 データの所在要件が保存場所の暗号証明によって強制されていることを検証します。
 #4.15.5    レベル: 3    役割: D/V
 クラウドプロバイダーのセキュリティ評価にエージェント固有の脅威モデリングおよびリスク評価が含まれていることを確認してください。

---

### 参考文献

NIST Cybersecurity Framework 2.0
CIS Controls v8
OWASP Container Security Verification Standard
Kubernetes Security Best Practices
SLSA Supply Chain Security Framework
NIST SP 800-190: Application Container Security Guide
Cloud Security Alliance: Cloud Controls Matrix
ENISA: Secure Infrastructure Design
NIST SP 800-53: Security Controls for Federal Information Systems
ISO 27001:2022 Information Security Management
NIST AI Risk Management Framework
CIS Kubernetes Benchmark
FIPS 140-2 Security Requirements
NIST SP 800-207: Zero Trust Architecture
IEEE 2857: Privacy Engineering for AI Systems
NIST SP 800-161: Cybersecurity Supply Chain Risk Management
NIST Post-Quantum Cryptography Standards
Intel SGX Developer Guide
AMD SEV-SNP White Paper
ARM TrustZone Technology
ZK-SNARKs: A Gentle Introduction
NIST SP 800-57: Cryptographic Key Management
Side-Channel Attack Countermeasures
Neuromorphic Computing Security Challenges
FPGA Security: Fundamentals, Evaluation, and Countermeasures
Microsoft SEAL: Homomorphic Encryption Library
HElib: Homomorphic Encryption Library
PALISADE Lattice Cryptography Library
Differential Privacy: A Survey of Results
Secure Aggregation for Federated Learning
Private Information Retrieval: Concepts and Constructions

## C5 AIコンポーネントおよびユーザーのアクセス制御とアイデンティティ

### 管理目標

AIシステムにおける効果的なアクセス制御には、堅牢なアイデンティティ管理、コンテキスト認識型の認可、およびゼロトラスト原則に従った実行時の強制が必要です。これらの制御により、人間、サービス、自律エージェントは明示的に許可された範囲内のモデル、データ、および計算リソースとのみやり取りし、継続的な検証と監査機能が確保されます。

---

### C5.1 アイデンティティ管理および認証

特権操作のためにマルチファクター認証を用いて、すべてのエンティティに暗号的に裏付けられたIDを確立します。

 #5.1.1    レベル: 1    役割: D/V
 すべての人間ユーザーおよびサービスプリンシパルが、一意のアイデンティティからトークンへのマッピング（共有アカウントや認証情報なし）を使用して、OIDC/SAMLプロトコルを通じて集中管理されたエンタープライズIDプロバイダー（IdP）で認証されることを確認してください。
 #5.1.2    レベル: 1    役割: D/V
 高リスク操作（モデルの展開、重みのエクスポート、トレーニングデータへのアクセス、本番環境の設定変更）が、多要素認証またはセッション再検証を伴うステップアップ認証を必要とすることを確認してください。
 #5.1.3    レベル: 2    役割: D
 新しい担当者が本番システムへのアクセスを受ける前に、NIST 800-63-3 IAL-2 または同等の基準に準拠した身元確認を受けていることを検証してください。
 #5.1.4    レベル: 2    役割: V
 アクセスレビューが四半期ごとに実施され、休眠アカウントの自動検出、認証情報のローテーションの強制、およびプロビジョニング解除のワークフローが行われていることを確認してください。
 #5.1.5    レベル: 3    役割: D/V
 フェデレーテッドAIエージェントが、最大有効期間24時間の署名付きJWTアサーションを介して認証され、かつ発信元の暗号学的証明を含むことを検証してください。

---

### C5.2 リソース認可と最小権限

すべてのAIリソースに対して、明確な許可モデルと監査証跡を備えた細粒度のアクセス制御を実装します。

 #5.2.1    レベル: 1    役割: D/V
 すべてのAIリソース（データセット、モデル、エンドポイント、ベクターコレクション、埋め込みインデックス、コンピュートインスタンス）が、明示的な許可リストとデフォルト拒否ポリシーを用いた役割ベースのアクセス制御を強制していることを確認してください。
 #5.2.2    レベル: 1    役割: D/V
 サービスアカウントで最小権限の原則がデフォルトで適用されていることを確認し、初期設定は読み取り専用の権限とし、書き込みアクセスにはビジネス上の正当な理由の文書化を必須とすること。
 #5.2.3    レベル: 1    役割: V
 すべてのアクセス制御の変更が承認された変更要求に関連付けられ、タイムスタンプ、実行者の識別情報、リソース識別子、権限の差分とともに不変に記録されていることを確認してください。
 #5.2.4    レベル: 2    役割: D
 データ分類ラベル（PII、PHI、輸出管理対象、専有情報）が派生リソース（埋め込み、プロンプトキャッシュ、モデル出力）に自動的に伝播し、一貫したポリシー適用が行われていることを検証してください。
 #5.2.5    レベル: 2    役割: D/V
 不正アクセスの試行や権限昇格イベントが、コンテキストメタデータとともに5分以内にSIEMシステムへリアルタイムアラートをトリガーすることを検証してください。

---

### C5.3 動的ポリシー評価

コンテキスト認識型の認可決定を行うための属性ベースアクセス制御（ABAC）エンジンを監査機能付きで展開します。

 #5.3.1    レベル: 1    役割: D/V
 認可の決定が認証されたAPIを介してアクセス可能で、暗号的完全性保護が施された専用のポリシーエンジン（OPA、Cedar、または同等のもの）に外部委譲されていることを検証してください。
 #5.3.2    レベル: 1    役割: D/V
 ポリシーがユーザーのクリアランスレベル、リソースの機密性分類、リクエストコンテキスト、テナント分離、および時間的制約などの動的属性を実行時に評価することを検証してください。
 #5.3.3    レベル: 2    役割: D
 ポリシー定義がバージョン管理され、ピアレビューされており、本番展開前にCI/CDパイプラインの自動テストを通じて検証されていることを確認してください。
 #5.3.4    レベル: 2    役割: V
 ポリシー評価結果に構造化された意思決定の根拠が含まれていることを確認し、それらが相関分析およびコンプライアンス報告のためにSIEMシステムへ送信されていることを検証する。
 #5.3.5    レベル: 3    役割: D/V
 ポリシーキャッシュの有効期間（TTL）値が、高感度リソースについては5分を超えず、キャッシュ無効化機能を持つ標準リソースについては1時間を超えないことを確認してください。

---

### C5.4 クエリ時のセキュリティ強制

必須のフィルタリングおよび行レベルのセキュリティポリシーを用いて、データベース層のセキュリティコントロールを実装します。

 #5.4.1    レベル: 1    役割: D/V
 すべてのベクトルデータベースおよびSQLクエリが、アプリケーションコードではなくデータベースエンジンレベルで強制される必須のセキュリティフィルター（テナントID、機密ラベル、ユーザースコープ）を含んでいることを検証してください。
 #5.4.2    レベル: 1    役割: D/V
 すべてのベクターデータベース、検索インデックス、およびトレーニングデータセットに対して、ポリシー継承を伴う行レベルセキュリティ（RLS）ポリシーとフィールドレベルのマスキングが有効になっていることを確認してください。
 #5.4.3    レベル: 2    役割: D
 失敗した認可評価が、「混乱代理攻撃」を防ぐためにクエリを直ちに中止し、空の結果セットを返すのではなく明示的な認可エラーコードを返すことを確認してください。
 #5.4.4    レベル: 2    役割: V
 ポリシー評価の遅延が継続的に監視され、認可回避を可能にするタイムアウト条件に対して自動アラートが設定されていることを確認してください。
 #5.4.5    レベル: 3    役割: D/V
 クエリの再試行メカニズムが、アクティブなユーザーセッション内での動的な権限変更を考慮して認可ポリシーを再評価することを確認してください。

---

### C5.5 出力フィルタリングとデータ損失防止

AI生成コンテンツにおける無許可のデータ露出を防止するために、ポストプロセッシング制御を導入してください。

 #5.5.1    レベル: 1    役割: D/V
 推論後のフィルタリング機構が、要求者にコンテンツを提供する前に、許可されていないPII（個人識別情報）、分類情報、および専有データをスキャンして編集していることを確認してください。
 #5.5.2    レベル: 1    役割: D/V
 モデルの出力に含まれる引用文献、参考文献、および出典の帰属が呼び出し元の権限に基づいて検証され、無許可のアクセスが検出された場合は削除されることを確認してください。
 #5.5.3    レベル: 2    役割: D
 ユーザーの許可レベルおよびデータ分類に基づいて、出力形式の制限（サニタイズされたPDF、メタデータが削除された画像、承認されたファイルタイプ）が適切に適用されていることを確認します。
 #5.5.4    レベル: 2    役割: V
 訂正アルゴリズムが決定論的であり、バージョン管理され、コンプライアンス調査や法医学分析を支援するために監査ログを維持していることを確認してください。
 #5.5.5    レベル: 3    役割: V
 高リスクの編集イベントが、データを露出させることなく、法医学的な取得のために元のコンテンツの暗号化ハッシュを含む適応型ログを生成することを検証してください。

---

### C5.6 マルチテナント分離

共有AIインフラストラクチャにおいて、テナント間の暗号的および論理的な分離を確保する。

 #5.6.1    レベル: 1    役割: D/V
 メモリスペース、埋め込みストア、キャッシュエントリ、および一時ファイルがテナントごとに名前空間で分離されており、テナント削除またはセッション終了時に安全に削除されることを確認してください。
 #5.6.2    レベル: 1    役割: D/V
 すべてのAPIリクエストに、セッションコンテキストおよびユーザーの権限と暗号学的に検証された認証済みテナント識別子が含まれていることを確認してください。
 #5.6.3    レベル: 2    役割: D
 サービスメッシュおよびコンテナオーケストレーションプラットフォーム内でのテナント間通信に対して、ネットワークポリシーがデフォルト拒否ルールを実装していることを確認してください。
 #5.6.4    レベル: 3    役割: D
 顧客管理キー（CMK）サポートを備えたテナントごとに暗号化キーが一意であること、およびテナントのデータストア間で暗号学的な分離が確保されていることを確認してください。

---

### C5.7 自律エージェントの認可

スコープ付き能力トークンと継続的な認証を通じて、AIエージェントおよび自律システムの制御権限を管理します。

 #5.7.1    レベル: 1    役割: D/V
 自律エージェントが、許可された操作、アクセス可能なリソース、時間制限、および運用制約を明示的に列挙したスコープ付きの能力トークンを受け取っていることを検証してください。
 #5.7.2    レベル: 1    役割: D/V
 高リスク機能（ファイルシステムアクセス、コード実行、外部APIコール、金融取引）がデフォルトで無効化されており、ビジネス上の正当な理由を伴う明示的な承認がなければ有効化できないことを確認してください。
 #5.7.3    レベル: 2    役割: D
 機能トークンがユーザーセッションに紐付けられていること、暗号的整合性保護が含まれていること、およびオフラインのシナリオで永続化または再利用できないことを確認してください。
 #5.7.4    レベル: 2    役割: V
 エージェント発信のアクションが、完全なコンテキスト評価と監査ログ記録を伴うABACポリシーエンジンによる二次承認を受けることを検証してください。
 #5.7.5    レベル: 3    役割: V
 エージェントのエラー条件および例外処理に、インシデント分析およびフォレンジック調査を支援するための機能範囲情報が含まれていることを確認してください。

---

### 参考文献

#### 標準とフレームワーク

NIST SP 800-63-3: Digital Identity Guidelines
Zero Trust Architecture – NIST SP 800-207
OWASP Application Security Verification Standard (AISVS)
​
#### 実装ガイド

Identity and Access Management in the AI Era: 2025 Guide – IDSA
Attribute-Based Access Control with OPA – Permify
How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS
​
#### AI特有のセキュリティ

Row Level Security in Vector DBs for RAG – Bluetuple.ai
Tenant Isolation in Multi-Tenant Systems – WorkOS
Handling AI Agent Permissions – Stytch
OWASP Top 10 for Large Language Model Applications

## C6 モデル、フレームワーク、およびデータのサプライチェーンセキュリティ

### 管理目標

AIサプライチェーン攻撃は、サードパーティのモデル、フレームワーク、またはデータセットを悪用してバックドア、バイアス、または悪用可能なコードを埋め込みます。これらのコントロールは、エンドツーエンドの出所管理、脆弱性管理、およびモニタリングを提供し、モデルのライフサイクル全体を保護します。

---

### C6.1 事前学習済みモデルの審査と出所確認

ファインチューニングや展開の前に、サードパーティモデルの出所、ライセンス、および隠れた挙動を評価・認証してください。

 #6.1.1    レベル: 1    役割: D/V
 すべてのサードパーティモデルアーティファクトが、ソースリポジトリおよびコミットハッシュを特定する署名付きの出所記録を含んでいることを確認してください。
 #6.1.2    レベル: 1    役割: D/V
 モデルがインポートされる前に、自動化ツールを使用して悪意のあるレイヤーやトロイの木馬トリガーがスキャンされていることを確認してください。
 #6.1.3    レベル: 2    役割: D
 転移学習のファインチューニングが、隠れた挙動を検出するための敵対的評価に合格することを検証してください。
 #6.1.4    レベル: 2    役割: V
 モデルライセンス、輸出管理タグ、およびデータ起源の記載がML-BOMエントリに記録されていることを確認してください。
 #6.1.5    レベル: 3    役割: D/V
 高リスクモデル（公開されアップロードされた重み、未検証の作成者）が人間のレビューと承認があるまで隔離されたままであることを確認してください。

---

### C6.2 フレームワークおよびライブラリのスキャン

ランタイムスタックのセキュリティを維持するために、MLフレームワークやライブラリを継続的にスキャンして、CVEや悪意のあるコードを検出します。

 #6.2.1    レベル: 1    役割: D/V
 CIパイプラインがAIフレームワークおよび重要なライブラリに対して依存関係スキャナーを実行していることを確認してください。
 #6.2.2    レベル: 1    役割: D/V
 重大な脆弱性（CVSS ≥ 7.0）が、本番用イメージへの昇格をブロックすることを確認してください。
 #6.2.3    レベル: 2    役割: D
 フォークされたまたはベンダーされたMLライブラリで静的コード解析が実行されていることを確認してください。
 #6.2.4    レベル: 2    役割: V
 フレームワークのアップグレード提案には、公開CVEフィードを参照したセキュリティ影響評価が含まれていることを確認してください。
 #6.2.5    レベル: 3    役割: V
 署名されたSBOMから逸脱する予期しない動的ライブラリのロードに対して、ランタイムセンサーがアラートを出すことを検証してください。

---

### C6.3 依存関係の固定および検証

すべての依存関係を不変のダイジェストに固定し、ビルドを再現して、同一で改ざんされていないアーティファクトを保証します。

 #6.3.1    レベル: 1    役割: D/V
 すべてのパッケージマネージャーがロックファイルを通じてバージョンピンニングを強制していることを確認してください。
 #6.3.2    レベル: 1    役割: D/V
 コンテナ参照において、変更可能なタグの代わりに不変のダイジェストが使用されていることを検証します。
 #6.3.3    レベル: 2    役割: D
 再現可能ビルドのチェックが、CI実行間でハッシュを比較して同一の出力を保証することを検証してください。
 #6.3.4    レベル: 2    役割: V
 監査の追跡可能性のために、ビルド証明書が18ヶ月間保存されていることを確認してください。
 #6.3.5    レベル: 3    役割: D
 期限切れの依存関係が、自動的にPRをトリガーしてピン留めされたバージョンを更新またはフォークすることを確認してください。

---

### C6.4 信頼できるソースの強制

アーティファクトのダウンロードは、暗号学的に検証され、組織が承認したソースからのみ許可し、それ以外はすべてブロックします。

 #6.4.1    レベル: 1    役割: D/V
 モデルの重み、データセット、およびコンテナが、承認されたドメインまたは内部レジストリからのみダウンロードされていることを確認してください。
 #6.4.2    レベル: 1    役割: D/V
 Sigstore/Cosignの署名が、アーティファクトがローカルにキャッシュされる前に公開者の身元を検証することを確認してください。
 #6.4.3    レベル: 2    役割: D
 アウトバウンドプロキシが未認証のアーティファクトダウンロードをブロックし、信頼済みソースポリシーを強制していることを検証してください。
 #6.4.4    レベル: 2    役割: V
 リポジトリの許可リストが四半期ごとにレビューされ、各エントリに対するビジネス上の正当性の証拠があることを確認してください。
 #6.4.5    レベル: 3    役割: V
 ポリシー違反がアーティファクトの隔離と依存パイプライン実行のロールバックを引き起こすことを検証してください。

---

### C6.5 サードパーティデータセットのリスク評価

外部データセットを毒性、バイアス、および法的遵守の観点から評価し、そのライフサイクル全体を通じて監視します。

 #6.5.1    レベル: 1    役割: D/V
 外部データセットがポイズニングリスクスコアリング（例：データフィンガープリンティング、異常値検出）を受けていることを確認してください。
 #6.5.2    レベル: 1    役割: D
 バイアスメトリクス（人口統計的公平性、均等機会）がデータセット承認前に計算されていることを確認してください。
 #6.5.3    レベル: 2    役割: V
 データセットの出所およびライセンス条件がML-BOMエントリに記録されていることを確認してください。
 #6.5.4    レベル: 2    役割: V
 ホストされたデータセットにおけるドリフトや破損を検出するために定期的な監視が行われていることを確認してください。
 #6.5.5    レベル: 3    役割: D
 トレーニング前に、自動スクラビングによって許可されていないコンテンツ（著作権、個人識別情報）が削除されていることを確認してください。

---

### C6.6 サプライチェーン攻撃モニタリング

CVEフィード、監査ログ分析、およびレッドチームシミュレーションを通じて、サプライチェーンの脅威を早期に検出します。

 #6.6.1    レベル: 1    役割: V
 CI/CDの監査ログが、異常なパッケージプルや改ざんされたビルドステップに関するSIEM検出にストリームされていることを確認してください。
 #6.6.2    レベル: 2    役割: D
 インシデント対応プレイブックに、侵害されたモデルやライブラリのロールバック手順が含まれていることを確認してください。
 #6.6.3    レベル: 3    役割: V
 アラートトリアージにおいて、脅威インテリジェンス強化がML特有の指標（例：モデル汚染IoC）にタグ付けされていることを検証します。

---

### C6.7 モデルアーティファクトのML‑BOM

詳細なML特化型SBOM（ML-BOM）を生成および署名し、下流の利用者がデプロイ時にコンポーネントの整合性を検証できるようにします。

 #6.7.1    レベル: 1    役割: D/V
 すべてのモデルアーティファクトが、データセット、重み、ハイパーパラメータ、およびライセンスをリスト化したML-BOMを公開していることを確認してください。
 #6.7.2    レベル: 1    役割: D/V
 ML-BOMの生成とCosign署名がCIで自動化されており、マージに必須であることを確認してください。
 #6.7.3    レベル: 2    役割: D
 ML‑BOMの完全性チェックが、コンポーネントのメタデータ（ハッシュ、ライセンス）が欠落している場合にビルドを失敗させることを検証してください。
 #6.7.4    レベル: 2    役割: V
 下流の利用者がAPIを介してML-BOMを照会し、デプロイ時にインポートされたモデルを検証できることを確認する。
 #6.7.5    レベル: 3    役割: V
 ML-BOMがバージョン管理されており、無許可の変更を検出するために差分が取られていることを確認してください。

---

### 参考文献

ML Supply Chain Compromise – MITRE ATLAS
Supply‑chain Levels for Software Artifacts (SLSA)
CycloneDX – Machine Learning Bill of Materials
What is Data Poisoning? – SentinelOne
Transfer Learning Attack – OWASP ML Security Top 10
AI Data Security Best Practices – CISA
Secure CI/CD Supply Chain – Sumo Logic
AI & Transparency: Protect ML Models – ReversingLabs
SBOM Overview – CISA
Training Data Poisoning Guide – Lakera.ai
Dependency Pinning for Reproducible Python – Medium

## C7 モデルの動作、出力制御および安全性保証

### 管理目標

モデルの出力は構造化され、信頼性が高く、安全で説明可能であり、かつ本番環境で継続的に監視される必要があります。これにより、幻覚現象、プライバシー漏洩、有害なコンテンツ、暴走行動が減少し、ユーザーの信頼と規制遵守が向上します。

---

### C7.1 出力形式の強制

厳格なスキーマ、制約付きデコーディング、および下流の検証により、誤った形式または悪意のあるコンテンツが拡散する前に阻止します。

 #7.1.1    レベル: 1    役割: D/V
 レスポンススキーマ（例：JSONスキーマ）がシステムプロンプトに提供されていることを確認し、すべての出力が自動的に検証されるようにします。スキーマに準拠しない出力は修正または拒否されます。
 #7.1.2    レベル: 1    役割: D/V
 オーバーフローやプロンプトインジェクションのサイドチャネルを防ぐために、制約付きデコーディング（停止トークン、正規表現、最大トークン数）が有効になっていることを確認してください。
 #7.1.3    レベル: 2    役割: D/V
 ダウンストリームのコンポーネントが出力を信頼されていないものとして扱い、スキーマやインジェクション安全なデシリアライザーに対して検証していることを確認してください。
 #7.1.4    レベル: 3    役割: V
 不適切な出力イベントがログに記録され、レート制限され、監視に表示されていることを検証してください。

---

### C7.2 幻覚検出と緩和

不確実性の推定とフォールバック戦略は、でっち上げられた回答を抑制します。

 #7.2.1    レベル: 1    役割: D/V
 トークンレベルの対数確率、アンサンブル自己整合性、またはファインチューニングされた幻覚検出器が各回答に信頼度スコアを割り当てることを確認してください。
 #7.2.2    レベル: 1    役割: D/V
 設定可能な信頼度の閾値を下回る応答がフォールバックワークフロー（例：検索強化生成、二次モデル、人間によるレビュー）をトリガーすることを検証してください。
 #7.2.3    レベル: 2    役割: D/V
 幻覚事象がルート原因のメタデータでタグ付けされ、事後解析および微調整パイプラインにフィードされていることを確認してください。
 #7.2.4    レベル: 3    役割: D/V
 主要なモデルまたは知識ベースの更新後に、閾値および検出器が再調整されていることを確認してください。
 #7.2.5    レベル: 3    役割: V
 ダッシュボードの可視化が幻覚率を追跡していることを確認してください。

---

### C7.3 出力の安全性およびプライバシーフィルタリング

ポリシーフィルターとレッドチームのカバレッジは、ユーザーと機密データを保護します。

 #7.3.1    レベル: 1    役割: D/V
 ポリシーに沿ったヘイト、嫌がらせ、自傷行為、過激派、および性的に露骨なコンテンツを事前および事後生成の分類器がブロックしていることを確認してください。
 #7.3.2    レベル: 1    役割: D/V
 PII/PCI の検出と自動マスキングがすべての応答で実行されることを確認してください。違反があった場合はプライバシーインシデントが発生します。
 #7.3.3    レベル: 2    役割: D
 機密保持タグ（例：営業秘密）が、テキスト、画像、コードなどのモダリティ間で伝播し、漏洩を防止することを検証してください。
 #7.3.4    レベル: 3    役割: D/V
 フィルターバイパスの試みや高リスク分類が二次承認またはユーザーの再認証を必要とすることを確認してください。
 #7.3.5    レベル: 3    役割: D/V
 フィルタリングの閾値が法域およびユーザーの年齢・役割の文脈を反映していることを確認してください。

---

### C7.4 出力およびアクションの制限

レート制限と承認ゲートは、乱用や過度の自律性を防止します。

 #7.4.1    レベル: 1    役割: D
 429エラー時に指数的バックオフを用いて、ユーザーごとおよびAPIキーごとのクォータがリクエスト、トークン、およびコストを制限していることを検証してください。
 #7.4.2    レベル: 1    役割: D/V
 特権的な操作（ファイル書き込み、コード実行、ネットワーク呼び出し）がポリシーベースの承認または人的介入を必要とすることを検証してください。
 #7.4.3    レベル: 2    役割: D/V
 同じリクエストに対して生成された画像、コード、テキストが悪意のあるコンテンツの密輸に使用されないように、クロスモーダルの整合性チェックが確実に機能していることを確認してください。
 #7.4.4    レベル: 2    役割: D
 エージェントの委任の深さ、再帰の制限、および許可されたツールのリストが明示的に構成されていることを確認してください。
 #7.4.5    レベル: 3    役割: V
 制限違反がSIEM取り込みのための構造化されたセキュリティイベントを発行することを検証してください。

---

### C7.5 出力の説明可能性

透明な信号はユーザーの信頼と内部デバッグを向上させます。

 #7.5.1    レベル: 2    役割: D/V
 リスク評価が適切と判断した場合に、ユーザー向けの信頼度スコアや簡潔な推論の要約が表示されることを確認してください。
 #7.5.2    レベル: 2    役割: D/V
 生成された説明が、機密性の高いシステムプロンプトや専有データを明かさないことを確認してください。
 #7.5.3    レベル: 3    役割: D
 システムがトークンレベルの対数確率またはアテンションマップを取得し、許可された検査のために保存していることを確認してください。
 #7.5.4    レベル: 3    役割: V
 説明可能性の成果物が監査可能性のためにモデルリリースとともにバージョン管理されていることを確認してください。

---

### C7.6 モニタリング統合

リアルタイムの可観測性は、開発と本番環境の間のループを閉じます。

 #7.6.1    レベル: 1    役割: D
 メトリクス（スキーマ違反、幻覚率、毒性、PII漏えい、遅延、コスト）が中央監視プラットフォームにストリームされることを確認してください。
 #7.6.2    レベル: 1    役割: V
 各安全指標に対してアラートしきい値が定義されており、オンコールのエスカレーションパスが設定されていることを確認してください。
 #7.6.3    レベル: 2    役割: V
 ダッシュボードが出力異常をモデル／バージョン、機能フラグ、および上流データの変更と関連付けていることを検証してください。
 #7.6.4    レベル: 2    役割: D/V
 監視データが、文書化されたMLOpsワークフロー内で再トレーニング、ファインチューニング、またはルール更新にフィードバックされていることを確認してください。
 #7.6.5    レベル: 3    役割: V
 監視パイプラインがペネトレーションテストされ、アクセス制御されていることを確認し、機密ログの漏洩を防止してください。

---

### 7.7 生成メディアの安全対策

AIシステムが違法、有害、または無許可のメディアコンテンツを生成しないように、ポリシー制約、出力検証、およびトレーサビリティを適用して保証します。

 #7.7.1    レベル: 1    役割: D/V
 システムプロンプトとユーザー指示が、違法、有害、または非同意のディープフェイクメディア（例：画像、動画、音声）の生成を明確に禁止していることを確認してください。
 #7.7.2    レベル: 2    役割: D/V
 プロンプトがなりすまし、性的に露骨なディープフェイク、または同意なしに実在の個人を描写するメディアを生成しようとする試みでフィルタリングされていることを確認してください。
 #7.7.3    レベル: 2    役割: V
 システムが知覚ハッシュ、ウォーターマーク検出、またはフィンガープリンティングを使用して、著作権で保護されたメディアの無許可複製を防止していることを確認してください。
 #7.7.4    レベル: 3    役割: D/V
 すべての生成されたメディアが、下流のトレーサビリティのために暗号的に署名されているか、ウォーターマークが付けられているか、改ざん耐性のあるプロビナンスメタデータが埋め込まれていることを確認してください。
 #7.7.5    レベル: 3    役割: V
 バイパス試行（例：プロンプトの不可解化、スラング、敵対的な言い回し）が検出、ログ記録、およびレート制限されていることを確認してください；繰り返される悪用は監視システムに報告されます。

### 参考文献

NIST AI Risk Management Framework
ISO/IEC 42001:2023 – AI Management System
OWASP Top-10 for Large Language Model Applications (2025)
Improper Output Handling – OWASP LLM05:2025
Practical Techniques to Constrain LLM Output
Dataiku – Structured Text Generation Guide
VL-Uncertainty: Detecting Hallucinations
HaDeMiF: Hallucination Detection & Mitigation
Building Confidence in LLM Outputs
Explainable AI & LLMs
LLM Red-Teaming Guide
Sensitive Information Disclosure in LLMs
LangChain – Chat Model Rate Limiting
OpenAI Rate-Limit & Exponential Back-off
Arize AI – LLM Observability Platform

## C8 メモリ、埋め込み、およびベクターデータベースのセキュリティ

### 管理目標

埋め込みとベクターストアは、現代のAIシステムの「ライブメモリ」として機能し、ユーザーが提供したデータを継続的に受け入れ、Retrieval-Augmented Generation（RAG）を通じてモデルコンテキストに再表示します。これらのメモリが管理されないまま放置されると、PII（個人識別情報）が漏洩したり、同意に違反したり、元のテキストを再構築するために逆利用されたりする可能性があります。この制御ファミリーの目的は、メモリパイプラインとベクトルデータベースを強化し、アクセス権を最小特権に制限し、埋め込み情報をプライバシー保護型にし、保存されたベクトルに有効期限を設定するか要求に応じて取り消し可能にし、かつユーザーごとのメモリが他のユーザーのプロンプトまたは完了結果に混入しないようにすることです。

---

### C8.1 メモリおよびRAGインデックスに関するアクセス制御

すべてのベクターコレクションに対して、細かいアクセス制御を強制してください。

 #8.1.1    レベル: 1    役割: D/V
 テナント、コレクション、またはドキュメントタグごとに、行レベルおよび名前空間レベルのアクセス制御ルールが挿入、削除、およびクエリ操作を制限していることを検証してください。
 #8.1.2    レベル: 1    役割: D/V
 APIキーやJWTがスコープ付きクレーム（例：コレクションID、アクション動詞）を保持しており、少なくとも四半期ごとにローテーションされていることを確認してください。
 #8.1.3    レベル: 2    役割: D/V
 権限昇格試行（例：クロスネームスペース類似性クエリ）が検出され、5分以内にSIEMに記録されることを確認してください。
 #8.1.4    レベル: 2    役割: D/V
 ベクターデータベースの監査ログが、サブジェクト識別子、操作、ベクターID/名前空間、類似度閾値、結果件数を記録していることを確認してください。
 #8.1.5    レベル: 3    役割: V
 エンジンがアップグレードされるかインデックスシャーディングルールが変更されるたびに、アクセス決定がバイパスの脆弱性についてテストされていることを確認してください。

---

### C8.2 埋め込みのサニタイズと検証

ベクトル化の前にテキストをPII（個人識別情報）で事前スクリーニングし、匿名化または仮名化し、必要に応じて後処理で埋め込みから残存シグナルを除去します。

 #8.2.1    レベル: 1    役割: D/V
 PIIおよび規制対象データが自動分類器によって検出され、埋め込み前にマスク処理、トークン化、または削除されることを確認してください。
 #8.2.2    レベル: 1    役割: D
 埋め込みパイプラインが、インデックスを汚染する可能性のある実行可能コードや非UTF-8アーティファクトを含む入力を拒否または隔離することを検証してください。
 #8.2.3    レベル: 2    役割: D/V
 既知のPIIトークンとの距離が設定可能な閾値を下回る文埋め込みに対して、局所的またはメトリック微分プライバシーのサニタイズ処理が適用されていることを検証する。
 #8.2.4    レベル: 2    役割: V
 サニタイズの有効性（例：PII削除の再現率、意味の変化）がベンチマークコーパスに対して少なくとも半年に一度検証されていることを確認してください。
 #8.2.5    レベル: 3    役割: D/V
 サニタイズ設定がバージョン管理されており、変更がピアレビューを経ていることを確認してください。

---

### C8.3 メモリの有効期限、取り消し、および削除

GDPRの「忘れられる権利」や類似の法律は迅速な消去を要求するため、ベクトルストアはTTL、ハードデリート、およびトゥームストーニングをサポートし、取り消されたベクトルが回復または再インデックス化されないようにする必要があります。

 #8.3.1    レベル: 1    役割: D/V
 すべてのベクターおよびメタデータレコードが、TTLまたは自動クリーンアップジョブで遵守される明示的な保持ラベルを持っていることを確認してください。
 #8.3.2    レベル: 1    役割: D/V
 ユーザーが開始した削除リクエストが、30日以内にベクトル、メタデータ、キャッシュのコピー、および派生インデックスを完全に削除することを検証してください。
 #8.3.3    レベル: 2    役割: D
 ハードウェアが対応している場合はストレージブロックの暗号破棄に続き、そうでなければキー保管庫のキー破棄に続くことを論理削除後に検証してください。
 #8.3.4    レベル: 3    役割: D/V
 期限切れのベクトルが期限切れ後500ms以内に最近傍検索結果から除外されることを検証してください。

---

### C8.4 埋め込みの逆変換と漏洩の防止

最近の防御手法—ノイズ重畳、射影ネットワーク、プライバシーニューロン摂動、およびアプリケーション層暗号化—は、トークンレベルの逆転率を5％以下に削減できます。

 #8.4.1    レベル: 1    役割: V
 反転攻撃、メンバーシップ攻撃、属性推測攻撃を網羅した正式な脅威モデルが存在し、毎年レビューされていることを確認する。
 #8.4.2    レベル: 2    役割: D/V
 アプリケーション層暗号化または検索可能暗号化が、インフラ管理者やクラウドスタッフによるベクターの直接読み取りから保護していることを検証してください。
 #8.4.3    レベル: 3    役割: V
 防御パラメータ（DPのε、ノイズのσ、射影ランクk）がプライバシー≥99％のトークン保護とユーティリティ≤3％の精度低下のバランスを保っていることを検証してください。
 #8.4.4    レベル: 3    役割: D/V
 モデルアップデートのリリースゲートに反転耐性メトリクスが含まれていることを、回帰予算が定義されている状態で検証してください。

---

### C8.5 ユーザー固有のメモリに対するスコープの強制

テナント間の情報漏洩は依然として主要なRAGリスクです。不適切にフィルタリングされた類似性クエリにより、他の顧客のプライベートドキュメントが表示される可能性があります。

 #8.5.1    レベル: 1    役割: D/V
 すべての検索クエリがLLMプロンプトに渡される前に、テナント/ユーザーIDで事後フィルタリングされていることを確認してください。
 #8.5.2    レベル: 1    役割: D
 コレクション名または名前空間付きIDが、ユーザーまたはテナントごとにソルト化されていることを確認し、スコープ間でベクトルが衝突しないようにします。
 #8.5.3    レベル: 2    役割: D/V
 設定可能な距離閾値を超え、かつ呼び出し元のスコープ外にある類似性の結果が破棄され、セキュリティアラートを引き起こすことを検証してください。
 #8.5.4    レベル: 2    役割: V
 マルチテナントストレステストが、範囲外のドキュメントを取得しようとする敵対的なクエリをシミュレートし、情報漏洩がないことを実証していることを確認してください。
 #8.5.5    レベル: 3    役割: D/V
 暗号化鍵がテナントごとに分離されていることを確認し、物理的なストレージが共有されていても暗号学的な分離が確保されていることを保証します。

---

### C8.6 高度なメモリシステムセキュリティ

エピソード記憶、意味記憶、作業記憶を含む高度なメモリアーキテクチャに対する、特定の分離および検証要件を伴うセキュリティ制御。

 #8.6.1    レベル: 1    役割: D/V
 異なるメモリタイプ（エピソード記憶、意味記憶、作業記憶）が、役割ベースのアクセス制御、個別の暗号鍵、および各メモリタイプのアクセスパターンの文書化とともに分離されたセキュリティコンテキストを持っていることを検証してください。
 #8.6.2    レベル: 2    役割: D/V
 記憶統合プロセスには、保存前にコンテンツのサニタイズ、ソースの検証、および整合性チェックを通じて悪意のある記憶の注入を防ぐためのセキュリティ検証が含まれていることを確認してください。
 #8.6.3    レベル: 2    役割: D/V
 メモリ検索クエリが検証およびサニタイズされ、不正な情報抽出を防止するために、クエリパターン解析、アクセス制御の適用、および結果フィルタリングが行われていることを確認してください。
 #8.6.4    レベル: 3    役割: D/V
 メモリ忘却メカニズムが、キー削除、多重上書き、または検証証明書付きのハードウェアベースの安全な削除を使用して、暗号消去の保証とともに機密情報を安全に削除することを検証してください。
 #8.6.5    レベル: 3    役割: D/V
 メモリ内容が通常の操作外で変更された場合にチェックサム、監査ログ、および自動アラートを使用して、不正な変更や破損があるかどうかメモリシステムの整合性が継続的に監視されていることを検証してください。

---

### 参考文献

Vector database security: Pinecone – IronCore Labs
Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera
Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances
Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv
DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview
Art. 17 GDPR – Right to Erasure
Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai
PII Identification and Removal – NVIDIA NeMo Docs
De-identifying Sensitive Data – Google Cloud DLP
Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails
Think Your RAG Is Secure? Think Again – Medium
Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn
Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog

## 9 自律的オーケストレーションとエージェンシー行動のセキュリティ

### 管理目標

自律型またはマルチエージェントAIシステムが、明示的に意図され、認証され、監査可能であり、かつ限定されたコストおよびリスクの閾値内でのみ行動を実行できるようにすることを保証します。これにより、自律システムの侵害、ツールの誤使用、エージェントループの検出、通信の乗っ取り、アイデンティティのなりすまし、群れの操作、意図の操作などの脅威から保護されます。

---

### 9.1 エージェントのタスク計画および再帰予算

再帰的な計画の実行を制限し、特権アクションに対して人間によるチェックポイントを強制する。

 #9.1.1    レベル: 1    役割: D/V
 最大再帰深度、幅、実時間、トークン数、およびエージェント実行ごとの金銭コストが中央で設定され、バージョン管理されていることを確認してください。
 #9.1.2    レベル: 1    役割: D/V
 特権的または不可逆的な操作（例：コードコミット、金融取引）については、実行前に監査可能なチャネルを通じて明示的な人間の承認が必要であることを確認してください。
 #9.1.3    レベル: 2    役割: D
 リアルタイムのリソースモニターがいずれかの予算閾値を超えた場合にサーキットブレーカーの中断をトリガーし、さらなるタスク拡張を停止することを検証する。
 #9.1.4    レベル: 2    役割: D/V
 サーキットブレーカーのイベントが、フォレンジックレビューのためにエージェントID、トリガー条件、およびキャプチャされたプラン状態と共にログ記録されていることを確認してください。
 #9.1.5    レベル: 3    役割: V
 セキュリティテストが予算枯渇および無制限プランのシナリオをカバーしており、データ損失なしに安全に停止することを確認してください。
 #9.1.6    レベル: 3    役割: D
 予算ポリシーがポリシー・アズ・コードとして表現され、CI/CDで強制されて構成のドリフトを防止していることを検証してください。

---

### 9.2 ツールプラグインのサンドボックス化

不正なシステムアクセスやコード実行を防ぐために、ツールの操作を分離してください。

 #9.2.1    レベル: 1    役割: D/V
 すべてのツール/プラグインが、最小権限のファイルシステム、ネットワーク、およびシステムコールポリシーを適用したOS、コンテナ、またはWASMレベルのサンドボックス内で実行されることを確認してください。
 #9.2.2    レベル: 1    役割: D/V
 サンドボックスのリソースクォータ（CPU、メモリ、ディスク、ネットワーク送信）と実行タイムアウトが適用され、ログに記録されていることを確認してください。
 #9.2.3    レベル: 2    役割: D/V
 ツールのバイナリまたは記述子がデジタル署名されていることを確認し、読み込み前に署名が検証されることを保証してください。
 #9.2.4    レベル: 2    役割: V
 サンドボックスのテレメトリがSIEMにストリーミングされることを検証し、異常（例：試みられたアウトバウンド接続）がアラートを発することを確認してください。
 #9.2.5    レベル: 3    役割: V
 高リスクのプラグインが本番環境に展開される前に、セキュリティレビューおよびペネトレーションテストを受けていることを確認してください。
 #9.2.6    レベル: 3    役割: D/V
 サンドボックスの脱出試行が自動的にブロックされ、違反したプラグインが調査待ちで隔離されることを確認してください。

---

### 9.3 自律ループとコスト制限

エージェント間の制御不能な再帰とコストの爆発を検知し、停止します。

 #9.3.1    レベル: 1    役割: D/V
 エージェント間の呼び出しに、ランタイムが減算および適用するホップ制限またはTTLが含まれていることを確認してください。
 #9.3.2    レベル: 2    役割: D
 エージェントが自己呼び出しや循環パターンを検出するために、一意のインボケーショングラフIDを維持していることを検証してください。
 #9.3.3    レベル: 2    役割: D/V
 累積のコンピュートユニットおよび支出カウンターがリクエストチェーンごとに追跡されていることを確認してください。制限を超えた場合、チェーンは中断されます。
 #9.3.4    レベル: 3    役割: V
 形式的解析またはモデル検査によって、エージェントプロトコルにおける無限再帰の不在が示されていることを確認してください。
 #9.3.5    レベル: 3    役割: D
 ループ中断イベントがアラートを生成し、継続的改善のメトリクスに反映されることを確認してください。

---

### 9.4 プロトコルレベルの誤用防止

エージェントと外部システム間の通信チャネルを安全にし、ハイジャックや操作を防止する。

 #9.4.1    レベル: 1    役割: D/V
 すべてのエージェントからツールおよびエージェント間のメッセージが認証されていること（例：相互TLSまたはJWT）およびエンドツーエンドで暗号化されていることを検証してください。
 #9.4.2    レベル: 1    役割: D
 スキーマが厳密に検証されていることを確認し、未知のフィールドや不正なメッセージは拒否されるようにしてください。
 #9.4.3    レベル: 2    役割: D/V
 完全なメッセージペイロード（ツールパラメータを含む）を対象とする整合性チェック（MACまたはデジタル署名）を検証してください。
 #9.4.4    レベル: 2    役割: D
 リプレイ保護（ノンスまたはタイムスタンプウィンドウ）がプロトコル層で適用されていることを確認してください。
 #9.4.5    レベル: 3    役割: V
 プロトコルの実装が注入またはデシリアライズの脆弱性に対してファジングおよび静的解析を受けていることを検証してください。

---

### 9.5 エージェントのアイデンティティと改ざん検知

操作が帰属可能であり、変更が検出可能であることを保証してください。

 #9.5.1    レベル: 1    役割: D/V
 各エージェントインスタンスが一意の暗号学的アイデンティティ（鍵ペアまたはハードウェアルート認証情報）を持っていることを検証する。
 #9.5.2    レベル: 2    役割: D/V
 すべてのエージェントのアクションに署名とタイムスタンプが付与されていることを確認し、ログには否認防止のための署名が含まれていることを検証してください。
 #9.5.3    レベル: 2    役割: V
 改ざん検知可能なログが追記専用または一度書き込み専用の媒体に保存されていることを検証してください。
 #9.5.4    レベル: 3    役割: D
 アイデンティティキーが定められたスケジュールおよび侵害指標に基づいてローテーションされることを検証する。
 #9.5.5    レベル: 3    役割: D/V
 なりすましやキー衝突の試みが検知された場合、影響を受けたエージェントを即座に隔離することを確認してください。

---

### 9.6 マルチエージェントスウォームリスク低減

集団行動による危険を、隔離と形式的安全モデリングによって軽減する。

 #9.6.1    レベル: 1    役割: D/V
 異なるセキュリティドメインで動作するエージェントが、分離されたランタイムサンドボックスまたはネットワークセグメントで実行されていることを検証してください。
 #9.6.2    レベル: 3    役割: V
 スウォーム行動がモデリングされ、展開前にライブネスと安全性について形式的に検証されていることを確認してください。
 #9.6.3    レベル: 3    役割: D
 ランタイムモニターが新たに発生する安全でないパターン（例：振動、デッドロック）を検出し、是正措置を開始することを確認してください。

---

### 9.7 ユーザーおよびツールの認証／認可

すべてのエージェント起動アクションに対して堅牢なアクセス制御を実装してください。

 #9.7.1    レベル: 1    役割: D/V
 エージェントが下流システムに対して第一級プリンシパルとして認証し、エンドユーザーの資格情報を決して再利用しないことを確認してください。
 #9.7.2    レベル: 2    役割: D
 細粒度の認可ポリシーが、エージェントが呼び出せるツールと供給できるパラメータを制限していることを検証してください。
 #9.7.3    レベル: 2    役割: V
 特権チェックがセッション開始時だけでなく、すべての呼び出し時に再評価されること（継続的な認可）を確認してください。
 #9.7.4    レベル: 3    役割: D
 委任された権限が自動的に期限切れとなり、タイムアウトまたはスコープの変更後に再同意が必要であることを確認してください。

---

### 9.8 エージェント間通信のセキュリティ

すべてのエージェント間メッセージを暗号化し、完全性を保護して、盗聴や改ざんを防止します。

 #9.8.1    レベル: 1    役割: D/V
 エージェントチャネルに対して、相互認証および完全前方秘匿暗号化（例：TLS 1.3）が必須であることを確認してください。
 #9.8.2    レベル: 1    役割: D
 メッセージの整合性と発信元が処理前に検証されていることを確認してください。検証に失敗した場合はアラートを発し、メッセージを破棄します。
 #9.8.3    レベル: 2    役割: D/V
 通信メタデータ（タイムスタンプ、シーケンス番号）がログに記録され、フォレンジック再構築をサポートしていることを確認してください。
 #9.8.4    レベル: 3    役割: V
 正式な検証またはモデルチェックにより、プロトコルの状態機械が安全でない状態に遷移できないことを確認します。

---

### 9.9 意図の検証と制約の強制

エージェントの行動がユーザーの明示された意図およびシステムの制約に一致していることを検証する。

 #9.9.1    レベル: 1    役割: D
 事前実行制約ソルバーが、提案されたアクションをハードコードされた安全性およびポリシールールに照らして検証することを確認してください。
 #9.9.2    レベル: 2    役割: D/V
 ハイインパクトな操作（財務、破壊的、プライバシーに敏感な操作）には、実行するユーザーからの明示的な意図確認が必要であることを検証してください。
 #9.9.3    レベル: 2    役割: V
 事後条件のチェックにより、完了した操作が意図した効果を副作用なく達成していることを検証し、不一致があればロールバックを引き起こすことを確認する。
 #9.9.4    レベル: 3    役割: V
 形式手法（例：モデル検査、定理証明）またはプロパティベースのテストが、エージェントの計画がすべての宣言された制約を満たしていることを示すことを検証します。
 #9.9.5    レベル: 3    役割: D
 インテントの不一致や制約違反のインシデントが継続的改善サイクルおよび脅威インテリジェンス共有に反映されることを確認してください。

---

### 9.10 エージェント推論戦略のセキュリティ

ReAct、Chain-of-Thought、および Tree-of-Thoughts アプローチを含むさまざまな推論戦略の安全な選択と実行。

 #9.10.1    レベル: 1    役割: D/V
 推論戦略の選択が決定論的な基準（入力の複雑さ、タスクの種類、セキュリティコンテキスト）を使用していること、および同一のセキュリティコンテキスト内で同一の入力に対しては同一の戦略選択が行われることを検証してください。
 #9.10.2    レベル: 1    役割: D/V
 各推論戦略（ReAct、Chain-of-Thought、Tree-of-Thoughts）には、それぞれの認知アプローチに特化した入力検証、出力サニタイズ、および実行時間制限が設けられていることを確認してください。
 #9.10.3    レベル: 2    役割: D/V
 推論戦略の遷移が、監査証跡の再構築のために、入力特性、選択基準の値、および実行メタデータを含む完全なコンテキストとともに記録されていることを検証してください。
 #9.10.4    レベル: 2    役割: D/V
 Tree-of-Thoughts推論には、ポリシー違反、リソース制限、安全境界が検出された場合に探索を終了する分岐剪定メカニズムが含まれていることを検証してください。
 #9.10.5    レベル: 2    役割: D/V
 ReAct（Reason-Act-Observe）サイクルには、それぞれの段階で検証チェックポイントが含まれていることを確認してください。具体的には、推論ステップの検証、行動の承認、および次の段階に進む前の観察のサニタイズです。
 #9.10.6    レベル: 3    役割: D/V
 推論戦略のパフォーマンス指標（実行時間、リソース使用量、出力品質）が、指標が設定した閾値を超えて逸脱した場合に自動アラートで監視されていることを確認してください。
 #9.10.7    レベル: 3    役割: D/V
 複数の戦略を組み合わせたハイブリッド推論アプローチが、いかなるセキュリティコントロールも回避することなく、すべての構成戦略の入力検証および出力制約を維持していることを確認してください。
 #9.10.8    レベル: 3    役割: D/V
 推論戦略のセキュリティテストには、異常な入力を用いたファジング、戦略の切り替えを強制する敵対的プロンプト、および各認知アプローチの境界条件テストが含まれていることを検証してください。

---

### 9.11 エージェントライフサイクル状態管理とセキュリティ

暗号監査証跡と定義された復旧手順を備えた安全なエージェント初期化、状態遷移、および終了。

 #9.11.1    レベル: 1    役割: D/V
 エージェントの初期化には、ハードウェア対応の資格情報を用いた暗号学的アイデンティティの確立と、エージェントID、タイムスタンプ、構成ハッシュ、および初期化パラメータを含む不変の起動監査ログが含まれていることを検証してください。
 #9.11.2    レベル: 2    役割: D/V
 エージェントの状態遷移が暗号署名され、タイムスタンプが付けられ、トリガーイベント、前の状態ハッシュ、新しい状態ハッシュ、実行されたセキュリティ検証を含む完全なコンテキストと共にログ記録されていることを確認してください。
 #9.11.3    レベル: 2    役割: D/V
 エージェントのシャットダウン手順に、暗号消去または多重上書きを用いた安全なメモリ消去、証明書機関への通知を伴う資格情報の取り消し、および改ざん検出可能な終了証明書の生成が含まれていることを確認してください。
 #9.11.4    レベル: 3    役割: D/V
 エージェントの回復メカニズムが、暗号化チェックサム（最低でもSHA-256）を使用して状態の整合性を検証し、破損が検出された場合に既知の正常な状態にロールバックすることを、 自動アラートおよび手動承認要件とともに確認してください。
 #9.11.5    レベル: 3    役割: D/V
 エージェントの永続化メカニズムが、エージェントごとのAES-256キーを使用して機密状態データを暗号化し、設定可能なスケジュール（最大90日）での安全なキーのローテーションを無停止で展開することを確認してください。

---

### 9.12 ツール統合セキュリティフレームワーク

定義されたリスク評価および承認プロセスを伴う、動的ツールのロード、実行、および結果検証に対するセキュリティ対策。

 #9.12.1    レベル: 1    役割: D/V
 ツール記述子に、必要な権限（読み取り/書き込み/実行）、リスクレベル（低/中/高）、リソース制限（CPU、メモリ、ネットワーク）、およびツールマニフェストに記載された検証要件を含むセキュリティメタデータが含まれていることを確認してください。
 #9.12.2    レベル: 1    役割: D/V
 ツールの実行結果が統合される前に、期待されるスキーマ（JSONスキーマ、XMLスキーマ）およびセキュリティポリシー（出力のサニタイズ、データ分類）に対して検証されていることを確認し、タイムアウト制限とエラー処理手順を適用します。
 #9.12.3    レベル: 2    役割: D/V
 ツールの操作ログが、権限の使用状況、データアクセスパターン、実行時間、リソース消費量、戻りコードなどの詳細なセキュリティコンテキストを含み、SIEM統合のための構造化ログ記録になっていることを検証してください。
 #9.12.4    レベル: 2    役割: D/V
 動的ツール読み込みメカニズムがPKIインフラストラクチャを使用してデジタル署名を検証し、実行前にサンドボックス分離と権限検証を伴う安全な読み込みプロトコルを実装していることを確認してください。
 #9.12.5    レベル: 3    役割: D/V
 新しいバージョンに対して、静的解析、動的テスト、およびセキュリティチームのレビューを含む必須の承認ゲートを伴うツールのセキュリティ評価が自動的にトリガーされ、承認基準とSLA要件が文書化されていることを確認してください。

---

#### 参考文献

MITRE ATLAS tactics ML09
Circuit-breaker research for AI agents — Zou et al., 2024
Trend Micro analysis of sandbox escapes in AI agents — Park, 2025
Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025
Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025
Rapid7 fundamentals on spoofing attack prevention — 2024
Imperial College verification of swarm systems — Lomuscio et al.
NIST AI Risk Management Framework 1.0, 2023
WIRED security briefing on encryption best practices, 2024
OWASP Top 10 for LLM Applications, 2025
Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS
[How Is LLM Reasoning Distracted by Irrelevant Context?
An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
Large Language Model Sentinel: LLM Agent for Adversarial Purification
Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents

## 10 敵対的堅牢性とプライバシー防御

### 管理目標

AIモデルが回避攻撃、推論攻撃、抽出攻撃、または毒性攻撃に直面した場合でも、信頼性があり、プライバシーを保護し、不正利用に強い状態を維持することを保証してください。

---

### 10.1 モデルの整合性と安全性

有害またはポリシー違反の出力に対して防御する。

 #10.1.1    レベル: 1    役割: D/V
 アラインメントテストスイート（レッドチームプロンプト、脱獄プローブ、不許可コンテンツ）がバージョン管理されており、すべてのモデルリリースで実行されていることを確認してください。
 #10.1.2    レベル: 1    役割: D
 拒否および安全完了のガードレールが適用されていることを確認してください。
 #10.1.3    レベル: 2    役割: D/V
 自動評価器が有害コンテンツの割合を測定し、設定された閾値を超えるリグレッションを検出していることを確認してください。
 #10.1.4    レベル: 2    役割: D
 カウンタージェイルブレイクトレーニングが文書化され、再現可能であることを確認してください。
 #10.1.5    レベル: 3    役割: V
 正式なポリシー準拠証明または認定された監視が、重要な領域をカバーしていることを確認してください。

---

### 10.2 敵対的例の堅牢化

操作された入力に対する耐性を強化する。堅牢な敵対的トレーニングとベンチマークスコアリングが、現在の最良の手法である。

 #10.2.1    レベル: 1    役割: D
 プロジェクトのリポジトリに、再現可能なシードを用いた敵対的トレーニング構成が含まれていることを確認してください。
 #10.2.2    レベル: 2    役割: D/V
 対抗例検出が本番パイプラインでブロッキングアラートを発生させることを検証する。
 #10.2.4    レベル: 3    役割: V
 認証された堅牢性の証明または区間境界証明書が、少なくとも最も重要なクラスをカバーしていることを確認してください。
 #10.2.5    レベル: 3    役割: V
 回帰テストが適応攻撃を使用して、測定可能なロバストネスの損失がないことを確認していることを検証してください。

---

### 10.3 メンバーシップ推論緩和

レコードが訓練データに含まれていたかどうかを判断する能力を制限する。差分プライバシーと信頼度スコアのマスキングが、最も効果的に知られている防御手段である。

 #10.3.1    レベル: 1    役割: D
 クエリごとのエントロピー正則化または温度スケーリングが過度に自信のある予測を減少させることを検証してください。
 #10.3.2    レベル: 2    役割: D
 機微なデータセットに対して、ε-境界付き差分プライベート最適化がトレーニングに用いられていることを検証してください。
 #10.3.3    レベル: 2    役割: V
 攻撃シミュレーション（シャドウモデルまたはブラックボックス）が保留データに対して攻撃AUC ≤ 0.60を示すことを検証してください。

---

### 10.4 モデル反転耐性

プライベート属性の再構築を防止する。最近の調査では、出力の切り捨てとDP保証が実用的な防御策として強調されている。

 #10.4.1    レベル: 1    役割: D
 敏感な属性が決して直接出力されないことを確認し、必要に応じてバケット化や一方向変換を使用してください。
 #10.4.2    レベル: 1    役割: D/V
 同じ主体からの繰り返される適応的クエリがクエリレート制限によって制御されていることを確認してください。
 #10.4.3    レベル: 2    役割: D
 モデルがプライバシー保護のためのノイズで学習されていることを検証してください。

---

### 10.5 モデル抽出防御

不正なクローン作成を検出し防止します。ウォーターマーキングとクエリパターン分析が推奨されます。

 #10.5.1    レベル: 1    役割: D
 推論ゲートウェイが、モデルの記憶閾値に調整されたグローバルおよびAPIキーごとのレート制限を強制していることを検証してください。
 #10.5.2    レベル: 2    役割: D/V
 クエリエントロピーと入力複数性の統計が自動抽出検出器に供給されることを検証してください。
 #10.5.3    レベル: 2    役割: V
 壊れやすいまたは確率的な透かしは、疑わしいクローンに対して1000回以下の問い合わせでp < 0.01で証明できることを確認してください。
 #10.5.4    レベル: 3    役割: D
 ウォーターマークキーとトリガーセットがハードウェアセキュリティモジュールに保存され、毎年ローテーションされていることを確認してください。
 #10.5.5    レベル: 3    役割: V
 抽出アラートイベントに違反クエリが含まれていることを確認し、インシデント対応プレイブックと統合されていることを確認してください。

---

### 10.6 推論時の毒物データ検出

バックドアや汚染された入力を識別し、中和します。

 #10.6.1    レベル: 1    役割: D
 モデル推論の前に、入力が異常検知器（例：STRIP、一貫性スコアリング）を通過することを確認してください。
 #10.6.2    レベル: 1    役割: V
 検出器の閾値がクリーン/汚染された検証セットで調整され、誤検知率が5%未満になることを確認してください。
 #10.6.3    レベル: 2    役割: D
 入力が汚染されているとフラグ付けされた場合に、ソフトブロックおよび人間によるレビューのワークフローがトリガーされることを確認してください。
 #10.6.4    レベル: 2    役割: V
 検出器が適応型でトリガーレスのバックドア攻撃によってストレステストされていることを検証してください。
 #10.6.5    レベル: 3    役割: D
 検出効果指標が記録され、新しい脅威インテリジェンスで定期的に再評価されていることを確認してください。

---

### 10.7 動的セキュリティポリシー適応

脅威インテリジェンスと行動分析に基づくリアルタイムのセキュリティポリシー更新。

 #10.7.1    レベル: 1    役割: D/V
 エージェントを再起動せずにセキュリティポリシーを動的に更新でき、ポリシーバージョンの整合性が維持されることを検証してください。
 #10.7.2    レベル: 2    役割: D/V
 ポリシーの更新が認可されたセキュリティ担当者によって暗号的に署名され、適用前に検証されていることを確認してください。
 #10.7.3    レベル: 2    役割: D/V
 動的ポリシー変更が、正当な理由、承認の連鎖、ロールバック手順を含む完全な監査証跡とともに記録されていることを確認してください。
 #10.7.4    レベル: 3    役割: D/V
 適応型セキュリティメカニズムがリスクコンテキストおよび行動パターンに基づいて脅威検出の感度を調整することを検証してください。
 #10.7.5    レベル: 3    役割: D/V
 ポリシー適応の決定が説明可能であり、セキュリティチームのレビューのための証拠のトレイルを含むことを確認してください。

---

### 10.8 リフレクションベースのセキュリティ分析

エージェントの自己反省とメタ認知分析によるセキュリティ検証。

 #10.8.1    レベル: 1    役割: D/V
 エージェントの反省メカニズムに、決定と行動に対するセキュリティに焦点を当てた自己評価が含まれていることを確認してください。
 #10.8.2    レベル: 2    役割: D/V
 反射出力が検証され、敵対的入力による自己評価メカニズムの操作を防止していることを確認してください。
 #10.8.3    レベル: 2    役割: D/V
 メタ認知的セキュリティ分析がエージェントの推論プロセスにおける潜在的なバイアス、操作、または妥協を特定することを検証する。
 #10.8.4    レベル: 3    役割: D/V
 リフレクションベースのセキュリティ警告が、強化された監視および潜在的な人間による介入ワークフローを引き起こすことを検証してください。
 #10.8.5    レベル: 3    役割: D/V
 セキュリティ反省からの継続的な学習が、正当な機能を損なうことなく脅威検出を向上させることを検証する。

---

### 10.9 進化と自己改善のセキュリティ

自己修正および進化が可能なエージェントシステムのためのセキュリティ制御。

 #10.9.1    レベル: 1    役割: D/V
 自己修正機能が指定された安全な領域内に制限されており、正式な検証境界が設けられていることを確認してください。
 #10.9.2    レベル: 2    役割: D/V
 進化提案が実装前にセキュリティ影響評価を受けることを検証してください。
 #10.9.3    レベル: 2    役割: D/V
 自己改善メカニズムに、整合性検証を伴うロールバック機能が含まれていることを確認してください。
 #10.9.4    レベル: 3    役割: D/V
 メタラーニングのセキュリティが、改善アルゴリズムの敵対的操作を防止することを検証する。
 #10.9.5    レベル: 3    役割: D/V
 再帰的な自己改善が数学的な収束証明を伴う形式的な安全制約によって制限されていることを検証する。

---

#### 参考文献

MITRE ATLAS adversary tactics for ML
NIST AI Risk Management Framework 1.0, 2023
OWASP Top 10 for LLM Applications, 2025
Adversarial Training: A Survey — Zhao et al., 2024
RobustBench adversarial-robustness benchmark
Membership-Inference & Model-Inversion Risk Survey, 2025
PURIFIER: Confidence-Score Defense against MI Attacks — AAAI 2023
Model-Inversion Attacks & Defenses Survey — AI Review, 2025
Comprehensive Defense Framework Against Model Extraction — IEEE TDSC 2024
Fragile Model Watermarking Survey — 2025
Data Poisoning in Deep Learning: A Survey — Zhao et al., 2025
BDetCLIP: Multimodal Prompting Backdoor Detection — Niu et al., 2024

## 11 プライバシー保護と個人データ管理

### 管理目標

収集、トレーニング、推論、インシデント対応など、AIライフサイクル全体にわたって厳格なプライバシー保証を維持し、個人データが明確な同意、最小限の必要範囲での処理、証明可能な消去、および正式なプライバシー保証のもとでのみ処理されるようにします。

---

### 11.1 匿名化とデータ最小化

 #11.1.1    レベル: 1    役割: D/V
 直接識別子および準識別子が削除され、ハッシュ化されていることを確認してください。
 #11.1.2    レベル: 2    役割: D/V
 自動監査がk-匿名性/l-多様性を測定し、しきい値がポリシーを下回った場合に警告を発することを検証してください。
 #11.1.3    レベル: 2    役割: V
 モデルの特徴重要度レポートが、ε = 0.01の相互情報量を超える識別子リークがないことを証明していることを検証してください。
 #11.1.4    レベル: 3    役割: V
 形式的な証明または合成データの認証が、リンク攻撃下でも再識別リスクが0.05以下であることを示していることを確認してください。

---

### 11.2 忘れられる権利および削除の強制管理

 #11.2.1    レベル: 1    役割: D/V
 データ主体の削除要求が、生データセット、チェックポイント、埋め込み、ログ、およびバックアップに30日未満のサービスレベル合意内で適切に反映されることを確認してください。
 #11.2.2    レベル: 2    役割: D
 「machine-unlearning」ルーチンが、認定されたアンラーニングアルゴリズムを使用して物理的に再トレーニングまたは近似的な除去を行うことを検証してください。
 #11.2.3    レベル: 2    役割: V
 シャドウモデル評価により、忘却後に忘れられたレコードの影響が出力の1%未満であることを検証する。
 #11.2.4    レベル: 3    役割: V
 削除イベントが不変的に記録され、規制当局が監査可能であることを確認してください。

---

### 11.3 差分プライバシー保護策

 #11.3.1    レベル: 2    役割: D/V
 累積εがポリシーの閾値を超えたときにプライバシー損失会計ダッシュボードがアラートを発することを確認してください。
 #11.3.2    レベル: 2    役割: V
 ブラックボックスプライバシー監査が宣言された値の10％以内でε̂を推定していることを検証する。
 #11.3.3    レベル: 3    役割: V
 形式的証明がすべての事後トレーニングのファインチューニングおよび埋め込みを網羅していることを検証する。

---

### 11.4 目的制限およびスコープクリープ防止

 #11.4.1    レベル: 1    役割: D
 すべてのデータセットおよびモデルチェックポイントが、元の同意に沿った機械可読の目的タグを持っていることを確認してください。
 #11.4.2    レベル: 1    役割: D/V
 ランタイムモニターが、宣言された目的と矛盾するクエリを検出し、ソフト拒否をトリガーすることを検証する。
 #11.4.3    レベル: 3    役割: D
 ポリシー・アズ・コードのゲートが、DPIAレビューなしでモデルの新しいドメインへの再展開をブロックすることを検証してください。
 #11.4.4    レベル: 3    役割: V
 正式なトレーサビリティ証明が、すべての個人データライフサイクルが同意された範囲内に留まることを示していることを検証してください。

---

### 11.5 同意管理と合法的根拠の追跡

 #11.5.1    レベル: 1    役割: D/V
 コンセント管理プラットフォーム（CMP）が、データ主体ごとにオプトインの状態、目的、および保持期間を記録していることを確認してください。
 #11.5.2    レベル: 2    役割: D
 APIが同意トークンを公開していることを確認してください。モデルは推論前にトークンスコープを検証する必要があります。
 #11.5.3    レベル: 2    役割: D/V
 同意が拒否または撤回された場合、24時間以内に処理パイプラインが停止することを確認してください。

---

### 11.6 プライバシー制御を伴うフェデレーテッドラーニング

 #11.6.1    レベル: 1    役割: D
 クライアントの更新が集約前にローカル差分プライバシーのノイズ付加を適用していることを検証してください。
 #11.6.2    レベル: 2    役割: D/V
 トレーニングメトリクスが差分プライバシーを保護しており、単一クライアントの損失を決して明らかにしないことを検証してください。
 #11.6.3    レベル: 2    役割: V
 ポイズニング耐性のある集約（例：Krum、Trimmed-Mean）が有効になっていることを確認してください。
 #11.6.4    レベル: 3    役割: V
 形式的証明が全体のε予算を示し、ユーティリティ損失が5未満であることを検証する。

---

#### 参考文献

GDPR & AI Compliance Best Practices
EU Parliament Study on GDPR & AI, 2020
ISO 31700-1:2023 — Privacy by Design for Consumer Products
NIST Privacy Framework 1.1 (2025 Draft)
Machine Unlearning: Right-to-Be-Forgotten Techniques
A Survey of Machine Unlearning, 2024
Auditing DP-SGD — ArXiv 2024
DP-SGD Explained — PyTorch Blog
Purpose-Limitation for AI — IJLIT 2025
Data-Protection Considerations for AI — URM Consulting
Top Consent-Management Platforms, 2025
Secure Aggregation in DP Federated Learning — ArXiv 2024

## C12 監視、ログ記録、および異常検知

### 管理目標

このセクションでは、モデルやその他のAIコンポーネントが何を見て、何を行い、何を返すかに関してリアルタイムおよびフォレンジックの可視性を提供するための要件を示しており、これにより脅威を検出、トリアージ、学習することが可能になります。

### C12.1 リクエストとレスポンスのログ記録

 #12.1.1    レベル: 1    役割: D/V
 すべてのユーザープロンプトとモデルの応答が、適切なメタデータ（例：タイムスタンプ、ユーザーID、セッションID、モデルバージョン）とともにログに記録されていることを確認する。
 #12.1.2    レベル: 1    役割: D/V
 ログが適切な保持ポリシーとバックアップ手順を備えた、安全でアクセス制御されたリポジトリに保存されていることを確認してください。
 #12.1.3    レベル: 1    役割: D/V
 ログストレージシステムが、ログに含まれる機密情報を保護するために、静止時および転送時の暗号化を実装していることを確認してください。
 #12.1.4    レベル: 1    役割: D/V
 プロンプトおよび出力内の機密データが、ログ記録前に自動的に編集またはマスクされることを検証し、PII、認証情報、および独自情報に対する設定可能な編集ルールを備えていることを確認してください。
 #12.1.5    レベル: 2    役割: D/V
 ポリシーの決定および安全フィルタリングのアクションが、コンテンツモデレーションシステムの監査およびデバッグを可能にする十分な詳細で記録されていることを確認してください。
 #12.1.6    レベル: 2    役割: D/V
 例えば、暗号署名や書き込み専用ストレージを通じてログの整合性が保護されていることを確認してください。

---

### C12.2 不正利用検出とアラート発報

 #12.2.1    レベル: 1    役割: D/V
 システムが署名ベースの検出を使用して、既知の脱獄パターン、プロンプトインジェクションの試み、および敵対的入力を検出し、警告を発することを確認してください。
 #12.2.2    レベル: 1    役割: D/V
 システムが標準のログ形式およびプロトコルを使用して、既存のセキュリティ情報およびイベント管理（SIEM）プラットフォームと統合されていることを確認してください。
 #12.2.3    レベル: 2    役割: D/V
 強化されたセキュリティイベントに、モデル識別子、信頼度スコア、安全フィルターの判断など、AI固有のコンテキストが含まれていることを確認してください。
 #12.2.4    レベル: 2    役割: D/V
 行動異常検出が異常な会話パターン、過剰な再試行回数、または体系的なプロービング行動を特定することを確認してください。
 #12.2.5    レベル: 2    役割: D/V
 潜在的なポリシー違反や攻撃の試みが検出された際に、リアルタイムのアラート機構がセキュリティチームに通知することを確認してください。
 #12.2.6    レベル: 2    役割: D/V
 AI特有の脅威パターンを検出するために、協調的なジェイルブレイク試行、プロンプトインジェクションキャンペーン、およびモデル抽出攻撃を含むカスタムルールが含まれていることを確認してください。
 #12.2.7    レベル: 3    役割: D/V
 自動化されたインシデント対応ワークフローが、侵害されたモデルを隔離し、悪意のあるユーザーをブロックし、重要なセキュリティイベントをエスカレートできることを検証する。

---

### C12.3 モデルドリフト検出

 #12.3.1    レベル: 1    役割: D/V
 システムが精度、信頼度スコア、レイテンシ、およびエラーレートなどの基本的なパフォーマンス指標をモデルのバージョンや期間にわたって追跡していることを検証してください。
 #12.3.2    レベル: 2    役割: D/V
 パフォーマンス指標が事前に定義された劣化閾値を超えるか、基準値から大幅に逸脱した場合に、自動アラートがトリガーされることを検証してください。
 #12.3.3    レベル: 2    役割: D/V
 モデルの出力に事実誤認、不整合、または捏造された情報が含まれている場合に、その事例を特定して警告する幻覚検出モニターが機能していることを確認してください。

---

### C12.4 パフォーマンスおよび動作テレメトリ

 #12.4.1    レベル: 1    役割: D/V
 リクエスト遅延、トークン消費量、メモリ使用量、およびスループットを含む運用指標が継続的に収集および監視されていることを確認してください。
 #12.4.2    レベル: 1    役割: D/V
 成功率と失敗率が、エラータイプおよびその根本原因の分類とともに追跡されていることを確認してください。
 #12.4.3    レベル: 2    役割: D/V
 リソース利用率の監視にGPU/CPU使用率、メモリ消費、およびストレージ要件が含まれ、しきい値を超えた場合のアラートが設定されていることを確認してください。

---

### C12.5 AIインシデント対応計画と実行

 #12.5.1    レベル: 1    役割: D/V
 インシデント対応計画が、モデルの侵害、データポイズニング、敵対的攻撃を含むAI関連のセキュリティイベントに特に対応していることを確認してください。
 #12.5.2    レベル: 2    役割: D/V
 インシデント対応チームが、モデルの挙動や攻撃ベクトルを調査するためのAI専用のフォレンジックツールと専門知識にアクセスできることを確認してください。
 #12.5.3    レベル: 3    役割: D/V
 事後分析には、モデルの再訓練に関する考慮、安全フィルターの更新、および教訓をセキュリティコントロールに統合することが含まれていることを確認してください。

---

### C12.5 AIパフォーマンス低下検出

AIモデルのパフォーマンスと品質の劣化を時間の経過とともに監視および検出する。

 #12.5.1    レベル: 1    役割: D/V
 モデルの精度、適合率、再現率、およびF1スコアが継続的に監視され、ベースラインの閾値と比較されていることを確認してください。
 #12.5.2    レベル: 1    役割: D/V
 データドリフト検出が、モデルの性能に影響を与える可能性のある入力分布の変化を監視することを検証します。
 #12.5.3    レベル: 2    役割: D/V
 概念ドリフト検出が、入力と期待される出力との関係の変化を特定することを確認します。
 #12.5.4    レベル: 2    役割: D/V
 パフォーマンスの低下が自動アラートをトリガーし、モデルの再トレーニングまたは置換ワークフローを開始することを検証します。
 #12.5.5    レベル: 3    役割: V
 劣化の根本原因分析が、データの変化、インフラストラクチャの問題、または外部要因とパフォーマンスの低下を相関させていることを確認してください。

---

### C12.6 DAGの可視化とワークフローのセキュリティ

ワークフロー可視化システムを情報漏洩および改ざん攻撃から保護します。

 #12.6.1    レベル: 1    役割: D/V
 DAGの可視化データが保存または送信される前に、機密情報が除去されていることを検証してください。
 #12.6.2    レベル: 1    役割: D/V
 ワークフローの可視化アクセス制御が、権限のあるユーザーのみがエージェントの意思決定経路と推論の痕跡を閲覧できることを確認してください。
 #12.6.3    レベル: 2    役割: D/V
 DAGデータの整合性が暗号署名および改ざん検知可能なストレージ機構を通じて保護されていることを検証します。
 #12.6.4    レベル: 2    役割: D/V
 ワークフロー可視化システムが、加工されたノードまたはエッジのデータを介したインジェクション攻撃を防ぐために入力検証を実装していることを確認してください。
 #12.6.5    レベル: 3    役割: D/V
 リアルタイムのDAG更新がレート制限され、検証されていることを確認し、可視化システムに対するサービス拒否攻撃を防止してください。

---

### C12.7 プロアクティブセキュリティ行動監視

能動的なエージェント行動分析によるセキュリティ脅威の検出と防止。

 #12.7.1    レベル: 1    役割: D/V
 実行前にリスク評価統合を用いて、プロアクティブなエージェントの行動がセキュリティ検証されていることを確認してください。
 #12.7.2    レベル: 2    役割: D/V
 自律的なイニシアチブのトリガーには、セキュリティコンテキストの評価と脅威ランドスケープの評価が含まれていることを確認してください。
 #12.7.3    レベル: 2    役割: D/V
 潜在的なセキュリティ影響および意図しない結果について、プロアクティブな行動パターンが分析されていることを検証してください。
 #12.7.4    レベル: 3    役割: D/V
 セキュリティに重要なプロアクティブな行動は、明示的な承認チェーンと監査証跡を必要とすることを検証してください。
 #12.7.5    レベル: 3    役割: D/V
 行動異常検知が、侵害を示す可能性のあるプロアクティブエージェントのパターンの逸脱を特定することを検証してください。

---

### 参考文献

NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3
ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6
EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping

## C13 人間の監視、説明責任およびガバナンス

### 管理目標

この章は、AIシステムにおける人間の監督と明確な責任連鎖を維持するための要件を提供し、AIのライフサイクル全体を通じて説明責任、透明性、および倫理的管理を確保します。

---

### C13.1 キルスイッチとオーバーライドメカニズム

AIシステムの安全でない挙動が観測された場合に備え、シャットダウンまたはロールバックの手順を提供してください。

 #13.1.1    レベル: 1    役割: D/V
 AIモデルの推論と出力を即座に停止する手動のキルスイッチ機構が存在することを確認してください。
 #13.1.2    レベル: 1    役割: D
 オーバーライドコントロールが認可された担当者のみにアクセス可能であることを確認してください。
 #13.1.3    レベル: 3    役割: D/V
 ロールバック手順が以前のモデルバージョンまたは安全モード操作に戻せることを確認する。
 #13.1.4    レベル: 3    役割: V
 オーバーライドメカニズムが定期的にテストされていることを確認してください。

---

### C13.2 人間参加型意思決定チェックポイント

リスクの事前定義された閾値を超えた場合、人間の承認を必要とする。

 #13.2.1    レベル: 1    役割: D/V
 高リスクのAI決定は、実行前に明示的な人間の承認が必要であることを確認してください。
 #13.2.2    レベル: 1    役割: D
 リスクしきい値が明確に定義されており、自動的に人間によるレビューのワークフローを起動することを確認してください。
 #13.2.3    レベル: 2    役割: D
 時間に敏感な意思決定において、人間の承認が要求される期間内に得られない場合に備えた代替手順があることを確認してください。
 #13.2.4    レベル: 3    役割: D/V
 該当する場合には、エスカレーション手順が異なる意思決定タイプまたはリスクカテゴリに対する明確な権限レベルを定義していることを確認してください。

---

### C13.3 責任連鎖と監査可能性

オペレーターの操作とモデルの決定を記録する。

 #13.3.1    レベル: 1    役割: D/V
 すべてのAIシステムの決定と人間の介入が、タイムスタンプ、ユーザー識別、決定の根拠とともに記録されていることを確認してください。
 #13.3.2    レベル: 2    役割: D
 監査ログが改ざんされないことを検証し、整合性検証メカニズムを含めること。

---

### C13.4 説明可能なAI技術

表面特徴の重要性、反事実、および局所的説明。

 #13.4.1    レベル: 1    役割: D/V
 AIシステムがその決定に対して、人間が理解できる形式で基本的な説明を提供していることを確認してください。
 #13.4.2    レベル: 2    役割: V
 説明の質が人間の評価研究および指標を通じて検証されていることを確認してください。
 #13.4.3    レベル: 3    役割: D/V
 重要な意思決定に対して、特徴の重要度スコアや帰属手法（SHAP、LIMEなど）が利用可能であることを確認してください。
 #13.4.4    レベル: 3    役割: V
 反実仮想説明が、ユースケースやドメインに適用可能な場合、結果を変えるために入力をどのように変更できるかを示していることを確認してください。

---

### C13.5 モデルカードと使用開示

意図された使用法、パフォーマンス指標、および倫理的考慮事項のためのモデルカードを維持する。

 #13.5.1    レベル: 1    役割: D
 モデルカードが予定されている使用ケース、制限事項、および既知の失敗モードを文書化していることを確認してください。
 #13.5.2    レベル: 1    役割: D/V
 異なる適用可能なユースケースにわたるパフォーマンス指標が開示されていることを確認してください。
 #13.5.3    レベル: 2    役割: D
 倫理的考慮事項、バイアス評価、公平性評価、トレーニングデータの特性、および既知のトレーニングデータの制限が文書化され、定期的に更新されていることを確認してください。
 #13.5.4    レベル: 2    役割: D/V
 モデルカードがバージョン管理されており、変更追跡を伴ってモデルのライフサイクル全体で維持されていることを確認してください。

---

### C13.6 不確実性の定量化

応答における信頼度スコアまたはエントロピー測定値を伝播させる。

 #13.6.1    レベル: 1    役割: D
 AIシステムが出力に対して信頼度スコアまたは不確実性の指標を提供していることを確認してください。
 #13.6.2    レベル: 2    役割: D/V
 不確実性の閾値が追加の人間によるレビューや代替の意思決定経路を引き起こすことを確認してください。
 #13.6.3    レベル: 2    役割: V
 不確実性定量化手法が基準となる真実データに対して校正および検証されていることを確認する。
 #13.6.4    レベル: 3    役割: D/V
 複数段階のAIワークフローを通じて不確実性の伝播が維持されていることを検証する。

---

### C13.7 ユーザー向け透明性レポート

インシデント、ドリフト、およびデータ使用に関する定期的な開示を提供する。

 #13.7.1    レベル: 1    役割: D/V
 データ使用ポリシーとユーザー同意管理の実践が利害関係者に明確に伝えられていることを確認してください。
 #13.7.2    レベル: 2    役割: D/V
 AIの影響評価が実施され、その結果が報告に含まれていることを確認してください。
 #13.7.3    レベル: 2    役割: D/V
 定期的に公開される透明性レポートが、AIのインシデントおよび運用指標を合理的な詳細で開示していることを確認する。

#### 参考文献

EU Artificial Intelligence Act — Regulation (EU) 2024/1689 (Official Journal, 12 July 2024)
ISO/IEC 23894:2023 — Artificial Intelligence — Guidance on Risk Management
ISO/IEC 42001:2023 — AI Management Systems Requirements
NIST AI Risk Management Framework 1.0
NIST SP 800-53 Revision 5 — Security and Privacy Controls
A Unified Approach to Interpreting Model Predictions (SHAP, ICML 2017)
Model Cards for Model Reporting (Mitchell et al., 2018)
Dropout as a Bayesian Approximation: Representing Model Uncertainty in Deep Learning (Gal & Ghahramani, 2016)
ISO/IEC 24029-2:2023 — Robustness of Neural Networks — Methodology for Formal Methods
IEEE 7001-2021 — Transparency of Autonomous Systems
GDPR — Article 5 "Transparency Principle" (Regulation (EU) 2016/679)
Human Oversight under Article 14 of the EU AI Act (Fink, 2025)

## 付録A：用語集

この包括的な用語集は、AISVS全体で使用される主要なAI、ML、およびセキュリティ用語の定義を提供し、明確さと共通理解を確保します。

敵対的サンプル：人間には知覚できない微妙な摂動を加えることで、AIモデルに誤りを引き起こさせるために意図的に作成された入力。
​
敵対的ロバストネス – AIにおける敵対的ロバストネスとは、意図的に作成された悪意のある入力によってエラーを引き起こされることなく、モデルがその性能を維持し抵抗する能力を指します。
​
エージェント – AIエージェントは、ユーザーに代わって目標を追求し、タスクを完了するためにAIを使用するソフトウェアシステムです。これらは推論、計画、記憶を示し、意思決定、学習、適応を行う一定の自律性を持っています。
​
エージェンティックAI：ある程度の自律性を持ち、目標を達成するために動作できるAIシステムであり、しばしば人間による直接の介入なしに意思決定と行動を行う。
​
属性ベースアクセス制御（ABAC）：ユーザー、リソース、操作、および環境の属性に基づいて権限の決定を行い、クエリ時に評価されるアクセス制御のパラダイム。
​
バックドア攻撃：モデルが特定のトリガーに対して特定の応答を示すように訓練され、それ以外の場合は通常通りに動作するタイプのデータ汚染攻撃。
​
バイアス：特定のグループや特定のコンテキストにおいて、不公平または差別的な結果をもたらす可能性のあるAIモデルの出力における体系的な誤り。
​
バイアス悪用：AIモデルに存在する既知のバイアスを利用して、出力や結果を操作する攻撃技術。
​
Cedar: AIシステムのABAC実装に使用される、細粒度の権限管理のためのAmazonのポリシー言語およびエンジン。
​
Chain of Thought: 最終的な回答を出す前に、中間的な推論ステップを生成することで言語モデルの推論能力を改善する技術。
​
サーキットブレーカー：特定のリスクしきい値を超えた場合にAIシステムの動作を自動的に停止するメカニズム。
​
データ漏洩：AIモデルの出力や挙動を通じた機密情報の意図しない露出。
​
データポイズニング：バックドアを仕込んだり性能を劣化させたりするために、モデルの整合性を損なうことを目的としてトレーニングデータを意図的に改ざんすること。
​
差分プライバシー – 差分プライバシーは、個々のデータ被験者のプライバシーを保護しながら、データセットに関する統計情報を公開するための数学的に厳密なフレームワークです。これにより、データ保持者は特定の個人に関する情報の漏洩を制限しつつ、グループの集計パターンを共有することが可能になります。
​
埋め込み：データ（テキスト、画像など）の意味的な意味を高次元空間で捉える密なベクトル表現。
​
説明可能性 – AIにおける説明可能性とは、AIシステムがその決定や予測に対して人間が理解できる理由を提供し、内部の仕組みについての洞察を示す能力のことです。
​
説明可能なAI（XAI）：さまざまな技術やフレームワークを通じて、その意思決定や行動について人間が理解可能な説明を提供するように設計されたAIシステム。
​
フェデレーテッドラーニング：データ自体を交換することなく、複数の分散型デバイス上のローカルデータサンプルを保持しながらモデルを学習させる機械学習のアプローチ。
​
ガードレール：AIシステムが有害であったり、偏ったり、その他望ましくない出力を生成するのを防ぐために実装される制約。
​
幻覚 – AI幻覚とは、AIモデルが訓練データや事実に基づかない誤ったまたは誤解を招く情報を生成する現象を指します。
​
ヒューマンインザループ（HITL）：重要な意思決定ポイントで人間の監視、検証、または介入を必要とするよう設計されたシステム。
​
インフラストラクチャー・アズ・コード（IaC）：手動プロセスの代わりにコードを通じてインフラストラクチャーを管理およびプロビジョニングし、セキュリティスキャンと一貫したデプロイメントを可能にすること。
​
Jailbreak: 特に大規模言語モデルにおいて、AIシステムの安全ガードレールを回避して禁止されたコンテンツを生成するために使用される技術。
​
最小権限: ユーザーおよびプロセスに対して必要最低限のアクセス権のみを付与するセキュリティ原則。
​
LIME（ローカル解釈可能モデル非依存性説明）：任意の機械学習分類器の予測を、解釈可能なモデルで局所的に近似することにより説明する手法。
​
メンバーシップ推論攻撃：特定のデータポイントが機械学習モデルのトレーニングに使用されたかどうかを判定することを目的とした攻撃。
​
MITRE ATLAS: 人工知能システムに対する敵対的脅威の全体像；AIシステムに対する敵対的戦術と技術のナレッジベース。
​
モデルカード – モデルカードは、AIモデルのパフォーマンス、制限、意図された用途、および倫理的考慮事項に関する標準化された情報を提供し、透明性と責任あるAI開発を促進する文書です。
​
モデル抽出：攻撃者がターゲットモデルに繰り返しクエリを送信し、許可なく機能的に類似したコピーを作成する攻撃。
​
モデル反転攻撃：モデルの出力を解析して学習データを再構築しようとする攻撃。
​
モデルライフサイクル管理 – AIモデルライフサイクル管理は、AIモデルの設計、開発、展開、監視、保守、そして最終的な引退を含むすべての段階を監督し、その効果を維持し目標に合致していることを確保するプロセスです。
​
モデルポイズニング：トレーニングプロセス中にモデルに直接脆弱性やバックドアを導入すること。
​
モデル盗用/窃取：繰り返しのクエリによって、専有モデルのコピーまたは近似を抽出すること。
​
マルチエージェントシステム：複数の相互作用するAIエージェントで構成され、それぞれが異なる能力や目標を持つ可能性があるシステム。
​
OPA（Open Policy Agent）：スタック全体で統一されたポリシー適用を可能にするオープンソースのポリシーエンジン。
​
プライバシー保護機械学習（PPML）：トレーニングデータのプライバシーを保護しながら、MLモデルをトレーニングおよび展開するための技術と方法。
​
プロンプトインジェクション：悪意のある命令が入力に埋め込まれ、モデルの意図された動作を上書きする攻撃。
​
RAG（Retrieval-Augmented Generation）：応答を生成する前に外部の知識ソースから関連情報を取得することで、大規模言語モデルを強化する手法。
​
レッドチーミング：AIシステムの脆弱性を特定するために、敵対的攻撃をシミュレートして積極的にテストする手法。
​
SBOM（ソフトウェア部品表）：ソフトウェアやAIモデルの構築に使用されるさまざまなコンポーネントの詳細およびサプライチェーンの関係を含む正式な記録。
​
SHAP（SHapley Additive exPlanations）：各特徴量の予測への寄与度を計算することで、任意の機械学習モデルの出力を説明するゲーム理論に基づくアプローチ。
​
サプライチェーン攻撃：サードパーティのライブラリ、データセット、または事前学習済みモデルなど、サプライチェーン内のセキュリティが弱い要素を狙ってシステムを侵害すること。
​
転移学習：あるタスクのために開発されたモデルを、別のタスクのモデルの出発点として再利用する技術。
​
ベクターデータベース：高次元ベクトル（埋め込み）を保存し、効率的な類似検索を実行するために設計された専門的なデータベース。
​
脆弱性スキャン：AIフレームワークや依存関係を含むソフトウェアコンポーネントの既知のセキュリティ脆弱性を特定する自動化ツール。
​
ウォーターマーキング：AI生成コンテンツに埋め込まれる識別不可能なマーカーを用いて、その起源を追跡したり、AI生成を検出したりする技術。
​
ゼロデイ脆弱性：開発者がパッチを作成および展開する前に攻撃者が悪用できる、以前に知られていなかった脆弱性。

## 付録B: 参考文献

### TODO

## 付録C: AIセキュリティガバナンスとドキュメンテーション

### 目的

この付録は、システムのライフサイクル全体にわたってAIセキュリティを管理するための組織構造、方針、およびプロセスを確立するための基本要件を提供します。

---

### AC.1 AIリスク管理フレームワークの導入

システムライフサイクル全体にわたってAI特有のリスクを特定、評価、軽減するための正式な枠組みを提供する。

 #AC.1.1    レベル: 1    役割: D/V
 AI特有のリスク評価方法論が文書化され、実施されていることを確認する。
 #AC.1.2    レベル: 2    役割: D
 AIライフサイクルの主要なポイントおよび重要な変更の前にリスク評価が実施されていることを確認してください。
 #AC.1.3    レベル: 3    役割: D/V
 リスク管理フレームワークが確立された標準（例：NIST AI RMF）に準拠していることを確認してください。

---

### AC.2 AI セキュリティポリシーおよび手順

安全なAIの開発、展開、および運用のための組織標準を定義し、実施する。

 #AC.2.1    レベル: 1    役割: D/V
 文書化されたAIセキュリティポリシーが存在することを確認してください。
 #AC.2.2    レベル: 2    役割: D
 ポリシーが少なくとも年に一度、または重大な脅威の状況変化の後に見直され、更新されていることを確認してください。
 #AC.2.3    レベル: 3    役割: D/V
 ポリシーがすべてのAISVSカテゴリーおよび適用される規制要件に対応していることを確認してください。

---

### AC.3 AIセキュリティの役割と責任

組織全体でAIセキュリティに対する明確な責任を確立する。

 #AC.3.1    レベル: 1    役割: D/V
 AIのセキュリティに関する役割と責任が文書化されていることを確認してください。
 #AC.3.2    レベル: 2    役割: D
 責任者が適切なセキュリティ専門知識を有していることを確認する。
 #AC.3.3    レベル: 3    役割: D/V
 高リスクAIシステムのために、AI倫理委員会またはガバナンス委員会が設立されていることを確認してください。

---

### AC.4 倫理的AIガイドラインの遵守

AIシステムが確立された倫理原則に従って運用されることを確保する。

 #AC.4.1    レベル: 1    役割: D/V
 AI開発と展開のための倫理ガイドラインが存在することを確認してください。
 #AC.4.2    レベル: 2    役割: D
 倫理違反を検出および報告するためのメカニズムが整備されていることを確認してください。
 #AC.4.3    レベル: 3    役割: D/V
 展開されたAIシステムに対して定期的な倫理レビューが実施されていることを確認してください。

---

### AC.5 AI規制コンプライアンス監視

進化するAI規制に対する認識と遵守を維持すること。

 #AC.5.1    レベル: 1    役割: D/V
 該当するAI規制を特定するためのプロセスが存在することを確認してください。
 #AC.5.2    レベル: 2    役割: D
 すべての規制要件への準拠が評価されていることを確認してください。
 #AC.5.3    レベル: 3    役割: D/V
 規制の変更がAIシステムのタイムリーなレビューと更新を引き起こすことを確認する。

### AC.6 トレーニングデータのガバナンス、文書化、およびプロセス

 #1.1.2    レベル: 1    役割: D/V
 品質、代表性、倫理的調達、およびライセンス遵守が検証されたデータセットのみを許可し、毒性、組み込みバイアス、および知的財産権侵害のリスクを低減することを確認してください。
 #1.1.5    レベル: 2    役割: D/V
 レビュアーによるクロスチェックまたはコンセンサスを通じて、ラベリング／アノテーションの品質が確保されていることを確認してください。
 #1.1.6    レベル: 2    役割: D/V
 重要なトレーニングデータセットについて、「データカード」または「データセット用データシート」が維持されていることを確認し、その特徴、動機、構成、収集プロセス、前処理、および推奨される使用方法や推奨されない使用方法を詳述してください。
 #1.3.2    レベル: 2    役割: D/V
 特定されたバイアスが、リバランス、ターゲットを絞ったデータ増強、アルゴリズム調整（例：前処理、処理中、後処理技術）、または再重み付けなどの文書化された戦略によって緩和されていることを確認し、緩和の公平性および全体的なモデル性能への影響が評価されていることを確認する。
 #1.3.3    レベル: 2    役割: D/V
 事後トレーニングの公平性指標が評価され、文書化されていることを確認してください。
 #1.3.4    レベル: 3    役割: D/V
 ライフサイクルのバイアスマネジメントポリシーが所有者およびレビューの頻度を割り当てていることを確認してください。
 #1.4.1    レベル: 2    役割: D/V
 ラベリング/アノテーションの品質が、明確なガイドライン、レビュアーの相互確認、コンセンサスメカニズム（例：アノテーター間の同意率の監視）、および不一致を解決するために定義されたプロセスを通じて確保されていることを確認してください。
 #1.4.4    レベル: 3    役割: D/V
 安全性、セキュリティ、公平性に関わる重要なラベル（例：有害なコンテンツの識別、重要な医療所見など）が必須の独立した二重レビューまたは同等の強力な検証を受けることを確認してください。
 #1.4.6    レベル: 2    役割: D/V
 ラベリングガイドおよび指示が包括的で、バージョン管理されており、ピアレビューされていることを確認してください。
 #1.4.6    レベル: 2    役割: D/V
 ラベルのデータスキーマが明確に定義され、バージョン管理されていることを確認してください。
 #1.3.1    レベル: 1    役割: D/V
 データセットが、表現の不均衡や法律で保護された属性（例：人種、性別、年齢）およびモデルの適用領域に関連するその他の倫理的に敏感な特性（例：社会経済的地位、所在地）にわたって潜在的なバイアスについてプロファイリングされていることを検証する。
 #1.5.3    レベル: 2    役割: V
 ドメイン専門家による手動スポットチェックが、統計的に有意なサンプル（例：≥1％または1,000サンプルのいずれか多い方、またはリスク評価により決定される）をカバーし、自動化では検出できない微妙な品質問題を特定していることを検証する。
 #1.8.4    レベル: 2    役割: D/V
 アウトソースまたはクラウドソースされたラベリングワークフローに、データの機密性、完全性、ラベル品質を確保し、データ漏洩を防止するための技術的および手続き的な保護策が含まれていることを検証してください。
 #1.5.4    レベル: 2    役割: D/V
 修復手順がプロベナンス記録に追加されていることを確認してください。
 #1.6.2    レベル: 2    役割: D/V
 フラグが付けられたサンプルがトレーニング前に手動レビューをトリガーすることを確認してください。
 #1.6.3    レベル: 2    役割: V
 結果がモデルのセキュリティドシエに反映され、継続的な脅威インテリジェンスに情報を提供していることを確認してください。
 #1.6.4    レベル: 3    役割: D/V
 検出ロジックが新しい脅威インテリジェンスで更新されていることを確認してください。
 #1.6.5    レベル: 3    役割: D/V
 オンライン学習パイプラインが分布の変化を監視していることを検証してください。
 #1.7.1    レベル: 1    役割: D/V
 トレーニングデータの削除ワークフローが、一次データおよび派生データを完全に消去し、モデルへの影響を評価していること、また影響を受けたモデルに対して必要に応じて再トレーニングや再調整などの対応が行われていることを確認してください。
 #1.7.2    レベル: 2    役割: D
 トレーニングに使用されるデータに対するユーザーの同意（および撤回）の範囲と状態を追跡し尊重するためのメカニズムが整っていることを確認し、新しいトレーニングプロセスや重要なモデルの更新にデータが組み込まれる前に同意が検証されていることを確認してください。
 #1.7.3    レベル: 2    役割: V
 ワークフローが年次でテストされ、記録されていることを確認してください。
 #1.8.1    レベル: 2    役割: D/V
 第三者のデータ供給者（事前学習モデルおよび外部データセットの提供者を含む）が、そのデータやモデルが統合される前に、セキュリティ、プライバシー、倫理的調達、およびデータ品質のデューデリジェンスを受けていることを確認する。
 #1.8.2    レベル: 1    役割: D
 外部転送がTLS/認証および整合性チェックを使用していることを確認してください。
 #1.8.3    レベル: 2    役割: D/V
 高リスクのデータソース（例：出所不明のオープンソースデータセット、未検証のサプライヤー）が、機微なアプリケーションで使用される前に、サンドボックス分析、広範な品質・バイアスチェック、特定のポイズニング検出などの強化された監査を受けることを確認してください。
 #1.8.4    レベル: 3    役割: D/V
 第三者から取得した事前学習済みモデルは、微調整や展開の前に、埋め込まれたバイアス、潜在的なバックドア、アーキテクチャの整合性、および元のトレーニングデータの出所について評価されていることを確認してください。
 #1.5.3    レベル: 2    役割: D/V
 敵対的トレーニングが使用されている場合、敵対的データセットの生成、管理、およびバージョン管理が文書化され、制御されていることを確認してください。
 #1.5.3    レベル: 3    役割: D/V
 敵対的ロバストネス訓練がモデルの性能（クリーン入力および敵対的入力の両方に対して）および公平性指標に与える影響が評価され、文書化され、監視されていることを確認してください。
 #1.5.4    レベル: 3    役割: D/V
 敵対的トレーニングおよび堅牢性の戦略が、進化する敵対的攻撃技術に対応するために定期的に見直され、更新されていることを検証してください。
 #1.4.2    レベル: 2    役割: D/V
 失敗したデータセットが監査証跡とともに隔離されていることを確認してください。
 #1.4.3    レベル: 2    役割: D/V
 品質ゲートが例外が承認されない限り、劣悪なデータセットをブロックすることを確認してください。
 #1.11.2    レベル: 2    役割: D/V
 合成データの生成プロセス、パラメータ、および意図された使用目的が文書化されていることを確認してください。
 #1.11.3    レベル: 2    役割: D/V
 合成データをトレーニングに使用する前に、バイアス、プライバシー漏洩、表現に関する問題についてリスク評価が行われていることを確認してください。
 #1.12.3    レベル: 2    役割: D/V
 疑わしいアクセスイベントに対してアラートが生成され、迅速に調査されていることを確認してください。
 #1.13.1    レベル: 1    役割: D/V
 すべてのトレーニングデータセットに対して明示的な保持期間が定義されていることを確認してください。
 #1.13.2    レベル: 2    役割: D/V
 データセットがそのライフサイクルの終了時に自動的に期限切れ、削除、または削除のためにレビューされることを確認してください。
 #1.13.3    レベル: 2    役割: D/V
 保持および削除の操作が記録され、監査可能であることを確認してください。
 #1.14.1    レベル: 2    役割: D/V
 すべてのデータセットに対して、データ居住要件と国境を越えた転送要件が特定され、施行されていることを確認してください。
 #1.14.2    レベル: 2    役割: D/V
 特定の業界規制（例：医療、金融）が特定され、データ処理において対応されていることを確認してください。
 #1.14.3    レベル: 2    役割: D/V
 関連するプライバシー法（例：GDPR、CCPA）への遵守が文書化され、定期的にレビューされていることを確認してください。
 #1.16.1    レベル: 2    役割: D/V
 データ主体からのアクセス、訂正、制限、または異議申し立ての要求に対応するためのメカニズムが存在することを確認してください。
 #1.16.2    レベル: 2    役割: D/V
 リクエストが法的に定められた期限内に記録され、追跡され、完了されていることを確認してください。
 #1.16.3    レベル: 2    役割: D/V
 データ主体の権利に関するプロセスが効果的に機能しているかを定期的にテストおよびレビューしていることを確認してください。
 #1.17.1    レベル: 2    役割: D/V
 データセットのバージョンを更新または置換する前に、モデルの性能、公平性、およびコンプライアンスを含むインパクト分析が実施されていることを確認してください。
 #1.17.2    レベル: 2    役割: D/V
 影響分析の結果が文書化され、関連する利害関係者によってレビューされていることを確認してください。
 #1.17.3    レベル: 2    役割: D/V
 新しいバージョンが許容できないリスクや後退をもたらした場合に備えて、ロールバックプランが存在することを確認してください。
 #1.18.1    レベル: 2    役割: D/V
 データ注釈に関与するすべての担当者が、身元調査を受けており、データのセキュリティおよびプライバシーに関するトレーニングを受けていることを確認してください。
 #1.18.2    レベル: 2    役割: D/V
 すべてのアノテーション担当者が機密保持契約および秘密保持契約に署名していることを確認してください。
 #1.18.3    レベル: 2    役割: D/V
 アノテーションプラットフォームがアクセス制御を強制し、内部脅威を監視していることを確認してください。

#### 参考文献

NIST AI Risk Management Framework 1.0
ISO/IEC 42001:2023 — AI Management Systems Requirements
ISO/IEC 23894:2023 — Artificial Intelligence — Guidance on Risk Management
EU Artificial Intelligence Act — Regulation (EU) 2024/1689
ISO/IEC 24029‑2:2023 — Robustness of Neural Networks — Methodology for Formal Methods

## 付録D：AI支援セキュアコーディングガバナンスと検証

### 目的

この章では、ソフトウェア開発中にAI支援コーディングツールを安全かつ効果的に使用するための基本的な組織的管理策を定義し、SDLC全体にわたるセキュリティとトレーサビリティを確保します。

---

### AD.1 AI支援セキュアコーディングワークフロー

既存のセキュリティゲートを弱めることなく、組織のセキュアソフトウェア開発ライフサイクル（SSDLC）にAIツールを統合する。

 #AD.1.1    レベル: 1    役割: D/V
 AIツールがコードを生成、リファクタリング、またはレビューするタイミングと方法を文書化したワークフローを確認してください。
 #AD.1.2    レベル: 2    役割: D
 ワークフローが各SSDLCフェーズ（設計、実装、コードレビュー、テスト、デプロイメント）に対応していることを確認してください。
 #AD.1.3    レベル: 3    役割: D/V
 AI生成コードに関して、メトリクス（例：脆弱性密度、平均検出時間）が収集され、人間のみのベースラインと比較されていることを確認してください。

---

### AD.2 AIツールの適格性評価および脅威モデリング

AIコーディングツールは、導入前にセキュリティ機能、リスク、およびサプライチェーンへの影響について評価を行うことを確実にしてください。

 #AD.2.1    レベル: 1    役割: D/V
 各AIツールの脅威モデルが、不正使用、モデル反転、データ漏洩、および依存チェーンのリスクを特定していることを確認してください。
 #AD.2.2    レベル: 2    役割: D
 ツール評価に、ローカルコンポーネントの静的/動的解析およびSaaSエンドポイント（TLS、認証/認可、ログ記録）の評価が含まれていることを確認してください。
 #AD.2.3    レベル: 3    役割: D/V
 評価が認識されたフレームワークに従っていることを確認し、主要なバージョン変更後に再実施されることを確認してください。

---

### AD.3 セキュアプロンプト＆コンテキスト管理

AIモデルのプロンプトやコンテキストを構築する際に、機密情報、専有コード、および個人データの漏洩を防止してください。

 #AD.3.1    レベル: 1    役割: D/V
 書面による指示が、プロンプト内で秘密情報、認証情報、または機密データを送信することを禁止していることを確認してください。
 #AD.3.2    レベル: 2    役割: D
 技術的コントロール（クライアント側の編集、承認済みコンテキストフィルター）が機密情報を自動的に除去することを検証してください。
 #AD.3.3    レベル: 3    役割: D/V
 プロンプトとレスポンスがトークン化され、転送中および保存時に暗号化されていること、および保持期間がデータ分類ポリシーに準拠していることを検証してください。

---

### AD.4 AI生成コードの検証

コードがマージまたはデプロイされる前に、AIによって生成された出力に導入された脆弱性を検出し、修復します。

 #AD.4.1    レベル: 1    役割: D/V
 AI生成コードは常に人間によるコードレビューを受けることを確認してください。
 #AD.4.2    レベル: 2    役割: D
 すべてのAI生成コードを含むプルリクエストで自動スキャナー（SAST/IAST/DAST）が実行され、重大な検出結果がある場合はマージをブロックすることを確認してください。
 #AD.4.3    レベル: 3    役割: D/V
 差分ファズテストやプロパティベーステストが、セキュリティクリティカルな動作（例：入力検証、認可ロジック）を証明することを確認してください。

---

### AD.5 コード提案の説明可能性とトレーサビリティ

監査人や開発者に、なぜ提案がなされたのか、そしてその提案がどのように進化したのかについての洞察を提供する。

 #AD.5.1    レベル: 1    役割: D/V
 プロンプト／レスポンスのペアがコミットIDとともに記録されていることを確認してください。
 #AD.5.2    レベル: 2    役割: D
 開発者が提案を裏付けるモデルの引用（トレーニングスニペット、ドキュメント）を表示できることを検証してください。
 #AD.5.3    レベル: 3    役割: D/V
 説明可能性レポートが設計成果物と共に保存され、セキュリティレビューで参照され、ISO/IEC 42001のトレーサビリティ原則を満たしていることを確認してください。

---

### AD.6 継続的フィードバックとモデル微調整

負のドリフトを防ぎながら、時間の経過とともにモデルのセキュリティ性能を向上させる。

 #AD.6.1    レベル: 1    役割: D/V
 開発者が安全でない、または非準拠の提案にフラグを立てることができ、そのフラグが追跡されていることを確認してください。
 #AD.6.2    レベル: 2    役割: D
 集約されたフィードバックが、検証済みのセキュアコーディングコーパス（例：OWASPチートシート）を用いた定期的なファインチューニングまたはリトリーバル強化生成に反映されていることを確認する。
 #AD.6.3    レベル: 3    役割: D/V
 閉ループ評価ハーネスが各ファインチューン後に回帰テストを実行することを検証してください。セキュリティメトリクスは、展開前に以前のベースラインを満たすか、それを上回らなければなりません。

---

#### 参考文献

NIST AI Risk Management Framework 1.0
ISO/IEC 42001:2023 — AI Management Systems Requirements
OWASP Secure Coding Practices — Quick Reference Guide

## 付録E: 例示ツールとフレームワーク

### 目的

この章では、特定のAISVS要件の実装または達成を支援できるツールおよびフレームワークの例を提供します。これらはAISVSチームやOWASP GenAIセキュリティプロジェクトによる推奨または推奨の表明として見なされるべきものではありません。

---

### AE.1 トレーニングデータガバナンスおよびバイアスマネジメント

データ分析、ガバナンス、およびバイアスマネジメントに使用されるツール。

 #AE.1.1    セクション: 1.1
 データインベントリツール: データインベントリ管理ツールのような...
 #AE.1.2    セクション: 1.2
 転送中の暗号化 HTTPSベースのアプリケーションにはTLSを使用し、openSSLやpythonのようなツールを活用します。`ssl`ライブラリ。

---

### AE.2 ユーザー入力検証

ユーザー入力を処理および検証するためのツール。

 #AE.2.1    セクション: 2.1
 プロンプトインジェクション防御ツール：NVIDIAのNeMoやGuardrails AIのようなガードレールツールを使用してください。

---


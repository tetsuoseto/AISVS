## 扉絵

### 標準について

人工知能セキュリティ検証標準（AISVS）は、データサイエンティスト、MLOpsエンジニア、ソフトウェアアーキテクト、開発者、テスター、セキュリティ専門家、ツールベンダー、規制当局、および利用者が、信頼できるAI対応システムおよびアプリケーションを設計、構築、テスト、検証するために使用できるコミュニティ主導のセキュリティ要件のカタログです。これは、データ収集やモデル開発から展開および継続的な監視に至るAIライフサイクル全体にわたるセキュリティ制御を指定する共通言語を提供し、組織がAIソリューションの回復力、プライバシー、安全性を測定し、向上させることを可能にします。

### 著作権とライセンス

バージョン 0.1（最初の公開ドラフト - 作業進行中）、2025年  

![license](images/license.png)
著作権 © 2025 The AISVS プロジェクト。  

以下の条件で公開されていますCreative Commons Attribution‑ShareAlike 4.0 International License.
この作品を再利用または配布する場合は、そのライセンス条件を他者に明確に伝えなければなりません。

### プロジェクトリード

ジム・マニコ
アラス “ラス” メミシャジチ

### 寄稿者およびレビュアー

https://github.com/ottosulin
https://github.com/mbhatt1
https://github.com/vineethsai
https://github.com/cciprofm
https://github.com/deepakrpandey12


---

AISVSは、人工知能システムの特有のセキュリティ課題に対応するために特別に作成されたまったく新しい標準です。より広範なセキュリティのベストプラクティスから着想を得ていますが、AISVSのすべての要件はAIの脅威環境を反映し、組織がより安全で耐障害性の高いAIソリューションを構築するのに役立つように、ゼロから開発されています。

## まえがき

人工知能セキュリティ検証標準（AISVS）バージョン1.0へようこそ！

### はじめに

2025年に共同コミュニティの努力によって設立されたAISVSは、現代のAIモデル、パイプライン、AI対応サービスを設計、開発、展開、運用する際に考慮すべきセキュリティ要件を定義しています。

AISVS v1.0は、プロジェクトリーダー、ワーキンググループ、およびより広範なコミュニティの貢献者たちの共同作業の成果を表しており、AIシステムのセキュリティを確保するための現実的で検証可能な基準を提供しています。

このリリースの目標は、AISVSを簡単に導入できるようにしつつ、その定義された範囲に厳密に集中し、AI固有の急速に進化するリスク環境に対応することです。

### AISVS バージョン 1.0 の主要目標

バージョン1.0は、いくつかの指針となる原則に基づいて作成されます。

#### 明確に定義されたスコープ

各要件はAISVSの名称および使命に沿っている必要があります：

人工知能 – コントロールはAI/MLレイヤー（データ、モデル、パイプライン、または推論）で動作し、AI実践者の責任です。
セキュリティ – 要件は特定されたセキュリティ、プライバシー、または安全リスクを直接的に軽減するものです。
検証 – 言語は客観的に適合性を検証できるように記述されている。
標準 – セクションは一貫した構造と用語を用いて、一貫性のある参照を形成します。
​
---

AISVS に従うことで、組織は自社の AI ソリューションのセキュリティ体制を体系的に評価・強化し、安全な AI エンジニアリングの文化を育成することができます。

## AISVSを使用して

人工知能セキュリティ検証基準（AISVS）は、現代のAIアプリケーションおよびサービスに対するセキュリティ要件を定義しており、アプリケーション開発者の管理下にある側面に焦点を当てています。

AISVSは、開発者、アーキテクト、セキュリティエンジニア、監査人を含む、AIアプリケーションのセキュリティを開発または評価するすべての人を対象としています。この章では、AISVSの構造と使用方法、検証レベルおよび意図された使用ケースについて紹介します。

### 人工知能セキュリティ検証レベル

AISVSは、3つの段階的に上昇するセキュリティ検証レベルを定義しています。各レベルは深さと複雑さを増し、組織がAIシステムのリスクレベルに応じてセキュリティ体制を調整できるようにします。

組織はレベル1から開始し、セキュリティ成熟度と脅威への露出が増加するにつれて、段階的により高いレベルを採用することができます。

#### レベルの定義

AISVS v1.0の各要件は、次のいずれかのレベルに割り当てられます:

 レベル1の要件

レベル1には、最も重要で基本的なセキュリティ要件が含まれます。これらは、他の前提条件や脆弱性に依存しない一般的な攻撃を防ぐことに焦点を当てています。ほとんどのレベル1のコントロールは、実装が比較的簡単であるか、労力に見合うほど重要です。

 レベル2の要件

レベル2は、より高度またはあまり一般的でない攻撃や、広範な脅威に対する多層防御に対応します。これらの要件は、より複雑なロジックを含む場合や、特定の攻撃の前提条件をターゲットにすることがあります。

 レベル3の要件

レベル3には、通常実装が難しいか、状況依存的な適用範囲を持つコントロールが含まれます。これらは多くの場合、防御の多層化メカニズムや、ニッチでターゲットを絞った高複雑度の攻撃に対する緩和策を表しています。

#### 役割（D/V）

各AISVS要件は、主な対象者に従って分類されています:

D – 開発者向け要件
V – 検証者／監査者向け要件
D/V – 開発者および検証者の両方に関連する

## C1 トレーニングデータガバナンスとバイアスマネジメント

### 制御目標

トレーニングデータは、出所、セキュリティ、品質、公平性を維持する方法で収集、取り扱い、管理されなければなりません。これにより、法的義務が果たされ、バイアス、中毒、またはトレーニング中に発生し、AIのライフサイクル全体に影響を及ぼす可能性のあるプライバシー侵害のリスクが低減されます。

---

### C1.1 トレーニングデータの出所

すべてのデータセットの検証可能なインベントリを維持し、信頼できるソースのみを受け入れ、監査可能性のためにすべての変更を記録します。

 #1.1.1    レベル: 1    役割: D/V
 すべてのトレーニングデータソース（出所、管理者/所有者、ライセンス、収集方法、使用制約、および処理履歴）に関する最新のインベントリが維持されていることを確認してください。
 #1.1.2    レベル: 1    役割: D/V
 トレーニングデータの処理が、不必要な特徴、属性、またはフィールド（例：未使用のメタデータ、機密PII、漏洩したテストデータ）を除外していることを検証してください。
 #1.1.3    レベル: 2    役割: D/V
 すべてのデータセットの変更が記録された承認ワークフローの対象であることを確認してください。
 #1.1.4    レベル: 3    役割: D/V
 可能な場合は、データセットまたはサブセットにウォーターマークまたはフィンガープリントが付けられていることを確認してください。

---

### C1.2 トレーニングデータのセキュリティと完全性

トレーニングデータへのアクセスを制限し、保存時および転送時に暗号化し、改ざん、盗難、またはデータポイズニングを防ぐためにその整合性を検証します。

 #1.2.1    レベル: 1    役割: D/V
 トレーニングデータの保存およびパイプラインがアクセス制御によって保護されていることを確認してください。
 #1.2.2    レベル: 2    役割: D/V
 トレーニングデータへのすべてのアクセスが記録されていることを確認し、ユーザー、時間、および行動を含める。
 #1.2.3    レベル: 2    役割: D/V
 トレーニングデータセットが、移動中および保存時に、業界標準の暗号アルゴリズムおよびキー管理手法を使用して暗号化されていることを確認してください。
 #1.2.4    レベル: 2    役割: D/V
 トレーニングデータの保存および転送中に、データの完全性を確保するために暗号学的ハッシュまたはデジタル署名が使用されていることを検証してください。
 #1.2.5    レベル: 2    役割: D/V
 トレーニングデータの不正な変更や破損を防ぐために、自動検出技術が適用されていることを確認してください。
 #1.2.6    レベル: 2    役割: D/V
 古いトレーニングデータが安全に削除または匿名化されていることを確認してください。
 #1.2.7    レベル: 3    役割: D/V
 すべてのトレーニングデータセットのバージョンが一意に識別され、不変に保存され、ロールバックおよびフォレンジック分析をサポートするために監査可能であることを検証してください。

---

### C1.3 トレーニングデータのラベリング品質、完全性、およびセキュリティ

ラベルを保護し、重要なデータに対して技術的なレビューを必須とする。

 #1.3.1    レベル: 2    役割: D/V
 ラベル付けされたアーティファクトの整合性と真正性を確保するために、暗号ハッシュまたはデジタル署名が適用されていることを確認してください。
 #1.3.2    レベル: 2    役割: D/V
 ラベリングインターフェースおよびプラットフォームが強力なアクセス制御を実施し、すべてのラベリング操作の改ざん検知可能な監査ログを維持し、不正な改変から保護していることを検証してください。
 #1.3.3    レベル: 3    役割: D/V
 ラベル内の機密情報が、保存時および転送時にデータフィールドレベルでマスキング、匿名化、または暗号化されていることを確認してください。

---

### C1.4 トレーニングデータの品質およびセキュリティ保証

自動検証、手動スポットチェック、記録された修正を組み合わせて、データセットの信頼性を保証します。

 #1.4.1    レベル: 1    役割: D
 自動テストが、すべての取り込みや重要なデータ変換時にフォーマットエラーやnullを検出することを確認してください。
 #1.4.2    レベル: 2    役割: D/V
 LLMのトレーニングおよびファインチューニングパイプラインが、ポイズニング検出およびデータ整合性検証（例：統計的手法、異常値検出、埋め込み解析）を実装し、潜在的なポイズニング攻撃（例：ラベル反転、バックドアトリガー挿入、役割切替コマンド、影響力のあるインスタンス攻撃）やトレーニングデータの意図しないデータ破損を識別できることを確認してください。
 #1.4.3    レベル: 3    役割: D/V
 適切な防御策、例えば敵対的生成例を用いた敵対的訓練、摂動された入力によるデータ拡張、またはロバスト最適化技術が、リスク評価に基づいて関連するモデルに対して実装および調整されていることを確認する。
 #1.4.4    レベル: 2    役割: D/V
 自動生成されたラベル（例えば、LLMや弱い教師あり学習を通じて生成されたもの）が、幻覚的、誤解を招く、または信頼度の低いラベルを検出するために、信頼度の閾値および一貫性チェックの対象となっていることを確認する。
 #1.4.5    レベル: 3    役割: D
 自動テストが、すべてのデータ取り込みまたは重要なデータ変換時にラベルのズレを検出することを確認してください。

---

### C1.5 データ系譜と追跡可能性

監査可能性およびインシデント対応のために、各データポイントの完全な経路をソースからモデル入力まで追跡します。

 #1.5.1    レベル: 2    役割: D/V
 各データポイントの系譜が、すべての変換、拡張、および統合を含めて記録されており、再構築可能であることを検証してください。
 #1.5.2    レベル: 2    役割: D/V
 系統情報レコードが不変であり、安全に保存され、監査のためにアクセス可能であることを検証してください。
 #1.5.3    レベル: 2    役割: D/V
 プライバシー保護または生成技術を用いて生成された合成データが系統追跡でカバーされていることを確認し、すべての合成データがパイプライン全体で実データと明確に区別され、ラベル付けされていることを確認してください。

---

### 参考文献

NIST AI Risk Management Framework
EU AI Act – Article 10: Data & Data Governance
MITRE ATLAS: Adversary Tactics for AI
Survey of ML Bias Mitigation Techniques – MDPI
Data Provenance & Lineage Best Practices – Nightfall AI
Data Labeling Quality Standards – LabelYourData
Training Data Poisoning Guide – Lakera.ai
CISA Advisory: Securing Data for AI Systems
ISO/IEC 23053: AI Management Systems Framework
IBM: What is AI Governance?
Google AI Principles
GDPR & AI Training Data – DataProtectionReport
Supply-Chain Security for AI Data – AppSOC
OpenAI Privacy Center – Data Deletion Controls
Adversarial ML Dataset – Kaggle

## C2 ユーザー入力検証

### 制御目標

ユーザー入力の堅牢な検証は、AIシステムに対する最も破壊的な攻撃のいくつかに対する第一防衛線です。プロンプトインジェクション攻撃は、システムの指示を上書きしたり、機密データを漏洩させたり、モデルを許可されていない行動へ誘導したりする可能性があります。専用のフィルターや指示階層が整備されていない限り、研究によれば、非常に長いコンテキストウィンドウを悪用する「マルチショット」脱獄攻撃は効果的であることが示されています。また、ホモグリフの置換やリートスピークのような微妙な敵対的摂動攻撃によって、モデルの判断が静かに変えられることもあります。

---

### C2.1 プロンプトインジェクション防御

プロンプトインジェクションはAIシステムにとって最大のリスクの一つです。この手法に対する防御策は、静的パターンフィルター、動的分類器、および命令階層の強制を組み合わせて用います。

 #2.1.1    レベル: 1    役割: D/V
 ユーザー入力が、既知のプロンプトインジェクションパターン（脱獄キーワード、「前の指示を無視」、ロールプレイチェーン、間接的なHTML/URL攻撃）を含む継続的に更新されるライブラリに対して検査されていることを確認してください。
 #2.1.2    レベル: 1    役割: D/V
 システムまたは開発者のメッセージが、コンテキストウィンドウの拡大後でもユーザーの指示を上書きする命令階層をシステムが適用していることを確認してください。
 #2.1.3    レベル: 2    役割: D/V
 敵対的評価テスト（例：レッドチームによる「多数ショット」プロンプト）が、すべてのモデルまたはプロンプトテンプレートのリリース前に実施されていることを確認し、成功率の閾値と回帰に対する自動ブロッカーが設定されていることを確認してください。
 #2.1.4    レベル: 2    役割: D
 サードパーティのコンテンツ（ウェブページ、PDF、電子メール）からのプロンプトが、メインプロンプトに連結される前に、隔離された解析コンテキストで適切にサニタイズされていることを確認してください。
 #2.1.5    レベル: 3    役割: D/V
 すべてのプロンプトフィルタールールの更新、分類モデルのバージョン、およびブロックリストの変更がバージョン管理されており、監査可能であることを確認してください。

---

### C2.2 敵対的サンプル耐性

自然言語処理（NLP）モデルは、ヒトが見逃しがちな微細な文字や単語レベルの摂動に対して依然として脆弱であり、それが原因でモデルは誤分類しやすい。

 #2.2.1    レベル: 1    役割: D
 基本的な入力正規化手順（Unicode NFC、ホモグリフマッピング、ホワイトスペースのトリミング）がトークナイゼーションの前に実行されることを確認してください。
 #2.2.2    レベル: 2    役割: D/V
 統計的異常検出が、言語規範から異常に高い編集距離を持つ入力、過剰に繰り返されるトークン、または異常な埋め込み距離を持つ入力をフラグ付けすることを検証してください。
 #2.2.3    レベル: 2    役割: D
 推論パイプラインが、オプションの敵対的訓練で強化されたモデルバリアントや防御層（例：ランダマイゼーション、防御的蒸留）を高リスクエンドポイント向けにサポートしていることを検証してください。
 #2.2.4    レベル: 2    役割: V
 疑わしい敵対的入力が隔離され、PIIの編集後に完全なペイロードとともにログ記録されていることを確認してください。
 #2.2.5    レベル: 3    役割: D/V
 堅牢性指標（既知の攻撃スイートの成功率）が時間経過で追跡され、回帰がリリースブロッカーを引き起こすことを確認してください。

---

### C2.3 スキーマ、タイプおよび長さの検証

不正な形式または過大な入力を特徴とするAI攻撃は、パースエラー、フィールド間でのプロンプトの漏れ、リソースの枯渇を引き起こす可能性があります。決定論的なツール呼び出しを行う際には、厳格なスキーマの適用も必須条件となります。

 #2.3.1    レベル: 1    役割: D
 すべてのAPIまたは関数呼び出しエンドポイントが明示的な入力スキーマ（JSONスキーマ、Protobuf、またはマルチモーダルの同等物）を定義しており、入力がプロンプトの組み立て前に検証されていることを確認してください。
 #2.3.2    レベル: 1    役割: D/V
 最大トークン数またはバイト数の制限を超える入力が、安全なエラーで拒否され、決して黙って切り捨てられないことを検証してください。
 #2.3.3    レベル: 2    役割: D/V
 タイプチェック（例えば、数値範囲、列挙型の値、画像/音声のMIMEタイプなど）がクライアントコードだけでなく、サーバーサイドでも確実に実施されていることを確認してください。
 #2.3.4    レベル: 2    役割: D
 意味論的バリデーター（例：JSON Schema）が定数時間で動作し、アルゴリズム的なDoS攻撃を防ぐことを検証してください。
 #2.3.5    レベル: 3    役割: V
 検証失敗が、セキュリティ対応を支援するためにペイロードの断片を伏せ字にし、明確なエラーコードと共にログ記録されていることを確認してください。

---

### C2.4 コンテンツおよびポリシースクリーニング

開発者は、不正な指示、ヘイトスピーチ、著作権で保護されたテキストなどの許可されていないコンテンツを要求する構文的に有効なプロンプトを検出し、それらが拡散するのを防止できるようにする必要があります。

 #2.4.1    レベル: 1    役割: D
 コンテンツ分類器（ゼロショットまたは微調整済み）が、暴力、自傷、ヘイト、性的内容、違法な要求について、設定可能な閾値で全ての入力をスコアリングすることを検証してください。
 #2.4.2    レベル: 1    役割: D/V
 ポリシーに違反する入力が標準化された拒否または安全な完了を受け取り、それらが下流のLLM呼び出しに伝播しないことを検証してください。
 #2.4.3    レベル: 2    役割: D
 スクリーニングモデルまたはルールセットが、少なくとも四半期ごとに再訓練または更新され、新たに観察されたジャイルブレイクやポリシーバイパスのパターンが組み込まれていることを確認してください。
 #2.4.4    レベル: 2    役割: D
 リクエスト時に解決される属性ベースのルールを通じて、ユーザー固有のポリシー（年齢、地域の法的制約）を遵守していることを検証してください。
 #2.4.5    レベル: 3    役割: V
 スクリーニングログに、SOC相関および将来のレッドチーム再実行のための分類器の信頼度スコアとポリシーカテゴリタグが含まれていることを確認してください。

---

### C2.5 入力レート制限と乱用防止

開発者は、入力レートを制限し、異常な使用パターンを検出することで、AIシステムに対する悪用、リソース枯渇、および自動化された攻撃を防止する必要があります。

 #2.5.1    レベル: 1    役割: D/V
 すべての入力エンドポイントに対して、ユーザーごと、IPごと、およびAPIキーごとのレートリミットが適用されていることを確認してください。
 #2.5.2    レベル: 2    役割: D/V
 DoS攻撃およびブルートフォース攻撃を防ぐために、バーストおよび持続的なレート制限が適切に調整されていることを確認してください。
 #2.5.3    レベル: 2    役割: D/V
 異常な使用パターン（例：連続リクエスト、入力の過剰送信）が自動的なブロックまたはエスカレーションを引き起こすことを確認してください。
 #2.5.4    レベル: 3    役割: V
 攻撃防止ログが保持され、新たに発生する攻撃パターンのためにレビューされていることを確認してください。

---

### C2.6 マルチモーダル入力検証

AIシステムは、注入、回避、またはリソースの乱用を防ぐために、非テキスト入力（画像、音声、ファイル）に対する堅牢な検証を含めるべきです。

 #2.6.1    レベル: 1    役割: D
 処理前に、すべての非テキスト入力（画像、音声、ファイル）がタイプ、サイズ、およびフォーマットについて検証されていることを確認してください。
 #2.6.2    レベル: 2    役割: D/V
 ファイルが取り込み前にマルウェアおよびステガノグラフィックペイロードのスキャンを受けていることを確認してください。
 #2.6.3    レベル: 2    役割: D/V
 画像/音声入力が敵対的摂動や既知の攻撃パターンに対して検査されていることを確認してください。
 #2.6.4    レベル: 3    役割: V
 マルチモーダル入力検証の失敗がログに記録され、調査のためのアラートがトリガーされることを確認してください。

---

### C2.7 入力の由来と帰属

AIシステムは、すべてのユーザー入力の起源を監視およびタグ付けすることで、監査、悪用追跡、コンプライアンスを支援すべきです。

 #2.7.1    レベル: 1    役割: D/V
 すべてのユーザー入力が取り込み時にメタデータ（ユーザーID、セッション、ソース、タイムスタンプ、IPアドレス）でタグ付けされていることを確認してください。
 #2.7.2    レベル: 2    役割: D/V
 すべての処理された入力に対して、出所のメタデータが保持され、監査可能であることを確認してください。
 #2.7.3    レベル: 2    役割: D/V
 異常または信頼できない入力ソースがフラグ付けされ、強化された検査またはブロックの対象となることを確認してください。

---

### C2.8 リアルタイム適応型脅威検知

開発者は、新しい攻撃パターンに適応し、コンパイルされたパターンマッチングによってリアルタイム保護を提供する高度な脅威検出システムをAIに対して導入すべきです。

 #2.8.1    レベル: 1    役割: D/V
 脅威検出パターンが、高性能なリアルタイムフィルタリングのために最適化された正規表現エンジンにコンパイルされ、レイテンシへの影響が最小限に抑えられていることを検証してください。
 #2.8.2    レベル: 1    役割: D/V
 脅威検出システムが異なる脅威カテゴリ（プロンプトインジェクション、有害コンテンツ、機密データ、システムコマンド）ごとに別々のパターンライブラリを維持していることを確認してください。
 #2.8.3    レベル: 2    役割: D/V
 適応型脅威検出が、攻撃の頻度と成功率に基づいて脅威感度を更新する機械学習モデルを組み込んでいることを検証してください。
 #2.8.4    レベル: 2    役割: D/V
 リアルタイムの脅威インテリジェンスフィードが、新しい攻撃シグネチャおよびIOC（侵害の指標）を使ってパターンライブラリを自動的に更新することを確認してください。
 #2.8.5    レベル: 3    役割: D/V
 脅威検出の誤検知率が継続的に監視されており、パターンの特異性が正当なユースケースへの干渉を最小限に抑えるよう自動的に調整されていることを確認してください。
 #2.8.6    レベル: 3    役割: D/V
 コンテキストベースの脅威分析が、入力ソース、ユーザーの行動パターン、およびセッション履歴を考慮して検出精度を向上させることを確認してください。
 #2.8.7    レベル: 3    役割: D/V
 脅威検知のパフォーマンス指標（検知率、処理遅延、リソース利用率）がリアルタイムで監視され、最適化されていることを確認してください。

---

### C2.9 マルチモーダル セキュリティ検証パイプライン

開発者は、特定の脅威検出およびリソース分離を用いて、テキスト、画像、音声、その他のAI入力モダリティに対するセキュリティ検証を提供すべきです。

 #2.9.1    レベル: 1    役割: D/V
 各入力モダリティが専用のセキュリティバリデータを備え、それぞれの脅威パターン（テキスト：プロンプトインジェクション、画像：ステガノグラフィ、音声：スペクトログラム攻撃）および検出閾値が文書化されていることを確認する。
 #2.9.2    レベル: 2    役割: D/V
 マルチモーダル入力が、それぞれのモダリティタイプに特有のリソース制限（メモリ、CPU、処理時間）を持つ独立したサンドボックス内で処理されていることを確認し、それがセキュリティポリシーに文書化されていることを検証してください。
 #2.9.3    レベル: 2    役割: D/V
 クロスモーダル攻撃検出が、相関ルールとアラート生成を用いて、複数の入力タイプにまたがる協調攻撃（例：画像内のステガノグラフィックペイロードとテキスト内のプロンプトインジェクションの組み合わせ）を識別することを検証してください。
 #2.9.4    レベル: 3    役割: D/V
 マルチモーダル検証の失敗が、すべての入力モダリティ、検証結果、脅威スコア、および構造化ログ形式での相関分析を含む詳細なログ記録をトリガーし、SIEM統合に対応していることを検証してください。
 #2.9.5    レベル: 3    役割: D/V
 モダリティ固有のコンテンツ分類器が、文書化されたスケジュール（最低でも四半期ごと）に従って、新しい脅威パターン、敵対的サンプル、および基準値以上の性能ベンチマークで更新されていることを確認してください。

---

### 参考文献

LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security
Generative AI's Biggest Security Flaw Is Not Easy to Fix
Many-shot jailbreaking \ Anthropic
$PDF$ OpenAI GPT-4.5 System Card
Notebook for the CheckThat Lab at CLEF 2024
Mitigate jailbreaks and prompt injections – Anthropic
Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis
OWASP Top 10 for LLM Applications 2025 – WorldTech IT
OWASP Machine Learning Security Top Ten
Few words about AI Security – Jussi Metso
How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry
Easily enforcing valid JSON schema following – API
AI Safety + Cybersecurity R\&D Tracker – Fairly AI
Anthropic makes 'jailbreak' advance to stop AI models producing harmful results
Pattern matching filter rules - IBM
Real-time Threat Detection

## C3 モデルライフサイクル管理と変更管理

### 制御目標

AIシステムは、不正または安全でないモデルの変更が本番環境に反映されるのを防ぐ変更管理プロセスを実装しなければなりません。この管理は、開発から展開、廃止に至るまでのライフサイクル全体を通じてモデルの整合性を確保し、迅速なインシデント対応を可能にし、すべての変更に対する責任を維持します。

コアセキュリティ目標：整合性、追跡可能性、および回復可能性を維持する管理されたプロセスを採用し、許可され検証されたモデルのみが本番環境に到達すること。

---

### C3.1 モデル認可と整合性

検証済みの完全性を持つ認可モデルのみが本番環境に到達します。

 #3.1.1    レベル: 1    役割: D/V
 展開前に、すべてのモデルアーティファクト（重み、設定、トークナイザー）が認可されたエンティティによって暗号学的に署名されていることを確認してください。
 #3.1.2    レベル: 1    役割: D/V
 モデルの整合性がデプロイ時に検証され、署名の検証に失敗した場合はモデルの読み込みが防止されることを確認してください。
 #3.1.3    レベル: 2    役割: D/V
 モデルの出所記録に、権限付与された主体の身元、トレーニングデータのチェックサム、合否ステータスを含む検証テスト結果、および作成タイムスタンプが含まれていることを確認してください。
 #3.1.4    レベル: 2    役割: D/V
 すべてのモデルアーティファクトが意味的バージョニング（MAJOR.MINOR.PATCH）を使用しており、それぞれのバージョン要素が増分される条件が文書化されていることを確認してください。
 #3.1.5    レベル: 2    役割: V
 依存関係の追跡がリアルタイムのインベントリを維持し、すべての消費システムの迅速な特定を可能にしていることを確認してください。

---

### C3.2 モデルの検証とテスト

モデルは展開前に定義されたセキュリティおよび安全性の検証を通過しなければなりません。

 #3.2.1    レベル: 1    役割: D/V
 モデルが展開前に、事前に合意された組織の合格/不合格基準を含む入力検証、出力のサニタイズ、安全性評価を含む自動化されたセキュリティテストを受けることを確認してください。
 #3.2.2    レベル: 1    役割: D/V
 検証の失敗が、事前に指定された権限者による明示的なオーバーライド承認と文書化された業務上の正当化があった場合を除き、自動的にモデルの展開をブロックすることを確認してください。
 #3.2.3    レベル: 2    役割: V
 テスト結果が暗号的に署名され、検証対象の特定のモデルバージョンのハッシュに不変にリンクされていることを確認してください。
 #3.2.4    レベル: 2    役割: D/V
 緊急展開には、事前に合意された期間内に予め指定されたセキュリティ権限者による文書化されたセキュリティリスク評価と承認が必要であることを確認してください。

---

### C3.3 制御された展開とロールバック

モデルの展開は、制御され、監視され、かつ元に戻せるものでなければなりません。

 #3.3.1    レベル: 1    役割: D
 本番環境へのデプロイメントが、事前に合意されたエラー率、レイテンシー閾値、またはセキュリティ警告基準に基づく自動ロールバックトリガーを備えた段階的なロールアウト機構（カナリアデプロイメント、ブルーグリーンデプロイメント）を実装していることを確認してください。
 #3.3.2    レベル: 1    役割: D/V
 ロールバック機能が事前定義された組織の時間枠内で、完全なモデル状態（重み、構成、依存関係）を原子的に復元することを検証してください。
 #3.3.3    レベル: 2    役割: D/V
 展開プロセスが暗号署名を検証し、モデルの有効化前に整合性チェックサムを計算して、一致しない場合は展開を失敗させることを確認してください。
 #3.3.4    レベル: 2    役割: D/V
 緊急モデルシャットダウン機能が、自動サーキットブレーカーまたは手動キルスイッチを介して、事前に定義された応答時間内にモデルエンドポイントを無効にできることを確認してください。
 #3.3.5    レベル: 2    役割: V
 ロールバックアーティファクト（以前のモデルバージョン、構成、依存関係）が組織のポリシーに従って、インシデント対応のために不変のストレージで保持されていることを確認してください。

---

### C3.4 変更の責任と監査

すべてのモデルのライフサイクルの変更は追跡可能で監査可能でなければなりません。

 #3.4.1    レベル: 1    役割: V
 すべてのモデル変更（展開、構成、廃止）が、タイムスタンプ、認証された実行者のID、変更タイプ、および変更前後の状態を含む不変の監査記録を生成することを検証してください。
 #3.4.2    レベル: 2    役割: D/V
 監査ログへのアクセスが適切な認可を必要とし、すべてのアクセス試行がユーザーの識別情報とタイムスタンプとともに記録されていることを確認してください。
 #3.4.3    レベル: 2    役割: D/V
 プロンプトテンプレートおよびシステムメッセージが、デプロイ前に指定されたレビュアーによる必須のコードレビューおよび承認を伴うgitリポジトリでバージョン管理されていることを確認してください。
 #3.4.4    レベル: 2    役割: V
 監査記録が、保持期間内の任意のタイムスタンプにおけるモデル状態の完全な再構築を可能にするために、十分な詳細（モデルハッシュ、構成スナップショット、依存関係のバージョン）を含んでいることを確認してください。

---

### C3.5 安全な開発プラクティス

モデルの開発およびトレーニングプロセスは、侵害を防ぐために安全な手法に従わなければなりません。

 #3.5.1    レベル: 1    役割: D
 モデル開発、テスト、および本番環境が物理的または論理的に分離されていることを確認してください。それらは共有インフラストラクチャを持たず、異なるアクセス制御が適用されており、データストアも分離されています。
 #3.5.2    レベル: 1    役割: D
 モデルのトレーニングおよびファインチューニングが、ネットワークアクセスが制御された隔離環境で行われていることを確認してください。
 #3.5.3    レベル: 1    役割: D/V
 トレーニングデータのソースが、モデル開発に使用される前に、完全性チェックを通じて検証され、信頼できるソースを介して認証され、文書化された管理記録があることを確認してください。
 #3.5.4    レベル: 2    役割: D
 モデル開発の成果物（ハイパーパラメータ、トレーニングスクリプト、設定ファイル）がバージョン管理に保存されており、トレーニングで使用する前にピアレビューの承認が必要であることを確認してください。

---

### C3.6 モデルの廃止と退役

モデルは、もはや必要でなくなった場合やセキュリティ上の問題が確認された場合に、安全に廃止されなければなりません。

 #3.6.1    レベル: 1    役割: D
 モデルの廃止プロセスが依存関係グラフを自動的にスキャンし、すべての利用システムを特定し、廃止前に事前に合意された通知期間を提供することを確認してください。
 #3.6.2    レベル: 1    役割: D/V
 退役したモデルのアーティファクトが、文書化されたデータ保持ポリシーに従い、暗号消去または複数回の上書きにより安全に消去されていることを確認し、破棄証明書でその破壊が検証されていることを確認してください。
 #3.6.3    レベル: 2    役割: V
 モデルの引退イベントがタイムスタンプとアクターの識別情報とともに記録され、モデルの署名が再利用を防ぐために取り消されていることを確認してください。
 #3.6.4    レベル: 2    役割: D/V
 緊急モデルリタイアメントが、重大なセキュリティ脆弱性が発見された場合に、自動キルスイッチを通じて事前に設定された緊急対応時間内にモデルアクセスを無効化できることを確認してください。

---

### 参考文献

MLOps Principles
Securing AI/ML Ops – Cisco.com
Audit logs security: cryptographically signed tamper-proof logs
Machine Learning Model Versioning: Top Tools & Best Practices
AI Hygiene Starts with Models and Data Loaders – SEI Blog
How to handle versioning and rollback of a deployed ML model?
Reinforcement fine-tuning – OpenAI API
Auditing Machine Learning models: Governance, Data Security and …
Adversarial Training to Improve Model Robustness
What is AI adversarial robustness? – IBM Research
Exploring Data Provenance: Ensuring Data Integrity and Authenticity
MITRE ATLAS
AWS Prescriptive Guidance – Best practices for retiring applications …

## C4インフラストラクチャ、構成および展開セキュリティ

### 制御目標

AIインフラストラクチャは、特権昇格、サプライチェーンの改ざん、およびランダムな横移動に対して、セキュアな構成、実行時の分離、信頼されたデプロイメントパイプライン、および包括的な監視を通じて強化されなければなりません。承認され、検証されたインフラストラクチャのコンポーネントと構成のみが、セキュリティ、完全性、および監査可能性を維持する管理されたプロセスを経て本番環境に到達します。

コアセキュリティ目標：暗号的に署名され、脆弱性スキャンされたインフラストラクチャコンポーネントのみが、自動化された検証パイプラインを通じて本番環境に到達し、セキュリティポリシーを強制し、不変の監査トレイルを維持すること。

---

### C4.1 実行環境の分離

カーネルレベルの分離プリミティブと強制アクセス制御を通じて、コンテナの脱出や権限昇格を防止します。

 #4.1.1    レベル: 1    役割: D/V
 すべてのAIコンテナがCAP_SETUID、CAP_SETGID、およびセキュリティベースラインに明記された明示的に必要な権限を除き、すべてのLinux権限を削除していることを確認してください。
 #4.1.2    レベル: 1    役割: D/V
 seccompプロファイルが事前承認された許可リストにあるシステムコール以外をすべてブロックし、違反があった場合にはコンテナを終了させ、セキュリティアラートを生成することを確認してください。
 #4.1.3    レベル: 2    役割: D/V
 AIワークロードが読み取り専用のルートファイルシステム、テンポラリデータ用のtmpfs、およびnoexecマウントオプションが適用された永続データ用の名前付きボリュームで実行されていることを検証してください。
 #4.1.4    レベル: 2    役割: D/V
 eBPFベースのランタイム監視（Falco、Tetragon、または同等のもの）が権限昇格の試みを検出し、組織の対応時間要件内で違反プロセスを自動的に終了することを検証してください。
 #4.1.5    レベル: 3    役割: D/V
 高リスクのAIワークロードが、認証検証付きでハードウェア分離環境（Intel TXT、AMD SVM、または専用のベアメタルノード）で実行されていることを確認してください。

---

### C4.2 セキュアなビルド＆デプロイメントパイプライン

再現可能なビルドと署名付きアーティファクトを通じて、暗号的な完全性とサプライチェーンのセキュリティを確保します。

 #4.2.1    レベル: 1    役割: D/V
 インフラストラクチャー・アズ・コードが、すべてのコミットでツール（tfsec、Checkov、またはTerrascan）を使用してスキャンされ、CRITICALまたはHIGHの重大度の検出結果がある場合はマージがブロックされることを確認してください。
 #4.2.2    レベル: 1    役割: D/V
 コンテナビルドがビルドごとに同一のSHA256ハッシュで再現可能であることを検証し、Sigstoreで署名されたSLSAレベル3のプロビナンス証明書を生成してください。
 #4.2.3    レベル: 2    役割: D/V
 コンテナイメージがCycloneDXまたはSPDXのSBOMを組み込み、Cosignで署名されていることを確認し、署名されていないイメージはレジストリへのプッシュ前に拒否し、デプロイ時にも拒否されるようにします。
 #4.2.4    レベル: 2    役割: D/V
 CI/CDパイプラインがHashiCorp Vault、AWS IAMロール、またはAzureマネージドアイデンティティからのOIDCトークンを使用し、その有効期間が組織のセキュリティポリシーの制限を超えていないことを確認してください。
 #4.2.5    レベル: 2    役割: D/V
 コンテナ実行前のデプロイメントプロセス中にCosign署名およびSLSAプロビナンスが検証され、検証エラーが発生した場合にはデプロイメントが失敗することを確認してください。
 #4.2.6    レベル: 2    役割: D/V
 ビルド環境が永続ストレージを持たず、生産用VPCからネットワーク的に隔離されたエフェメラルコンテナまたはVMで実行されていることを確認してください。

---

### C4.3 ネットワークセキュリティとアクセス制御

デフォルト拒否ポリシーと暗号化通信を用いてゼロトラストネットワーキングを実装します。

 #4.3.1    レベル: 1    役割: D/V
 Kubernetes NetworkPolicies または同等の機能が、必要なポート（443、8080 など）に対して明示的な許可ルールを持つデフォルト拒否のインバウンド/アウトバウンド制御を実装していることを確認してください。
 #4.3.2    レベル: 1    役割: D/V
 SSH（ポート22）、RDP（ポート3389）、およびクラウドメタデータエンドポイント（169.254.169.254）がブロックされているか、証明書ベースの認証が必要であることを確認してください。
 #4.3.3    レベル: 2    役割: D/V
 egressトラフィックがHTTP/HTTPSプロキシ（Squid、Istio、またはクラウドNATゲートウェイ）を通じてフィルタリングされ、ドメイン許可リストを使用し、ブロックされたリクエストがログに記録されていることを検証してください。
 #4.3.4    レベル: 2    役割: D/V
 サービス間通信が相互TLSを使用し、組織のポリシーに従って証明書がローテーションされ、証明書の検証が強制されていること（skip-verifyフラグが使用されていないこと）を確認してください。
 #4.3.5    レベル: 2    役割: D/V
 AIインフラストラクチャが専用のVPC/VNetで稼働し、直接インターネットアクセスがなく、NATゲートウェイまたはバスチオンホストを通じてのみ通信していることを確認してください。

---

### C4.4 シークレットおよび暗号鍵管理

ハードウェアに裏付けられたストレージおよびゼロトラストアクセスによる自動ローテーションを通じて認証情報を保護します。

 #4.4.1    レベル: 1    役割: D/V
 秘密は、AES-256を使用した保存時の暗号化とともに、HashiCorp Vault、AWS Secrets Manager、Azure Key Vault、またはGoogle Secret Managerに保管されていることを確認してください。
 #4.4.2    レベル: 1    役割: D/V
 暗号鍵がFIPS 140-2レベル2のHSM（AWS CloudHSM、Azure Dedicated HSM）で生成され、組織の暗号ポリシーに従った鍵のローテーションが行われていることを検証します。
 #4.4.3    レベル: 2    役割: D/V
 秘密のローテーションがゼロダウンタイムのデプロイメントで自動化されており、かつ人事異動やセキュリティインシデントによって即時にローテーションがトリガーされることを確認してください。
 #4.4.4    レベル: 2    役割: D/V
 コンテナイメージがGitLeaks、TruffleHog、またはdetect-secretsなどのツールでスキャンされ、APIキー、パスワード、または証明書を含むビルドがブロックされていることを確認してください。
 #4.4.5    レベル: 2    役割: D/V
 本番環境のシークレットアクセスにはハードウェアトークン（YubiKey、FIDO2）を用いた多要素認証（MFA）が必要であり、ユーザー識別情報とタイムスタンプを含む不変の監査ログに記録されていることを確認してください。
 #4.4.6    レベル: 2    役割: D/V
 秘密はKubernetesシークレット、マウントされたボリューム、またはinitコンテナを介して注入されていることを確認し、秘密が環境変数やイメージに埋め込まれることが決してないようにしてください。

---

### C4.5 AI ワークロードのサンドボックス化と検証

包括的な行動分析を伴う安全なサンドボックス内で信頼できないAIモデルを隔離します。

 #4.5.1    レベル: 1    役割: D/V
 外部のAIモデルが、gVisor、microVM（Firecracker、CrossVMなど）、または--security-opt=no-new-privilegesおよび--read-onlyフラグを使用したDockerコンテナで実行されていることを確認してください。
 #4.5.2    レベル: 1    役割: D/V
 サンドボックス環境がネットワーク接続なし（--network=none）であるか、ローカルホストへのアクセスのみ許可され、すべての外部リクエストがiptablesルールでブロックされていることを確認してください。
 #4.5.3    レベル: 2    役割: D/V
 AIモデルの検証には、組織的に定義されたテストカバレッジと動作分析を用いたバックドア検出のための自動化されたレッドチームテストが含まれていることを確認してください。
 #4.5.4    レベル: 2    役割: D/V
 AIモデルが本番環境に昇格される前に、そのサンドボックスの結果が認可されたセキュリティ担当者によって暗号的に署名され、不変の監査ログに保存されていることを確認してください。
 #4.5.5    レベル: 2    役割: D/V
 評価間にサンドボックス環境がゴールデンイメージから破棄および再作成され、ファイルシステムとメモリが完全にクリーンアップされていることを確認してください。

---

### C4.6 インフラストラクチャーセキュリティ監視

インフラストラクチャを継続的にスキャンおよび監視し、自動修復とリアルタイムアラートを実施します。

 #4.6.1    レベル: 1    役割: D/V
 コンテナイメージが組織のスケジュールに従ってスキャンされていることを確認し、組織のリスク閾値に基づいて重要な脆弱性が検出された場合は展開がブロックされるようにしてください。
 #4.6.2    レベル: 1    役割: D/V
 組織で定義されたコンプライアンス閾値および失敗したチェックの自動修復を用いて、インフラストラクチャがCISベンチマークまたはNIST 800-53コントロールに準拠していることを検証します。
 #4.6.3    レベル: 2    役割: D/V
 組織のリスク管理タイムラインに従って、高重大度の脆弱性が修正されていることを確認し、積極的に悪用されているCVEに対しては緊急対応手順を適用する。
 #4.6.4    レベル: 2    役割: V
 セキュリティアラートがCEFまたはSTIX/TAXIIフォーマットを使用して自動エンリッチメントとともに、SIEMプラットフォーム（Splunk、Elastic、またはSentinel）と統合されていることを検証してください。
 #4.6.5    レベル: 3    役割: V
 インフラストラクチャのメトリクスが、SLAダッシュボードおよび経営層向けレポーティング付きで監視システム（Prometheus、DataDog）にエクスポートされていることを確認してください。
 #4.6.6    レベル: 2    役割: D/V
 組織の監視要件に従ってツール（Chef InSpec、AWS Config）を使用して構成ドリフトが検出されることを確認し、不正な変更に対しては自動ロールバックが行われることを確認してください。

---

### C4.7 AIインフラストラクチャ資源管理

リソース枯渇攻撃を防止し、クォータと監視を通じて公正なリソース配分を確保します。

 #4.7.1    レベル: 1    役割: D/V
 GPU/TPUの使用率が監視され、組織で定められた閾値でアラートがトリガーされ、容量管理ポリシーに基づいて自動スケーリングまたは負荷分散が有効化されていることを確認してください。
 #4.7.2    レベル: 1    役割: D/V
 AIワークロードの指標（推論レイテンシ、スループット、エラー率）が組織の監視要件に従って収集され、インフラストラクチャの利用状況と相関していることを確認してください。
 #4.7.3    レベル: 2    役割: D/V
 KubernetesのResourceQuotaまたは同等の機能が、組織のリソース割り当てポリシーに従って個々のワークロードを制限し、ハードリミットが適用されていることを検証してください。
 #4.7.4    レベル: 2    役割: V
 コスト監視が、組織の予算閾値に基づくアラートおよび予算超過に対する自動制御とともに、ワークロード／テナントごとの支出を追跡していることを確認してください。
 #4.7.5    レベル: 3    役割: V
 キャパシティプランニングが、組織で定義された予測期間を用いた過去のデータと、需要パターンに基づく自動リソースプロビジョニングを利用していることを検証してください。
 #4.7.6    レベル: 2    役割: D/V
 組織の対応要件に従って、リソース枯渇が回路遮断器をトリガーすることを検証します。これには、キャパシティポリシーに基づくレート制限やワークロードの分離が含まれます。

---

### C4.8 環境分離およびプロモーション制御

自動化された昇格ゲートとセキュリティ検証により、厳格な環境境界を強化します。

 #4.8.1    レベル: 1    役割: D/V
 dev/test/prod 環境がそれぞれ別の VPC/VNet で実行されており、共有の IAM ロール、セキュリティグループ、またはネットワーク接続がないことを確認してください。
 #4.8.2    レベル: 1    役割: D/V
 環境プロモーションには、組織で定義された権限を持つ担当者による暗号署名と変更不可能な監査記録が必要であることを検証してください。
 #4.8.3    レベル: 2    役割: D/V
 本番環境がSSHアクセスをブロックし、デバッグエンドポイントを無効化し、緊急時を除いて組織の事前通知要件を伴う変更要求を必須としていることを確認してください。
 #4.8.4    レベル: 2    役割: D/V
 インフラストラクチャー・アズ・コードの変更が、メインブランチへのマージ前に自動テストおよびセキュリティスキャンを伴うピアレビューを必要とすることを確認してください。
 #4.8.5    レベル: 2    役割: D/V
 非本番データが組織のプライバシー要件に従って匿名化されていること、合成データ生成が行われていること、またはPII（個人識別情報）を除去した完全なデータマスキングが確認されていることを検証する。
 #4.8.6    レベル: 2    役割: D/V
 昇進ゲートに、自動化されたセキュリティテスト（SAST、DAST、コンテナスキャン）が含まれており、クリティカルな問題がゼロでなければ承認されないことを確認してください。

---

### C4.9 インフラストラクチャのバックアップとリカバリー

自動バックアップ、検証済みの復旧手順、および災害復旧機能を通じてインフラのレジリエンスを確保します。

 #4.9.1    レベル: 1    役割: D/V
 インフラストラクチャの構成が、組織のバックアップスケジュールに従って、3-2-1バックアップ戦略を実装し、地理的に分散した地域にバックアップされていることを検証します。
 #4.9.2    レベル: 2    役割: D/V
 バックアップシステムが分離されたネットワークで動作し、別個の認証情報とランサムウェア対策のためのエアギャップストレージを使用していることを確認してください。
 #4.9.3    レベル: 2    役割: V
 復旧手順が、組織のスケジュールに従って自動テストによりテストおよび検証されており、RTOおよびRPOの目標が組織の要件を満たしていることを確認してください。
 #4.9.4    レベル: 3    役割: V
 災害復旧には、モデル重みの復元、GPUクラスターの再構築、サービス依存関係のマッピングを含むAI固有のランブックが含まれていることを確認してください。

---

### C4.10 インフラストラクチャのコンプライアンスとガバナンス

継続的な評価、文書化、および自動化された制御を通じて、規制遵守を維持します。

 #4.10.1    レベル: 2    役割: D/V
 組織のスケジュールに基づき、SOC 2、ISO 27001、またはFedRAMPの管理策に対してインフラストラクチャの準拠状況が評価され、自動証拠収集が行われていることを検証します。
 #4.10.2    レベル: 2    役割: V
 インフラストラクチャのドキュメントに、組織の変更管理要件に従って更新されたネットワーク図、データフローマップ、および脅威モデルが含まれていることを確認してください。
 #4.10.3    レベル: 3    役割: D/V
 インフラストラクチャの変更が、自動化されたコンプライアンス影響評価を経て、ハイリスクの変更に対しては規制承認ワークフローが適用されることを確認してください。

---

### C4.11 AIハードウェアセキュリティ

GPU、TPU、および専用AIアクセラレータを含む、AI専用のハードウェアコンポーネントを保護します。

 #4.11.1    レベル: 2    役割: D/V
 AIアクセラレータのファームウェア（GPU BIOS、TPUファームウェア）が暗号署名で検証され、組織のパッチ管理スケジュールに従って更新されていることを確認してください。
 #4.11.2    レベル: 2    役割: D/V
 ワークロードの実行前に、TPM 2.0、Intel TXT、または AMD SVM を使用したハードウェア認証によって AI アクセラレータの整合性が検証されることを確認してください。
 #4.11.3    レベル: 2    役割: D/V
 SR-IOV、MIG（マルチインスタンスGPU）、または同等のハードウェアパーティショニングを使用して、ワークロード間でGPUメモリが分離され、ジョブ間でメモリのサニタイズが行われていることを検証してください。
 #4.11.4    レベル: 3    役割: V
 AIハードウェアのサプライチェーンにおいて、製造元の証明書による出所確認および改ざん防止包装の検証が含まれていることを確認してください。
 #4.11.5    レベル: 3    役割: D/V
 ハードウェアセキュリティモジュール（HSM）が、FIPS 140-2 レベル3またはCommon Criteria EAL4+認証を取得して、AIモデルの重みおよび暗号鍵を保護していることを確認してください。

---

### C4.12 エッジ＆分散AIインフラストラクチャ

エッジコンピューティング、フェデレーテッドラーニング、およびマルチサイトアーキテクチャを含む安全な分散AI展開。

 #4.12.1    レベル: 2    役割: D/V
 エッジAIデバイスが組織の証明書管理ポリシーに従って回転されるデバイス証明書を使用して、相互TLSによって中央インフラストラクチャに認証されることを検証してください。
 #4.12.2    レベル: 2    役割: D/V
 エッジデバイスが署名検証済みのセキュアブートを実装し、ファームウェアのダウングレード攻撃を防ぐロールバック保護を備えていることを確認してください。
 #4.12.3    レベル: 3    役割: D/V
 分散型AIの協調が、参加者の検証と悪意のあるノード検出を備えたビザンチン障害耐性コンセンサスアルゴリズムを使用していることを確認してください。
 #4.12.4    レベル: 3    役割: D/V
 エッジからクラウドへの通信が、帯域幅制限、データ圧縮、および安全なローカルストレージを備えたオフライン動作機能を含んでいることを検証してください。

---

### C4.13 マルチクラウドおよびハイブリッドインフラストラクチャセキュリティ

複数のクラウドプロバイダーおよびハイブリッドクラウド・オンプレミス展開にわたるAIワークロードを安全に保護します。

 #4.13.1    レベル: 2    役割: D/V
 マルチクラウドAI展開で、クラウドに依存しないアイデンティティフェデレーション（OIDC、SAML）を使用し、プロバイダー間で集中化されたポリシー管理が行われていることを確認してください。
 #4.13.2    レベル: 2    役割: D/V
 クロスクラウドデータ転送が、カスタマー管理キーによるエンドツーエンド暗号化を使用し、かつ管轄地域ごとに適用されるデータ居住制御を確実に適用していることを検証してください。
 #4.13.3    レベル: 2    役割: D/V
 ハイブリッドクラウドAIワークロードが、オンプレミス環境とクラウド環境の両方で一貫したセキュリティポリシーを実装し、統合された監視とアラート機能を備えていることを確認してください。
 #4.13.4    レベル: 3    役割: V
 クラウドベンダーロックイン防止には、ポータブルなインフラストラクチャ・アズ・コード、標準化されたAPI、およびフォーマット変換ツールを備えたデータエクスポート機能が含まれていることを確認してください。
 #4.13.5    レベル: 3    役割: V
 マルチクラウドのコスト最適化には、リソースの過剰展開を防ぐセキュリティコントロールと、無許可のクロスクラウドデータ転送費用を防止する措置が含まれていることを確認してください。

---

### C4.14 インフラストラクチャ自動化とGitOpsセキュリティ

AIインフラ管理のための安全なインフラストラクチャ自動化パイプラインとGitOpsワークフロー。

 #4.14.1    レベル: 2    役割: D/V
 GitOpsリポジトリがGPGキーによる署名付きコミットを必要とし、メインブランチへの直接プッシュを防止するブランチ保護ルールを適用していることを確認してください。
 #4.14.2    レベル: 2    役割: D/V
 インフラストラクチャの自動化に、組織の対応要件に基づいてトリガーされる不正な変更に対するドリフト検出、自動修復、およびロールバック機能が含まれていることを検証してください。
 #4.14.3    レベル: 2    役割: D/V
 自動化されたインフラストラクチャのプロビジョニングが、セキュリティポリシーの検証を含み、準拠しない構成に対して展開をブロックすることを確認してください。
 #4.14.4    レベル: 2    役割: D/V
 インフラストラクチャの自動化シークレットが、外部シークレットオペレーター（External Secrets Operator、Bank-Vaults）を通じて管理され、自動ローテーションが行われていることを確認してください。
 #4.14.5    レベル: 3    役割: V
 セルフヒーリングインフラストラクチャが、セキュリティイベントの相関分析と自動化されたインシデント対応および利害関係者への通知ワークフローを含んでいることを確認してください。

---

### C4.15 量子耐性インフラストラクチャセキュリティ

ポスト量子暗号と量子安全プロトコルを通じて、量子コンピューティングの脅威に対するAIインフラストラクチャを準備する。

 #4.15.1    レベル: 3    役割: D/V
 AIインフラストラクチャが、鍵交換およびデジタル署名のためにNIST承認のポスト量子暗号アルゴリズム（CRYSTALS-Kyber、CRYSTALS-Dilithium、SPHINCS+）を実装していることを確認してください。
 #4.15.2    レベル: 3    役割: D/V
 量子安全な鍵管理プロトコルを用いて、高セキュリティのAI通信のために量子鍵配送（QKD）システムが実装されていることを検証してください。
 #4.15.3    レベル: 3    役割: D/V
 暗号アジリティフレームワークが、自動化された証明書および鍵のローテーションにより、新しいポスト量子アルゴリズムへの迅速な移行を可能にすることを検証してください。
 #4.15.4    レベル: 3    役割: V
 量子脅威モデリングが、文書化された移行スケジュールとリスク評価とともに、AIインフラストラクチャの量子攻撃に対する脆弱性を評価していることを検証してください。
 #4.15.5    レベル: 3    役割: D/V
 ハイブリッドな古典-量子暗号システムが、量子移行期間中にパフォーマンス監視を伴う多層防御を提供することを検証する。

---

### C4.16 機密コンピューティングとセキュアエンクレーブ

ハードウェアベースの信頼できる実行環境と機密コンピューティング技術を使用して、AIワークロードとモデルの重みを保護します。

 #4.16.1    レベル: 3    役割: D/V
 Intel SGXエンクレーブ、AMD SEV-SNP、またはARM TrustZone内で暗号化メモリと認証検証を伴い、機密性の高いAIモデルが実行されることを検証してください。
 #4.16.2    レベル: 3    役割: D/V
 機密コンテナ（Kata Containers、機密コンピューティングを用いた gVisor）が、ハードウェアによって強制されるメモリ暗号化を用いてAIワークロードを分離していることを検証してください。
 #4.16.3    レベル: 3    役割: D/V
 遠隔認証がエンクレーブの完全性を検証し、実行環境の真正性に関する暗号学的証明とともにAIモデルのロード前に確認することを検証してください。
 #4.16.4    レベル: 3    役割: D/V
 機密のAI推論サービスが、シールドされたモデル重みと保護された実行環境による暗号化計算を通じてモデル抽出を防止していることを検証してください。
 #4.16.5    レベル: 3    役割: D/V
 信頼できる実行環境のオーケストレーションが、リモート認証と暗号化通信チャネルを用いてセキュアエンクレーブのライフサイクルを管理していることを検証してください。
 #4.16.6    レベル: 3    役割: D/V
 安全なマルチパーティコンピュテーション（SMPC）が、個々のデータセットやモデルパラメータを公開することなく、協調的なAIトレーニングを可能にすることを検証してください。

---

### C4.17 ゼロ知識インフラストラクチャ

機密情報を明かさずにプライバシー保護されたAIの検証および認証のために、ゼロ知識証明システムを実装する。

 #4.17.1    レベル: 3    役割: D/V
 ゼロ知識証明（ZK-SNARKs、ZK-STARKs）は、モデルの重みやトレーニングデータを公開することなく、AIモデルの完全性およびトレーニングの由来を検証できることを確認してください。
 #4.17.2    レベル: 3    役割: D/V
 ZKベースの認証システムが、身元に関する情報を明かすことなくAIサービスのためのプライバシー保護型ユーザー認証を可能にすることを検証してください。
 #4.17.3    レベル: 3    役割: D/V
 プライベートセットインターセクション（PSI）プロトコルは、個別のデータセットを公開することなく、フェデレーテッドAIにおける安全なデータマッチングを可能にすることを検証してください。
 #4.17.4    レベル: 3    役割: D/V
 ゼロ知識機械学習（ZKML）システムは、計算の正確性を証明する暗号学的証明を用いて検証可能なAI推論を可能にすることを確認してください。
 #4.17.5    レベル: 3    役割: D/V
 ZK-rollupsは、バッチ検証と計算負荷の軽減によって、スケーラブルでプライバシーを保護するAIトランザクション処理を提供することを検証してください。

---

### C4.18 サイドチャネル攻撃防止

タイミング攻撃、電力攻撃、電磁波攻撃、キャッシュベースのサイドチャネル攻撃からAIインフラストラクチャを保護し、機密情報の漏洩を防ぎます。

 #4.18.1    レベル: 3    役割: D/V
 AI推論のタイミングが定数時間アルゴリズムとパディングを使用して正規化され、タイミングに基づくモデル抽出攻撃を防止していることを確認してください。
 #4.18.2    レベル: 3    役割: D/V
 AIハードウェアに対する電力解析保護には、ノイズ注入、電力ラインフィルタリング、およびランダム化された実行パターンが含まれていることを確認してください。
 #4.18.3    レベル: 3    役割: D/V
 キャッシュベースのサイドチャネル緩和策は、情報漏洩を防ぐためにキャッシュのパーティショニング、ランダム化、およびフラッシュ命令を使用していることを確認してください。
 #4.18.4    レベル: 3    役割: D/V
 電磁波放射防護には、TEMPEST様式の攻撃を防ぐために、シールド、信号フィルタリング、およびランダム化処理が含まれていることを確認してください。
 #4.18.5    レベル: 3    役割: D/V
 マイクロアーキテクチャのサイドチャネル防御には、投機的実行制御やメモリアクセスパターンの難読化が含まれていることを確認してください。

---

### C4.19 ニューロモルフィックおよび専門化AIハードウェアセキュリティ

ニューロモルフィックチップ、FPGA、カスタムASIC、および光学コンピューティングシステムを含む、新興のAIハードウェアアーキテクチャのセキュリティを確保する。

 #4.19.1    レベル: 3    役割: D/V
 ニューロモルフィックチップのセキュリティには、スパイクパターンの暗号化、シナプス重みの保護、およびハードウェアベースの学習ルール検証が含まれていることを確認してください。
 #4.19.2    レベル: 3    役割: D/V
 FPGAベースのAIアクセラレータが、ビットストリームの暗号化、改ざん防止機構、および認証されたアップデートによる安全な構成のロードを実装していることを検証してください。
 #4.19.3    レベル: 3    役割: D/V
 カスタムASICのセキュリティには、オンチップセキュリティプロセッサ、ハードウェアルートオブトラスト、および改ざん検出機能を備えた安全なキー保管が含まれていることを検証してください。
 #4.19.4    レベル: 3    役割: D/V
 光学計算システムが量子安全な光学暗号化、セキュアなフォトニックスイッチング、および保護された光信号処理を実装していることを検証する。
 #4.19.5    レベル: 3    役割: D/V
 ハイブリッドアナログ・デジタルAIチップが、安全なアナログ計算、保護された重みの保存、および認証されたアナログからデジタルへの変換を含むことを検証してください。

---

### C4.20 プライバシー保護計算インフラストラクチャ

AI処理および分析中の機密データを保護するため、プライバシー保護計算のためのインフラストラクチャ制御を実装します。

 #4.20.1    レベル: 3    役割: D/V
 ホモモルフィック暗号化インフラストラクチャが、暗号的整合性検証およびパフォーマンス監視を伴う機密AIワークロードの暗号化計算を可能にしていることを検証する。
 #4.20.2    レベル: 3    役割: D/V
 プライベート情報検索システムが、アクセスパターンの暗号学的保護を用いて、問い合わせパターンを明かすことなくデータベースクエリを可能にすることを検証する。
 #4.20.3    レベル: 3    役割: D/V
 セキュアマルチパーティ計算プロトコルが、個々の入力や中間計算を公開することなくプライバシーを保護したAI推論を可能にすることを検証してください。
 #4.20.4    レベル: 3    役割: D/V
 プライバシー保護型キー管理には、分散キー生成、しきい値暗号方式、およびハードウェア支援による保護を備えた安全なキー回転が含まれていることを確認してください。
 #4.20.5    レベル: 3    役割: D/V
 プライバシー保護計算の性能が、暗号学的なセキュリティ保証を維持しながら、バッチ処理、キャッシュ、およびハードウェアアクセラレーションを通じて最適化されていることを検証する。

---

### C4.15 エージェントフレームワーク クラウド統合セキュリティとハイブリッド展開

ハイブリッドオンプレミス/クラウドアーキテクチャを持つクラウド統合型エージェントフレームワークのセキュリティコントロール。

 #4.15.1    レベル: 1    役割: D/V
 クラウドストレージ統合がエージェント制御の鍵管理によるエンドツーエンド暗号化を使用していることを確認してください。
 #4.15.2    レベル: 2    役割: D/V
 ハイブリッド展開のセキュリティ境界が明確に定義されており、通信チャネルが暗号化されていることを確認してください。
 #4.15.3    レベル: 2    役割: D/V
 クラウドリソースへのアクセスが、継続的認証を伴うゼロトラスト検証を含んでいることを確認してください。
 #4.15.4    レベル: 3    役割: D/V
 データ居住要件が保管場所の暗号的証明によって確実に施行されていることを検証する。
 #4.15.5    レベル: 3    役割: D/V
 クラウドプロバイダーのセキュリティ評価に、エージェント固有の脅威モデリングおよびリスク評価が含まれていることを確認してください。

---

### 参考文献

NIST Cybersecurity Framework 2.0
CIS Controls v8
OWASP Container Security Verification Standard
Kubernetes Security Best Practices
SLSA Supply Chain Security Framework
NIST SP 800-190: Application Container Security Guide
Cloud Security Alliance: Cloud Controls Matrix
ENISA: Secure Infrastructure Design
NIST SP 800-53: Security Controls for Federal Information Systems
ISO 27001:2022 Information Security Management
NIST AI Risk Management Framework
CIS Kubernetes Benchmark
FIPS 140-2 Security Requirements
NIST SP 800-207: Zero Trust Architecture
IEEE 2857: Privacy Engineering for AI Systems
NIST SP 800-161: Cybersecurity Supply Chain Risk Management
NIST Post-Quantum Cryptography Standards
Intel SGX Developer Guide
AMD SEV-SNP White Paper
ARM TrustZone Technology
ZK-SNARKs: A Gentle Introduction
NIST SP 800-57: Cryptographic Key Management
Side-Channel Attack Countermeasures
Neuromorphic Computing Security Challenges
FPGA Security: Fundamentals, Evaluation, and Countermeasures
Microsoft SEAL: Homomorphic Encryption Library
HElib: Homomorphic Encryption Library
PALISADE Lattice Cryptography Library
Differential Privacy: A Survey of Results
Secure Aggregation for Federated Learning
Private Information Retrieval: Concepts and Constructions

## C5 AIコンポーネントおよびユーザー向けアクセス制御とアイデンティティ

### 制御目標

AIシステムの効果的なアクセス制御には、堅牢なアイデンティティ管理、コンテキスト認識の認可、およびゼロトラスト原則に基づく実行時の強制が必要です。これらの制御により、人間、サービス、自律エージェントは明示的に付与されたスコープ内のモデル、データ、および計算リソースとだけ相互作用でき、継続的な検証と監査機能が確保されます。

---

### C5.1 アイデンティティ管理と認証

特権操作のために多要素認証を用いて、すべてのエンティティに暗号学的に裏付けられた識別を確立する。

 #5.1.1    レベル: 1    役割: D/V
 すべての人間のユーザーとサービスプリンシパルが、OIDC/SAMLプロトコルを使用して一元化された企業のアイデンティティプロバイダー（IdP）を通じて認証され、ユニークなアイデンティティからトークンへのマッピングが行われていること（共有アカウントや資格情報がないこと）を検証してください。
 #5.1.2    レベル: 1    役割: D/V
 高リスク操作（モデルのデプロイ、重みのエクスポート、トレーニングデータへのアクセス、本番環境の設定変更）には、多要素認証またはセッションの再検証を伴うステップアップ認証が必要であることを確認してください。
 #5.1.3    レベル: 2    役割: D
 新しい管理者が本番システムアクセスを受ける前に、NIST 800-63-3 IAL-2 または同等の基準に準拠した身元確認（アイデンティティプルーフィング）を受けていることを確認してください。
 #5.1.4    レベル: 2    役割: V
 アクセスレビューが四半期ごとに実施されていること、および自動的な休眠アカウント検出、認証情報のローテーション強制、そしてプロビジョニング解除ワークフローが行われていることを検証してください。
 #5.1.5    レベル: 3    役割: D/V
 フェデレーテッドAIエージェントが、最大有効期間24時間の署名付きJWTアサーションを介して認証され、かつ起源を証明する暗号的証明を含むことを検証してください。

---

### C5.2 リソース承認と最小権限

すべてのAIリソースに対して、明示的な許可モデルと監査トレイルを備えたきめ細かいアクセス制御を実装してください。

 #5.2.1    レベル: 1    役割: D/V
 すべてのAIリソース（データセット、モデル、エンドポイント、ベクターコレクション、埋め込みインデックス、コンピュートインスタンス）が、明示的な許可リストおよびデフォルト拒否ポリシーを用いたロールベースアクセス制御を適用していることを検証してください。
 #5.2.2    レベル: 1    役割: D/V
 サービスアカウントに対して、最小権限の原則がデフォルトで適用され、読み取り専用の権限から開始されることと、書き込み権限には文書化された業務上の正当な理由が必要であることを確認してください。
 #5.2.3    レベル: 1    役割: V
 すべてのアクセス制御の変更が、承認された変更要求に関連付けられており、タイムスタンプ、実行者の識別情報、リソース識別子、権限の差分とともに不変に記録されていることを検証してください。
 #5.2.4    レベル: 2    役割: D
 データ分類ラベル（PII、PHI、輸出管理対象、所有権保持）が派生リソース（埋め込み、プロンプトキャッシュ、モデル出力）に自動的に伝達され、一貫したポリシー適用がなされていることを検証してください。
 #5.2.5    レベル: 2    役割: D/V
 不正アクセスの試行および権限昇格イベントが、5分以内にコンテキストメタデータとともにSIEMシステムにリアルタイムアラートを生成することを確認してください。

---

### C5.3 動的ポリシー評価

コンテキストに基づく認可判断と監査機能を備えた属性ベースのアクセス制御（ABAC）エンジンを展開します。

 #5.3.1    レベル: 1    役割: D/V
 認証されたAPIを介してアクセス可能で、暗号的整合性保護が施された専用のポリシーエンジン（OPA、Cedar、または同等のもの）に権限決定が外部化されていることを検証してください。
 #5.3.2    レベル: 1    役割: D/V
 ポリシーが動的属性をランタイムで評価することを確認してください。これには、ユーザーのクリアランスレベル、リソースの機密分類、リクエストコンテキスト、テナントの分離、および時間的制約が含まれます。
 #5.3.3    レベル: 2    役割: D
 ポリシー定義がバージョン管理され、ピアレビューされ、CI/CDパイプラインでの自動テストを通じて検証されてから本番環境に展開されることを確認してください。
 #5.3.4    レベル: 2    役割: V
 ポリシー評価結果に構造化された意思決定の根拠が含まれていることを確認し、それらが相関分析およびコンプライアンス報告のためにSIEMシステムに送信されていることを検証してください。
 #5.3.5    レベル: 3    役割: D/V
 高感度リソースに対してはポリシーキャッシュの有効期限（TTL）値が5分を超えないこと、標準リソースに対してはキャッシュ無効化機能付きで1時間を超えないことを確認してください。

---

### C5.4 クエリ時のセキュリティ強制

必須のフィルタリングおよび行レベルのセキュリティポリシーを使用して、データベース層のセキュリティ制御を実装します。

 #5.4.1    レベル: 1    役割: D/V
 すべてのベクターデータベースおよびSQLクエリに必須のセキュリティフィルター（テナントID、機微ラベル、ユーザースコープ）が含まれ、これらがアプリケーションコードではなくデータベースエンジンレベルで強制されていることを検証してください。
 #5.4.2    レベル: 1    役割: D/V
 すべてのベクトルデータベース、検索インデックス、およびトレーニングデータセットに対して、ポリシー継承を伴う行レベルセキュリティ（RLS）ポリシーとフィールドレベルのマスキングが有効になっていることを確認してください。
 #5.4.3    レベル: 2    役割: D
 失敗した認可評価が、「混乱した代理攻撃」を防ぐために、クエリを即座に中止し、空の結果セットを返すのではなく明示的な認可エラーコードを返すことを確認してください。
 #5.4.4    レベル: 2    役割: V
 ポリシー評価の遅延が継続的に監視されており、認可のバイパスを可能にするタイムアウト条件に対して自動アラートが設定されていることを確認してください。
 #5.4.5    レベル: 3    役割: D/V
 クエリの再試行メカニズムが、アクティブなユーザーセッション内での動的な権限変更を反映するために認可ポリシーを再評価することを検証してください。

---

### C5.5 出力フィルタリングおよびデータ漏えい防止

AI生成コンテンツにおける不正なデータ露出を防ぐために、後処理の制御を導入してください。

 #5.5.1    レベル: 1    役割: D/V
 推論後のフィルタリング機構が、リクエスト者にコンテンツを提供する前に、許可されていない個人識別情報（PII）、機密情報、および専有データをスキャンして削除することを確認してください。
 #5.5.2    レベル: 1    役割: D/V
 モデル出力内の引用文、参照、および情報源の帰属が呼び出し元の権限と照合され、無許可のアクセスが検出された場合は削除されることを検証してください。
 #5.5.3    レベル: 2    役割: D
 ユーザーの権限レベルおよびデータ分類に基づいて、出力形式の制限（サニタイズされたPDF、メタデータが削除された画像、承認されたファイルタイプ）が適用されていることを検証してください。
 #5.5.4    レベル: 2    役割: V
 検閲アルゴリズムが決定論的であり、バージョン管理されていて、コンプライアンス調査およびフォレンジック分析を支援するための監査ログを保持していることを確認してください。
 #5.5.5    レベル: 3    役割: V
 高リスクの消去イベントが、データの露出を防ぎつつ、元のコンテンツの暗号ハッシュを含む適応ログを生成していることを検証してください。

---

### C5.6 マルチテナントの分離

共有AIインフラストラクチャにおいてテナント間の暗号的および論理的な分離を確保する。

 #5.6.1    レベル: 1    役割: D/V
 メモリ空間、埋め込みストア、キャッシュエントリ、および一時ファイルが、テナントごとに名前空間で分離されていることを確認し、テナントの削除またはセッションの終了時には安全にパージされることを保証してください。
 #5.6.2    レベル: 1    役割: D/V
 すべてのAPIリクエストが、セッションコンテキストおよびユーザー権限に対して暗号的に検証された認証済みテナント識別子を含んでいることを確認してください。
 #5.6.3    レベル: 2    役割: D
 ネットワークポリシーがサービスメッシュおよびコンテナオーケストレーションプラットフォーム内のテナント間通信に対してデフォルト拒否ルールを実装していることを検証してください。
 #5.6.4    レベル: 3    役割: D
 テナントごとに一意の暗号鍵であることを、カスタマー管理キー（CMK）サポートおよびテナントのデータストア間の暗号的分離をもって検証してください。

---

### C5.7 自律エージェントの認可

スコープ付き能力トークンと継続的な認可を通じて、AIエージェントおよび自律システムの制御権限を管理します。

 #5.7.1    レベル: 1    役割: D/V
 自律エージェントが、許可された操作、アクセス可能なリソース、時間の制限、運用上の制約を明示的に列挙したスコープ付きの能力トークンを受け取っていることを確認してください。
 #5.7.2    レベル: 1    役割: D/V
 高リスクな機能（ファイルシステムアクセス、コード実行、外部API呼び出し、金融取引）がデフォルトで無効になっていることを確認し、有効化にはビジネス上の正当な理由を伴う明示的な承認が必要であることを確認してください。
 #5.7.3    レベル: 2    役割: D
 能力トークンがユーザーセッションに紐付けられていることを確認し、暗号的整合性保護が含まれていること、またオフラインの状況で永続化または再利用できないことを保証してください。
 #5.7.4    レベル: 2    役割: V
 エージェントが開始したアクションが、完全なコンテキスト評価および監査ログを伴うABACポリシーエンジンによる二次承認を受けることを検証してください。
 #5.7.5    レベル: 3    役割: V
 エージェントのエラー条件および例外処理に、インシデント分析およびフォレンジック調査をサポートするための能力範囲情報が含まれていることを確認してください。

---

### 参考文献

#### 標準とフレームワーク

NIST SP 800-63-3: Digital Identity Guidelines
Zero Trust Architecture – NIST SP 800-207
OWASP Application Security Verification Standard (AISVS)
​
#### 実装ガイド

Identity and Access Management in the AI Era: 2025 Guide – IDSA
Attribute-Based Access Control with OPA – Permify
How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS
​
#### AI特有のセキュリティ

Row Level Security in Vector DBs for RAG – Bluetuple.ai
Tenant Isolation in Multi-Tenant Systems – WorkOS
Handling AI Agent Permissions – Stytch
OWASP Top 10 for Large Language Model Applications

## C6 モデル、フレームワークおよびデータのサプライチェーンセキュリティ

### 制御目標

AIサプライチェーン攻撃は、サードパーティのモデル、フレームワーク、またはデータセットを悪用してバックドア、バイアス、または悪用可能なコードを埋め込みます。これらの制御は、エンドツーエンドの由来管理、脆弱性管理、および監視を提供し、モデルのライフサイクル全体を保護します。

---

### C6.1 事前学習済みモデルの審査と出所管理

ファインチューニングや展開の前に、サードパーティモデルの起源、ライセンス、および隠れた挙動を評価し認証してください。

 #6.1.1    レベル: 1    役割: D/V
 すべてのサードパーティモデルアーティファクトに、ソースリポジトリとコミットハッシュを識別する署名付きのプロベナンス記録が含まれていることを確認してください。
 #6.1.2    レベル: 1    役割: D/V
 モデルがインポートされる前に、自動化ツールを使用して悪意のあるレイヤーやトロイの木馬のトリガーがスキャンされていることを確認してください。
 #6.1.3    レベル: 2    役割: D
 転移学習のファインチューニングが、隠れた動作を検出するための敵対的評価に合格することを確認する。
 #6.1.4    レベル: 2    役割: V
 モデルライセンス、輸出管理タグ、およびデータ出所の声明がML-BOMエントリに記録されていることを確認してください。
 #6.1.5    レベル: 3    役割: D/V
 高リスクモデル（公開された重み、未検証の作成者）は、人間によるレビューと承認が行われるまで隔離されたままであることを確認してください。

---

### C6.2 フレームワーク＆ライブラリスキャン

実行時スタックの安全性を維持するために、MLフレームワークおよびライブラリを継続的にスキャンしてCVEおよび悪意のあるコードを検出します。

 #6.2.1    レベル: 1    役割: D/V
 CIパイプラインがAIフレームワークおよび重要なライブラリに対して依存関係スキャナーを実行することを確認してください。
 #6.2.2    レベル: 1    役割: D/V
 重要な脆弱性（CVSS ≥ 7.0）が、プロダクションイメージへの昇格をブロックすることを確認してください。
 #6.2.3    レベル: 2    役割: D
 フォークされたまたはベンダリングされたMLライブラリに対しても静的コード解析が実行されることを確認してください。
 #6.2.4    レベル: 2    役割: V
 フレームワークのアップグレード提案に、公開されているCVEフィードを参照したセキュリティ影響評価が含まれていることを確認してください。
 #6.2.5    レベル: 3    役割: V
 実行時センサーが、署名されたSBOMから逸脱した予期しない動的ライブラリの読み込みについて警告することを検証してください。

---

### C6.3 依存関係の固定と検証

すべての依存関係を変更不可能なダイジェストに固定し、再現可能なビルドを行うことで、完全に一致し改ざんされていないアーティファクトを保証します。

 #6.3.1    レベル: 1    役割: D/V
 すべてのパッケージマネージャーがロックファイルを介してバージョン固定を強制していることを確認してください。
 #6.3.2    レベル: 1    役割: D/V
 コンテナ参照において、可変タグの代わりに不変のダイジェストが使用されていることを確認してください。
 #6.3.3    レベル: 2    役割: D
 再現可能なビルドチェックが、同一の出力を保証するためにCIランのハッシュを比較していることを確認してください。
 #6.3.4    レベル: 2    役割: V
 ビルド証明書が監査の追跡可能性のために18ヶ月間保存されていることを確認してください。
 #6.3.5    レベル: 3    役割: D
 期限切れの依存関係が、自動プルリクエストをトリガーしてピン留めされたバージョンを更新またはフォークすることを確認してください。

---

### C6.4 信頼されたソースの強制

暗号的に検証され、組織が承認したソースからのみ成果物のダウンロードを許可し、それ以外はすべてブロックします。

 #6.4.1    レベル: 1    役割: D/V
 モデルの重み、データセット、およびコンテナが承認されたドメインまたは内部レジストリからのみダウンロードされていることを確認してください。
 #6.4.2    レベル: 1    役割: D/V
 Sigstore/Cosignの署名が、アーティファクトをローカルにキャッシュする前に発行者の身元を検証することを確認してください。
 #6.4.3    レベル: 2    役割: D
 信頼されたソースのポリシーを適用するために、出力プロキシが認証されていないアーティファクトのダウンロードをブロックしていることを検証してください。
 #6.4.4    レベル: 2    役割: V
 リポジトリの許可リストが四半期ごとにレビューされており、各エントリに対する業務上の正当性の証拠があることを確認してください。
 #6.4.5    レベル: 3    役割: V
 ポリシー違反がアーティファクトの隔離および依存するパイプライン実行のロールバックを引き起こすことを確認してください。

---

### C6.5 サードパーティデータセットリスク評価

外部データセットを毒性、バイアス、法的遵守について評価し、それらのライフサイクル全体を通じて監視します。

 #6.5.1    レベル: 1    役割: D/V
 外部データセットがポイズニングリスクスコアリング（例：データフィンガープリンティング、異常値検出）を受けることを確認してください。
 #6.5.2    レベル: 1    役割: D
 バイアスメトリクス（人口統計的公平性、機会均等）がデータセット承認前に計算されていることを確認してください。
 #6.5.3    レベル: 2    役割: V
 データセットの発端情報およびライセンス条項がML-BOMエントリに記録されていることを確認してください。
 #6.5.4    レベル: 2    役割: V
 ホストされているデータセットのドリフトや破損を定期的なモニタリングが検出することを確認してください。
 #6.5.5    レベル: 3    役割: D
 トレーニング前に、自動スクラビングを通じて許可されていないコンテンツ（著作権、個人を特定できる情報）が削除されていることを確認してください。

---

### C6.6 サプライチェーン攻撃の監視

CVEフィード、監査ログ分析、およびレッドチームシミュレーションを通じてサプライチェーンの脅威を早期に検出します。

 #6.6.1    レベル: 1    役割: V
 CI/CDの監査ログが異常なパッケージプルや改ざんされたビルドステップの検出のためにSIEMにストリームされていることを確認してください。
 #6.6.2    レベル: 2    役割: D
 インシデント対応プレイブックに、侵害されたモデルやライブラリのロールバック手順が含まれていることを確認してください。
 #6.6.3    レベル: 3    役割: V
 アラートトリアージにおいて、脅威インテリジェンスの強化が機械学習特有の指標（例：モデル汚染のIoC）にタグ付けされていることを検証してください。

---

### C6.7 モデルアーティファクトのためのML-BOM

詳細な機械学習（ML）特有のSBOM（ML-BOM）を生成および署名し、下流の利用者が展開時にコンポーネントの整合性を検証できるようにします。

 #6.7.1    レベル: 1    役割: D/V
 すべてのモデルアーティファクトが、データセット、重み、ハイパーパラメータ、およびライセンスを一覧表示したML-BOMを公開していることを確認してください。
 #6.7.2    レベル: 1    役割: D/V
 ML-BOMの生成とCosign署名がCIで自動化されており、マージに必須であることを確認してください。
 #6.7.3    レベル: 2    役割: D
 コンポーネントのメタデータ（ハッシュ、ライセンス）が欠落している場合、ML‑BOM 完全性チェックがビルドを失敗させることを検証してください。
 #6.7.4    レベル: 2    役割: V
 ダウンストリームの利用者が、展開時にインポートされたモデルを検証するために、APIを介してML-BOMを照会できることを確認してください。
 #6.7.5    レベル: 3    役割: V
 ML-BOMがバージョン管理され、不正な変更を検出するために差分が確認されていることを検証してください。

---

### 参考文献

ML Supply Chain Compromise – MITRE ATLAS
Supply‑chain Levels for Software Artifacts (SLSA)
CycloneDX – Machine Learning Bill of Materials
What is Data Poisoning? – SentinelOne
Transfer Learning Attack – OWASP ML Security Top 10
AI Data Security Best Practices – CISA
Secure CI/CD Supply Chain – Sumo Logic
AI & Transparency: Protect ML Models – ReversingLabs
SBOM Overview – CISA
Training Data Poisoning Guide – Lakera.ai
Dependency Pinning for Reproducible Python – Medium

## C7 モデルの挙動、出力制御、および安全性保証

### 制御目標

モデルの出力は、構造化されており、信頼性があり、安全で、説明可能であり、かつ本番環境で継続的に監視される必要があります。これにより、誤情報、プライバシー漏洩、有害なコンテンツ、および暴走行動が減少し、ユーザーの信頼と規制遵守が向上します。

---

### C7.1 出力形式の強制

厳密なスキーマ、制約付きデコーディング、および下流の検証により、誤形成または悪意のあるコンテンツが拡散する前に停止されます。

 #7.1.1    レベル: 1    役割: D/V
 レスポンススキーマ（例：JSONスキーマ）がシステムプロンプトに提供されていることを確認し、すべての出力が自動的に検証されるようにします；基準を満たさない出力は修正または拒否されます。
 #7.1.2    レベル: 1    役割: D/V
 オーバーフローやプロンプトインジェクションのサイドチャネルを防ぐために、制約付きデコーディング（停止トークン、正規表現、最大トークン数）が有効になっていることを確認してください。
 #7.1.3    レベル: 2    役割: D/V
 下流のコンポーネントが出力を信頼できないものとして扱い、スキーマやインジェクション安全なデシリアライザーに対して検証していることを確認してください。
 #7.1.4    レベル: 3    役割: V
 不適切な出力イベントがログ記録され、レート制限され、監視に表示されることを確認してください。

---

### C7.2 幻覚検出と軽減

不確実性の推定とフォールバック戦略は、でっち上げられた回答を抑制します。

 #7.2.1    レベル: 1    役割: D/V
 トークンレベルの対数確率、アンサンブルによる自己一貫性、またはファインチューニングされた幻覚検出器が各回答に信頼度スコアを割り当てていることを確認してください。
 #7.2.2    レベル: 1    役割: D/V
 設定可能な信頼度しきい値を下回る応答が、フォールバックワークフロー（例：検索強化生成、セカンダリモデル、または人間によるレビュー）をトリガーすることを検証してください。
 #7.2.3    レベル: 2    役割: D/V
 幻覚事象が根本原因のメタデータでタグ付けされ、事後分析およびファインチューニングのパイプラインにフィードされていることを確認してください。
 #7.2.4    レベル: 3    役割: D/V
 主要なモデルまたはナレッジベースの更新後に、しきい値と検出器が再調整されていることを確認してください。
 #7.2.5    レベル: 3    役割: V
 ダッシュボードの可視化が誤認率を追跡していることを確認してください。

---

### C7.3 出力の安全性とプライバシーフィルタリング

ポリシーフィルターとレッドチームのカバレッジは、ユーザーと機密データを保護します。

 #7.3.1    レベル: 1    役割: D/V
 事前および事後生成の分類器が、ポリシーに準拠したヘイト、嫌がらせ、自己傷害、過激派、および性的に露骨なコンテンツをブロックすることを確認してください。
 #7.3.2    レベル: 1    役割: D/V
 PII/PCIの検出と自動編集がすべての応答で実行されることを確認してください。違反があった場合はプライバシーインシデントが発生します。
 #7.3.3    レベル: 2    役割: D
 機密性のタグ（例：営業秘密）がモダリティを超えて伝播し、テキスト、画像、コードにおける情報漏洩を防止することを検証してください。
 #7.3.4    レベル: 3    役割: D/V
 フィルター回避の試みや高リスクの分類が、二次承認またはユーザーの再認証を必要とすることを確認してください。
 #7.3.5    レベル: 3    役割: D/V
 フィルタリングの閾値が法的管轄区域およびユーザーの年齢・役割の文脈を反映していることを確認してください。

---

### C7.4 出力およびアクションの制限

レート制限と承認ゲートは、不正利用や過剰な自律性を防止します。

 #7.4.1    レベル: 1    役割: D
 429エラー時に指数的バックオフを行いながら、ユーザーごとおよびAPIキーごとのクォータがリクエスト数、トークン数、コストを制限していることを検証してください。
 #7.4.2    レベル: 1    役割: D/V
 特権アクション（ファイル書き込み、コード実行、ネットワーク呼び出し）がポリシーベースの承認または人間の介入を必要とすることを確認してください。
 #7.4.3    レベル: 2    役割: D/V
 クロスモーダル整合性チェックが、同じリクエストに対して生成された画像、コード、およびテキストが悪意のあるコンテンツを密輸するために使用されないことを検証してください。
 #7.4.4    レベル: 2    役割: D
 エージェントの委任の深さ、再帰制限、および許可されたツールリストが明示的に設定されていることを確認してください。
 #7.4.5    レベル: 3    役割: V
 制限違反がSIEM取り込みのための構造化されたセキュリティイベントを生成することを検証します。

---

### C7.5 出力の説明可能性

透明なシグナルはユーザーの信頼と内部デバッグを向上させます。

 #7.5.1    レベル: 2    役割: D/V
 リスク評価が適切と判断した場合に、ユーザー向けの信頼度スコアや簡易的な理由要約が表示されることを検証してください。
 #7.5.2    レベル: 2    役割: D/V
 生成された説明が機密性の高いシステムプロンプトや専有データを漏らさないように確認してください。
 #7.5.3    レベル: 3    役割: D
 システムがトークンレベルの対数確率またはアテンションマップを取得し、許可された検査のために保存していることを確認してください。
 #7.5.4    レベル: 3    役割: V
 説明可能性アーティファクトが監査可能性のためにモデルリリースと共にバージョン管理されていることを確認してください。

---

### C7.6 監視統合

リアルタイムの可観測性は、開発と本番環境の間のループを閉じます。

 #7.6.1    レベル: 1    役割: D
 メトリクス（スキーマ違反、幻覚率、有害性、PII漏洩、遅延、コスト）が中央監視プラットフォームにストリーミングされることを確認してください。
 #7.6.2    レベル: 1    役割: V
 各安全指標に対してアラート閾値が定義されており、オンコールのエスカレーション経路が設定されていることを確認してください。
 #7.6.3    レベル: 2    役割: V
 ダッシュボードが出力の異常をモデル/バージョン、機能フラグ、および上流データの変更と関連付けていることを確認してください。
 #7.6.4    レベル: 2    役割: D/V
 監視データが文書化されたMLOpsワークフロー内で再学習、ファインチューニング、またはルールの更新にフィードバックされていることを確認してください。
 #7.6.5    レベル: 3    役割: V
 監視パイプラインがペネトレーションテストされており、機密ログの漏えいを防ぐためにアクセス制御されていることを確認してください。

---

### 7.7 生成メディアの安全対策

ポリシー制約、出力検証、および追跡可能性を強化することで、AIシステムが違法、有害、または無許可のメディアコンテンツを生成しないようにします。

 #7.7.1    レベル: 1    役割: D/V
 システムプロンプトおよびユーザー指示が、違法、有害、または非同意のディープフェイクメディア（例：画像、動画、音声）の生成を明示的に禁止していることを確認してください。
 #7.7.2    レベル: 2    役割: D/V
 プロンプトがなりすましの生成、性的に露骨なディープフェイク、または実在の個人の同意なしに描かれたメディアの試みに対してフィルタリングされていることを検証してください。
 #7.7.3    レベル: 2    役割: V
 システムが、著作権で保護されたメディアの無断複製を防止するために、知覚ハッシュ、ウォーターマーク検出、またはフィンガープリンティングを使用していることを確認してください。
 #7.7.4    レベル: 3    役割: D/V
 すべての生成されたメディアが暗号的に署名されていること、透かしが入っていること、または改ざん防止のためのプロビナンスメタデータが埋め込まれており、下流での追跡可能性が確保されていることを確認してください。
 #7.7.5    レベル: 3    役割: V
 バイパス試行（例：プロンプトの難読化、スラング、敵対的表現）が検出され、ログに記録され、レート制限されることを確認してください。繰り返される悪用は監視システムに通知されます。

### 参考文献

NIST AI Risk Management Framework
ISO/IEC 42001:2023 – AI Management System
OWASP Top-10 for Large Language Model Applications (2025)
Improper Output Handling – OWASP LLM05:2025
Practical Techniques to Constrain LLM Output
Dataiku – Structured Text Generation Guide
VL-Uncertainty: Detecting Hallucinations
HaDeMiF: Hallucination Detection & Mitigation
Building Confidence in LLM Outputs
Explainable AI & LLMs
LLM Red-Teaming Guide
Sensitive Information Disclosure in LLMs
LangChain – Chat Model Rate Limiting
OpenAI Rate-Limit & Exponential Back-off
Arize AI – LLM Observability Platform

## C8 メモリ、埋め込み、およびベクターデータベースのセキュリティ

### 制御目標

埋め込みとベクトルストアは、現代のAIシステムの「ライブメモリ」として機能し、ユーザーから提供されたデータを継続的に受け入れ、Retrieval-Augmented Generation（RAG）を通じてモデルのコンテキストに再び表示します。これが管理されなければ、このメモリは個人識別情報（PII）の漏洩、同意違反、あるいは元のテキストを再構築するために逆利用される可能性があります。この制御群の目的は、メモリパイプラインとベクトルデータベースを強化し、アクセス権を最小権限に制限し、埋め込みがプライバシー保護されたものであることを確保し、保存されたベクトルが期限切れになるか必要に応じて取り消し可能であり、ユーザーごとのメモリが他のユーザーのプロンプトや生成結果を汚染しないようにすることです。

---

### C8.1 メモリとRAGインデックスに対するアクセス制御

すべてのベクターコレクションに対して細粒度のアクセス制御を強制します。

 #8.1.1    レベル: 1    役割: D/V
 行/ネームスペースレベルのアクセス制御ルールが、テナント、コレクション、またはドキュメントタグごとに挿入、削除、およびクエリ操作を制限していることを検証してください。
 #8.1.2    レベル: 1    役割: D/V
 APIキーまたはJWTがスコープ付きのクレーム（例：コレクションID、アクション動詞）を含み、少なくとも四半期ごとにローテーションされていることを確認してください。
 #8.1.3    レベル: 2    役割: D/V
 権限昇格の試み（例：クロスネームスペース類似性クエリ）が検出され、5分以内にSIEMにログが記録されることを確認してください。
 #8.1.4    レベル: 2    役割: D/V
 ベクターデータベースが監査ログにサブジェクト識別子、操作、ベクターID／名前空間、類似度閾値、および結果数を記録していることを確認してください。
 #8.1.5    レベル: 3    役割: V
 エンジンがアップグレードされるか、インデックスシャーディングルールが変更されるたびに、アクセス決定がバイパスの欠陥についてテストされていることを確認してください。

---

### C8.2 埋め込みのサニタイズと検証

ベクトル化の前にテキストを事前にスクリーニングして個人を特定できる情報（PII）を検出し、削除または仮名化します。また、必要に応じて埋め込みの後処理を行い、残留する信号を除去します。

 #8.2.1    レベル: 1    役割: D/V
 PIIおよび規制対象データが自動分類器によって検出され、埋め込み前にマスク、トークン化、または削除されていることを確認してください。
 #8.2.2    レベル: 1    役割: D
 埋め込みパイプラインが、インデックスを汚染する可能性のある実行可能コードまたは非UTF-8のアーティファクトを含む入力を拒否または隔離することを検証してください。
 #8.2.3    レベル: 2    役割: D/V
 既知のPIIトークンとの距離が設定可能な閾値を下回る文の埋め込みに対して、局所的またはメトリックの差分プライバシーによるサニタイズが適用されていることを検証する。
 #8.2.4    レベル: 2    役割: V
 サニタイズの有効性（例：個人識別情報の抹消のリコール、意味のずれ）が、ベンチマークコーパスに対して少なくとも半期ごとに検証されていることを確認してください。
 #8.2.5    レベル: 3    役割: D/V
 サニタイズ設定がバージョン管理されており、変更がピアレビューを受けていることを確認してください。

---

### C8.3 メモリの有効期限、取り消し、および削除

GDPRの「忘れられる権利」や類似の法律は、適時の消去を要求しているため、ベクターストアはTTL、ハードデリート、およびトゥームストーニングをサポートし、取り消されたベクトルが回復または再インデックスされないようにしなければなりません。

 #8.3.1    レベル: 1    役割: D/V
 すべてのベクターおよびメタデータレコードが、TTLまたは自動クリーンアップジョブによって適用される明示的な保持ラベルを持っていることを検証してください。
 #8.3.2    レベル: 1    役割: D/V
 ユーザーが開始した削除リクエストが、30日以内にベクトル、メタデータ、キャッシュコピー、および派生インデックスを完全に削除することを確認してください。
 #8.3.3    レベル: 2    役割: D
 論理的な削除が、ハードウェアが対応している場合はストレージブロックの暗号的シュレッディングによって、その対応がない場合はキー管理システムでのキー破棄によって行われていることを検証してください。
 #8.3.4    レベル: 3    役割: D/V
 有効期限切れのベクターが、有効期限切れから500ms以内に最近傍検索結果から除外されることを検証してください。

---

### C8.4 埋め込みの逆転と情報漏洩の防止

最近の防御策—ノイズ重畳、射影ネットワーク、プライバシーニューロン摂動、およびアプリケーション層暗号化—は、トークンレベルの反転率を5%以下に抑えることができます。

 #8.4.1    レベル: 1    役割: V
 反転攻撃、メンバーシップ攻撃、および属性推測攻撃をカバーする正式な脅威モデルが存在し、毎年見直されていることを確認してください。
 #8.4.2    レベル: 2    役割: D/V
 アプリケーション層の暗号化または検索可能な暗号化が、インフラ管理者やクラウドスタッフによるベクトルの直接読み取りから保護していることを検証してください。
 #8.4.3    レベル: 3    役割: V
 防御パラメータ（DPのε、ノイズσ、射影ランクk）がプライバシー≥99％のトークン保護とユーティリティ≤3％の精度損失を両立していることを検証してください。
 #8.4.4    レベル: 3    役割: D/V
 モデル更新のリリースゲートに反転耐性メトリクスが含まれていることを確認し、回帰予算が定義されていることを確認してください。

---

### C8.5 ユーザー固有メモリに対するスコープの強制

クロステナントの情報漏洩は依然として主要なRAGリスクです。不適切にフィルタリングされた類似度クエリにより、別の顧客のプライベートドキュメントが露見する可能性があります。

 #8.5.1    レベル: 1    役割: D/V
 すべての検索クエリが、LLMプロンプトに渡される前にテナント/ユーザーIDによってポストフィルタリングされていることを確認してください。
 #8.5.2    レベル: 1    役割: D
 コレクション名または名前空間付きIDがユーザーまたはテナントごとにソルト化されていることを確認し、ベクトルがスコープ間で衝突しないようにします。
 #8.5.3    レベル: 2    役割: D/V
 構成可能な距離閾値を超え、かつ呼び出し元のスコープ外にある類似性結果が破棄され、セキュリティ警告を引き起こすことを確認してください。
 #8.5.4    レベル: 2    役割: V
 マルチテナントのストレステストが、範囲外のドキュメントを取得しようとする敵対的なクエリをシミュレートし、情報漏洩がゼロであることを示すことを確認してください。
 #8.5.5    レベル: 3    役割: D/V
 暗号鍵がテナントごとに分離されていることを確認し、物理的なストレージが共有されていても暗号学的な分離が保証されるようにします。

---

### C8.6 高度なメモリシステムセキュリティ

エピソード記憶、意味記憶、作業記憶を含む高度なメモリアーキテクチャのための特定の分離および検証要件を備えたセキュリティコントロール。

 #8.6.1    レベル: 1    役割: D/V
 エピソード記憶、意味記憶、作業記憶などの異なるメモリタイプが、役割ベースのアクセス制御、個別の暗号化キー、および各メモリタイプのアクセスパターンの文書化を備えた独立したセキュリティコンテキストを持っていることを検証してください。
 #8.6.2    レベル: 2    役割: D/V
 メモリ統合プロセスには、保存前にコンテンツのサニタイズ、ソースの検証、および整合性チェックを通じて悪意のあるメモリの注入を防ぐためのセキュリティ検証が含まれていることを確認してください。
 #8.6.3    レベル: 2    役割: D/V
 メモリ取得クエリが、クエリパターンの分析、不正アクセス制御、および結果のフィルタリングを通じて、許可されていない情報の抽出を防ぐために検証およびサニタイズされていることを確認してください。
 #8.6.4    レベル: 3    役割: D/V
 メモリの忘却機構が、鍵の削除、多重上書き、または検証証明書付きのハードウェアベースの安全な削除を用いて、暗号削除保証により機密情報を安全に削除していることを検証してください。
 #8.6.5    レベル: 3    役割: D/V
 メモリシステムの整合性が、チェックサム、監査ログ、および通常の操作外でメモリ内容が変更された際の自動アラートを通じて、不正な変更や破損について継続的に監視されていることを検証してください。

---

### 参考文献

Vector database security: Pinecone – IronCore Labs
Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera
Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances
Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv
DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview
Art. 17 GDPR – Right to Erasure
Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai
PII Identification and Removal – NVIDIA NeMo Docs
De-identifying Sensitive Data – Google Cloud DLP
Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails
Think Your RAG Is Secure? Think Again – Medium
Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn
Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog

## 9 自律的オーケストレーションとエージェント的行動のセキュリティ

### 制御目標

自律型またはマルチエージェントAIシステムが、明示的に意図され、認証され、監査可能であり、かつ限定されたコストおよびリスクの閾値内の行動のみを実行できるようにします。これにより、自律システムの侵害、ツールの誤用、エージェントループ検出、通信の乗っ取り、アイデンティティのなりすまし、群れの操作、および意図の操作といった脅威から保護されます。

---

### 9.1 エージェントのタスク計画と再帰予算

特権アクションに対しては、再帰的な計画のスロットリングを行い、必ず人間によるチェックポイントを設ける。

 #9.1.1    レベル: 1    役割: D/V
 最大再帰深度、幅、実時間、トークン、およびエージェント実行ごとの金銭的コストが中央で設定され、バージョン管理されていることを検証してください。
 #9.1.2    レベル: 1    役割: D/V
 特権的または取り消し不可能な操作（例：コードコミット、資金移動）は、実行前に監査可能なチャネルを通じて明示的な人間の承認が必要であることを確認してください。
 #9.1.3    レベル: 2    役割: D
 リアルタイムリソースモニターが、いずれかの予算しきい値を超えた場合にサーキットブレーカー割り込みをトリガーし、それ以上のタスク拡張を停止することを確認してください。
 #9.1.4    レベル: 2    役割: D/V
 回路遮断器イベントがエージェントID、トリガー条件、およびフォレンジックレビュー用にキャプチャされたプラン状態とともにログに記録されていることを確認してください。
 #9.1.5    レベル: 3    役割: V
 セキュリティテストが予算枯渇および暴走プランのシナリオをカバーし、データ損失なく安全に停止することを検証してください。
 #9.1.6    レベル: 3    役割: D
 予算ポリシーがポリシー・アズ・コードとして表現され、CI/CDで強制されて構成のドリフトを防止していることを確認してください。

---

### 9.2 ツールプラグインのサンドボックス化

ツールの操作を分離して、不正なシステムアクセスやコード実行を防止します。

 #9.2.1    レベル: 1    役割: D/V
 すべてのツール/プラグインが、最小特権のファイルシステム、ネットワーク、およびシステムコールポリシーを持つOS、コンテナ、またはWASMレベルのサンドボックス内で実行されることを検証してください。
 #9.2.2    レベル: 1    役割: D/V
 サンドボックスのリソースクォータ（CPU、メモリ、ディスク、ネットワーク送信）および実行タイムアウトが適切に適用され、ログに記録されていることを確認してください。
 #9.2.3    レベル: 2    役割: D/V
 ツールのバイナリまたはディスクリプタがデジタル署名されていることを確認し、読み込み前に署名が検証されていることを確認してください。
 #9.2.4    レベル: 2    役割: V
 サンドボックスのテレメトリがSIEMにストリーミングされていることを確認し、異常（例：試みられたアウトバウンド接続）がアラートを発生させるか検証してください。
 #9.2.5    レベル: 3    役割: V
 高リスクのプラグインが本番環境に展開される前に、セキュリティレビューとペネトレーションテストを実施することを確認してください。
 #9.2.6    レベル: 3    役割: D/V
 サンドボックス脱出の試みが自動的にブロックされ、違反したプラグインが調査まで隔離されることを確認してください。

---

### 9.3 自律ループとコスト制限

制御不能なエージェント間の再帰およびコストの爆発を検出し、停止します。

 #9.3.1    レベル: 1    役割: D/V
 エージェント間の呼び出しに、ランタイムがデクリメントして強制するホップリミットまたはTTLが含まれていることを確認してください。
 #9.3.2    レベル: 2    役割: D
 エージェントが自己呼び出しや循環パターンを検出するために、一意の呼び出しグラフIDを維持していることを確認してください。
 #9.3.3    レベル: 2    役割: D/V
 累積のコンピュートユニットおよび支出カウンターがリクエストチェーンごとに追跡されていることを確認する。制限を超えた場合はチェーンを中止する。
 #9.3.4    レベル: 3    役割: V
 形式的解析またはモデル検査がエージェントプロトコルにおける無制限再帰の不存在を示していることを検証する。
 #9.3.5    レベル: 3    役割: D
 ループ中断イベントがアラートを生成し、継続的改善の指標に反映されることを検証してください。

---

### 9.4 プロトコルレベルの誤用防止

エージェントと外部システム間の安全な通信チャネルを確保し、乗っ取りや操作を防止します。

 #9.4.1    レベル: 1    役割: D/V
 すべてのエージェントからツールおよびエージェント間のメッセージが認証されていること（例：相互TLSまたはJWT）およびエンドツーエンドで暗号化されていることを確認してください。
 #9.4.2    レベル: 1    役割: D
 スキーマが厳密に検証されていることを確認し、不明なフィールドや不正なメッセージが拒否されるようにしてください。
 #9.4.3    レベル: 2    役割: D/V
 整合性チェック（MACやデジタル署名）がツールのパラメータを含むメッセージペイロード全体をカバーしていることを確認してください。
 #9.4.4    レベル: 2    役割: D
 リプレイ保護（ノンスまたはタイムスタンプウィンドウ）がプロトコル層で確実に適用されていることを確認してください。
 #9.4.5    レベル: 3    役割: V
 プロトコル実装がインジェクションやデシリアライズの脆弱性に対してファジングおよび静的解析を受けていることを確認してください。

---

### 9.5 エージェントのアイデンティティと改ざん検知

操作が誰によるものか明確であり、変更が検知可能であることを保証してください。

 #9.5.1    レベル: 1    役割: D/V
 各エージェントインスタンスが固有の暗号学的識別子（鍵ペアまたはハードウェアルート認証情報）を保持していることを確認してください。
 #9.5.2    レベル: 2    役割: D/V
 すべてのエージェントのアクションが署名およびタイムスタンプされていることを確認し、ログには否認防止のための署名が含まれていることを確認してください。
 #9.5.3    レベル: 2    役割: V
 改ざん検知ログが追加専用または書き込み一回限りの媒体に保存されていることを確認してください。
 #9.5.4    レベル: 3    役割: D
 識別キーが定められたスケジュールおよび侵害の指標に基づいてローテーションされることを検証する。
 #9.5.5    レベル: 3    役割: D/V
 なりすましやキー衝突の試みが発生した場合、影響を受けたエージェントが即時に隔離されることを確認してください。

---

### 9.6 マルチエージェント群れリスク軽減

集団的行動による危険を隔離と形式的安全モデリングによって軽減します。

 #9.6.1    レベル: 1    役割: D/V
 異なるセキュリティドメインで動作するエージェントが、分離された実行時サンドボックスまたはネットワークセグメント内で実行されていることを検証してください。
 #9.6.2    レベル: 3    役割: V
 展開前に、スウォーム行動がモデル化され、ライブネスと安全性について形式的に検証されていることを確認してください。
 #9.6.3    レベル: 3    役割: D
 ランタイムモニターが、発生する可能性のある安全でないパターン（例：振動、デッドロック）を検出し、是正措置を開始することを確認してください。

---

### 9.7 ユーザーおよびツールの認証／認可

すべてのエージェントによってトリガーされるアクションに対して、堅牢なアクセス制御を実装してください。

 #9.7.1    レベル: 1    役割: D/V
 エージェントがダウンストリームシステムに対してファーストクラスのプリンシパルとして認証し、エンドユーザーの資格情報を再利用しないことを検証してください。
 #9.7.2    レベル: 2    役割: D
 細粒度の認可ポリシーが、エージェントが呼び出せるツールおよび提供できるパラメータを制限していることを検証してください。
 #9.7.3    レベル: 2    役割: V
 権限チェックがセッション開始時だけでなく、すべての呼び出しで再評価される（継続的な認可）ことを確認してください。
 #9.7.4    レベル: 3    役割: D
 委任された権限が自動的に期限切れとなり、タイムアウトまたはスコープの変更後に再同意が必要であることを確認してください。

---

### 9.8 エージェント間通信のセキュリティ

盗聴や改ざんを防ぐため、すべてのエージェント間メッセージを暗号化し、完全性を保護してください。

 #9.8.1    レベル: 1    役割: D/V
 エージェントチャネルに対して、相互認証および完全前方秘匿暗号化（例：TLS 1.3）が必須であることを検証してください。
 #9.8.2    レベル: 1    役割: D
 メッセージの完全性と送信元が処理前に検証されていることを確認してください。検証に失敗した場合はアラートを発し、メッセージを破棄します。
 #9.8.3    レベル: 2    役割: D/V
 通信メタデータ（タイムスタンプ、シーケンス番号）がフォレンジック再構築をサポートするためにログ記録されていることを確認してください。
 #9.8.4    レベル: 3    役割: V
 形式検証またはモデル検査によって、プロトコルの状態機械が安全でない状態に遷移できないことを確認してください。

---

### 9.9 意図の検証と制約の強制

エージェントの行動がユーザーの明示された意図およびシステムの制約に合致していることを検証する。

 #9.9.1    レベル: 1    役割: D
 事前実行制約ソルバーが、提案された行動をハードコードされた安全性およびポリシールールと照合していることを検証してください。
 #9.9.2    レベル: 2    役割: D/V
 高影響のある操作（財務、破壊的、プライバシーに敏感なもの）が、操作を開始したユーザーからの明示的な意図の確認を必要とすることを検証してください。
 #9.9.3    レベル: 2    役割: V
 完了したアクションが副作用なく意図した効果を達成していることを検証するために事後条件チェックを行い、不一致があればロールバックを実行します。
 #9.9.4    レベル: 3    役割: V
 エージェントの計画がすべての宣言された制約を満たしていることを形式手法（例：モデル検査、定理証明）やプロパティベースのテストによって検証する。
 #9.9.5    レベル: 3    役割: D
 意図の不一致や制約違反の事案が継続的改善サイクルおよび脅威インテリジェンス共有に反映されることを確認してください。

---

### 9.10 エージェント推論戦略のセキュリティ

ReAct、Chain-of-Thought、Tree-of-Thoughtsアプローチを含むさまざまな推論戦略の安全な選択と実行。

 #9.10.1    レベル: 1    役割: D/V
 推論戦略の選択が決定論的な基準（入力の複雑さ、タスクの種類、セキュリティコンテキスト）を使用していることを検証し、同一のセキュリティコンテキスト内で同一の入力が同一の戦略選択を生成することを確認してください。
 #9.10.2    レベル: 1    役割: D/V
 各推論戦略（ReAct、Chain-of-Thought、Tree-of-Thoughts）には、それぞれの認知アプローチに特化した入力検証、出力のサニタイズ、および実行時間制限が専用に設けられていることを確認してください。
 #9.10.3    レベル: 2    役割: D/V
 推論戦略の移行が、入力の特性、選択基準の値、および実行のメタデータを含む完全なコンテキストで記録されており、監査トレイルの再構築に利用できることを検証してください。
 #9.10.4    レベル: 2    役割: D/V
 Tree-of-Thoughts推論には、ポリシー違反、リソース制限、安全境界が検出された場合に探索を終了するブランチプルーニング機構が含まれていることを確認してください。
 #9.10.5    レベル: 2    役割: D/V
 ReAct（Reason-Act-Observe）サイクルには、各フェーズで検証チェックポイントが含まれていることを確認してください：推論ステップの検証、行動の承認、および次に進む前の観察のサニタイズ。
 #9.10.6    レベル: 3    役割: D/V
 推論戦略のパフォーマンス指標（実行時間、リソース使用量、出力品質）が、設定された閾値を超えて逸脱した場合に自動アラートで監視されていることを確認してください。
 #9.10.7    レベル: 3    役割: D/V
 複数の戦略を組み合わせたハイブリッド推論アプローチが、いかなるセキュリティ制御も回避することなく、すべての構成要素の戦略における入力検証および出力制約を維持していることを検証してください。
 #9.10.8    レベル: 3    役割: D/V
 推論戦略のセキュリティテストには、異常な入力によるファジング、戦略の切り替えを強制するために設計された敵対的プロンプト、および各認知アプローチの境界条件テストが含まれていることを確認してください。

---

### 9.11 エージェントライフサイクル状態管理とセキュリティ

暗号化された監査証跡と定義された復旧手順を伴う、安全なエージェントの初期化、状態遷移、および終了。

 #9.11.1    レベル: 1    役割: D/V
 エージェントの初期化において、ハードウェアに裏付けられた証明書を用いた暗号学的な識別の確立、およびエージェントID、タイムスタンプ、構成ハッシュ、初期化パラメータを含む不変の起動監査ログが含まれていることを検証してください。
 #9.11.2    レベル: 2    役割: D/V
 エージェントの状態遷移が暗号的に署名され、タイムスタンプが付与され、トリガーイベント、前の状態ハッシュ、新しい状態ハッシュ、実行されたセキュリティ検証を含む完全なコンテキストとともにログ記録されていることを確認してください。
 #9.11.3    レベル: 2    役割: D/V
 エージェントのシャットダウン手順に、暗号的消去または複数回の上書きによる安全なメモリ消去、証明書機関への通知を伴う資格情報の取り消し、および改ざん検知可能な終了証明書の生成が含まれていることを確認してください。
 #9.11.4    レベル: 3    役割: D/V
 エージェントの回復メカニズムが暗号学的チェックサム（最低でもSHA-256）を使用して状態の整合性を検証し、破損が検出された場合には既知の正常な状態にロールバックし、自動アラートおよび手動承認要件を伴うことを確認してください。
 #9.11.5    レベル: 3    役割: D/V
 エージェントの永続化メカニズムが、エージェントごとのAES-256キーで機密状態データを暗号化し、設定可能なスケジュール（最大90日）での安全なキー回転を実装し、ゼロダウンタイムでのデプロイを実現していることを検証してください。

---

### 9.12 ツール統合セキュリティフレームワーク

定義されたリスク評価および承認プロセスを伴う、動的ツールの読み込み、実行、および結果検証のためのセキュリティ制御。

 #9.12.1    レベル: 1    役割: D/V
 ツール記述子に、必要な権限（読み取り/書き込み/実行）、リスクレベル（低/中/高）、リソース制限（CPU、メモリ、ネットワーク）、およびツールマニフェストに記録された検証要件を指定するセキュリティメタデータが含まれていることを確認してください。
 #9.12.2    レベル: 1    役割: D/V
 ツールの実行結果が、統合前に予想されるスキーマ（JSONスキーマ、XMLスキーマ）およびセキュリティポリシー（出力のサニタイズ、データ分類）に対して検証されることを確認し、タイムアウト制限およびエラー処理手順を適用してください。
 #9.12.3    レベル: 2    役割: D/V
 ツールの操作ログに、特権の使用、データアクセスパターン、実行時間、リソース消費、戻りコードを含む詳細なセキュリティコンテキストが含まれていることを検証し、SIEM統合のための構造化ログとして記録されていることを確認してください。
 #9.12.4    レベル: 2    役割: D/V
 動的ツール読み込み機構がPKIインフラストラクチャを使用してデジタル署名を検証し、実行前にサンドボックス分離および権限検証を伴う安全な読み込みプロトコルを実装していることを確認してください。
 #9.12.5    レベル: 3    役割: D/V
 新しいバージョンに対して、静的解析、動的テスト、およびセキュリティチームのレビューを含む必須の承認ゲートがあり、文書化された承認基準とSLA要件と共にツールのセキュリティ評価が自動的にトリガーされることを検証してください。

---

#### 参考文献

MITRE ATLAS tactics ML09
Circuit-breaker research for AI agents — Zou et al., 2024
Trend Micro analysis of sandbox escapes in AI agents — Park, 2025
Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025
Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025
Rapid7 fundamentals on spoofing attack prevention — 2024
Imperial College verification of swarm systems — Lomuscio et al.
NIST AI Risk Management Framework 1.0, 2023
WIRED security briefing on encryption best practices, 2024
OWASP Top 10 for LLM Applications, 2025
Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS
[How Is LLM Reasoning Distracted by Irrelevant Context?
An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
Large Language Model Sentinel: LLM Agent for Adversarial Purification
Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents

## 10 逆境耐性とプライバシー防御

### 制御目標

AIモデルが回避、推論、抽出、または毒物攻撃に直面した場合でも、信頼性が高く、プライバシーを保護し、不正利用に強い状態を維持することを保証する。

---

### 10.1 モデルアライメントと安全性

有害またはポリシー違反の出力に対して警戒する。

 #10.1.1    レベル: 1    役割: D/V
 アライメントテストスイート（レッドチームプロンプト、ジョイルブレイクプローブ、許可されていないコンテンツ）がバージョン管理され、すべてのモデルリリースで実行されていることを確認してください。
 #10.1.2    レベル: 1    役割: D
 拒否および安全完了ガードレールが適用されていることを確認してください。
 #10.1.3    レベル: 2    役割: D/V
 自動評価者が有害コンテンツ率を測定し、設定された閾値を超える劣化をフラグ付けすることを確認してください。
 #10.1.4    レベル: 2    役割: D
 カウンタージェイルブレイクトレーニングが文書化され、再現可能であることを確認してください。
 #10.1.5    レベル: 3    役割: V
 正式なポリシー遵守証明または認定された監視が重要な領域をカバーしていることを確認してください。

---

### 10.2 敵対的サンプル耐性強化

操作された入力に対する耐性を高める。堅牢な敵対的トレーニングとベンチマークスコアリングが現在のベストプラクティスである。

 #10.2.1    レベル: 1    役割: D
 プロジェクトのリポジトリに、再現可能なシードを用いた敵対的トレーニング構成が含まれていることを確認してください。
 #10.2.2    レベル: 2    役割: D/V
 敵対的サンプル検出が本番パイプラインでブロッキングアラートを発することを確認してください。
 #10.2.4    レベル: 3    役割: V
 認定された頑健性証明または区間境界証明書が、少なくとも上位の重要なクラスをカバーしていることを確認してください。
 #10.2.5    レベル: 3    役割: V
 回帰テストが、測定可能なロバストネスの低下がないことを確認するために適応型攻撃を使用していることを検証してください。

---

### 10.3 会員推測緩和

レコードがトレーニングデータに含まれていたかどうかを判定する能力を制限します。差分プライバシーと信頼度スコアのマスキングが、現在知られている中で最も効果的な防御手段です。

 #10.3.1    レベル: 1    役割: D
 クエリごとのエントロピー正則化または温度スケーリングが過信的な予測を減少させることを検証してください。
 #10.3.2    レベル: 2    役割: D
 機微なデータセットに対して、トレーニングがε制約付き差分プライベート最適化を使用していることを検証してください。
 #10.3.3    レベル: 2    役割: V
 攻撃シミュレーション（シャドウモデルまたはブラックボックス）が保持データに対して攻撃AUC ≤ 0.60を示すことを確認してください。

---

### 10.4 モデル反転耐性

プライベート属性の再構築を防止する。最近の調査では、出力の切り捨てとDP保証が実用的な防御策として強調されている。

 #10.4.1    レベル: 1    役割: D
 機密属性が直接出力されないことを確認してください。必要な場合は、バケットや一方向変換を使用してください。
 #10.4.2    レベル: 1    役割: D/V
 同じ主体からの繰り返しの適応クエリに対して、クエリレート制限が適切に動作していることを検証してください。
 #10.4.3    レベル: 2    役割: D
 モデルがプライバシー保護ノイズを用いて訓練されていることを検証してください。

---

### 10.5 モデル抽出防御

不正なクローン作成を検知し抑制します。ウォーターマーキングとクエリパターン分析が推奨されます。

 #10.5.1    レベル: 1    役割: D
 推論ゲートウェイがモデルの記憶閾値に調整されたグローバルおよびAPIキーごとのレート制限を適用していることを確認してください。
 #10.5.2    レベル: 2    役割: D/V
 クエリエントロピーおよび入力複数性の統計が自動抽出検出器にフィードされることを検証します。
 #10.5.3    レベル: 2    役割: V
 疑わしいクローンに対して1 000回以下のクエリで、壊れやすいまたは確率的なウォーターマークがp < 0.01で証明できることを検証してください。
 #10.5.4    レベル: 3    役割: D
 ウォーターマークキーとトリガーセットがハードウェアセキュリティモジュールに保存され、毎年ローテーションされていることを検証してください。
 #10.5.5    レベル: 3    役割: V
 抽出アラートイベントに違反クエリが含まれており、インシデント対応プレイブックと統合されていることを確認してください。

---

### 10.6 推論時の改ざんデータ検出

バックドアや汚染された入力を特定し、無効化します。

 #10.6.1    レベル: 1    役割: D
 モデル推論の前に、入力が異常検知器（例：STRIP、一貫性スコアリング）を通過することを確認してください。
 #10.6.2    レベル: 1    役割: V
 検出器の閾値が、誤検知率5%未満を達成するために、クリーンおよび汚染された検証セットで調整されていることを確認してください。
 #10.6.3    レベル: 2    役割: D
 毒されたとフラグ付けされた入力がソフトブロッキングおよび人間によるレビューのワークフローをトリガーすることを確認してください。
 #10.6.4    レベル: 2    役割: V
 検出器が適応的でトリガーなしのバックドア攻撃によってストレステストされていることを確認してください。
 #10.6.5    レベル: 3    役割: D
 検出効果指標が記録され、新しい脅威インテリジェンスとともに定期的に再評価されていることを確認してください。

---

### 10.7 動的セキュリティポリシー適応

脅威インテリジェンスと行動分析に基づくリアルタイムのセキュリティポリシー更新。

 #10.7.1    レベル: 1    役割: D/V
 エージェントの再起動なしでセキュリティポリシーを動的に更新でき、かつポリシーバージョンの整合性を維持できることを検証してください。
 #10.7.2    レベル: 2    役割: D/V
 ポリシーの更新が認可されたセキュリティ担当者によって暗号的に署名され、適用前に検証されていることを確認してください。
 #10.7.3    レベル: 2    役割: D/V
 動的ポリシーの変更が、正当化、承認連鎖、およびロールバック手順を含む完全な監査証跡とともに記録されていることを確認してください。
 #10.7.4    レベル: 3    役割: D/V
 適応型セキュリティ機構がリスクコンテキストおよび行動パターンに基づいて脅威検出の感度を調整することを確認してください。
 #10.7.5    レベル: 3    役割: D/V
 ポリシー適応の決定が説明可能であり、セキュリティチームのレビューのための証拠のトレイルを含むことを確認してください。

---

### 10.8 リフレクションベースのセキュリティ分析

エージェントの自己反省とメタ認知分析によるセキュリティ検証。

 #10.8.1    レベル: 1    役割: D/V
 エージェントのリフレクションメカニズムに、意思決定や行動のセキュリティに焦点を当てた自己評価が含まれていることを検証してください。
 #10.8.2    レベル: 2    役割: D/V
 リフレクション出力が検証され、敵対的入力による自己評価メカニズムの操作を防止していることを確認してください。
 #10.8.3    レベル: 2    役割: D/V
 メタ認知的セキュリティ分析が、エージェントの推論プロセスにおける潜在的なバイアス、操作、または妥協を特定することを検証してください。
 #10.8.4    レベル: 3    役割: D/V
 リフレクションベースのセキュリティ警告が強化された監視および潜在的な人間による介入ワークフローをトリガーすることを確認してください。
 #10.8.5    レベル: 3    役割: D/V
 セキュリティ反省からの継続的な学習が、正当な機能を損なうことなく脅威検出を向上させることを検証する。

---

### 10.9 進化と自己改善のセキュリティ

自己修正および進化が可能なエージェントシステムのためのセキュリティ制御。

 #10.9.1    レベル: 1    役割: D/V
 自己修正機能が正式な検証境界内の指定された安全な領域に制限されていることを確認してください。
 #10.9.2    レベル: 2    役割: D/V
 進化提案が実装前にセキュリティ影響評価を受けることを確認してください。
 #10.9.3    レベル: 2    役割: D/V
 自己改善メカニズムには、整合性検証を伴うロールバック機能が含まれていることを確認してください。
 #10.9.4    レベル: 3    役割: D/V
 メタラーニングのセキュリティが改善アルゴリズムの敵対的操作を防止することを検証する。
 #10.9.5    レベル: 3    役割: D/V
 形式的安全制約によって再帰的自己改善が制限されていることを、収束の数学的証明を用いて検証する。

---

#### 参考文献

MITRE ATLAS adversary tactics for ML
NIST AI Risk Management Framework 1.0, 2023
OWASP Top 10 for LLM Applications, 2025
Adversarial Training: A Survey — Zhao et al., 2024
RobustBench adversarial-robustness benchmark
Membership-Inference & Model-Inversion Risk Survey, 2025
PURIFIER: Confidence-Score Defense against MI Attacks — AAAI 2023
Model-Inversion Attacks & Defenses Survey — AI Review, 2025
Comprehensive Defense Framework Against Model Extraction — IEEE TDSC 2024
Fragile Model Watermarking Survey — 2025
Data Poisoning in Deep Learning: A Survey — Zhao et al., 2025
BDetCLIP: Multimodal Prompting Backdoor Detection — Niu et al., 2024

## 11 プライバシー保護と個人データ管理

### 制御目標

AIのライフサイクル全体（収集、トレーニング、推論、インシデント対応）にわたり厳格なプライバシー保証を維持し、個人データが明確な同意、最小限の必要範囲、検証可能な消去、および正式なプライバシー保証のもとでのみ処理されるようにします。

---

### 11.1 匿名化とデータ最小化

 #11.1.1    レベル: 1    役割: D/V
 直接識別子および準識別子が削除またはハッシュ化されていることを確認してください。
 #11.1.2    レベル: 2    役割: D/V
 自動監査がk-匿名性/l-多様性を測定し、閾値がポリシーを下回った場合に警告することを検証する。
 #11.1.3    レベル: 2    役割: V
 モデルの特徴重要度レポートが、ε = 0.01の相互情報量を超える識別子の漏えいがないことを証明していることを確認してください。
 #11.1.4    レベル: 3    役割: V
 形式的証明または合成データの認証により、リンク攻撃があっても再識別リスクが0.05以下であることを確認してください。

---

### 11.2 忘れられる権利と削除の強制

 #11.2.1    レベル: 1    役割: D/V
 データ主体の削除要求が、30日未満のサービスレベル合意内で、生データセット、チェックポイント、埋め込み、ログ、およびバックアップに伝播されることを確認してください。
 #11.2.2    レベル: 2    役割: D
 「machine-unlearning」ルーチンが、認証済みのアンラーニングアルゴリズムを使用して、物理的に再訓練または近似削除を行うことを検証してください。
 #11.2.3    レベル: 2    役割: V
 シャドウモデルの評価により、忘却処理後の忘れられたレコードが出力に与える影響が1%未満であることを確認してください。
 #11.2.4    レベル: 3    役割: V
 削除イベントが不変に記録され、規制当局が監査可能であることを確認してください。

---

### 11.3 差分プライバシー保護措置

 #11.3.1    レベル: 2    役割: D/V
 累積のεがポリシーの閾値を超えたときに、プライバシー損失の監査ダッシュボードが警告を出すことを検証してください。
 #11.3.2    レベル: 2    役割: V
 ブラックボックスプライバシー監査が宣言された値の10％以内でε̂を推定していることを検証してください。
 #11.3.3    レベル: 3    役割: V
 形式的証明がすべてのトレーニング後のファインチューニングおよび埋め込みを網羅していることを検証してください。

---

### 11.4 目的制限およびスコープクリープ防止

 #11.4.1    レベル: 1    役割: D
 すべてのデータセットとモデルチェックポイントに、元の同意に沿った機械判読可能な目的タグが付与されていることを確認してください。
 #11.4.2    レベル: 1    役割: D/V
 ランタイムモニターが、宣言された目的と矛盾するクエリを検出し、ソフトリフューザルをトリガーすることを検証してください。
 #11.4.3    レベル: 3    役割: D
 モデルの新しいドメインへの再展開がDPIAレビューなしで行われないように、ポリシー・アズ・コードのゲートがブロックすることを検証してください。
 #11.4.4    レベル: 3    役割: V
 正式なトレーサビリティ証明により、すべての個人データのライフサイクルが同意された範囲内にあることを検証してください。

---

### 11.5 同意管理と合法的根拠の追跡

 #11.5.1    レベル: 1    役割: D/V
 同意管理プラットフォーム（CMP）が、データ主体ごとにオプトインの状態、目的、および保持期間を記録していることを確認してください。
 #11.5.2    レベル: 2    役割: D
 APIが同意トークンを公開していることを確認してください。モデルは推論前にトークンスコープを検証する必要があります。
 #11.5.3    レベル: 2    役割: D/V
 拒否または撤回された同意が処理パイプラインを24時間以内に停止することを確認してください。

---

### 11.6 プライバシー制御を備えたフェデレーテッドラーニング

 #11.6.1    レベル: 1    役割: D
 クライアントの更新が集約前に局所的差分プライバシーノイズの追加を適用していることを検証してください。
 #11.6.2    レベル: 2    役割: D/V
 トレーニングメトリクスが差分プライバシーを保持し、単一クライアントの損失を決して明らかにしないことを検証してください。
 #11.6.3    レベル: 2    役割: V
 ポイズニング耐性のある集約（例：Krum／Trimmed-Mean）が有効になっていることを確認してください。
 #11.6.4    レベル: 3    役割: V
 形式的な証明により、5未満の効用損失で全体のε予算が示されていることを検証してください。

---

#### 参考文献

GDPR & AI Compliance Best Practices
EU Parliament Study on GDPR & AI, 2020
ISO 31700-1:2023 — Privacy by Design for Consumer Products
NIST Privacy Framework 1.1 (2025 Draft)
Machine Unlearning: Right-to-Be-Forgotten Techniques
A Survey of Machine Unlearning, 2024
Auditing DP-SGD — ArXiv 2024
DP-SGD Explained — PyTorch Blog
Purpose-Limitation for AI — IJLIT 2025
Data-Protection Considerations for AI — URM Consulting
Top Consent-Management Platforms, 2025
Secure Aggregation in DP Federated Learning — ArXiv 2024

## C12 モニタリング、ログ記録、および異常検知

### 制御目標

このセクションでは、モデルおよびその他のAIコンポーネントが見るもの、行うこと、返すものに対してリアルタイムおよびフォレンジックの可視性を提供するための要件を示します。これにより、脅威を検出、トリアージ、および学習できるようにします。

### C12.1 リクエストおよびレスポンスのログ記録

 #12.1.1    レベル: 1    役割: D/V
 すべてのユーザープロンプトとモデルの応答が、適切なメタデータ（例：タイムスタンプ、ユーザーID、セッションID、モデルバージョン）とともにログに記録されていることを確認してください。
 #12.1.2    レベル: 1    役割: D/V
 ログが適切な保持ポリシーとバックアップ手順を備えた、安全でアクセス制御されたリポジトリに保存されていることを確認してください。
 #12.1.3    レベル: 1    役割: D/V
 ログストレージシステムが、ログに含まれる機密情報を保護するために、保存時および転送時の暗号化を実装していることを確認してください。
 #12.1.4    レベル: 1    役割: D/V
 プロンプトおよび出力内の機微なデータがログに記録される前に自動的に抹消またはマスクされることを確認し、PII、認証情報、および独自情報に対する設定可能な抹消ルールを備えていることを確認してください。
 #12.1.5    レベル: 2    役割: D/V
 ポリシー決定および安全フィルタリングのアクションが、コンテンツモデレーションシステムの監査およびデバッグを可能にするために十分な詳細でログ記録されていることを確認してください。
 #12.1.6    レベル: 2    役割: D/V
 ログの整合性が暗号署名や書き込み専用ストレージなどを通じて保護されていることを検証してください。

---

### C12.2 不正使用検出とアラート管理

 #12.2.1    レベル: 1    役割: D/V
 システムが既知のジャイルブレイクパターン、プロンプトインジェクションの試み、および敵対的入力をシグネチャベースの検出で検出し警告することを確認してください。
 #12.2.2    レベル: 1    役割: D/V
 システムが標準的なログ形式やプロトコルを使用して、既存のセキュリティ情報およびイベント管理（SIEM）プラットフォームと統合されていることを確認してください。
 #12.2.3    レベル: 2    役割: D/V
 強化されたセキュリティイベントに、モデル識別子、信頼度スコア、安全フィルターの判定など、AI固有のコンテキストが含まれていることを確認してください。
 #12.2.4    レベル: 2    役割: D/V
 異常な会話パターン、過剰な再試行回数、または体系的なプロービング行動を識別するために、行動異常検出が機能していることを検証してください。
 #12.2.5    レベル: 2    役割: D/V
 潜在的なポリシー違反や攻撃試行が検出された際に、リアルタイムのアラート機構がセキュリティチームに通知することを確認してください。
 #12.2.6    レベル: 2    役割: D/V
 AI固有の脅威パターン、例えば協調的な jailbreak 試行、プロンプトインジェクションキャンペーン、およびモデル抽出攻撃を検出するためのカスタムルールが含まれていることを確認してください。
 #12.2.7    レベル: 3    役割: D/V
 自動化されたインシデント対応ワークフローが、侵害されたモデルを分離し、悪意のあるユーザーをブロックし、重大なセキュリティイベントをエスカレーションできることを検証します。

---

### C12.3 モデルドリフト検出

 #12.3.1    レベル: 1    役割: D/V
 システムがモデルのバージョンや期間にわたって、精度、信頼度スコア、レイテンシ、およびエラー率などの基本的なパフォーマンス指標を追跡していることを確認してください。
 #12.3.2    レベル: 2    役割: D/V
 パフォーマンス指標が事前に定義された劣化閾値を超えるか、ベースラインから大幅に逸脱した場合に、自動アラートがトリガーされることを検証してください。
 #12.3.3    レベル: 2    役割: D/V
 モデル出力に事実誤認、一貫性の欠如、または捏造された情報が含まれている場合に、幻覚検出モニターがそれを特定しフラグを立てることを確認してください。

---

### C12.4 パフォーマンスおよび動作テレメトリー

 #12.4.1    レベル: 1    役割: D/V
 リクエストの待ち時間、トークン消費量、メモリ使用量、スループットなどの運用指標が継続的に収集および監視されていることを確認してください。
 #12.4.2    レベル: 1    役割: D/V
 成功率と失敗率が、エラータイプおよびその根本原因の分類とともに追跡されていることを確認してください。
 #12.4.3    レベル: 2    役割: D/V
 リソース利用状況の監視には、GPU/CPU使用率、メモリ消費量、ストレージ要件が含まれ、閾値超過時にはアラートが発生することを確認してください。

---

### C12.5 AIインシデント対応計画と実行

 #12.5.1    レベル: 1    役割: D/V
 インシデント対応計画が、モデルの妥協、データポイズニング、敵対的攻撃など、AIに関連するセキュリティイベントを具体的に扱っていることを確認してください。
 #12.5.2    レベル: 2    役割: D/V
 インシデント対応チームが、モデルの挙動や攻撃ベクトルを調査するためのAI専用のフォレンジックツールと専門知識にアクセスできることを確認してください。
 #12.5.3    レベル: 3    役割: D/V
 事後分析にモデルの再トレーニングの検討、安全フィルターの更新、および学んだ教訓のセキュリティ制御への統合が含まれていることを確認してください。

---

### C12.5 AI パフォーマンス低下検出

時間の経過に伴うAIモデルの性能および品質の劣化を監視および検出する。

 #12.5.1    レベル: 1    役割: D/V
 モデルの精度、適合率、再現率、およびF1スコアが継続的に監視され、基準値と比較されていることを確認してください。
 #12.5.2    レベル: 1    役割: D/V
 データドリフト検出が、モデルのパフォーマンスに影響を与える可能性のある入力分布の変化を監視していることを確認してください。
 #12.5.3    レベル: 2    役割: D/V
 概念ドリフト検出が、入力と期待される出力の関係の変化を特定することを検証する。
 #12.5.4    レベル: 2    役割: D/V
 パフォーマンスの劣化が自動アラートを引き起こし、モデルの再訓練または置換ワークフローを開始することを確認してください。
 #12.5.5    レベル: 3    役割: V
 劣化の根本原因分析が、パフォーマンスの低下とデータの変化、インフラストラクチャの問題、または外部要因との相関を確認することを検証してください。

---

### C12.6 DAGの可視化とワークフローのセキュリティ

ワークフロー可視化システムを情報漏洩および改ざん攻撃から保護する。

 #12.6.1    レベル: 1    役割: D/V
 DAGの可視化データが保存または送信される前に、機密情報が除去されていることを検証してください。
 #12.6.2    レベル: 1    役割: D/V
 ワークフロービジュアライゼーションのアクセス制御が、許可されたユーザーのみがエージェントの意思決定経路および推論トレースを閲覧できることを検証してください。
 #12.6.3    レベル: 2    役割: D/V
 DAGデータの整合性が暗号署名および改ざん検知可能なストレージメカニズムによって保護されていることを検証する。
 #12.6.4    レベル: 2    役割: D/V
 ワークフロービジュアライゼーションシステムが、作成されたノードまたはエッジのデータを通じたインジェクション攻撃を防ぐために入力検証を実装していることを確認してください。
 #12.6.5    レベル: 3    役割: D/V
 リアルタイムDAGの更新がレート制限されており、可視化システムに対するサービス拒否攻撃を防ぐために検証されていることを確認してください。

---

### C12.7 プロアクティブなセキュリティ行動監視

プロアクティブなエージェント行動分析によるセキュリティ脅威の検出と予防。

 #12.7.1    レベル: 1    役割: D/V
 リスク評価統合を用いて、実行前にプロアクティブエージェントの行動がセキュリティ検証されていることを確認してください。
 #12.7.2    レベル: 2    役割: D/V
 自律的なイニシアティブのトリガーには、セキュリティコンテキストの評価と脅威の状況評価が含まれていることを確認してください。
 #12.7.3    レベル: 2    役割: D/V
 プロアクティブな行動パターンが潜在的なセキュリティ上の影響および意図しない結果について分析されていることを検証してください。
 #12.7.4    レベル: 3    役割: D/V
 セキュリティに重要なプロアクティブな行動には、監査証跡を伴う明示的な承認チェーンが必要であることを確認してください。
 #12.7.5    レベル: 3    役割: D/V
 行動異常検知が、侵害を示す可能性のある能動的エージェントのパターンの逸脱を特定することを検証する。

---

### 参考文献

NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3
ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6
EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping

## C13 人間の監督、説明責任、およびガバナンス

### 制御目標

この章では、AIシステムにおける人間の監視と明確な責任の連鎖を維持するための要件を提供し、AIライフサイクル全体にわたって説明可能性、透明性、および倫理的管理を保証します。

---

### C13.1 キルスイッチ＆オーバーライドメカニズム

AIシステムの安全でない挙動が観察された場合に備えて、シャットダウンまたはロールバックの手順を提供してください。

 #13.1.1    レベル: 1    役割: D/V
 AIモデルの推論と出力を即座に停止するための手動キルスイッチ機構が存在することを確認してください。
 #13.1.2    レベル: 1    役割: D
 オーバーライドコントロールが許可された担当者のみがアクセス可能であることを確認してください。
 #13.1.3    レベル: 3    役割: D/V
 ロールバック手順が以前のモデルバージョンまたは安全モード操作に戻せることを確認してください。
 #13.1.4    レベル: 3    役割: V
 オーバーライド機構が定期的にテストされていることを確認してください。

---

### C13.2 人間参加型意思決定チェックポイント

リスクの事前設定された閾値を超えた場合は、人間の承認を必要とします。

 #13.2.1    レベル: 1    役割: D/V
 高リスクのAI決定は実行前に明確な人間の承認を必要とすることを確認してください。
 #13.2.2    レベル: 1    役割: D
 リスク閾値が明確に定義され、自動的に人間のレビュー ワークフローをトリガーすることを確認してください。
 #13.2.3    レベル: 2    役割: D
 人間の承認が必要な時間内に得られない場合に備えて、時間に敏感な意思決定にフォールバック手順があることを確認してください。
 #13.2.4    レベル: 3    役割: D/V
 適用可能な場合、エスカレーション手順が異なる意思決定の種類やリスクカテゴリに対して明確な権限レベルを定めていることを確認してください。

---

### C13.3 責任の連鎖と監査可能性

オペレーターの操作とモデルの決定を記録します。

 #13.3.1    レベル: 1    役割: D/V
 すべてのAIシステムの決定および人間の介入が、タイムスタンプ、ユーザー識別情報、および決定理由とともに記録されていることを確認してください。
 #13.3.2    レベル: 2    役割: D
 監査ログが改ざんされないことを確認し、完全性検証メカニズムを含めること。

---

### C13.4 説明可能なAI技術

表面特徴の重要性、反事実、および局所的説明。

 #13.4.1    レベル: 1    役割: D/V
 AIシステムがその決定に対して人間が理解できる形式で基本的な説明を提供していることを検証してください。
 #13.4.2    レベル: 2    役割: V
 説明の品質が人間による評価研究と指標を通じて検証されていることを確認してください。
 #13.4.3    レベル: 3    役割: D/V
 重要な意思決定に対して、特徴重要度スコアや帰属方法（SHAP、LIMEなど）が利用可能であることを確認してください。
 #13.4.4    レベル: 3    役割: V
 カウンターファクチュアル説明が、使用例およびドメインに適用可能な場合に、どのように入力を変更すれば結果を変えられるかを示していることを確認してください。

---

### C13.5 モデルカードと使用開示

モデルカードを、意図された使用法、性能指標、および倫理的考慮事項について維持する。

 #13.5.1    レベル: 1    役割: D
 モデルカードが意図された使用例、制限、および既知の故障モードを文書化していることを確認してください。
 #13.5.2    レベル: 1    役割: D/V
 異なる適用可能なユースケースにわたるパフォーマンス指標が開示されていることを確認してください。
 #13.5.3    レベル: 2    役割: D
 倫理的考慮事項、バイアス評価、公正性評価、トレーニングデータの特性、および既知のトレーニングデータの制限が文書化され、定期的に更新されていることを確認してください。
 #13.5.4    レベル: 2    役割: D/V
 モデルカードがバージョン管理されており、変更追跡とともにモデルのライフサイクル全体で維持されていることを確認してください。

---

### C13.6 不確実性の定量化

応答における信頼度スコアやエントロピー測度を伝搬させる。

 #13.6.1    レベル: 1    役割: D
 AIシステムが出力に対して信頼度スコアまたは不確実性の測定値を提供していることを確認してください。
 #13.6.2    レベル: 2    役割: D/V
 不確実性の閾値が追加の人間によるレビューまたは代替の意思決定経路を引き起こすことを確認してください。
 #13.6.3    レベル: 2    役割: V
 不確実性定量化手法が基準となる真値データに対して較正および検証されていることを確認してください。
 #13.6.4    レベル: 3    役割: D/V
 不確実性の伝播がマルチステップのAIワークフローを通じて維持されていることを確認する。

---

### C13.7 ユーザー向け透明性レポート

インシデント、ドリフト、およびデータ使用に関する定期的な開示を提供する。

 #13.7.1    レベル: 1    役割: D/V
 データ使用ポリシーおよびユーザー同意管理の実践がステークホルダーに明確に伝えられていることを確認してください。
 #13.7.2    レベル: 2    役割: D/V
 AI影響評価が実施され、その結果が報告に含まれていることを確認してください。
 #13.7.3    レベル: 2    役割: D/V
 透明性レポートが定期的に公開され、AIのインシデントおよび運用指標が適切な詳細で開示されていることを確認してください。

#### 参考文献

EU Artificial Intelligence Act — Regulation (EU) 2024/1689 (Official Journal, 12 July 2024)
ISO/IEC 23894:2023 — Artificial Intelligence — Guidance on Risk Management
ISO/IEC 42001:2023 — AI Management Systems Requirements
NIST AI Risk Management Framework 1.0
NIST SP 800-53 Revision 5 — Security and Privacy Controls
A Unified Approach to Interpreting Model Predictions (SHAP, ICML 2017)
Model Cards for Model Reporting (Mitchell et al., 2018)
Dropout as a Bayesian Approximation: Representing Model Uncertainty in Deep Learning (Gal & Ghahramani, 2016)
ISO/IEC 24029-2:2023 — Robustness of Neural Networks — Methodology for Formal Methods
IEEE 7001-2021 — Transparency of Autonomous Systems
GDPR — Article 5 "Transparency Principle" (Regulation (EU) 2016/679)
Human Oversight under Article 14 of the EU AI Act (Fink, 2025)

## 付録A：用語集

この包括的な用語集は、AISVS全体で使用される主要なAI、機械学習、およびセキュリティ用語の定義を提供し、明確さと共通理解を保証します。

敵対的サンプル：人間には知覚できない微妙な摂動を加えることで、AIモデルに誤りを引き起こさせるために意図的に作成された入力。
​
敵対的ロバストネス – AIにおける敵対的ロバストネスとは、意図的に作成された悪意のある入力によって誤動作を引き起こされることなく、モデルがその性能を維持し続ける能力を指します。
​
エージェント – AIエージェントは、ユーザーに代わって目標を追求し、タスクを完了するためにAIを使用するソフトウェアシステムです。彼らは推論、計画、記憶を示し、意思決定、学習、適応を行う一定の自律性を持っています。
​
エージェンティックAI：ある程度の自律性を持ち、目標を達成するために稼働できるAIシステムであり、多くの場合、直接的な人間の介入なしに意思決定や行動を行う。
​
属性ベースアクセス制御（ABAC）：ユーザー、リソース、アクション、および環境の属性に基づいて認可決定が行われるアクセス制御のパラダイムであり、クエリ実行時に評価される。
​
バックドア攻撃：モデルが特定のトリガーに対して特定の反応をするように訓練され、それ以外の時は正常に動作するデータ毒性攻撃の一種。
​
バイアス：特定のグループや特定の状況において不公平または差別的な結果をもたらす可能性がある、AIモデルの出力における体系的な誤り。
​
バイアス悪用：AIモデルにおける既知のバイアスを利用して出力や結果を操作する攻撃手法。
​
Cedar：AIシステム向けのABAC実装に使用される、詳細な権限管理のためのAmazonのポリシー言語およびエンジン。
​
Chain of Thought: 最終的な回答を生成する前に中間の推論ステップを生成することで、言語モデルの推論能力を向上させる手法。
​
サーキットブレーカー：特定のリスク閾値を超えた場合にAIシステムの動作を自動的に停止するメカニズム。
​
データリーク：AIモデルの出力や挙動を通じて機密情報が意図せず漏洩すること。
​
データポイズニング：モデルの整合性を損なうために訓練データを意図的に破損させること。これはしばしばバックドアを仕込んだり、性能を低下させたりする目的で行われる。
​
差分プライバシー – 差分プライバシーは、個々のデータ主体のプライバシーを保護しながら、データセットに関する統計情報を公開するための数学的に厳密な枠組みです。これにより、データ保有者は特定の個人に関する情報の漏洩を制限しつつ、グループの集約パターンを共有することが可能になります。
​
埋め込み：意味的な意味を高次元の空間で捉える、データ（テキスト、画像など）の密なベクトル表現。
​
説明可能性 – 説明可能性とは、AIシステムがその意思決定や予測の理由を人間に理解できる形で提供し、その内部の動作についての洞察を与える能力のことです。
​
説明可能なAI（XAI）：その決定や行動について人間が理解できる説明を様々な技術やフレームワークを通じて提供するよう設計されたAIシステム。
​
フェデレーテッドラーニング：データ自体を交換することなく、複数の分散型デバイスが保持するローカルデータサンプルを用いてモデルを訓練する機械学習のアプローチ。
​
ガードレール：AIシステムが有害、偏った、またはその他望ましくない出力を生成するのを防ぐために実装された制約。
​
幻覚 – AIの幻覚とは、AIモデルが学習データや事実に基づかない誤ったまたは誤解を招く情報を生成する現象を指します。
​
ヒューマン・イン・ザ・ループ（HITL）：重要な意思決定ポイントで人間の監視、検証、または介入を必要とするように設計されたシステム。
​
インフラストラクチャー・アズ・コード（IaC）：手動プロセスの代わりにコードを通じてインフラストラクチャーを管理およびプロビジョニングし、セキュリティスキャンと一貫したデプロイメントを可能にすること。
​
脱獄（Jailbreak）：特に大規模言語モデルにおいて、AIシステムの安全ガードレールを回避し、禁止されたコンテンツを生成するために使用される技術。
​
最小権限: ユーザーおよびプロセスに対して必要最小限のアクセス権のみを付与するというセキュリティ原則。
​
LIME（ローカル解釈可能モデル非依存説明）：任意の機械学習分類器の予測を、解釈可能なモデルで局所的に近似することによって説明する手法。
​
メンバーシップ推論攻撃：特定のデータポイントが機械学習モデルのトレーニングに使用されたかどうかを判定することを目的とした攻撃。
​
MITRE ATLAS: 人工知能システムに対する敵対的脅威の全景；AIシステムに対する敵対的戦術と技術の知識ベース。
​
モデルカード – モデルカードは、AIモデルの性能、制限、意図された使用法、および倫理的考慮事項に関する標準化された情報を提供し、透明性と責任あるAI開発を促進するための文書です。
​
モデル抽出：攻撃者が対象モデルに繰り返しクエリを送信し、許可なく機能的に類似したコピーを作成する攻撃。
​
モデル反転攻撃：モデルの出力を解析して訓練データを再構築しようとする攻撃。
​
モデルライフサイクル管理 – AIモデルライフサイクル管理は、設計、開発、展開、監視、メンテナンス、および最終的な廃止を含む、AIモデルの全存在段階を監督し、効果的で目的に沿った状態を維持するプロセスです。
​
モデルポイズニング：トレーニングプロセス中にモデルに直接脆弱性やバックドアを導入すること。
​
モデル盗用/盗難：繰り返しのクエリを通じて、専有モデルのコピーまたは近似値を抽出すること。
​
マルチエージェントシステム：異なる能力や目標を持つ複数のAIエージェントが相互に作用することで構成されるシステム。
​
OPA（Open Policy Agent）：スタック全体で統一されたポリシー適用を可能にするオープンソースのポリシーエンジン。
​
プライバシー保護機械学習（PPML）：トレーニングデータのプライバシーを保護しながら、機械学習モデルをトレーニングおよびデプロイするための技術と方法。
​
プロンプトインジェクション：モデルの意図された動作を上書きするために、悪意のある指示が入力に埋め込まれる攻撃。
​
RAG（Retrieval-Augmented Generation）：応答を生成する前に外部の知識ソースから関連情報を取得することで、大規模言語モデルを強化する手法。
​
レッドチーミング：敵対的攻撃をシミュレートしてAIシステムを積極的にテストし、脆弱性を特定する手法。
​
SBOM（ソフトウェア部品表）：ソフトウェアやAIモデルの構築に使用されるさまざまなコンポーネントの詳細とサプライチェーンの関係を含む正式な記録。
​
SHAP（SHapley Additive exPlanations）：ゲーム理論に基づくアプローチで、各特徴量が予測にどのように寄与しているかを計算することで、任意の機械学習モデルの出力を説明します。
​
サプライチェーン攻撃：サードパーティのライブラリ、データセット、または事前学習済みモデルなど、供給チェーン内のセキュリティが低い要素を標的にしてシステムを侵害すること。
​
転移学習：あるタスクのために開発されたモデルを、別のタスクのモデルの出発点として再利用する技術。
​
ベクトルデータベース：高次元ベクトル（埋め込み）を保存し、効率的な類似検索を行うために設計された専門のデータベース。
​
脆弱性スキャン：AIフレームワークや依存関係を含むソフトウェアコンポーネントにおける既知のセキュリティ脆弱性を特定する自動化ツール。
​
ウォーターマーキング：AI生成コンテンツの起源を追跡したり、AI生成を検出したりするために、知覚できないマーカーを埋め込む技術。
​
ゼロデイ脆弱性：開発者がパッチを作成および展開する前に攻撃者が悪用可能な、以前は知られていなかった脆弱性。

## 付録B：参考文献

### TODO

## 付録C: AI セキュリティ ガバナンスとドキュメンテーション

### 目的

この付録は、システムライフサイクル全体にわたるAIセキュリティを管理するための組織構造、方針、およびプロセスを確立するための基礎的要件を提供します。

---

### AC.1 AIリスク管理フレームワークの採用

システムライフサイクル全体にわたり、AI固有のリスクを特定、評価、および軽減するための正式なフレームワークを提供する。

 #AC.1.1    レベル: 1    役割: D/V
 AI固有のリスク評価方法論が文書化され、実施されていることを確認してください。
 #AC.1.2    レベル: 2    役割: D
 AIライフサイクルの重要なポイントおよび重要な変更の前にリスク評価が実施されていることを確認してください。
 #AC.1.3    レベル: 3    役割: D/V
 リスク管理フレームワークが確立された基準（例：NIST AI RMF）と一致していることを確認する。

---

### AC.2 AI セキュリティポリシーと手順

安全なAIの開発、展開、および運用のための組織基準を定義し、それを実施する。

 #AC.2.1    レベル: 1    役割: D/V
 文書化されたAIセキュリティポリシーが存在することを確認してください。
 #AC.2.2    レベル: 2    役割: D
 ポリシーが少なくとも年に一度、および重大な脅威状況の変化後にレビューされ、更新されていることを確認してください。
 #AC.2.3    レベル: 3    役割: D/V
 ポリシーがすべてのAISVSカテゴリおよび適用される規制要件を網羅していることを確認してください。

---

### AC.3 AIセキュリティの役割と責任

組織全体でAIセキュリティに対する明確な責任体制を確立する。

 #AC.3.1    レベル: 1    役割: D/V
 AIセキュリティの役割と責任が文書化されていることを確認してください。
 #AC.3.2    レベル: 2    役割: D
 責任者が適切なセキュリティ専門知識を持っていることを確認してください。
 #AC.3.3    レベル: 3    役割: D/V
 高リスクのAIシステムに対して、AI倫理委員会またはガバナンス委員会が設立されていることを確認してください。

---

### AC.4 倫理的なAIガイドラインの施行

AIシステムが確立された倫理原則に従って運用されることを確保する。

 #AC.4.1    レベル: 1    役割: D/V
 AI開発および展開のための倫理ガイドラインが存在することを確認する。
 #AC.4.2    レベル: 2    役割: D
 倫理違反を検出し報告するための仕組みが整っていることを確認してください。
 #AC.4.3    レベル: 3    役割: D/V
 展開されたAIシステムに対して定期的な倫理的レビューが実施されていることを確認してください。

---

### AC.5 AI規制コンプライアンス監視

進化するAI規制に対する認識と準拠を維持すること。

 #AC.5.1    レベル: 1    役割: D/V
 適用されるAI規制を特定するためのプロセスが存在することを確認してください。
 #AC.5.2    レベル: 2    役割: D
 すべての規制要件の遵守状況が評価されていることを確認してください。
 #AC.5.3    レベル: 3    役割: D/V
 規制の変更がAIシステムの適時なレビューと更新を引き起こすことを確認する。

### AC.6 トレーニングデータのガバナンス、文書化およびプロセス

 #1.1.2    レベル: 1    役割: D/V
 品質、代表性、倫理的調達、およびライセンス遵守のために精査されたデータセットのみを許可し、データの汚染、埋め込みバイアス、および知的財産権侵害のリスクを低減することを検証します。
 #1.1.5    レベル: 2    役割: D/V
 レビューアーのクロスチェックまたはコンセンサスによってラベリング／アノテーションの品質が確保されていることを確認してください。
 #1.1.6    レベル: 2    役割: D/V
 重要なトレーニングデータセットについて、「データカード」または「データセット用データシート」が維持されていることを確認し、それらに特性、動機、構成、収集プロセス、前処理、および推奨される／推奨されない使用方法が詳細に記載されていることを確認してください。
 #1.3.2    レベル: 2    役割: D/V
 特定されたバイアスが、再バランス、ターゲットを絞ったデータ増強、アルゴリズム調整（例：前処理、処理中、後処理技術）、または再重み付けなどの文書化された戦略を通じて軽減されていることを検証し、軽減策が公平性およびモデル全体のパフォーマンスに与える影響を評価すること。
 #1.3.3    レベル: 2    役割: D/V
 トレーニング後の公平性指標が評価され、文書化されていることを確認してください。
 #1.3.4    レベル: 3    役割: D/V
 ライフサイクルバイアスマネジメントポリシーが所有者とレビュー頻度を割り当てていることを確認してください。
 #1.4.1    レベル: 2    役割: D/V
 ラベリング／アノテーションの品質が、明確なガイドライン、レビュワーによる相互確認、コンセンサスメカニズム（例：アノテーター間の一致を監視すること）、および不一致を解決するための定義されたプロセスを通じて確保されていることを確認してください。
 #1.4.4    レベル: 3    役割: D/V
 安全性、セキュリティ、または公正性にとって重要なラベル（例：有害なコンテンツの識別、重要な医療所見）が、必須の独立した二重レビューまたは同等の堅牢な検証を受けていることを確認してください。
 #1.4.6    レベル: 2    役割: D/V
 ラベリングガイドと指示が包括的で、バージョン管理されており、ピアレビューされていることを確認してください。
 #1.4.6    レベル: 2    役割: D/V
 ラベルのデータスキーマが明確に定義され、バージョン管理されていることを確認してください。
 #1.3.1    レベル: 1    役割: D/V
 データセットが、法的に保護された属性（例：人種、性別、年齢）およびモデルの適用領域に関連するその他の倫理的に敏感な特性（例：社会経済的地位、所在地）に関して、表現の不均衡や潜在的なバイアスについてプロファイリングされていることを確認してください。
 #1.5.3    レベル: 2    役割: V
 自動化では検出できない微細な品質問題を特定するために、ドメイン専門家によるマニュアルのスポットチェックが統計的に有意なサンプル（例：1%以上または1,000サンプルのいずれか大きい方、またはリスク評価により決定された量）をカバーしていることを確認する。
 #1.8.4    レベル: 2    役割: D/V
 アウトソーシングまたはクラウドソーシングされたラベリングワークフローに、データの機密性、整合性、ラベル品質を確保し、データ漏洩を防止するための技術的および手続き上の安全対策が含まれていることを確認してください。
 #1.5.4    レベル: 2    役割: D/V
 修復手順がプロビナンス記録に付加されていることを確認してください。
 #1.6.2    レベル: 2    役割: D/V
 フラグが立てられたサンプルがトレーニング前に手動レビューをトリガーすることを確認してください。
 #1.6.3    レベル: 2    役割: V
 結果がモデルのセキュリティドシエに反映され、継続的な脅威インテリジェンスに通知されることを確認してください。
 #1.6.4    レベル: 3    役割: D/V
 検出ロジックが新しい脅威インテリジェンスで更新されていることを確認してください。
 #1.6.5    レベル: 3    役割: D/V
 オンライン学習パイプラインが分布の変動を監視していることを検証してください。
 #1.7.1    レベル: 1    役割: D/V
 トレーニングデータの削除ワークフローが、一次データおよび派生データを完全に削除し、モデルへの影響を評価していることを確認し、影響を受けたモデルに対して必要に応じて再トレーニングや再調整などの対処が行われていることを評価してください。
 #1.7.2    レベル: 2    役割: D
 トレーニングに使用されるデータに対するユーザーの同意（および撤回）の範囲と状況を追跡し尊重するための仕組みが整っていることを確認し、データが新しいトレーニングプロセスや重要なモデル更新に組み込まれる前に同意が検証されていることを確認してください。
 #1.7.3    レベル: 2    役割: V
 ワークフローが年に一度テストされ、記録されていることを確認してください。
 #1.8.1    レベル: 2    役割: D/V
 第三者のデータ供給者（事前学習済みモデルの提供者や外部データセットの提供者を含む）が、そのデータやモデルが統合される前に、セキュリティ、プライバシー、倫理的調達、およびデータ品質のデューデリジェンスを受けていることを確認してください。
 #1.8.2    レベル: 1    役割: D
 外部転送がTLS認証および完全性チェックを使用していることを検証してください。
 #1.8.3    レベル: 2    役割: D/V
 高リスクのデータソース（例：出所不明のオープンソースデータセット、未検証のサプライヤー）が、機密性の高いアプリケーションで使用される前に、サンドボックス分析、徹底した品質・バイアスチェック、ターゲットを絞ったポイズニング検出などの強化された精査を受けていることを確認してください。
 #1.8.4    レベル: 3    役割: D/V
 事前学習済みモデルをサードパーティから入手した場合、ファインチューニングや展開の前に、組み込みバイアス、潜在的なバックドア、アーキテクチャの整合性、および元のトレーニングデータの出所について評価されていることを確認してください。
 #1.5.3    レベル: 2    役割: D/V
 敵対的トレーニングが使用されている場合、敵対的データセットの生成、管理、およびバージョン管理が文書化され、管理されていることを確認してください。
 #1.5.3    レベル: 3    役割: D/V
 敵対的ロバストネストレーニングがモデルのパフォーマンス（クリーン入力および敵対的入力の両方に対して）および公平性指標に与える影響が評価され、文書化され、監視されていることを確認する。
 #1.5.4    レベル: 3    役割: D/V
 敵対的トレーニングおよびロバストネスの戦略が、進化する敵対的攻撃手法に対抗するために定期的に見直され、更新されていることを確認する。
 #1.4.2    レベル: 2    役割: D/V
 監査記録を伴って、失敗したデータセットが隔離されていることを確認してください。
 #1.4.3    レベル: 2    役割: D/V
 例外が承認されていない限り、品質ゲートが基準以下のデータセットをブロックすることを確認してください。
 #1.11.2    レベル: 2    役割: D/V
 合成データの生成プロセス、パラメータ、および意図された使用目的が文書化されていることを確認してください。
 #1.11.3    レベル: 2    役割: D/V
 合成データをトレーニングに使用する前に、バイアス、プライバシー漏洩、および表現上の問題に関してリスク評価が行われていることを確認してください。
 #1.12.3    レベル: 2    役割: D/V
 疑わしいアクセスイベントに対してアラートが生成され、迅速に調査されていることを確認してください。
 #1.13.1    レベル: 1    役割: D/V
 すべてのトレーニングデータセットに対して明示的な保持期間が定義されていることを確認してください。
 #1.13.2    レベル: 2    役割: D/V
 データセットがライフサイクルの終了時に自動的に期限切れ、削除、または削除のためにレビューされることを確認してください。
 #1.13.3    レベル: 2    役割: D/V
 保持および削除の操作が記録され、監査可能であることを確認してください。
 #1.14.1    レベル: 2    役割: D/V
 すべてのデータセットに対して、データ居住地および国境を越えた転送の要件が特定され、適用されていることを確認してください。
 #1.14.2    レベル: 2    役割: D/V
 データ処理において、業界別規制（例：医療、金融）が特定され、対応されていることを確認してください。
 #1.14.3    レベル: 2    役割: D/V
 関連するプライバシー法（例：GDPR、CCPA）への準拠が文書化され、定期的にレビューされていることを確認してください。
 #1.16.1    レベル: 2    役割: D/V
 データ主体からのアクセス、訂正、制限、または異議申し立ての要求に対応するためのメカニズムが存在することを確認してください。
 #1.16.2    レベル: 2    役割: D/V
 リクエストが法的に定められた期限内に記録され、追跡され、履行されていることを確認してください。
 #1.16.3    レベル: 2    役割: D/V
 データ主体の権利に関するプロセスが効果的であることを検証し、定期的にテストおよび見直しが行われていることを確認してください。
 #1.17.1    レベル: 2    役割: D/V
 データセットのバージョンを更新または置き換える前に、モデルのパフォーマンス、公平性、およびコンプライアンスを対象とした影響分析が実施されていることを確認してください。
 #1.17.2    レベル: 2    役割: D/V
 影響分析の結果が文書化され、関連する利害関係者によってレビューされていることを確認する。
 #1.17.3    レベル: 2    役割: D/V
 新しいバージョンが受け入れられないリスクや回帰をもたらす場合に備え、ロールバック計画が存在することを確認してください。
 #1.18.1    レベル: 2    役割: D/V
 データ注釈に関与するすべての担当者が、身元調査を受け、データのセキュリティとプライバシーに関する訓練を受けていることを確認してください。
 #1.18.2    レベル: 2    役割: D/V
 すべてのアノテーション担当者が機密保持および非開示契約書に署名していることを確認してください。
 #1.18.3    レベル: 2    役割: D/V
 アノテーションプラットフォームがアクセス制御を実施し、内部脅威を監視していることを確認してください。

#### 参考文献

NIST AI Risk Management Framework 1.0
ISO/IEC 42001:2023 — AI Management Systems Requirements
ISO/IEC 23894:2023 — Artificial Intelligence — Guidance on Risk Management
EU Artificial Intelligence Act — Regulation (EU) 2024/1689
ISO/IEC 24029‑2:2023 — Robustness of Neural Networks — Methodology for Formal Methods

## 付録D：AI支援によるセキュアコーディングのガバナンスと検証

### 目的

この章では、ソフトウェア開発中にAI支援コーディングツールを安全かつ効果的に使用するための基礎的な組織的管理策を定義し、SDLC全体でのセキュリティとトレーサビリティを確保します。

---

### AD.1 AI支援セキュアコーディングワークフロー

既存のセキュリティゲートを弱めることなく、組織の安全なソフトウェア開発ライフサイクル（SSDLC）にAIツールを統合する。

 #AD.1.1    レベル: 1    役割: D/V
 文書化されたワークフローが、AIツールがコードを生成、リファクタリング、またはレビューするタイミングと方法を説明していることを確認してください。
 #AD.1.2    レベル: 2    役割: D
 ワークフローが各SSDLCフェーズ（設計、実装、コードレビュー、テスト、展開）に対応していることを確認してください。
 #AD.1.3    レベル: 3    役割: D/V
 AI生成コードに対してメトリクス（例：脆弱性密度、平均検出時間）が収集され、人間のみの基準値と比較されていることを確認してください。

---

### AD.2 AIツールの資格評価と脅威モデリング

AIコーディングツールは、採用前にセキュリティ機能、リスク、およびサプライチェーンへの影響について評価を行うことを確実にしてください。

 #AD.2.1    レベル: 1    役割: D/V
 各AIツールの脅威モデルが、誤用、モデル逆転、データ漏洩、および依存関係チェーンのリスクを特定していることを確認してください。
 #AD.2.2    レベル: 2    役割: D
 ツール評価には、ローカルコンポーネントの静的/動的解析およびSaaSエンドポイント（TLS、認証/認可、ログ記録）の評価が含まれていることを確認してください。
 #AD.2.3    レベル: 3    役割: D/V
 評価が認識されたフレームワークに従っていることを確認し、主要なバージョン変更後に再実施されることを確認してください。

---

### AD.3 セキュアプロンプト＆コンテキスト管理

AIモデルのプロンプトやコンテキストを構築する際に、秘密情報、専有コード、および個人データの漏洩を防止してください。

 #AD.3.1    レベル: 1    役割: D/V
 書面による指示に、プロンプト内で秘密情報、認証情報、または機密データを送信することを禁止していることを確認してください。
 #AD.3.2    レベル: 2    役割: D
 技術的な制御（クライアント側の抹消、承認されたコンテキストフィルター）が自動的に機密情報を除去することを検証してください。
 #AD.3.3    レベル: 3    役割: D/V
 プロンプトと応答がトークン化され、転送中および保存時に暗号化されていること、ならびに保持期間がデータ分類ポリシーに準拠していることを検証してください。

---

### AD.4 AI生成コードの検証

コードがマージまたはデプロイされる前に、AI出力によって導入された脆弱性を検出して修復します。

 #AD.4.1    レベル: 1    役割: D/V
 AI生成コードが常に人間のコードレビューを受けるように確認してください。
 #AD.4.2    レベル: 2    役割: D
 AI生成コードを含むすべてのプルリクエストに対して自動スキャナー（SAST/IAST/DAST）が実行され、重大な検出結果がある場合はマージをブロックすることを確認してください。
 #AD.4.3    レベル: 3    役割: D/V
 差分ファズテストまたはプロパティベースのテストが、セキュリティクリティカルな動作（例：入力検証、認可ロジック）を証明していることを検証してください。

---

### AD.5 コード提案の説明性と追跡可能性

監査人や開発者に対して、なぜ提案がされたのか、そしてその提案がどのように進化したのかについての洞察を提供する。

 #AD.5.1    レベル: 1    役割: D/V
 プロンプト/レスポンスのペアがコミットIDと共に記録されていることを確認してください。
 #AD.5.2    レベル: 2    役割: D
 開発者が提案をサポートするモデルの引用（トレーニングスニペット、ドキュメント）を表示できることを確認してください。
 #AD.5.3    レベル: 3    役割: D/V
 説明可能性レポートが設計成果物とともに保存され、セキュリティレビューで参照されていることを確認し、ISO/IEC 42001のトレーサビリティ原則を満たしていることを確認してください。

---

### AD.6 継続的フィードバックとモデルのファインチューニング

モデルのセキュリティ性能を時間経過とともに向上させつつ、負のドリフトを防止する。

 #AD.6.1    レベル: 1    役割: D/V
 開発者が安全でない、または非準拠な提案にフラグを立てられること、そしてそのフラグが追跡されることを検証してください。
 #AD.6.2    レベル: 2    役割: D
 集約されたフィードバックが、検証済みのセキュアコーディングコーパス（例：OWASPチートシート）を用いた定期的なファインチューニングやリトリーバル増強生成に反映されていることを確認してください。
 #AD.6.3    レベル: 3    役割: D/V
 閉ループ評価ハーネスが各ファインチューニング後に回帰テストを実行することを検証してください。セキュリティメトリクスは、展開前に前のベースラインを満たすかそれを上回っている必要があります。

---

#### 参考文献

NIST AI Risk Management Framework 1.0
ISO/IEC 42001:2023 — AI Management Systems Requirements
OWASP Secure Coding Practices — Quick Reference Guide

## 付録E: 例となるツールとフレームワーク

### 目的

この章では、特定のAISVS要件の実装や達成を支援するツールおよびフレームワークの例を示します。これらは、AISVSチームやOWASP GenAIセキュリティプロジェクトによる推奨や支持と見なすべきではありません。

---

### AE.1 トレーニングデータのガバナンスとバイアス管理

データ分析、ガバナンス、およびバイアスマネジメントに使用されるツール。

 #AE.1.1    セクション: 1.1
 データインベントリツール: 例えばデータインベントリ管理ツールのような...
 #AE.1.2    セクション: 1.2
 転送中の暗号化 HTTPSベースのアプリケーションにはTLSを使用し、openSSLやpythonのようなツールを利用します`ssl`ライブラリ。

---

### AE.2 ユーザー入力の検証

ユーザー入力を処理および検証するためのツール。

 #AE.2.1    セクション: 2.1
 プロンプトインジェクション防御ツール: NVIDIAのNeMoやGuardrails AIのようなガードレールツールを使用してください。

---


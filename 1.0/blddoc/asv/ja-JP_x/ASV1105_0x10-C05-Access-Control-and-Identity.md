# C5 AIコンポーネントおよびユーザー向けアクセス制御とアイデンティティ

## 制御目標

AIシステムの効果的なアクセス制御には、堅牢なアイデンティティ管理、コンテキスト認識の認可、およびゼロトラスト原則に基づく実行時の強制が必要です。これらの制御により、人間、サービス、自律エージェントは明示的に付与されたスコープ内のモデル、データ、および計算リソースとだけ相互作用でき、継続的な検証と監査機能が確保されます。

---

## C5.1 アイデンティティ管理と認証

特権操作のために多要素認証を用いて、すべてのエンティティに暗号学的に裏付けられた識別を確立する。

|   #   | 説明                                                                                                                                               | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.1.1 | すべての人間のユーザーとサービスプリンシパルが、OIDC/SAMLプロトコルを使用して一元化された企業のアイデンティティプロバイダー（IdP）を通じて認証され、ユニークなアイデンティティからトークンへのマッピングが行われていること（共有アカウントや資格情報がないこと）を検証してください。 |  1  | D/V |
| 5.1.2 | 高リスク操作（モデルのデプロイ、重みのエクスポート、トレーニングデータへのアクセス、本番環境の設定変更）には、多要素認証またはセッションの再検証を伴うステップアップ認証が必要であることを確認してください。                                           |  1  | D/V |
| 5.1.3 | 新しい管理者が本番システムアクセスを受ける前に、NIST 800-63-3 IAL-2 または同等の基準に準拠した身元確認（アイデンティティプルーフィング）を受けていることを確認してください。                                                 |  2  |  D  |
| 5.1.4 | アクセスレビューが四半期ごとに実施されていること、および自動的な休眠アカウント検出、認証情報のローテーション強制、そしてプロビジョニング解除ワークフローが行われていることを検証してください。                                                  |  2  |  V  |
| 5.1.5 | フェデレーテッドAIエージェントが、最大有効期間24時間の署名付きJWTアサーションを介して認証され、かつ起源を証明する暗号的証明を含むことを検証してください。                                                                 |  3  | D/V |

---

## C5.2 リソース承認と最小権限

すべてのAIリソースに対して、明示的な許可モデルと監査トレイルを備えたきめ細かいアクセス制御を実装してください。

|   #   | 説明                                                                                                                            | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | すべてのAIリソース（データセット、モデル、エンドポイント、ベクターコレクション、埋め込みインデックス、コンピュートインスタンス）が、明示的な許可リストおよびデフォルト拒否ポリシーを用いたロールベースアクセス制御を適用していることを検証してください。 |  1  | D/V |
| 5.2.2 | サービスアカウントに対して、最小権限の原則がデフォルトで適用され、読み取り専用の権限から開始されることと、書き込み権限には文書化された業務上の正当な理由が必要であることを確認してください。                                |  1  | D/V |
| 5.2.3 | すべてのアクセス制御の変更が、承認された変更要求に関連付けられており、タイムスタンプ、実行者の識別情報、リソース識別子、権限の差分とともに不変に記録されていることを検証してください。                                   |  1  |  V  |
| 5.2.4 | データ分類ラベル（PII、PHI、輸出管理対象、所有権保持）が派生リソース（埋め込み、プロンプトキャッシュ、モデル出力）に自動的に伝達され、一貫したポリシー適用がなされていることを検証してください。                           |  2  |  D  |
| 5.2.5 | 不正アクセスの試行および権限昇格イベントが、5分以内にコンテキストメタデータとともにSIEMシステムにリアルタイムアラートを生成することを確認してください。                                                |  2  | D/V |

---

## C5.3 動的ポリシー評価

コンテキストに基づく認可判断と監査機能を備えた属性ベースのアクセス制御（ABAC）エンジンを展開します。

|   #   | 説明                                                                                                | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | 認証されたAPIを介してアクセス可能で、暗号的整合性保護が施された専用のポリシーエンジン（OPA、Cedar、または同等のもの）に権限決定が外部化されていることを検証してください。        |  1  | D/V |
| 5.3.2 | ポリシーが動的属性をランタイムで評価することを確認してください。これには、ユーザーのクリアランスレベル、リソースの機密分類、リクエストコンテキスト、テナントの分離、および時間的制約が含まれます。 |  1  | D/V |
| 5.3.3 | ポリシー定義がバージョン管理され、ピアレビューされ、CI/CDパイプラインでの自動テストを通じて検証されてから本番環境に展開されることを確認してください。                     |  2  |  D  |
| 5.3.4 | ポリシー評価結果に構造化された意思決定の根拠が含まれていることを確認し、それらが相関分析およびコンプライアンス報告のためにSIEMシステムに送信されていることを検証してください。         |  2  |  V  |
| 5.3.5 | 高感度リソースに対してはポリシーキャッシュの有効期限（TTL）値が5分を超えないこと、標準リソースに対してはキャッシュ無効化機能付きで1時間を超えないことを確認してください。           |  3  | D/V |

---

## C5.4 クエリ時のセキュリティ強制

必須のフィルタリングおよび行レベルのセキュリティポリシーを使用して、データベース層のセキュリティ制御を実装します。

|   #   | 説明                                                                                                                     | レベル | 役割  |
| :---: | ---------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | すべてのベクターデータベースおよびSQLクエリに必須のセキュリティフィルター（テナントID、機微ラベル、ユーザースコープ）が含まれ、これらがアプリケーションコードではなくデータベースエンジンレベルで強制されていることを検証してください。 |  1  | D/V |
| 5.4.2 | すべてのベクトルデータベース、検索インデックス、およびトレーニングデータセットに対して、ポリシー継承を伴う行レベルセキュリティ（RLS）ポリシーとフィールドレベルのマスキングが有効になっていることを確認してください。           |  1  | D/V |
| 5.4.3 | 失敗した認可評価が、「混乱した代理攻撃」を防ぐために、クエリを即座に中止し、空の結果セットを返すのではなく明示的な認可エラーコードを返すことを確認してください。                                       |  2  |  D  |
| 5.4.4 | ポリシー評価の遅延が継続的に監視されており、認可のバイパスを可能にするタイムアウト条件に対して自動アラートが設定されていることを確認してください。                                              |  2  |  V  |
| 5.4.5 | クエリの再試行メカニズムが、アクティブなユーザーセッション内での動的な権限変更を反映するために認可ポリシーを再評価することを検証してください。                                                |  3  | D/V |

---

## C5.5 出力フィルタリングおよびデータ漏えい防止

AI生成コンテンツにおける不正なデータ露出を防ぐために、後処理の制御を導入してください。

|   #   | 説明                                                                                          | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.5.1 | 推論後のフィルタリング機構が、リクエスト者にコンテンツを提供する前に、許可されていない個人識別情報（PII）、機密情報、および専有データをスキャンして削除することを確認してください。 |  1  | D/V |
| 5.5.2 | モデル出力内の引用文、参照、および情報源の帰属が呼び出し元の権限と照合され、無許可のアクセスが検出された場合は削除されることを検証してください。                    |  1  | D/V |
| 5.5.3 | ユーザーの権限レベルおよびデータ分類に基づいて、出力形式の制限（サニタイズされたPDF、メタデータが削除された画像、承認されたファイルタイプ）が適用されていることを検証してください。 |  2  |  D  |
| 5.5.4 | 検閲アルゴリズムが決定論的であり、バージョン管理されていて、コンプライアンス調査およびフォレンジック分析を支援するための監査ログを保持していることを確認してください。         |  2  |  V  |
| 5.5.5 | 高リスクの消去イベントが、データの露出を防ぎつつ、元のコンテンツの暗号ハッシュを含む適応ログを生成していることを検証してください。                           |  3  |  V  |

---

## C5.6 マルチテナントの分離

共有AIインフラストラクチャにおいてテナント間の暗号的および論理的な分離を確保する。

|   #   | 説明                                                                                                      | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.6.1 | メモリ空間、埋め込みストア、キャッシュエントリ、および一時ファイルが、テナントごとに名前空間で分離されていることを確認し、テナントの削除またはセッションの終了時には安全にパージされることを保証してください。 |  1  | D/V |
| 5.6.2 | すべてのAPIリクエストが、セッションコンテキストおよびユーザー権限に対して暗号的に検証された認証済みテナント識別子を含んでいることを確認してください。                            |  1  | D/V |
| 5.6.3 | ネットワークポリシーがサービスメッシュおよびコンテナオーケストレーションプラットフォーム内のテナント間通信に対してデフォルト拒否ルールを実装していることを検証してください。                  |  2  |  D  |
| 5.6.4 | テナントごとに一意の暗号鍵であることを、カスタマー管理キー（CMK）サポートおよびテナントのデータストア間の暗号的分離をもって検証してください。                                |  3  |  D  |

---

## C5.7 自律エージェントの認可

スコープ付き能力トークンと継続的な認可を通じて、AIエージェントおよび自律システムの制御権限を管理します。

|   #   | 説明                                                                                                          | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | 自律エージェントが、許可された操作、アクセス可能なリソース、時間の制限、運用上の制約を明示的に列挙したスコープ付きの能力トークンを受け取っていることを確認してください。                        |  1  | D/V |
| 5.7.2 | 高リスクな機能（ファイルシステムアクセス、コード実行、外部API呼び出し、金融取引）がデフォルトで無効になっていることを確認し、有効化にはビジネス上の正当な理由を伴う明示的な承認が必要であることを確認してください。 |  1  | D/V |
| 5.7.3 | 能力トークンがユーザーセッションに紐付けられていることを確認し、暗号的整合性保護が含まれていること、またオフラインの状況で永続化または再利用できないことを保証してください。                      |  2  |  D  |
| 5.7.4 | エージェントが開始したアクションが、完全なコンテキスト評価および監査ログを伴うABACポリシーエンジンによる二次承認を受けることを検証してください。                                  |  2  |  V  |
| 5.7.5 | エージェントのエラー条件および例外処理に、インシデント分析およびフォレンジック調査をサポートするための能力範囲情報が含まれていることを確認してください。                                |  3  |  V  |

---

## 参考文献

### 標準とフレームワーク

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### 実装ガイド

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### AI特有のセキュリティ

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


# C5 AI コンポーネントおよびユーザーのアクセス制御とアイデンティティ

## 統制目標

AIシステムにおける効果的なアクセス制御には、堅牢なアイデンティティ管理、文脈認識型認可、そしてゼロトラスト原則に沿った実行時適用が必要です。これらの制御は、人間、サービス、そして自律エージェントが、明示的に許可されたスコープ内でのみモデル、データ、計算資源と相互作用できるようにし、継続的な検証と監査機能を提供します。

---

## C5.1 アイデンティティ管理 & 認証

すべての主体に対して、暗号技術によって裏付けられたアイデンティティを確立し、特権操作には多要素認証を適用する。

|   #   | 説明                                                                                                                                 | レベル | 役割  |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.1.1 | すべての人間のユーザーとサービスプリンシパルが、集中化された企業アイデンティティプロバイダ（IdP）を介してOIDC/SAMLプロトコルを用いて認証し、一意のアイデンティティとトークンの対応づけを確保することを検証する（共有アカウントや認証情報の共有は不可）。 |  1  | D/V |
| 5.1.2 | 高リスク操作（モデルのデプロイ、重みのエクスポート、トレーニングデータへのアクセス、本番環境の構成変更）が、マルチファクター認証またはセッション再認証を伴うステップアップ認証を必要とすることを検証する。                              |  1  | D/V |
| 5.1.3 | 新規プリンシパルが、NIST 800-63-3 IAL-2または同等の基準に沿った身元確認を受けることを、本番システムへのアクセスを取得する前に確認する。                                                      |  2  |  D  |
| 5.1.4 | アクセスレビューが四半期ごとに実施され、休眠アカウントの自動検出、資格情報ローテーションの強制、デプロビジョニング ワークフローの実行を確認します。                                                         |  2  |  V  |
| 5.1.5 | フェデレーテッドAIエージェントが、署名済みJWTアサーションを介して認証され、最大有効期限が24時間で、起源を示す暗号学的証拠を含むことを検証する。                                                        |  3  | D/V |

---

## C5.2 リソース認可と最小権限

すべてのAIリソースに対して、明示的な権限モデルと監査証跡を備えた細粒度のアクセス制御を実装する。

|   #   | 説明                                                                                                                      | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.2.1 | すべてのAIリソース（データセット、モデル、エンドポイント、ベクトルコレクション、埋め込みインデックス、計算インスタンス）が、明示的な許可リストとデフォルト拒否ポリシーを備えたロールベースアクセス制御を適用していることを検証してください。 |  1  | D/V |
| 5.2.2 | デフォルトで最小権限の原則が適用されていることを検証し、サービスアカウントは読み取り専用権限から開始し、書き込みアクセスには文書化されたビジネス上の正当性が必要であることを確認する。                             |  1  | D/V |
| 5.2.3 | すべてのアクセス制御の変更が承認済みの変更要求に紐づけられ、タイムスタンプ、実行者の識別情報、リソース識別子、および権限の差分を含む不変なログとして記録されていることを検証してください。                           |  1  |  V  |
| 5.2.4 | データ分類ラベル（PII、PHI、輸出規制対象、企業機密）が、派生リソース（埋め込み表現、プロンプトキャッシュ、モデル出力）へ自動的に伝搬し、一貫したポリシーの適用が行われることを検証する。                         |  2  |  D  |
| 5.2.5 | 不正アクセスの試行および権限昇格イベントが、文脈情報を含むメタデータを付与したリアルタイムアラートとしてSIEMシステムへ5分以内に通知されることを検証する。                                         |  2  | D/V |

---

## C5.3 動的ポリシー評価

コンテキスト認識に基づく認可決定のための属性ベースのアクセス制御（ABAC）エンジンを展開し、監査機能を備える。

|   #   | 説明                                                                                            | レベル | 役割  |
| :---: | --------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.3.1 | 認可決定が専用のポリシーエンジン（OPA、Cedar、または同等のもの）に外部化され、認証済みの API を介してアクセス可能で、暗号技術による整合性保護が提供されていることを検証する。 |  1  | D/V |
| 5.3.2 | ポリシーが実行時に動的属性を評価することを検証します。これには、ユーザーのクリアランスレベル、リソースの機密性分類、リクエストコンテキスト、テナント分離、時間的制約を含みます。      |  1  | D/V |
| 5.3.3 | ポリシー定義がバージョン管理され、査読済みで、CI/CDパイプラインでの自動テストを通じて検証されることを、本番環境へのデプロイ前に確認する。                       |  2  |  D  |
| 5.3.4 | ポリシー評価結果に構造化された意思決定根拠が含まれていることを検証し、それらが相関分析およびコンプライアンス報告のために SIEM システムへ送信されることを確認する。          |  2  |  V  |
| 5.3.5 | キャッシュの無効化機能を備えたリソースについて、ポリシーキャッシュの TTL 値が機密性の高いリソースでは最大 5 分、標準リソースでは最大 1 時間を超えないことを検証してください。  |  3  | D/V |

---

## C5.4 クエリ-時のセキュリティ適用

データベース層のセキュリティ制御を実装し、強制的なフィルタリングと行レベルのセキュリティポリシーを適用する。

|   #   | 説明                                                                                                                  | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.4.1 | すべてのベクトルデータベースおよび SQL クエリに、テナントID、機密性ラベル、ユーザー範囲といった必須のセキュリティフィルターが、アプリケーションコードではなくデータベースエンジンレベルで強制されていることを検証してください。 |  1  | D/V |
| 5.4.2 | すべてのベクトルデータベース、検索インデックス、およびトレーニングデータセットについて、ポリシー継承を有効にし、行レベルのセキュリティ（RLS）ポリシーおよびフィールドレベルのマスキングが有効になっていることを検証します。     |  1  | D/V |
| 5.4.3 | 認可評価の失敗が、クエリを直ちに中止し、空の結果セットを返すのではなく、明示的な認可エラーコードを返すことによって、「混同した代理人攻撃」を防ぐことを検証する。                                    |  2  |  D  |
| 5.4.4 | ポリシー評価のレイテンシが継続的に監視され、認可回避を引き起こす可能性のあるタイムアウト条件に対して自動アラートが発されていることを確認する。                                             |  2  |  V  |
| 5.4.5 | クエリ再試行メカニズムが、アクティブなユーザー セッション内の動的な権限変更を考慮して、認可ポリシーを再評価することを検証する。                                                    |  3  | D/V |

---

## C5.5 出力フィルタリングとデータ損失防止

AI生成コンテンツにおける不正なデータ露出を防ぐための事後処理制御を展開する。

|   #   | 説明                                                                                           | レベル | 役割  |
| :---: | -------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.5.1 | 推論後のフィルタリング機構が、要求者へコンテンツを提供する前に、許可されていないPII（個人を特定できる情報）、機密情報、および企業秘密データをスキャンして伏せ字にすることを検証する。 |  1  | D/V |
| 5.5.2 | モデル出力における引用・参照・出典の帰属情報が、呼び出し元の権限と照合して検証され、不正アクセスが検出された場合には削除されることを確認する。                      |  1  | D/V |
| 5.5.3 | 出力形式の制限（サニタイズされたPDFファイル、メタデータを削除した画像、承認済みファイルタイプ）が、ユーザーの権限レベルとデータ分類に基づいて適用されていることを検証する。      |  2  |  D  |
| 5.5.4 | 伏字化アルゴリズムが決定論的で、バージョン管理されており、監査ログを保持して、コンプライアンス調査および法医学的分析を支援することを確認してください。                  |  2  |  V  |
| 5.5.5 | 高リスクの秘匿化イベントがデータ露出を伴わずに、元の内容の暗号学的ハッシュ値を含む適応型ログを生成することを検証する。                                  |  3  |  V  |

---

## C5.6 マルチテナント分離

共有AIインフラストラクチャにおけるテナント間の暗号的および論理的隔離を確保する。

|   #   | 説明                                                                                         | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------ | :-: | :-: |
| 5.6.1 | メモリ空間、埋め込みストア、キャッシュエントリ、および一時ファイルが、テナントごとにネームスペースで分離され、テナントの削除またはセッション終了時に安全に消去されることを検証する。 |  1  | D/V |
| 5.6.2 | すべての API リクエストに、認証済みのテナント識別子が含まれており、それがセッションコンテキストおよびユーザーの権限情報に対して暗号学的に検証されることを確認してください。   |  1  | D/V |
| 5.6.3 | サービスメッシュ内およびコンテナオーケストレーションプラットフォーム内で、ネットワークポリシーがテナント間通信に対してデフォルト拒否ルールを実装していることを検証してください。   |  2  |  D  |
| 5.6.4 | テナントごとに暗号鍵が一意であることを確認し、顧客管理キー（CMK）をサポートし、テナントデータストア間の暗号学的分離を確保する。                          |  3  |  D  |

---

## C5.7 自律エージェントの認可

スコープ付き能力トークンと継続的認可を通じて、AIエージェントと自律システムの権限を制御する。

|   #   | 説明                                                                                                      | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 5.7.1 | 自律エージェントが、許可された操作、アクセス可能なリソース、時間的境界、および運用上の制約を明示的に列挙するスコープ付き能力トークンを受け取ることを検証する。                         |  1  | D/V |
| 5.7.2 | 高リスク機能（ファイルシステムアクセス、コード実行、外部API呼び出し、金融取引）がデフォルトで無効になっていることを検証し、有効化にはビジネス上の正当な理由を添えた明示的な承認が必要であることを確認する。 |  1  | D/V |
| 5.7.3 | 能力トークンがユーザーセッションに紐付けられていることを検証し、暗号的整合性保護を含め、オフライン環境で永続化または再利用されないことを保証してください。                           |  2  |  D  |
| 5.7.4 | エージェント起動アクションが ABAC ポリシーエンジンを介して完全なコンテキスト評価と監査ログを伴う二次認可を受けることを検証します。                                    |  2  |  V  |
| 5.7.5 | エージェントのエラー条件および例外処理に、インシデント分析とフォレンジック調査を支援するための能力の範囲情報を含めることを確認してください。                                  |  3  |  V  |

---

## 参考文献

### 標準とフレームワーク

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### 実装ガイド

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### AI-特化セキュリティ

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


# C3 モデルライフサイクル管理と変更管理

## 統制目標

AIシステムは、本番環境へ到達する不正または不安全なモデル変更を防ぐ変更管理プロセスを実装しなければならない--この統制は、開発から展開、廃止までのライフサイクル全体を通じてモデルの完全性を保証し、迅速なインシデント対応を可能にし、すべての変更に対する説明責任を維持する。

コアセキュリティ目標: 本番環境へデプロイされるのは、承認済み・検証済みのモデルのみとし、それを実現するのは、完全性・追跡性・回復性を維持する制御されたプロセスを用いることである。

---

## C3.1 モデルの認可と完全性

検証済みの完全性を備えた認可済みモデルのみが本番環境に到達する。

|   #   | 説明                                                                                                    | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------------- | :-: | :-: |
| 3.1.1 | デプロイ前に、すべてのモデルアーティファクト（重み、設定、トークナイザ）が認可されたエンティティによって暗号署名されていることを検証してください。                             |  1  | D/V |
| 3.1.2 | デプロイ時にモデルの完全性が検証されることを確認し、署名検証の失敗がモデルの読み込みを妨げることを保証する。                                                |  1  | D/V |
| 3.1.3 | モデル由来情報の記録が、承認主体の身元、学習データのハッシュ値、検証テスト結果（合否ステータス付き）、および作成タイムスタンプを含むことを確認する。                            |  2  | D/V |
| 3.1.4 | すべてのモデルアーティファクトがセマンティック・バージョニング（MAJOR.MINOR.PATCH）を使用していることを、各バージョン成分がいつ増分されるかを規定した文書化された基準とともに検証します。 |  2  | D/V |
| 3.1.5 | 依存関係の追跡が、すべての消費システムを迅速に特定できるリアルタイム在庫情報を維持していることを検証する。                                                 |  2  |  V  |

---

## C3.2 モデル検証 & テスト

モデルは、デプロイ前に定義されたセキュリティおよび安全性の検証を必ず通過する必要があります。

|   #   | 説明                                                                                         | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------ | :-: | :-: |
| 3.2.1 | デプロイ前に、モデルが入力検証、出力のサニタイズ、及び安全性評価を含む自動化されたセキュリティテストを受け、事前に合意された組織の合格/不合格閾値を満たすことを確認する。      |  1  | D/V |
| 3.2.2 | 検証の失敗が、事前に指定された承認権を有する担当者による明示的なオーバーライド承認の後、文書化されたビジネス上の正当化を伴って自動的にモデルのデプロイをブロックすることを確認する。 |  1  | D/V |
| 3.2.3 | テスト結果が暗号署名され、検証対象の特定モデルバージョンのハッシュに不変に結びついていることを確認する。                                       |  2  |  V  |
| 3.2.4 | 緊急展開には、文書化されたセキュリティリスク評価と、事前に指定されたセキュリティ当局からの承認が、事前に合意された時間枠内で求められることを検証する。                |  2  | D/V |

---

## C3.3 制御されたデプロイメントとロールバック

モデルのデプロイは、制御され、監視され、元に戻せる必要がある。

|   #   | 説明                                                                                                                             | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 3.3.1 | 本番環境へのデプロイが段階的なロールアウト機構（カナリアリリース、ブルーグリーンデプロイメント）を実装し、事前に合意されたエラー率、レイテンシ閾値、またはセキュリティアラート基準に基づいて自動ロールバックをトリガーする条件を満たしていることを検証する。 |  1  |  D  |
| 3.3.2 | ロールバック機能が、モデルの完全な状態（重み、設定、依存関係）を原子性を保って復元し、事前に定義された組織の時間枠内で実行されることを検証する。                                                       |  1  | D/V |
| 3.3.3 | デプロイメントプロセスがデジタル署名を検証し、モデルを起動する前に整合性チェックサムを計算することを確認し、いずれかの不一致がある場合はデプロイを失敗させる。                                                |  2  | D/V |
| 3.3.4 | 緊急時のモデルシャットダウン機能が、事前に定義された応答時間内に自動サーキットブレーカーまたは手動キルスイッチを介してモデルエンドポイントを無効化できることを検証する。                                           |  2  | D/V |
| 3.3.5 | 組織のポリシーに従い、ロールバック成果物（以前のモデルバージョン、設定、依存関係）がインシデント対応のための不変ストレージに保持されていることを検証する。                                                  |  2  |  V  |

---

## C3.4 変更の説明責任および監査

すべてのモデルのライフサイクル変更は追跡可能で監査可能でなければならない。

|   #   | 説明                                                                                              | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------- | :-: | :-: |
| 3.4.1 | すべてのモデル変更（デプロイ、設定、運用終了）について、タイムスタンプ、認証済み実行者ID、変更タイプ、前後の状態を含む不変の監査記録を生成することを検証してください。            |  1  |  V  |
| 3.4.2 | 監査ログへのアクセスが適切な認可を要することを検証し、すべてのアクセス試行がユーザーIDとタイムスタンプを記録していることを確認してください。                         |  2  | D/V |
| 3.4.3 | デプロイ前に、指定されたレビュアーによる必須のコードレビューと承認を受けた上で、Gitリポジトリにおけるプロンプトテンプレートとシステムメッセージがバージョン管理されていることを検証する。  |  2  | D/V |
| 3.4.4 | 保持期間内の任意のタイムスタンプに対して、モデル状態を完全に再構築できるよう、監査記録に十分な詳細（モデルハッシュ、設定スナップショット、依存関係のバージョン）が含まれていることを検証する。 |  2  |  V  |

---

## C3.5 セキュア開発の実践

モデルの開発と訓練プロセスは、侵害を防ぐために安全な実践に従う必要があります。

|   #   | 説明                                                                                                   | レベル | 役割  |
| :---: | ---------------------------------------------------------------------------------------------------- | :-: | :-: |
| 3.5.1 | モデル開発環境、テスト環境、本番環境が物理的または論理的に分離されていることを確認してください。これらは共有インフラストラクチャを持たず、個別のアクセス制御が適用され、データストアが分離されています。 |  1  |  D  |
| 3.5.2 | モデルのトレーニングとファインチューニングが、ネットワークアクセスが制御された隔離環境で実行されることを検証する。                                            |  1  |  D  |
| 3.5.3 | モデル開発に使用する前に、トレーニングデータのソースが整合性検査で検証され、信頼できるソースを介して認証され、文書化されたチェーン・オブ・カストディを伴っていることを確認する。             |  1  | D/V |
| 3.5.4 | モデル開発成果物（ハイパーパラメータ、トレーニングスクリプト、設定ファイル）がバージョン管理に保存されており、トレーニングに使用する前にピアレビュー承認を必要とすることを確認する。           |  2  |  D  |

---

## C3.6 モデルの退役 & デコミッショニング

モデルは、もはや必要がなくなった場合、またはセキュリティ上の問題が特定された場合には、安全に退役させるべきです。

|   #   | 説明                                                                                               | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------ | :-: | :-: |
| 3.6.1 | モデルの退役プロセスが依存関係グラフを自動的にスキャンし、モデルの出力を利用するすべてのシステムを特定し、廃止前に事前合意された通知期間を提供することを検証する。                |  1  |  D  |
| 3.6.2 | 退役済みモデルのアーティファクトが、文書化されたデータ保持ポリシーに従って、暗号化消去またはマルチパス上書きによって安全に消去されることを検証し、検証済みの破棄証明書を添付する。        |  1  | D/V |
| 3.6.3 | モデルのリタイアイベントが、タイムスタンプと実行者の識別情報を伴ってログに記録されることを確認し、再利用を防ぐためにモデル署名を失効させる。                           |  2  |  V  |
| 3.6.4 | 重大なセキュリティ脆弱性が発見された場合には、事前に設定された緊急対応時間枠内で、緊急時のモデル退役がモデルへのアクセスを自動的に無効化できることを、自動化されたキルスイッチを介して検証する。 |  2  | D/V |

---

## 参考文献

* [MLOps Principles](https://ml-ops.org/content/mlops-principles)
* [Securing AI/ML Ops – Cisco.com](https://sec.cloudapps.cisco.com/security/center/resources/SecuringAIMLOps)
* [Audit logs security: cryptographically signed tamper-proof logs](https://www.cossacklabs.com/blog/audit-logs-security/)
* [Machine Learning Model Versioning: Top Tools & Best Practices](https://lakefs.io/blog/model-versioning/)
* [AI Hygiene Starts with Models and Data Loaders – SEI Blog](https://insights.sei.cmu.edu/documents/6190/AI-Hygiene-Starts-with-Models-and-Data-Loaders_1G0KTRh.pdf)
* [How to handle versioning and rollback of a deployed ML model?](https://learn.microsoft.com/en-au/answers/questions/1845378/how-to-handle-versioning-and-rollback-of-a-deploye)
* [Reinforcement fine-tuning – OpenAI API](https://platform.openai.com/docs/guides/reinforcement-fine-tuning)
* [Auditing Machine Learning models: Governance, Data Security and …](https://www.linkedin.com/pulse/auditing-machine-learning-models-governance-data-security-negrete-yn81f)
* [Adversarial Training to Improve Model Robustness](https://medium.com/%40amit25173/adversarial-training-to-improve-model-robustness-5e285b516713)
* [What is AI adversarial robustness? – IBM Research](https://research.ibm.com/blog/securing-ai-workflows-with-adversarial-robustness)
* [Exploring Data Provenance: Ensuring Data Integrity and Authenticity](https://www.astera.com/type/blog/data-provenance/)
* [MITRE ATLAS](https://atlas.mitre.org/)
* [AWS Prescriptive Guidance – Best practices for retiring applications …](https://docs.aws.amazon.com/pdfs/prescriptive-guidance/latest/migration-app-retirement-best-practices/migration-app-retirement-best-practices.pdf)


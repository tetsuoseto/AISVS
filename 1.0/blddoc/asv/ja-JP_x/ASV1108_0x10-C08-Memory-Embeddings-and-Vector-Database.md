# C8 Memory, 埋め込み表現とベクトルデータベースのセキュリティ

## 統制目標

埋め込みとベクトルストアは、現代のAIシステムの「ライブメモリ」として機能し、絶えずユーザーが提供したデータを受け取り、Retrieval-Augmented Generation（RAG）を介してモデルのコンテキストへ再提示します。統制されていないまま放置すると、このメモリはPIIを漏えいさせたり、同意を侵害したり、元のテキストを再構築するために反転される可能性があります。本統制ファミリーの目的は、メモリパイプラインとベクトルデータベースを堅牢化し、アクセスを最小権限に限定し、埋め込みをプライバシー保護型にし、保存されたベクトルを有効期限切れにするか、必要に応じて取り消し可能にし、個々のユーザーのメモリが別のユーザーのプロンプトや生成結果を汚染しないようにすることです。

---

## C8.1 メモリ & RAG 指標へのアクセス制御

すべてのベクトルコレクションに細粒度のアクセス制御を適用する。

|   #   | 説明                                                                                           | レベル | 役割  |
| :---: | -------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.1.1 | テナント、コレクション、またはドキュメントタグごとに、挿入、削除、およびクエリ操作を制限する行/名前空間-レベルのアクセス制御ルールを検証する。                     |  1  | D/V |
| 8.1.2 | APIキーまたはJWTには、コレクションIDやアクション動詞などのスコープ付きクレームが含まれていることを検証し、それらが少なくとも四半期ごとにローテーションされていることを確認する。 |  1  | D/V |
| 8.1.3 | 権限昇格の試行（例：異なるネームスペース間の類似性クエリ）が検出され、5分以内にSIEMへ記録されることを検証する。                                   |  2  | D/V |
| 8.1.4 | ベクトルDBの監査ログが、主体識別子、操作、ベクトルID/ネームスペース、類似度閾値、および結果件数を記録していることを確認してください。                        |  2  | D/V |
| 8.1.5 | エンジンがアップグレードされるたび、または index-sharding ルールが変更される場合には、アクセス決定がバイパス脆弱性に対して検証されていることを確認してください。     |  3  |  V  |

---

## C8.2 埋め込みのサニタイズ & 検証

PII（個人を特定できる情報）を事前にスクリーニングし、ベクトル化の前に伏字化／偽名化を行い、必要に応じて埋め込みベクトルを後処理して残留信号を除去する。

|   #   | 説明                                                                                                  | レベル | 役割  |
| :---: | --------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.2.1 | PIIおよび規制対象データを自動分類器で検出し、埋め込み前にマスク、トークン化、または削除します。                                                   |  1  | D/V |
| 8.2.2 | 埋め込みパイプラインが、インデックスを汚染する可能性のある実行可能なコードを含む入力や、非UTF-8アーティファクトを含む入力を拒否または検疫することを検証する。                   |  1  |  D  |
| 8.2.3 | 文埋め込み表現に対して、既知のPIIトークンのいずれかとの距離が設定可能な閾値を下回る場合に、局所差分プライバシー保護またはメトリック差分プライバシー保護のサニタイズが適用されていることを検証する。 |  2  | D/V |
| 8.2.4 | サニタイズの有効性（例：PIIのマスキングの再現率、意味的ドリフト）が少なくとも半年ごとにベンチマークコーパスに対して検証されていることを確認する。                          |  2  |  V  |
| 8.2.5 | サニタイズ設定がバージョン管理されており、変更がピアレビューを受けていることを確認してください。                                                    |  3  | D/V |

---

## C8.3 メモリの有効期限、取り消し、削除

GDPR（一般データ保護規則）の「忘れられる権利」および同様の法は適時の削除を要求します。したがって、ベクトルストアはTTL（Time To Live）をはじめ、ハードデリート、そして墓標-化をサポートし、撤回されたベクトルが回復できず、再インデックス化されることを防ぐ必要があります。

|   #   | 説明                                                                              | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------- | :-: | :-: |
| 8.3.1 | すべてのベクトルとメタデータレコードが、TTLまたは自動クリーンアップジョブによって遵守される明示的な保持ラベルを携えていることを検証する。          |  1  | D/V |
| 8.3.2 | ユーザーが開始した削除リクエストが、ベクトル、メタデータ、キャッシュコピー、派生インデックスを30日以内に消去することを検証する。               |  1  | D/V |
| 8.3.3 | 論理削除の後、ハードウェアが対応していればストレージブロックの暗号的シュレッディングを行い、そうでなければ Key Vault の鍵を破棄することを検証する。 |  2  |  D  |
| 8.3.4 | 有効期限切れのベクトルが、有効期限切れから 500 ms 未満の時間内に最近傍探索の結果から除外されることを検証する。                     |  3  | D/V |

---

## C8.4 埋め込みの反転と漏洩を防止

最近の防御策—ノイズの重畳、プロジェクションネットワーク、プライバシー-ニューロン摂動、そしてアプリケーション-層の暗号化—は、トークン-レベルの復元率を5%以下に抑えることができる。

|   #   | 説明                                                                                        | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------- | :-: | :-: |
| 8.4.1 | 公式な脅威モデルが、逆推定攻撃、メンバーシップ推定攻撃、属性推定攻撃を含むものであり、毎年見直されていることを確認する。                              |  1  |  V  |
| 8.4.2 | アプリケーション層の暗号化または検索可能暗号化が、インフラストラクチャの管理者またはクラウド担当者による直接的な読み取りからベクトルを保護していることを検証してください。     |  2  | D/V |
| 8.4.3 | 防御パラメータ（DP の ε、ノイズ σ、射影階数 k）が、プライバシーを 99 % 以上、トークン保護を維持し、有用性を 3 % 以下の精度低下でバランスさせることを検証する。 |  3  |  V  |
| 8.4.4 | モデル更新のリリースゲートの一部として、インバージョン耐性指標が含まれていることを検証し、回帰予算を定義する。                                   |  3  | D/V |

---

## C8.5 ユーザー固有メモリのスコープ適用

テナント間の情報流出は依然として RAG の最大級のリスクです：適切にフィルタリングされていない類似クエリは、他の顧客の機密文書を露出させる可能性があります。

|   #   | 説明                                                                           | レベル | 役割  |
| :---: | ---------------------------------------------------------------------------- | :-: | :-: |
| 8.5.1 | すべての検索クエリが、LLMプロンプトへ渡される前に、テナントIDおよびユーザーIDで事後フィルタリングされていることを検証する。            |  1  | D/V |
| 8.5.2 | コレクション名またはネームスペース付きIDが、ユーザーまたはテナントごとにソルトされていることを検証し、スコープ間でベクトルが衝突しないようにします。  |  1  |  D  |
| 8.5.3 | 呼び出し元の範囲外かつ設定可能な距離閾値を超える類似性結果は破棄され、セキュリティ警告を発することを検証する。                      |  2  | D/V |
| 8.5.4 | マルチテナント環境におけるストレステストが、範囲外のドキュメントを取得しようとする敵対的なクエリをシミュレートし、情報漏洩ゼロを実証することを検証する。 |  2  |  V  |
| 8.5.5 | 暗号鍵がテナントごとに分離されていることを検証し、物理的なストレージが共有されていても暗号学的分離を保証します。                     |  3  | D/V |

---

## C8.6 高度な メモリシステム の セキュリティ

エピソード記憶、意味記憶、作業記憶を含む高度なメモリアーキテクチャに対する、特定の隔離および検証要件を備えたセキュリティコントロール。

|   #   | 説明                                                                                                              | レベル | 役割  |
| :---: | --------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 8.6.1 | 異なるメモリタイプ（エピソード記憶、意味記憶、作業記憶）が、ロールベースのアクセス制御、別個の暗号化鍵、各メモリタイプに対する文書化されたアクセスパターンとともに、隔離されたセキュリティコンテキストを有することを検証する。 |  1  | D/V |
| 8.6.2 | メモリ統合プロセスには、保存前にコンテンツのサニタイズ、出所検証、整合性チェックを通じて、悪意のあるメモリの注入を防ぐセキュリティ検証が含まれていることを確認してください。                          |  2  | D/V |
| 8.6.3 | 不正な情報の抽出を防ぐために、クエリパターン分析、アクセス制御の適用、そして結果のフィルタリングを通じて、メモリ取得クエリが検証され、サニタイズされることを確認する。                             |  2  | D/V |
| 8.6.4 | メモリ消去機構が、鍵削除、複数回の上書き、または検証証明書付きのハードウェアベースのセキュア削除を用いて、機微情報を安全に削除する暗号学的消去保証を満たすことを検証する。                           |  3  | D/V |
| 8.6.5 | メモリシステムの整合性が、許可されていない変更または破損を検出するため、チェックサム、監査ログ、およびメモリ内容が通常の操作範囲外に変更された場合の自動通知を通じて継続的に監視されていることを検証します。          |  3  | D/V |

---

## 参考文献

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)


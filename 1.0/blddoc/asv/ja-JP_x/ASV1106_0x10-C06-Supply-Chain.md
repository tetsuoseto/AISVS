# モデル、フレームワーク、およびデータのためのC6サプライチェーンセキュリティ

## 制御目標

AIのサプライチェーン攻撃は、サードパーティのモデル、フレームワーク、またはデータセットを悪用してバックドア、バイアス、または悪用可能なコードを組み込むことを狙います。これらのコントロールは、モデルのライフサイクル全体を保護するために、エンドツーエンドの出所管理、脆弱性管理、および監視を提供します。

---

## C6.1 事前学習済みモデルの検証と出所確認

微調整や展開の前に、サードパーティモデルの起源、ライセンス、および隠れた挙動を評価し、認証してください。

|   #   | 説明                                                                               | レベル | 役割  |
| :---: | -------------------------------------------------------------------------------- | :-: | :-: |
| 6.1.1 | すべてのサードパーティモデルアーティファクトに、ソースリポジトリとコミットハッシュを特定する署名付きのプロビナンスレコードが含まれていることを確認してください。 |  1  | D/V |
| 6.1.2 | モデルがインポートされる前に、自動化ツールを使用して悪意のあるレイヤーやトロイの木馬トリガーがスキャンされていることを確認してください。             |  1  | D/V |
| 6.1.3 | 転移学習によるファインチューニングが、隠れた挙動を検出するための敵対的評価に合格することを検証してください。                           |  2  |  D  |
| 6.1.4 | モデルライセンス、輸出管理タグ、およびデータ出所の声明がML-BOMエントリに記録されていることを確認してください。                       |  2  |  V  |
| 6.1.5 | ハイリスクモデル（公開アップロードされた重み、未検証の作成者）が、人間によるレビューと承認が行われるまで検疫状態のままであることを確認してください。       |  3  | D/V |

---

## C6.2 フレームワーク＆ライブラリスキャン

機械学習フレームワークとライブラリを継続的にスキャンし、CVEや悪意のあるコードを検出してランタイムスタックのセキュリティを維持します。

|   #   | 説明                                                                   | レベル | 役割  |
| :---: | -------------------------------------------------------------------- | :-: | :-: |
| 6.2.1 | CIパイプラインがAIフレームワークおよび重要なライブラリに対して依存関係スキャナーを実行していることを確認してください。        |  1  | D/V |
| 6.2.2 | 重要な脆弱性（CVSS ≥ 7.0）がある場合、生産用イメージへの昇格をブロックすることを確認してください。               |  1  | D/V |
| 6.2.3 | フォークまたはベンダー化されたMLライブラリで静的コード分析が実行されていることを確認してください。                   |  2  |  D  |
| 6.2.4 | フレームワークのアップグレード提案には、公開されているCVEフィードを参照したセキュリティ影響評価が含まれていることを確認してください。 |  2  |  V  |
| 6.2.5 | 署名されたSBOMから逸脱する予期しない動的ライブラリのロードに対してランタイムセンサーが警告することを検証してください。        |  3  |  V  |

---

## C6.3 依存関係のピニングと検証

すべての依存関係を不変のダイジェストに固定し、ビルドを再現して同一で改ざんされていないアーティファクトを保証します。

|   #   | 説明                                                          | レベル | 役割  |
| :---: | ----------------------------------------------------------- | :-: | :-: |
| 6.3.1 | すべてのパッケージマネージャがロックファイルを通じてバージョンの固定を強制していることを確認してください。       |  1  | D/V |
| 6.3.2 | コンテナ参照において、可変タグの代わりに不変のダイジェストが使用されていることを確認してください。           |  1  | D/V |
| 6.3.3 | 再現可能ビルドのチェックがCI実行間でハッシュを比較し、同一の出力を保証していることを検証する。            |  2  |  D  |
| 6.3.4 | 監査の追跡可能性のために、ビルド証明書が18か月間保存されていることを確認してください。                |  2  |  V  |
| 6.3.5 | 期限切れの依存関係が自動プルリクエストをトリガーして、更新または固定バージョンのフォークを行うことを確認してください。 |  3  |  D  |

---

## C6.4 信頼されたソースの強制

暗号学的に検証され、組織が承認したソースからのみアーティファクトのダウンロードを許可し、それ以外はすべてブロックします。

|   #   | 説明                                                                         | レベル | 役割  |
| :---: | -------------------------------------------------------------------------- | :-: | :-: |
| 6.4.1 | モデルの重み、データセット、およびコンテナが承認されたドメインまたは内部レジストリからのみダウンロードされることを確認してください。         |  1  | D/V |
| 6.4.2 | Sigstore/Cosignの署名がアーティファクトをローカルにキャッシュする前にパブリッシャーの識別を検証することを確認してください。      |  1  | D/V |
| 6.4.3 | 信頼されたソースポリシーを強制するために、イグレスプロキシが認証されていないアーティファクトのダウンロードをブロックしていることを確認してください。 |  2  |  D  |
| 6.4.4 | リポジトリの許可リストが四半期ごとにレビューされており、各エントリに対するビジネス上の正当性の証拠があることを確認してください。           |  2  |  V  |
| 6.4.5 | ポリシー違反がアーティファクトの隔離および依存するパイプライン実行のロールバックをトリガーすることを検証してください。                |  3  |  V  |

---

## C6.5 サードパーティデータセットリスク評価

外部データセットを毒性、バイアス、法的遵守の観点から評価し、そのライフサイクルを通じて監視する。

|   #   | 説明                                                                 | レベル | 役割  |
| :---: | ------------------------------------------------------------------ | :-: | :-: |
| 6.5.1 | 外部データセットがポイズニングリスクスコアリング（例：データフィンガープリンティング、異常検出）を受けていることを確認してください。 |  1  | D/V |
| 6.5.2 | バイアスメトリクス（人口統計的パリティ、均等機会）がデータセットの承認前に計算されていることを確認してください。           |  1  |  D  |
| 6.5.3 | ML-BOMエントリにおいて、データセットの由来およびライセンス条件が適切に記録されていることを確認してください。          |  2  |  V  |
| 6.5.4 | ホストされているデータセットにおけるドリフトや破損を定期的な監視で検出できることを確認してください。                 |  2  |  V  |
| 6.5.5 | トレーニング前に、自動スクラビングによって許可されていないコンテンツ（著作権、個人識別情報）が削除されていることを確認してください。 |  3  |  D  |

---

## C6.6 サプライチェーン攻撃監視

CVEフィード、監査ログ分析、レッドチームのシミュレーションを通じて、サプライチェーンの脅威を早期に検出します。

|   #   | 説明                                                                       | レベル | 役割  |
| :---: | ------------------------------------------------------------------------ | :-: | :-: |
| 6.6.1 | CI/CDの監査ログが異常なパッケージの取得や改ざんされたビルドステップの検出のためにSIEMにストリームされていることを確認してください。   |  1  |  V  |
| 6.6.2 | インシデント対応プレイブックに、侵害されたモデルやライブラリのロールバック手順が含まれていることを確認してください。               |  2  |  D  |
| 6.6.3 | alertトリアージにおいて、threat‑intelの強化がML特有の指標（例：モデル汚染のIoC）をタグ付けしていることを検証してください。 |  3  |  V  |

---

## C6.7 モデルアーティファクトのためのML-BOM

詳細なML専用SBOM（ML-BOM）を生成して署名し、下流の利用者が展開時にコンポーネントの完全性を検証できるようにします。

|   #   | 説明                                                                            | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------- | :-: | :-: |
| 6.7.1 | すべてのモデルアーティファクトが、データセット、重み、ハイパーパラメータ、およびライセンスを一覧表示したML‑BOMを公開していることを確認してください。 |  1  | D/V |
| 6.7.2 | ML-BOMの生成とCosign署名がCIで自動化されており、マージに必須であることを確認してください。                          |  1  | D/V |
| 6.7.3 | コンポーネントのメタデータ（ハッシュ、ライセンス）が欠落している場合、ML‑BOMの完全性チェックがビルドを失敗させることを確認してください。       |  2  |  D  |
| 6.7.4 | ダウンストリームの利用者がデプロイ時にインポートされたモデルを検証するために、API経由でML-BOMを照会できることを確認してください。         |  2  |  V  |
| 6.7.5 | ML-BOMがバージョン管理され、不正な変更を検出するために差分が確認されていることを検証してください。                          |  3  |  V  |

---

## 参考文献

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


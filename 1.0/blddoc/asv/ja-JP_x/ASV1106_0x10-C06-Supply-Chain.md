# モデル、フレームワーク、およびデータのためのC6サプライチェーンセキュリティ

## 管理目標

AIのサプライチェーン攻撃は、サードパーティのモデル、フレームワーク、またはデータセットを悪用してバックドア、バイアス、または悪用可能なコードを埋め込みます。これらのコントロールは、エンドツーエンドの出所管理、脆弱性管理、および監視を提供し、モデルのライフサイクル全体を保護します。

---

## C6.1 事前学習済みモデルの審査と出自確認

ファインチューニングや展開の前に、サードパーティモデルの出所、ライセンス、隠れた挙動を評価および認証してください。

|   #   | 説明                                                                         | レベル | 役割  |
| :---: | -------------------------------------------------------------------------- | :-: | :-: |
| 6.1.1 | すべてのサードパーティモデルアーティファクトに、ソースリポジトリとコミットハッシュを特定する署名付きの由来記録が含まれていることを検証してください。 |  1  | D/V |
| 6.1.2 | モデルをインポートする前に、自動化ツールを使用して悪意のあるレイヤーやトロイの木馬トリガーがスキャンされていることを確認してください。        |  1  | D/V |
| 6.1.3 | 転移学習のファインチューニングが隠れた挙動を検出するための敵対的評価に合格することを検証してください。                        |  2  |  D  |
| 6.1.4 | モデルライセンス、輸出管理タグ、およびデータ起源ステートメントがML-BOMエントリに記録されていることを確認してください。             |  2  |  V  |
| 6.1.5 | 高リスクモデル（公開された重み、未確認のクリエイター）が人間によるレビューと承認まで隔離されたままであることを確認してください。           |  3  | D/V |

---

## C6.2 フレームワーク＆ライブラリスキャン

実行時スタックを安全に保つために、MLフレームワークとライブラリを継続的にスキャンし、CVEや悪意のあるコードを検出します。

|   #   | 説明                                                                   | レベル | 役割  |
| :---: | -------------------------------------------------------------------- | :-: | :-: |
| 6.2.1 | CIパイプラインがAIフレームワークおよび重要なライブラリに対して依存関係スキャナーを実行していることを確認してください。        |  1  | D/V |
| 6.2.2 | 重大な脆弱性（CVSS ≥ 7.0）が本番用イメージへの昇格をブロックすることを確認してください。                    |  1  | D/V |
| 6.2.3 | フォークまたはベンダー化されたMLライブラリで静的コード解析が実行されることを確認してください。                     |  2  |  D  |
| 6.2.4 | フレームワークのアップグレード提案には、公開されているCVEフィードを参照したセキュリティ影響評価が含まれていることを確認してください。 |  2  |  V  |
| 6.2.5 | 署名されたSBOMから逸脱した予期しない動的ライブラリのロードに対して、ランタイムセンサーが警告を発することを確認してください。     |  3  |  V  |

---

## C6.3 依存関係のピニングと検証

すべての依存関係を不変のダイジェストに固定し、ビルドを再現して同一で改ざんのないアーティファクトを保証します。

|   #   | 説明                                                             | レベル | 役割  |
| :---: | -------------------------------------------------------------- | :-: | :-: |
| 6.3.1 | すべてのパッケージマネージャーがロックファイルを介してバージョン固定を強制していることを確認してください。          |  1  | D/V |
| 6.3.2 | コンテナ参照において、変更可能なタグの代わりに変更不可能なダイジェストが使用されていることを確認してください。        |  1  | D/V |
| 6.3.3 | 再現可能ビルドチェックがCI実行間でハッシュを比較し、同一の出力を保証していることを確認してください。            |  2  |  D  |
| 6.3.4 | 監査の追跡可能性のために、ビルドの証明書が18か月間保存されていることを確認してください。                  |  2  |  V  |
| 6.3.5 | 期限切れの依存関係が自動プルリクエストをトリガーして、固定されたバージョンの更新またはフォークを行うことを確認してください。 |  3  |  D  |

---

## C6.4 信頼されたソースの強制適用

暗号的に検証され、組織が承認したソースからのアーティファクトのダウンロードのみを許可し、それ以外はすべてブロックします。

|   #   | 説明                                                                        | レベル | 役割  |
| :---: | ------------------------------------------------------------------------- | :-: | :-: |
| 6.4.1 | モデルの重み、データセット、およびコンテナが、承認されたドメインまたは内部レジストリからのみダウンロードされていることを確認してください。     |  1  | D/V |
| 6.4.2 | Sigstore/Cosignの署名が、成果物がローカルにキャッシュされる前に発行者の身元を検証することを確認してください。            |  1  | D/V |
| 6.4.3 | egress プロキシが認証されていないアーティファクトのダウンロードをブロックし、信頼できるソースポリシーを強制していることを確認してください。 |  2  |  D  |
| 6.4.4 | リポジトリの許可リストが四半期ごとにレビューされており、各エントリについてビジネス上の正当な理由の証拠があることを確認してください。        |  2  |  V  |
| 6.4.5 | ポリシー違反がアーティファクトの隔離および依存するパイプライン実行のロールバックをトリガーすることを検証してください。               |  3  |  V  |

---

## C6.5 サードパーティデータセットのリスク評価

外部データセットを毒性、バイアス、法的遵守について評価し、そのライフサイクルを通じて監視します。

|   #   | 説明                                                                 | レベル | 役割  |
| :---: | ------------------------------------------------------------------ | :-: | :-: |
| 6.5.1 | 外部データセットがポイズニングリスクのスコアリング（例：データフィンガープリンティング、異常値検出）を受けることを確認してください。 |  1  | D/V |
| 6.5.2 | バイアスメトリクス（人口統計的均等性、機会均等）がデータセット承認前に計算されていることを確認してください。             |  1  |  D  |
| 6.5.3 | データセットの出所およびライセンス条件がML-BOMエントリに記録されていることを確認してください。                 |  2  |  V  |
| 6.5.4 | ホストされているデータセットのドリフトや破損を定期的な監視で検出できることを確認してください。                    |  2  |  V  |
| 6.5.5 | トレーニング前に、許可されていないコンテンツ（著作権、個人識別情報）が自動スクラビングによって削除されていることを確認してください。 |  3  |  D  |

---

## C6.6 サプライチェーン攻撃監視

CVEフィード、監査ログ分析、およびレッドチームシミュレーションを通じてサプライチェーンの脅威を早期に検出します。

|   #   | 説明                                                                    | レベル | 役割  |
| :---: | --------------------------------------------------------------------- | :-: | :-: |
| 6.6.1 | CI/CDの監査ログが異常なパッケージプルや改ざんされたビルドステップの検出のためにSIEMにストリームされていることを確認してください。 |  1  |  V  |
| 6.6.2 | インシデント対応プレイブックに、侵害されたモデルやライブラリのロールバック手順が含まれていることを確認してください。            |  2  |  D  |
| 6.6.3 | 脅威インテリジェンスの強化がアラートトリアージにおいてML特有の指標（例：モデル汚染のIoC）にタグ付けされていることを検証してください。 |  3  |  V  |

---

## C6.7 モデルアーティファクトのためのML-BOM

詳細なML特有のSBOM（ML-BOM）を生成して署名し、下流の利用者が展開時にコンポーネントの整合性を検証できるようにします。

|   #   | 説明                                                                            | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------- | :-: | :-: |
| 6.7.1 | すべてのモデルアーティファクトが、データセット、重み、ハイパーパラメータ、およびライセンスを一覧表示するML-BOMを公開していることを確認してください。 |  1  | D/V |
| 6.7.2 | ML-BOMの生成とCosign署名がCIで自動化されており、マージに必須であることを確認してください。                          |  1  | D/V |
| 6.7.3 | コンポーネントのメタデータ（ハッシュ、ライセンス）が欠落している場合、ML-BOM完全性チェックがビルドを失敗させることを検証してください。        |  2  |  D  |
| 6.7.4 | ダウンストリームの利用者が、デプロイ時にインポートされたモデルを検証するために、APIを通じてML-BOMをクエリできることを確認する。          |  2  |  V  |
| 6.7.5 | ML-BOMがバージョン管理されており、不正な変更を検出するために差分が取られていることを確認してください。                        |  3  |  V  |

---

## 参考文献

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


# C6 モデル、フレームワークおよびデータのサプライチェーンセキュリティ

## 制御目標

AIサプライチェーン攻撃は、サードパーティのモデル、フレームワーク、またはデータセットを悪用してバックドア、バイアス、または悪用可能なコードを埋め込みます。これらの制御は、エンドツーエンドの由来管理、脆弱性管理、および監視を提供し、モデルのライフサイクル全体を保護します。

---

## C6.1 事前学習済みモデルの審査と出所管理

ファインチューニングや展開の前に、サードパーティモデルの起源、ライセンス、および隠れた挙動を評価し認証してください。

|   #   | 説明                                                                             | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------ | :-: | :-: |
| 6.1.1 | すべてのサードパーティモデルアーティファクトに、ソースリポジトリとコミットハッシュを識別する署名付きのプロベナンス記録が含まれていることを確認してください。 |  1  | D/V |
| 6.1.2 | モデルがインポートされる前に、自動化ツールを使用して悪意のあるレイヤーやトロイの木馬のトリガーがスキャンされていることを確認してください。          |  1  | D/V |
| 6.1.3 | 転移学習のファインチューニングが、隠れた動作を検出するための敵対的評価に合格することを確認する。                               |  2  |  D  |
| 6.1.4 | モデルライセンス、輸出管理タグ、およびデータ出所の声明がML-BOMエントリに記録されていることを確認してください。                     |  2  |  V  |
| 6.1.5 | 高リスクモデル（公開された重み、未検証の作成者）は、人間によるレビューと承認が行われるまで隔離されたままであることを確認してください。            |  3  | D/V |

---

## C6.2 フレームワーク＆ライブラリスキャン

実行時スタックの安全性を維持するために、MLフレームワークおよびライブラリを継続的にスキャンしてCVEおよび悪意のあるコードを検出します。

|   #   | 説明                                                                  | レベル | 役割  |
| :---: | ------------------------------------------------------------------- | :-: | :-: |
| 6.2.1 | CIパイプラインがAIフレームワークおよび重要なライブラリに対して依存関係スキャナーを実行することを確認してください。         |  1  | D/V |
| 6.2.2 | 重要な脆弱性（CVSS ≥ 7.0）が、プロダクションイメージへの昇格をブロックすることを確認してください。              |  1  | D/V |
| 6.2.3 | フォークされたまたはベンダリングされたMLライブラリに対しても静的コード解析が実行されることを確認してください。            |  2  |  D  |
| 6.2.4 | フレームワークのアップグレード提案に、公開されているCVEフィードを参照したセキュリティ影響評価が含まれていることを確認してください。 |  2  |  V  |
| 6.2.5 | 実行時センサーが、署名されたSBOMから逸脱した予期しない動的ライブラリの読み込みについて警告することを検証してください。       |  3  |  V  |

---

## C6.3 依存関係の固定と検証

すべての依存関係を変更不可能なダイジェストに固定し、再現可能なビルドを行うことで、完全に一致し改ざんされていないアーティファクトを保証します。

|   #   | 説明                                                              | レベル | 役割  |
| :---: | --------------------------------------------------------------- | :-: | :-: |
| 6.3.1 | すべてのパッケージマネージャーがロックファイルを介してバージョン固定を強制していることを確認してください。           |  1  | D/V |
| 6.3.2 | コンテナ参照において、可変タグの代わりに不変のダイジェストが使用されていることを確認してください。               |  1  | D/V |
| 6.3.3 | 再現可能なビルドチェックが、同一の出力を保証するためにCIランのハッシュを比較していることを確認してください。         |  2  |  D  |
| 6.3.4 | ビルド証明書が監査の追跡可能性のために18ヶ月間保存されていることを確認してください。                     |  2  |  V  |
| 6.3.5 | 期限切れの依存関係が、自動プルリクエストをトリガーしてピン留めされたバージョンを更新またはフォークすることを確認してください。 |  3  |  D  |

---

## C6.4 信頼されたソースの強制

暗号的に検証され、組織が承認したソースからのみ成果物のダウンロードを許可し、それ以外はすべてブロックします。

|   #   | 説明                                                                        | レベル | 役割  |
| :---: | ------------------------------------------------------------------------- | :-: | :-: |
| 6.4.1 | モデルの重み、データセット、およびコンテナが承認されたドメインまたは内部レジストリからのみダウンロードされていることを確認してください。      |  1  | D/V |
| 6.4.2 | Sigstore/Cosignの署名が、アーティファクトをローカルにキャッシュする前に発行者の身元を検証することを確認してください。        |  1  | D/V |
| 6.4.3 | 信頼されたソースのポリシーを適用するために、出力プロキシが認証されていないアーティファクトのダウンロードをブロックしていることを検証してください。 |  2  |  D  |
| 6.4.4 | リポジトリの許可リストが四半期ごとにレビューされており、各エントリに対する業務上の正当性の証拠があることを確認してください。            |  2  |  V  |
| 6.4.5 | ポリシー違反がアーティファクトの隔離および依存するパイプライン実行のロールバックを引き起こすことを確認してください。                |  3  |  V  |

---

## C6.5 サードパーティデータセットリスク評価

外部データセットを毒性、バイアス、法的遵守について評価し、それらのライフサイクル全体を通じて監視します。

|   #   | 説明                                                                     | レベル | 役割  |
| :---: | ---------------------------------------------------------------------- | :-: | :-: |
| 6.5.1 | 外部データセットがポイズニングリスクスコアリング（例：データフィンガープリンティング、異常値検出）を受けることを確認してください。      |  1  | D/V |
| 6.5.2 | バイアスメトリクス（人口統計的公平性、機会均等）がデータセット承認前に計算されていることを確認してください。                 |  1  |  D  |
| 6.5.3 | データセットの発端情報およびライセンス条項がML-BOMエントリに記録されていることを確認してください。                   |  2  |  V  |
| 6.5.4 | ホストされているデータセットのドリフトや破損を定期的なモニタリングが検出することを確認してください。                     |  2  |  V  |
| 6.5.5 | トレーニング前に、自動スクラビングを通じて許可されていないコンテンツ（著作権、個人を特定できる情報）が削除されていることを確認してください。 |  3  |  D  |

---

## C6.6 サプライチェーン攻撃の監視

CVEフィード、監査ログ分析、およびレッドチームシミュレーションを通じてサプライチェーンの脅威を早期に検出します。

|   #   | 説明                                                                       | レベル | 役割  |
| :---: | ------------------------------------------------------------------------ | :-: | :-: |
| 6.6.1 | CI/CDの監査ログが異常なパッケージプルや改ざんされたビルドステップの検出のためにSIEMにストリームされていることを確認してください。    |  1  |  V  |
| 6.6.2 | インシデント対応プレイブックに、侵害されたモデルやライブラリのロールバック手順が含まれていることを確認してください。               |  2  |  D  |
| 6.6.3 | アラートトリアージにおいて、脅威インテリジェンスの強化が機械学習特有の指標（例：モデル汚染のIoC）にタグ付けされていることを検証してください。 |  3  |  V  |

---

## C6.7 モデルアーティファクトのためのML-BOM

詳細な機械学習（ML）特有のSBOM（ML-BOM）を生成および署名し、下流の利用者が展開時にコンポーネントの整合性を検証できるようにします。

|   #   | 説明                                                                            | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------- | :-: | :-: |
| 6.7.1 | すべてのモデルアーティファクトが、データセット、重み、ハイパーパラメータ、およびライセンスを一覧表示したML-BOMを公開していることを確認してください。 |  1  | D/V |
| 6.7.2 | ML-BOMの生成とCosign署名がCIで自動化されており、マージに必須であることを確認してください。                          |  1  | D/V |
| 6.7.3 | コンポーネントのメタデータ（ハッシュ、ライセンス）が欠落している場合、ML‑BOM 完全性チェックがビルドを失敗させることを検証してください。       |  2  |  D  |
| 6.7.4 | ダウンストリームの利用者が、展開時にインポートされたモデルを検証するために、APIを介してML-BOMを照会できることを確認してください。         |  2  |  V  |
| 6.7.5 | ML-BOMがバージョン管理され、不正な変更を検出するために差分が確認されていることを検証してください。                          |  3  |  V  |

---

## 参考文献

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


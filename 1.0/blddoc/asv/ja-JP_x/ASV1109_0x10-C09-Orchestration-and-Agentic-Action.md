# 9 自律オーケストレーションとエージェント的行動のセキュリティ

## 統制目標

自律型またはマルチエージェントAIシステムは、明示的に意図され、認証され、監査可能で、かつ費用とリスクの閾値が制限された範囲内の行動のみを実行できるようにする。これにより、以下の脅威に対して保護します：自律システムの侵害、ツールの不正使用、エージェント・ループ検出、通信の乗っ取り、アイデンティティのなりすまし、群知能の操作、そして意図の改ざん。

---

## 9.1 エージェントのタスク-計画と再帰予算

再帰的な計画を制限し、特権的なアクションには人間のチェックポイントを設ける。

|   #   | 説明                                                                                  | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------- | :-: | :-: |
| 9.1.1 | 最大再帰深度、探索幅、ウォールクロック時間、トークン数、およびエージェント実行あたりの金銭的コストが一元的に設定され、バージョン管理されていることを確認してください。 |  1  | D/V |
| 9.1.2 | 特権的または不可逆的な操作（例：コードのコミット、資金の移動）が、実行前に監査可能なチャネルを介して明示的な人間の承認を必要とすることを検証する。           |  1  | D/V |
| 9.1.3 | リアルタイムのリソース監視が、いずれかの予算閾値を超えた場合にサーキットブレーカを作動させ、さらなるタスク拡張を停止することを検証する。                |  2  |  D  |
| 9.1.4 | フォレンジック調査のため、サーキットブレーカーのイベントが、エージェントID、トリガ条件、取得済みのプラン状態とともに記録されていることを検証してください。      |  2  | D/V |
| 9.1.5 | セキュリティテストが予算枯渇および暴走プランのシナリオを網羅していることを検証し、データ損失なしに安全に停止できることを確認する。                   |  3  |  V  |
| 9.1.6 | 予算ポリシーをポリシー・アズ・コードとして表現し、CI/CD で適用・強制されていることを検証して、構成のドリフトをブロックします。                  |  3  |  D  |

---

## 9.2 ツール プラグイン サンドボックス化

ツールの相互作用を分離し、不正なシステムアクセスやコードの実行を防止する。

|   #   | 説明                                                                                                       | レベル | 役割  |
| :---: | -------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.2.1 | すべてのツール／プラグインが、OS、コンテナ、または WASM レベルのサンドボックス内で、最小権限のファイルシステム、ネットワーク、およびシステムコール ポリシーを適用して実行されることを検証してください。 |  1  | D/V |
| 9.2.2 | サンドボックスのリソースクォータ（CPU、メモリ、ディスク、ネットワーク出力）と実行タイムアウトが適用され、ログに記録されていることを確認する。                                 |  1  | D/V |
| 9.2.3 | ツールのバイナリまたはディスクリプタがデジタル署名されていることを確認し、読み込み前に署名を検証します。                                                     |  2  | D/V |
| 9.2.4 | サンドボックスのテレメトリがSIEMにストリームとして送信されることを検証し、異常（例：外部への接続を試みた場合など）がアラートを発生させることを確認する。                           |  2  |  V  |
| 9.2.5 | 高リスクのプラグインが本番環境へのデプロイ前にセキュリティレビューとペネトレーションテストを受けることを確認してください。                                            |  3  |  V  |
| 9.2.6 | サンドボックスからの脱出を試みる行為が自動的にブロックされることを検証し、問題のプラグインが調査中は検疫されることを確認してください。                                      |  3  | D/V |

---

## 9.3 自律ループ & コスト境界

制御不能なエージェント間の再帰とコストの爆発を検出して停止する。

|   #   | 説明                                                                   | レベル | 役割  |
| :---: | -------------------------------------------------------------------- | :-: | :-: |
| 9.3.1 | エージェント間の呼び出しに、ランタイムがデクリメントして適用を強制するホップ制限または TTL が含まれていることを検証する。      |  1  | D/V |
| 9.3.2 | エージェントが自己呼び出しや循環パターンを検出するために、固有の invocation-graph ID を維持していることを検証する。 |  2  |  D  |
| 9.3.3 | 累積コンピュートユニットと消費カウンターがリクエストチェーンごとに追跡されていることを検証する; 制限を超えるとチェーンは中止される。  |  2  | D/V |
| 9.3.4 | 形式的解析またはモデル検査が、エージェントのプロトコルにおける無限再帰が存在しないことを示すことを検証する。               |  3  |  V  |
| 9.3.5 | loop-abort イベントがアラートを生成し、継続的改善の指標に寄与することを検証する。                       |  3  |  D  |

---

## 9.4 プロトコルレベルの不正利用対策

エージェントと外部システム間の通信チャネルを保護し、乗っ取りや改ざんを防ぐ。

|   #   | 説明                                                                                            | レベル | 役割  |
| :---: | --------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.4.1 | すべてのエージェント-ツール間およびエージェント-エージェント間のメッセージが認証されており（例：相互TLS認証またはJWT）、エンドツーエンドで暗号化されていることを確認してください。 |  1  | D/V |
| 9.4.2 | スキーマが厳密に検証されていることを確認し、未知のフィールドや形式が不正なメッセージは拒否される。                                             |  1  |  D  |
| 9.4.3 | 整合性検証（MAC またはデジタル署名）が、ツールのパラメータを含むメッセージ全体のペイロードをカバーしていることを確認する。                               |  2  | D/V |
| 9.4.4 | プロトコル層でリプレイ防止機構（ノンスまたはタイムスタンプウィンドウ）が適用されていることを検証する。                                           |  2  |  D  |
| 9.4.5 | プロトコル実装がインジェクション脆弱性やデシリアライズ脆弱性に対して、ファジングと静的解析を受けていることを確認する。                                   |  3  |  V  |

---

## 9.5 エージェントの識別と改ざん証跡

行動を帰属可能にし、変更を検出可能にする。

|   #   | 説明                                                                            | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------- | :-: | :-: |
| 9.5.1 | 各エージェント・インスタンスが固有の暗号的アイデンティティ（鍵ペアまたはハードウェア・ルート認証情報）を有していることを検証してください。         |  1  | D/V |
| 9.5.2 | すべてのエージェントのアクションが署名され、タイムスタンプが付与されていることを検証してください。ログには否認不能性を確保するための署名が含まれています。 |  2  | D/V |
| 9.5.3 | 改ざん検知可能なログが、追記専用媒体または書き込み一度きりの媒体に保存されていることを検証する。                              |  2  |  V  |
| 9.5.4 | アイデンティティ鍵が定義されたスケジュールと侵害の兆候に基づいてローテーションすることを検証する。                             |  3  |  D  |
| 9.5.5 | なりすましまたは鍵の衝突の試みが、影響を受けたエージェントを直ちに隔離するよう誘発することを確認してください。                       |  3  | D/V |

---

## 9.6 マルチ-エージェント・スウォームのリスク低減

分離と形式的安全モデリングを通じて、集合的行動による危険を軽減する。

|   #   | 説明                                                                    | レベル | 役割  |
| :---: | --------------------------------------------------------------------- | :-: | :-: |
| 9.6.1 | 異なるセキュリティ領域で動作するエージェントが、分離されたランタイムサンドボックスまたはネットワークセグメントで実行されることを検証する。 |  1  | D/V |
| 9.6.2 | 展開前に、群れの挙動がモデル化され、生存性および安全性について形式的に検証されていることを確認する。                    |  3  |  V  |
| 9.6.3 | ランタイムモニターが新たに出現する不安全パターン（例：発振、デッドロック）を検出し、是正措置を開始することを検証する。           |  3  |  D  |

---

## 9.7 ユーザー & ツール 認証 / 認可

すべてのエージェントによってトリガーされるアクションに対して、堅牢なアクセス制御を実装する。

|   #   | 説明                                                                         | レベル | 役割  |
| :---: | -------------------------------------------------------------------------- | :-: | :-: |
| 9.7.1 | エージェントが下流システムに対してファーストクラスプリンシパルとして認証していることを検証し、エンドユーザーの資格情報を再利用しないことを確認する。 |  1  | D/V |
| 9.7.2 | 細粒度の認可ポリシーが、エージェントが呼び出せるツールと、エージェントが提供できるパラメータを制限していることを検証する。              |  2  |  D  |
| 9.7.3 | 各呼び出し時に権限チェックが再評価されること（継続的認可）を検証し、セッション開始時だけでなく毎回実行されることを確認する。             |  2  |  V  |
| 9.7.4 | 委任された権限が自動的に失効し、タイムアウト後またはスコープ変更後に再同意を求めることを検証します。                         |  3  |  D  |

---

## 9.8 エージェント間の通信セキュリティ

すべてのエージェント間のメッセージを暗号化し、完全性を確保して、盗聴と改ざんを防止する。

|   #   | 説明                                                                     | レベル | 役割  |
| :---: | ---------------------------------------------------------------------- | :-: | :-: |
| 9.8.1 | エージェントチャネルには、相互認証と完全前方秘匿性を備えた暗号化（例：TLS 1.3）が必須であることを検証する。              |  1  | D/V |
| 9.8.2 | 処理を行う前に、メッセージの完全性と発信元が検証されていることを確認してください。検証に失敗した場合は、警告を発し、メッセージを破棄します。 |  1  |  D  |
| 9.8.3 | 法医学的再構成を支援するために、通信メタデータ（タイムスタンプ、シーケンス番号）がログに記録されていることを確認する。            |  2  | D/V |
| 9.8.4 | 形式検証またはモデル検査を用いて、プロトコルの状態機械が不安全な状態へ移行しないことを確認する。                       |  3  |  V  |

---

## 9.9 インテント検証 & 制約の適用

エージェントの行動が、ユーザーの明示的な意図およびシステム制約に沿っていることを検証する。

|   #   | 説明                                                                             | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------ | :-: | :-: |
| 9.9.1 | 実行前の制約ソルバーが、提案された行動をハードコーディングされた安全性およびポリシー規則と照合することを検証する。                      |  1  |  D  |
| 9.9.2 | 高影響の操作（金融的影響を伴うもの、破壊的なもの、プライバシーに敏感なもの）には、操作を開始したユーザーからの明示的な意図の確認を必要とすることを検証する。 |  2  | D/V |
| 9.9.3 | 事後条件の検証により、完了したアクションが意図した効果を副作用なく達成したことを確認する。差異が生じた場合はロールバックを実行する。             |  2  |  V  |
| 9.9.4 | 形式手法（例：モデル検査、定理証明）または性質ベースのテストを用いて、エージェントの計画が宣言されたすべての制約を満たすことを検証する。           |  3  |  V  |
| 9.9.5 | インテント不一致または制約違反のインシデントが、継続的改善サイクルと脅威情報共有を促進することを検証する。                          |  3  |  D  |

---

## 9.10 エージェント推論戦略とセキュリティ

ReAct、Chain-of-Thought、および Tree-of-Thoughts アプローチを含む、さまざまな推論戦略の安全な選択と実行。

|   #    | 説明                                                                                                      | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.10.1 | 推論戦略の選択が決定論的基準（入力の複雑性、タスクの種類、セキュリティコンテキスト）を用いて行われ、同一の入力が同じセキュリティコンテキスト内で同一の戦略選択を生み出すことを検証する。            |  1  | D/V |
| 9.10.2 | 各推論戦略（ReAct、Chain-of-Thought、Tree-of-Thoughts）には、それぞれの認知アプローチに固有の入力検証、出力のサニタイズ、および実行時間制限が備わっていることを検証する。 |  1  | D/V |
| 9.10.3 | 推論戦略の遷移が、監査証跡の再構築のために、入力特性、選択基準値、実行メタデータを含む完全な文脈とともに記録されていることを検証する。                                     |  2  | D/V |
| 9.10.4 | Tree-of-Thoughtsの推論が、ポリシー違反、リソース制限、または安全境界が検出されたときに探索を終了する分岐の枝刈り機構を含んでいることを確認する。                        |  2  | D/V |
| 9.10.5 | ReAct（Reason-Act-Observe）サイクルが各フェーズに検証ポイントを含み、先に進む前に推論ステップの検証、アクションの承認、観測のサニタイズが行われることを検証してください。        |  2  | D/V |
| 9.10.6 | 推論戦略のパフォーマンス指標（実行時間、リソース使用量、出力品質）が、設定された閾値を超えた場合に自動アラートで監視されることを検証する。                                   |  3  | D/V |
| 9.10.7 | 複数の戦略を組み合わせるハイブリッド推論アプローチが、すべての構成戦略の入力検証と出力制約を回避することなく維持していることを検証する。                                    |  3  | D/V |
| 9.10.8 | 推論戦略のセキュリティテストには、形式が崩れた入力を対象としたファジング、戦略の切替を強制するよう設計された敵対的プロンプト、そして各認知アプローチに対する境界条件テストが含まれていることを検証する。    |  3  | D/V |

---

## 9.11 エージェントのライフサイクル状態管理とセキュリティ

セキュアなエージェントの初期化、状態遷移、終了、および暗号化された監査証跡と定義済みの復旧手順。

|   #    | 説明                                                                                                                    | レベル | 役割  |
| :----: | --------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.11.1 | エージェントの初期化が、ハードウェア保護された認証情報を用いた暗号的なアイデンティティの確立を含み、エージェントID、タイムスタンプ、設定ハッシュ、および初期化パラメータを含む不可変の起動監査ログを保持していることを検証してください。 |  1  | D/V |
| 9.11.2 | エージェントの状態遷移が暗号署名され、タイムスタンプが付与され、トリガーとなるイベント、前状態ハッシュ、新状態ハッシュ、および実施されたセキュリティ検証を含む完全な文脈とともにログに記録されていることを検証する。            |  2  | D/V |
| 9.11.3 | エージェントのシャットダウン手順が、暗号化消去またはマルチパス上書きを用いた安全なメモリ消去、認証情報の取り消しと認証局への通知、そして改ざん検知機能を備えた終了証明書の発行を含むことを検証してください。                |  2  | D/V |
| 9.11.4 | エージェント回復機構が、状態の整合性を暗号学的ハッシュ値（SHA-256を最低限とする）を用いて検証し、破損が検出された場合に自動通知と手動承認要件を伴って既知の良好な状態へロールバックすることを検証する。               |  3  | D/V |
| 9.11.5 | エージェントの永続化メカニズムが機密性の高い状態データをエージェントごとに AES-256 鍵で暗号化し、設定可能なスケジュール（最大 90 日）で安全な鍵回転を実装し、ゼロダウンタイムでのデプロイを実現していることを検証する。    |  3  | D/V |

---

## 9.12 ツール統合セキュリティフレームワーク

定義されたリスク評価および承認プロセスを伴う、動的ツールの読み込み、実行、結果検証に対するセキュリティ制御。

|   #    | 説明                                                                                                                          | レベル | 役割  |
| :----: | --------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.12.1 | ツール記述子に、必要な権限（読み取り/書き込み/実行）、リスクレベル（低/中/高）、リソース制限（CPU、メモリ、ネットワーク）を指定するセキュリティメタデータ、およびツールマニフェストに文書化された検証要件が含まれていることを確認する。     |  1  | D/V |
| 9.12.2 | ツールの実行結果が、想定されるスキーマ（JSON Schema、XML Schema）およびセキュリティポリシー（出力のサニタイズ、データ分類）に対して検証されることを、タイムアウト制限およびエラーハンドリング手順と統合する前に確認してください。 |  1  | D/V |
| 9.12.3 | SIEM統合のために、ツールの相互作用ログが権限の使用、データアクセスパターン、実行時間、リソース消費量、および戻り値コードを含む詳細なセキュリティコンテキストを構造化ログとして記録していることを確認する。                     |  2  | D/V |
| 9.12.4 | 動的ツール読み込み機構が PKI インフラストラクチャを用いてデジタル署名を検証することを確認し、実行前にサンドボックス分離と権限検証を含む安全な読み込みプロトコルを実装する。                                    |  2  | D/V |
| 9.12.5 | 新しいバージョンに対して、静的解析、動的テスト、セキュリティチームの審査を含む必須の承認ゲートを備えたツールのセキュリティ評価が自動的にトリガーされることを検証し、承認基準およびSLA要件を文書化していることを確認する。              |  3  | D/V |

---

### 参考文献

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)


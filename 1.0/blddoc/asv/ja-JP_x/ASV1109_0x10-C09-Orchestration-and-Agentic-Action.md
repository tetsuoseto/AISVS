# 9 自律的オーケストレーションとエージェンシー行動のセキュリティ

## 制御目標

自律型またはマルチエージェントAIシステムは、明示的に意図された、認証された、監査可能な、かつ制限されたコストおよびリスクの閾値内でのみアクションを実行できるようにします。これにより、自律システムの侵害、ツールの誤用、エージェントループの検出、通信のハイジャック、アイデンティティのなりすまし、スウォーム操作、意図操作などの脅威から保護されます。

---

## 9.1 エージェントのタスク計画と再帰予算

再帰的なプランを制限し、特権的な操作に対して人間のチェックポイントを強制してください。

|   #   | 説明                                                                                   | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------ | :-: | :-: |
| 9.1.1 | 最大再帰深度、幅、実時間、トークン、およびエージェント実行ごとの金銭的コストが中央で設定され、バージョン管理されていることを確認してください。              |  1  | D/V |
| 9.1.2 | 権限のある操作や取り消し不可能な操作（例：コードコミット、財務振替）が実行される前に、監査可能なチャネルを通じた明示的な人間の承認を必要とすることを確認してください。  |  1  | D/V |
| 9.1.3 | リアルタイムリソースモニターが、いずれかの予算しきい値を超えた場合にサーキットブレーカー割り込みをトリガーし、それ以上のタスク拡張を停止することを検証してください。   |  2  |  D  |
| 9.1.4 | サーキットブレーカーイベントがエージェントID、トリガー条件、およびフォレンジックレビューのために記録されたプラン状態と共にログに記録されていることを確認してください。 |  2  | D/V |
| 9.1.5 | セキュリティテストが予算枯渇および暴走プランのシナリオをカバーし、データ損失なく安全に停止できることを確認してください。                         |  3  |  V  |
| 9.1.6 | 予算ポリシーがポリシー・アズ・コードとして記述され、構成のずれを防ぐためにCI/CDで強制されていることを確認してください。                       |  3  |  D  |

---

## 9.2 ツールプラグインのサンドボックス化

ツールの操作を分離し、不正なシステムアクセスやコード実行を防止します。

|   #   | 説明                                                                                                    | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.2.1 | すべてのツール／プラグインが、最小権限のファイルシステム、ネットワーク、およびシステムコールポリシーを備えたOS、コンテナ、またはWASMレベルのサンドボックス内で実行されていることを確認してください。 |  1  | D/V |
| 9.2.2 | サンドボックスのリソース割り当て（CPU、メモリ、ディスク、ネットワーク出力）および実行タイムアウトが適用され、ログに記録されていることを確認してください。                        |  1  | D/V |
| 9.2.3 | ツールのバイナリまたは記述子がデジタル署名されていることを確認し、読み込み前に署名を検証します。                                                      |  2  | D/V |
| 9.2.4 | サンドボックスのテレメトリがSIEMにストリーミングされることを確認する。異常（例：試みられたアウトバウンド接続）が検出された場合はアラートが発生する。                          |  2  |  V  |
| 9.2.5 | 高リスクのプラグインが本番環境に導入される前に、セキュリティレビューおよびペネトレーションテストを受けることを確認してください。                                      |  3  |  V  |
| 9.2.6 | サンドボックスの脱出試行が自動的にブロックされ、問題のあるプラグインが調査のために隔離されることを確認してください。                                            |  3  | D/V |

---

## 9.3 自律ループとコスト境界設定

制御されていないエージェント間の再帰およびコストの爆発を検出し、停止する。

|   #   | 説明                                                                     | レベル | 役割  |
| :---: | ---------------------------------------------------------------------- | :-: | :-: |
| 9.3.1 | インターエージェント呼び出しに、ランタイムがデクリメントし適用するホップ制限またはTTLが含まれていることを検証してください。        |  1  | D/V |
| 9.3.2 | エージェントが自己呼び出しや循環パターンを検出するために、一意の呼び出しグラフIDを維持していることを確認してください。           |  2  |  D  |
| 9.3.3 | 累積のコンピュートユニットおよび支出カウンターがリクエストチェーンごとに追跡されていることを検証する。制限を超えた場合はチェーンを中止する。 |  2  | D/V |
| 9.3.4 | 形式的解析またはモデル検査によって、エージェントプロトコルにおける無制限再帰が存在しないことを検証してください。               |  3  |  V  |
| 9.3.5 | ループ中断イベントがアラートを生成し、継続的改善の指標に反映されることを確認してください。                          |  3  |  D  |

---

## 9.4 プロトコルレベルの誤使用防止

エージェントと外部システム間の安全な通信チャネルを確保し、ハイジャックや操作を防止します。

|   #   | 説明                                                                                                | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.4.1 | すべてのエージェントからツールへのメッセージおよびエージェント間のメッセージが認証されていること（例えば、相互TLSまたはJWT）およびエンドツーエンドで暗号化されていることを確認してください。 |  1  | D/V |
| 9.4.2 | スキーマが厳格に検証されていることを確認し、未知のフィールドや不正な形式のメッセージは拒否されることを確認してください。                                      |  1  |  D  |
| 9.4.3 | 整合性チェック（MACやデジタル署名）がツールパラメータを含むメッセージペイロード全体をカバーしていることを検証してください。                                   |  2  | D/V |
| 9.4.4 | リプレイ防止（ノンスまたはタイムスタンプウィンドウ）がプロトコル層で強制されていることを確認してください。                                             |  2  |  D  |
| 9.4.5 | プロトコル実装が、注入攻撃やデシリアライズの脆弱性に対してファジングおよび静的解析を受けることを確認してください。                                         |  3  |  V  |

---

## 9.5 エージェントの識別と改ざん検出

行動が帰属可能であり、変更が検出可能であることを確保してください。

|   #   | 説明                                                                         | レベル | 役割  |
| :---: | -------------------------------------------------------------------------- | :-: | :-: |
| 9.5.1 | 各エージェントインスタンスが一意の暗号学的アイデンティティ（鍵ペアまたはハードウェアルートの資格情報）を保持していることを確認する。         |  1  | D/V |
| 9.5.2 | すべてのエージェントのアクションに署名とタイムスタンプが付されていることを確認し、ログには否認防止のための署名が含まれていることを検証してください。 |  2  | D/V |
| 9.5.3 | 改ざん検知ログが追記専用または一度しか書き込めない媒体に保存されていることを確認してください。                            |  2  |  V  |
| 9.5.4 | 識別キーが定められたスケジュールと侵害指標に基づいて回転することを検証する。                                     |  3  |  D  |
| 9.5.5 | なりすましやキー競合の試みが検知された場合、該当エージェントが直ちに隔離されることを確認してください。                        |  3  | D/V |

---

## 9.6 マルチエージェント群のリスク低減

集団行動の危険を隔離および形式的な安全モデリングを通じて軽減する。

|   #   | 説明                                                                             | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------ | :-: | :-: |
| 9.6.1 | 異なるセキュリティドメインで動作するエージェントが、分離されたランタイムサンドボックスまたはネットワークセグメント内で実行されていることを検証してください。 |  1  | D/V |
| 9.6.2 | 展開前に、群れ行動がモデル化され、生存性と安全性について形式的に検証されていることを確認してください。                            |  3  |  V  |
| 9.6.3 | ランタイムモニターが新たに発生する安全でないパターン（例：振動、デッドロック）を検出し、是正措置を開始することを検証する。                  |  3  |  D  |

---

## 9.7 ユーザーおよびツールの認証／認可

すべてのエージェント起動アクションに対して堅牢なアクセス制御を実装してください。

|   #   | 説明                                                                          | レベル | 役割  |
| :---: | --------------------------------------------------------------------------- | :-: | :-: |
| 9.7.1 | エージェントがダウンストリームシステムに対してファーストクラスの主体として認証し、エンドユーザーの資格情報を決して再利用しないことを検証してください。 |  1  | D/V |
| 9.7.2 | 細粒度の認可ポリシーが、エージェントが呼び出せるツールと提供できるパラメータを制限していることを検証してください。                   |  2  |  D  |
| 9.7.3 | 権限チェックがセッション開始時だけでなく、すべての呼び出し時に再評価されること（継続的な認証）を確認してください。                   |  2  |  V  |
| 9.7.4 | 委任された権限が自動的に期限切れとなり、タイムアウトまたはスコープ変更後に再承認が必要であることを確認してください。                  |  3  |  D  |

---

## 9.8 エージェント間通信のセキュリティ

盗聴や改ざんを防ぐために、すべてのエージェント間メッセージを暗号化し、完全性を保護してください。

|   #   | 説明                                                                  | レベル | 役割  |
| :---: | ------------------------------------------------------------------- | :-: | :-: |
| 9.8.1 | エージェントチャネルに対して、相互認証および完全前方秘匿性暗号化（例：TLS 1.3）が必須であることを確認してください。       |  1  | D/V |
| 9.8.2 | メッセージの整合性と送信元が処理前に検証されていることを確認してください。検証に失敗した場合はアラートを発し、メッセージを破棄します。 |  1  |  D  |
| 9.8.3 | 通信メタデータ（タイムスタンプ、シーケンス番号）がフォレンジック再構築をサポートするために記録されていることを確認してください。    |  2  | D/V |
| 9.8.4 | 形式的検証またはモデルチェックにより、プロトコルステートマシンが安全でない状態に遷移することがないことを確認してください。       |  3  |  V  |

---

## 9.9 意図検証と制約の強制

エージェントの行動がユーザーの明示された意図およびシステムの制約と一致していることを検証する。

|   #   | 説明                                                                                    | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------- | :-: | :-: |
| 9.9.1 | 事前実行制約ソルバーが、提案されたアクションをハードコードされた安全性およびポリシールールに照らして検証することを確認してください。                    |  1  |  D  |
| 9.9.2 | 高影響の操作（財務的、破壊的、プライバシーに敏感なもの）については、開始ユーザーからの明示的な意図の確認が必要であることを検証してください。                |  2  | D/V |
| 9.9.3 | ポストコンディションチェックが、完了したアクションが意図した効果を副作用なしで達成したことを検証することを確認してください。不一致があった場合はロールバックを発動します。 |  2  |  V  |
| 9.9.4 | 形式手法（例えば、モデル検査、定理証明）やプロパティベーステストが、エージェントの計画がすべての宣言された制約を満たしていることを実証していることを検証してください。   |  3  |  V  |
| 9.9.5 | 意図の不一致や制約違反の事案が継続的改善サイクルおよび脅威インテリジェンス共有に反映されることを確認してください。                             |  3  |  D  |

---

## 9.10 エージェント推論戦略のセキュリティ

ReAct、Chain-of-Thought、Tree-of-Thoughtsアプローチを含むさまざまな推論戦略の安全な選択と実行。

|   #    | 説明                                                                                                           | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 9.10.1 | 推論戦略の選択が決定論的な基準（入力の複雑さ、タスクの種類、セキュリティコンテキスト）を使用していることを検証し、同一のセキュリティコンテキスト内で同一の入力が同一の戦略選択を生み出すことを確認してください。     |  1  | D/V |
| 9.10.2 | 各推論戦略（ReAct、Chain-of-Thought、Tree-of-Thoughts）に、それぞれの認知アプローチに特化した入力検証、出力のサニタイズ、および実行時間制限が設けられていることを確認してください。 |  1  | D/V |
| 9.10.3 | 推論戦略の遷移が、入力の特性、選択基準の値、実行メタデータを含む完全なコンテキストとともにログに記録されていることを検証し、監査トレイルの再構築を可能にしてください。                          |  2  | D/V |
| 9.10.4 | Tree-of-Thoughts推論には、ポリシー違反、リソース制限、または安全境界が検出された場合に探索を終了する枝刈りメカニズムが含まれていることを確認してください。                        |  2  | D/V |
| 9.10.5 | ReAct（Reason-Act-Observe）サイクルには、各フェーズでの検証チェックポイントが含まれていることを確認してください：推論ステップの検証、行動の承認、および次に進む前の観察のサニタイズ。       |  2  | D/V |
| 9.10.6 | 推論戦略のパフォーマンス指標（実行時間、リソース使用量、出力品質）が監視され、指標が設定された閾値を超えて逸脱した場合に自動アラートが発生することを確認してください。                          |  3  | D/V |
| 9.10.7 | 複数の戦略を組み合わせたハイブリッド推論アプローチが、いかなるセキュリティ制御も迂回することなく、すべての構成戦略の入力検証および出力制約を維持していることを検証してください。                     |  3  | D/V |
| 9.10.8 | 推論戦略のセキュリティテストには、不正な入力によるファジング、戦略の切り替えを強制するために設計された敵対的プロンプト、および各認知アプローチに対する境界条件テストが含まれていることを検証してください。        |  3  | D/V |

---

## 9.11 エージェントライフサイクル状態管理とセキュリティ

暗号的な監査証跡と定義された復旧手順を備えた、安全なエージェントの初期化、状態遷移、および終了。

|   #    | 説明                                                                                                                   | レベル | 役割  |
| :----: | -------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.11.1 | エージェントの初期化に、ハードウェアに基づく資格情報を用いた暗号学的アイデンティティの確立、およびエージェントID、タイムスタンプ、構成ハッシュ、初期化パラメータを含む不変の起動監査ログが含まれていることを検証してください。     |  1  | D/V |
| 9.11.2 | エージェントの状態遷移が暗号的に署名され、タイムスタンプが付与され、トリガーイベント、前の状態ハッシュ、新しい状態ハッシュ、および実行されたセキュリティ検証を含む完全なコンテキストとともにログに記録されていることを確認してください。 |  2  | D/V |
| 9.11.3 | エージェントのシャットダウン手順に、暗号消去または複数回上書きによる安全なメモリ消去、証明書機関への通知を含む認証情報の取り消し、および改ざん防止終結証明書の生成が含まれていることを確認してください。                 |  2  | D/V |
| 9.11.4 | エージェントの回復メカニズムが、暗号学的チェックサム（最低でも SHA-256）を使用して状態の整合性を検証し、破損が検出された場合には既知の正常な状態にロールバックし、自動アラートおよび手動承認の要件があることを確認してください。 |  3  | D/V |
| 9.11.5 | エージェントの永続化メカニズムが、エージェントごとのAES-256キーを使用して機密状態データを暗号化し、最大90日間の設定可能なスケジュールで安全なキーのローテーションをゼロダウンタイムで展開していることを検証してください。    |  3  | D/V |

---

## 9.12 ツール統合セキュリティフレームワーク

定義されたリスク評価および承認プロセスを備えた、動的ツールのロード、実行、および結果検証のためのセキュリティコントロール。

|   #    | 説明                                                                                                                           | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.12.1 | ツールの記述子に、必要な権限（読み取り/書き込み/実行）、リスクレベル（低/中/高）、リソース制限（CPU、メモリ、ネットワーク）、およびツールマニフェストに文書化された検証要件を指定するセキュリティメタデータが含まれていることを確認してください。 |  1  | D/V |
| 9.12.2 | ツールの実行結果が統合される前に、期待されるスキーマ（JSONスキーマ、XMLスキーマ）およびセキュリティポリシー（出力のサニタイズ、データ分類）に対して検証され、タイムアウト制限とエラーハンドリング手順が適用されていることを確認してください。   |  1  | D/V |
| 9.12.3 | ツールの操作ログに、特権使用状況、データアクセスパターン、実行時間、リソース消費、戻りコードを含む詳細なセキュリティコンテキストが含まれており、SIEM統合のための構造化ログが記録されていることを確認してください。                  |  2  | D/V |
| 9.12.4 | 動的ツール読み込みメカニズムがPKIインフラストラクチャを用いてデジタル署名を検証し、実行前にサンドボックス分離および権限検証を行う安全な読み込みプロトコルを実装していることを確認してください。                            |  2  | D/V |
| 9.12.5 | ツールのセキュリティ評価が、新しいバージョンに対して自動的にトリガーされることを確認し、静的解析、動的テスト、およびセキュリティチームのレビューを含む必須の承認ゲートが設けられ、文書化された承認基準とSLA要件があることを確認してください。     |  3  | D/V |

---

### 参考文献

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)


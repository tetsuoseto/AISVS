# C12 監視、ログ記録、および異常検知

## 制御目標

このセクションでは、モデルやその他のAIコンポーネントが何を見て、どのように動作し、何を返すかについてのリアルタイムおよびフォレンジック可視化を提供するための要件を示しており、これにより脅威を検出、トリアージ、および学習することが可能になります。

## C12.1 リクエスト＆レスポンスのログ記録

|   #    | 説明                                                                                             | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | すべてのユーザープロンプトとモデルの応答が、適切なメタデータ（例：タイムスタンプ、ユーザーID、セッションID、モデルバージョン）と共に記録されていることを確認してください。        |  1  | D/V |
| 12.1.2 | ログが適切な保持ポリシーとバックアップ手順を備えた、安全でアクセス制御されたリポジトリに保存されていることを確認してください。                                |  1  | D/V |
| 12.1.3 | ログ保存システムが、ログに含まれる機密情報を保護するために、保存時および転送時の暗号化を実装していることを確認してください。                                 |  1  | D/V |
| 12.1.4 | プロンプトおよび出力内の機密データがログ記録前に自動的に削除またはマスクされることを確認し、PII、認証情報、および専有情報に対する設定可能な削除ルールを備えていることを確認してください。 |  1  | D/V |
| 12.1.5 | ポリシー決定および安全フィルタリングの対策が、コンテンツモデレーションシステムの監査およびデバッグを可能にする十分な詳細で記録されていることを確認してください。               |  2  | D/V |
| 12.1.6 | 例えば、暗号学的署名や書き込み専用ストレージなどを通じて、ログの完全性が保護されていることを検証してください。                                        |  2  | D/V |

---

## C12.2 不正利用検出とアラート通知

|   #    | 説明                                                                                              | レベル | 役割  |
| :----: | ----------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | システムが既知の脱獄パターン、プロンプトインジェクションの試み、および署名ベースの検出を使用した敵対的入力を検出し、警告することを検証します。                         |  1  | D/V |
| 12.2.2 | システムが標準のログフォーマットとプロトコルを使用して、既存のセキュリティ情報およびイベント管理（SIEM）プラットフォームと統合されていることを検証します。                 |  1  | D/V |
| 12.2.3 | 強化されたセキュリティイベントに、モデル識別子、信頼度スコア、安全フィルタの判断など、AI特有のコンテキストが含まれていることを確認してください。                       |  2  | D/V |
| 12.2.4 | 行動異常検知が異常な会話パターン、過剰な再試行試行、または体系的な探査行動を識別することを確認してください。                                          |  2  | D/V |
| 12.2.5 | 潜在的なポリシー違反や攻撃の試みが検出された際に、リアルタイムのアラート機構がセキュリティチームに通知することを検証してください。                               |  2  | D/V |
| 12.2.6 | カスタムルールが、協調されたジャイルブレイク試行、プロンプトインジェクションキャンペーン、およびモデル抽出攻撃などのAI固有の脅威パターンを検出するために含まれていることを確認してください。 |  2  | D/V |
| 12.2.7 | 自動化されたインシデント対応ワークフローが、侵害されたモデルを隔離し、悪意のあるユーザーをブロックし、重要なセキュリティイベントをエスカレートできることを検証してください。          |  3  | D/V |

---

## C12.3 モデルドリフト検出

|   #    | 説明                                                                           | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | システムがモデルのバージョンや期間ごとに、精度、信頼度スコア、レイテンシ、エラー率などの基本的なパフォーマンス指標を追跡していることを確認してください。 |  1  | D/V |
| 12.3.2 | パフォーマンス指標が事前に定義された劣化しきい値を超えたり、ベースラインから著しく逸脱した場合に、自動アラートがトリガーされることを検証します。     |  2  | D/V |
| 12.3.3 | モデルの出力に事実誤認、不整合、または捏造された情報が含まれている場合に、それを検出しフラグを立てる幻覚検出モニターを検証してください。         |  2  | D/V |

---

## C12.4 パフォーマンスおよび動作のテレメトリー

|   #    | 説明                                                                        | レベル | 役割  |
| :----: | ------------------------------------------------------------------------- | :-: | :-: |
| 12.4.1 | リクエストレイテンシ、トークン消費量、メモリ使用量、スループットを含む運用指標が継続的に収集および監視されていることを確認してください。      |  1  | D/V |
| 12.4.2 | 成功率と失敗率が、エラータイプおよびその根本原因の分類とともに追跡されていることを確認してください。                        |  1  | D/V |
| 12.4.3 | リソース使用量の監視には、GPU/CPU使用率、メモリ消費量、およびストレージ要件が含まれ、閾値超過時のアラート通知があることを確認してください。 |  2  | D/V |

---

## C12.5 AI インシデント対応計画と実行

|   #    | 説明                                                                           | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | インシデント対応計画が、モデルの侵害、データポイズニング、敵対的攻撃を含むAI関連のセキュリティイベントに特に対応していることを確認してください。    |  1  | D/V |
| 12.5.2 | インシデント対応チームが、モデルの挙動や攻撃ベクトルを調査するためのAI専用のフォレンジックツールおよび専門知識にアクセスできることを確認してください。 |  2  | D/V |
| 12.5.3 | 事後分析にモデルの再訓練の考慮、安全フィルターの更新、セキュリティコントロールへの教訓の統合が含まれていることを確認してください。            |  3  | D/V |

---

## C12.6 AIパフォーマンス劣化検出

AIモデルのパフォーマンスと品質の劣化を時間経過で監視および検出する。

|   #    | 説明                                                          | レベル | 役割  |
| :----: | ----------------------------------------------------------- | :-: | :-: |
| 12.6.1 | モデルの精度、適合率、再現率、およびF1スコアが継続的に監視され、基準値と比較されていることを確認してください。    |  1  | D/V |
| 12.6.2 | データドリフト検出が、モデルの性能に影響を与える可能性のある入力分布の変化を監視していることを確認してください。    |  1  | D/V |
| 12.6.3 | 概念ドリフト検出が、入力と期待される出力の関係の変化を識別することを確認してください。                 |  2  | D/V |
| 12.6.4 | パフォーマンスの低下が自動警告を引き起こし、モデルの再訓練または置換ワークフローを開始することを確認してください。   |  2  | D/V |
| 12.6.5 | 劣化原因分析が、パフォーマンス低下をデータの変化、インフラ問題、または外部要因と相関付けていることを確認してください。 |  3  |  V  |

---

## C12.7 DAGの可視化とワークフローのセキュリティ

ワークフロー可視化システムを情報漏洩や改ざん攻撃から保護する。

|   #    | 説明                                                                                    | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | DAGの可視化データが保存または送信される前に、機密情報が除去されていることを確認してください。                                      |  1  | D/V |
| 12.7.2 | ワークフロービジュアライゼーションのアクセス制御が、認可されたユーザーのみがエージェントの意思決定経路と推論の軌跡を閲覧できることを確認してください。           |  1  | D/V |
| 12.7.3 | DAGデータの完全性が暗号署名および改ざん検知ストレージメカニズムによって保護されていることを検証する。                                  |  2  | D/V |
| 12.7.4 | ワークフロービジュアライゼーションシステムが、作成されたノードまたはエッジのデータを介したインジェクション攻撃を防ぐために、入力検証を実装していることを確認してください。 |  2  | D/V |
| 12.7.5 | リアルタイムDAG更新がレート制限され、可視化システムへのサービス拒否攻撃を防ぐために検証されていることを確認してください。                        |  3  | D/V |

---

## C12.8 プロアクティブなセキュリティ行動監視

能動的なエージェント行動分析によるセキュリティ脅威の検出と防止。

|   #    | 説明                                                                      | レベル | 役割  |
| :----: | ----------------------------------------------------------------------- | :-: | :-: |
| 12.8.1 | プロアクティブなエージェントの行動が実行される前に、リスク評価の統合によりセキュリティ検証されていることを確認してください。          |  1  | D/V |
| 12.8.2 | 自律的なイニシアチブのトリガーには、セキュリティコンテキストの評価および脅威ランドスケープのアセスメントが含まれていることを確認してください。 |  2  | D/V |
| 12.8.3 | プロアクティブな行動パターンが潜在的なセキュリティへの影響および意図しない結果について分析されていることを確認します。             |  2  | D/V |
| 12.8.4 | セキュリティに重要なプロアクティブな行動には、監査証跡を伴う明示的な承認チェーンが必要であることを確認してください。              |  3  | D/V |
| 12.8.5 | 行動異常検出が、妥協を示す可能性のあるプロアクティブエージェントのパターンの逸脱を識別することを検証する。                   |  3  | D/V |

---

## 参考文献

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)


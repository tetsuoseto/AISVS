# C12 モニタリング、ログ記録、および異常検知

## 管理目標

このセクションでは、モデルおよびその他のAIコンポーネントが何を見て、何を行い、何を返すかをリアルタイムおよびフォレンジックで可視化するための要件を提供し、脅威を検出、トリアージ、および学習できるようにします。

## C12.1 リクエストおよびレスポンスのログ記録

|   #    | 説明                                                                                             | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | すべてのユーザープロンプトとモデルの応答が、適切なメタデータ（例：タイムスタンプ、ユーザーID、セッションID、モデルバージョン）とともにログに記録されていることを確認してください。    |  1  | D/V |
| 12.1.2 | ログが適切な保持ポリシーおよびバックアップ手順を備えた、安全でアクセス制御されたリポジトリに保存されていることを確認してください。                              |  1  | D/V |
| 12.1.3 | ログストレージシステムが、ログに含まれる機密情報を保護するために、保存時と転送時の両方で暗号化を実装していることを確認してください。                             |  1  | D/V |
| 12.1.4 | プロンプトおよび出力内の機密データがログ記録前に自動的に削除またはマスクされることを確認し、PII、認証情報、および独自情報に対する構成可能な削除ルールを備えていることを検証してください。 |  1  | D/V |
| 12.1.5 | ポリシー決定および安全フィルタリングの操作が、コンテンツモデレーションシステムの監査とデバッグを可能にする十分な詳細でログに記録されていることを確認してください。              |  2  | D/V |
| 12.1.6 | ログの完全性が暗号署名や書き込み専用ストレージなどによって保護されていることを確認してください。                                               |  2  | D/V |

---

## C12.2 悪用検出とアラート通知

|   #    | 説明                                                                                             | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | システムが署名ベースの検出を使用して、既知の脱獄パターン、プロンプトインジェクションの試み、および敵対的入力を検出し、警告を出すことを確認してください。                   |  1  | D/V |
| 12.2.2 | システムが標準のログ形式およびプロトコルを使用して、既存のセキュリティ情報イベント管理（SIEM）プラットフォームと統合されていることを確認してください。                  |  1  | D/V |
| 12.2.3 | 強化されたセキュリティイベントに、モデル識別子、信頼度スコア、安全フィルターの判定などのAI固有のコンテキストが含まれていることを検証してください。                     |  2  | D/V |
| 12.2.4 | 行動異常検知が、異常な会話パターン、過剰な再試行回数、または体系的な探査行動を特定することを確認してください。                                        |  2  | D/V |
| 12.2.5 | リアルタイムのアラート機構が、潜在的なポリシー違反や攻撃試行が検出された際にセキュリティチームに通知することを確認してください。                               |  2  | D/V |
| 12.2.6 | カスタムルールが、協調的なジャイルブレイク試行、プロンプトインジェクションキャンペーン、およびモデル抽出攻撃を含むAI特有の脅威パターンを検出するために含まれていることを確認してください。 |  2  | D/V |
| 12.2.7 | 自動化されたインシデント対応ワークフローが、侵害されたモデルを隔離し、悪意のあるユーザーをブロックし、重要なセキュリティイベントをエスカレーションできることを検証します。          |  3  | D/V |

---

## C12.3 モデルドリフト検出

|   #    | 説明                                                                                 | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | システムがモデルのバージョンおよび期間を通じて、精度、信頼度スコア、レイテンシ、およびエラー率などの基本的なパフォーマンス指標を追跡していることを検証してください。 |  1  | D/V |
| 12.3.2 | パフォーマンス指標が事前に定められた劣化閾値を超えた場合、またはベースラインから大幅に逸脱した場合に、自動アラートが作動することを確認してください。         |  2  | D/V |
| 12.3.3 | モデルの出力に事実と異なる、不整合な、または捏造された情報が含まれている場合に、それを特定しフラグを立てることができるかどうか、幻覚検出モニターを検証してください。 |  2  | D/V |

---

## C12.4 パフォーマンスおよび動作テレメトリ

|   #    | 説明                                                                          | レベル | 役割  |
| :----: | --------------------------------------------------------------------------- | :-: | :-: |
| 12.4.1 | リクエスト遅延、トークン消費、メモリ使用量、スループットを含む運用指標が継続的に収集および監視されていることを確認してください。            |  1  | D/V |
| 12.4.2 | 成功率と失敗率が、エラータイプおよびその根本原因の分類とともに追跡されていることを確認してください。                          |  1  | D/V |
| 12.4.3 | リソース使用状況の監視にGPU/CPU使用率、メモリ消費量、ストレージ要件が含まれており、閾値を超えた場合にアラートが発生することを確認してください。 |  2  | D/V |

---

## C12.5 AI インシデント対応計画と実行

|   #    | 説明                                                                         | レベル | 役割  |
| :----: | -------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | インシデント対応計画が、モデルの侵害、データポイズニング、敵対的攻撃を含むAI関連のセキュリティイベントに特に対応していることを確認してください。  |  1  | D/V |
| 12.5.2 | インシデント対応チームが、モデルの挙動や攻撃ベクトルを調査するためのAI特有のフォレンジックツールと専門知識にアクセスできることを確認してください。 |  2  | D/V |
| 12.5.3 | 事後分析にモデルの再訓練の考慮、安全フィルターの更新、および教訓のセキュリティ制御への統合が含まれていることを確認してください。           |  3  | D/V |

---

## C12.5 AIパフォーマンス劣化検出

AIモデルの性能と品質の経時的な劣化を監視し検出する。

|   #    | 説明                                                              | レベル | 役割  |
| :----: | --------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | モデルの精度、適合率、再現率、およびF1スコアが継続的に監視され、ベースラインの閾値と比較されていることを確認してください。  |  1  | D/V |
| 12.5.2 | データドリフト検出がモデルのパフォーマンスに影響を与える可能性のある入力分布の変化を監視していることを確認してください。    |  1  | D/V |
| 12.5.3 | 概念ドリフト検出が、入力と期待される出力との関係の変化を識別することを確認してください。                    |  2  | D/V |
| 12.5.4 | パフォーマンスの低下が自動アラートをトリガーし、モデルの再訓練または置換のワークフローを開始することを確認してください。    |  2  | D/V |
| 12.5.5 | 劣化の根本原因分析が、性能低下とデータの変化、インフラストラクチャの問題、または外部要因と相関していることを確認してください。 |  3  |  V  |

---

## C12.6 DAG可視化とワークフローセキュリティ

ワークフロー可視化システムを情報漏洩や改ざん攻撃から保護する。

|   #    | 説明                                                                           | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------- | :-: | :-: |
| 12.6.1 | 保存または送信前に、DAG可視化データが機密情報を除去するように適切にサニタイズされていることを確認してください。                    |  1  | D/V |
| 12.6.2 | ワークフローの可視化アクセス制御が、許可されたユーザーのみがエージェントの意思決定経路および推論過程を閲覧できるようにしていることを確認してください。  |  1  | D/V |
| 12.6.3 | DAGのデータ整合性が暗号署名および改ざん検知ストレージ機構によって保護されていることを確認してください。                        |  2  | D/V |
| 12.6.4 | ワークフロー可視化システムが、細工されたノードまたはエッジデータを通じたインジェクション攻撃を防ぐために、入力検証を実装していることを確認してください。 |  2  | D/V |
| 12.6.5 | リアルタイムDAG更新がレート制限されており、可視化システムに対するサービス拒否攻撃を防ぐために検証されていることを確認してください。          |  3  | D/V |

---

## C12.7 プロアクティブなセキュリティ行動モニタリング

プロアクティブなエージェントの行動分析によるセキュリティ脅威の検出と防止。

|   #    | 説明                                                           | レベル | 役割  |
| :----: | ------------------------------------------------------------ | :-: | :-: |
| 12.7.1 | リスク評価の統合を用いて、実行前にプロアクティブエージェントの動作がセキュリティ検証されていることを確認してください。  |  1  | D/V |
| 12.7.2 | 自律的なイニシアチブのトリガーには、セキュリティコンテキストの評価と脅威状況の評価が含まれていることを確認してください。 |  2  | D/V |
| 12.7.3 | 積極的な行動パターンが潜在的なセキュリティ上の影響や意図しない結果について分析されていることを確認する。         |  2  | D/V |
| 12.7.4 | セキュリティに重要なプロアクティブな行動には、監査証跡のある明示的な承認チェーンが必要であることを確認してください。   |  3  | D/V |
| 12.7.5 | 行動異常検知が、侵害を示す可能性のあるプロアクティブエージェントのパターンの逸脱を識別することを検証してください。    |  3  | D/V |

---

## 参考文献

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


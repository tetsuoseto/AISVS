# C12 モニタリング、ログ記録、および異常検知

## 制御目標

このセクションでは、モデルおよびその他のAIコンポーネントが見るもの、行うこと、返すものに対してリアルタイムおよびフォレンジックの可視性を提供するための要件を示します。これにより、脅威を検出、トリアージ、および学習できるようにします。

## C12.1 リクエストおよびレスポンスのログ記録

|   #    | 説明                                                                                                  | レベル | 役割  |
| :----: | --------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | すべてのユーザープロンプトとモデルの応答が、適切なメタデータ（例：タイムスタンプ、ユーザーID、セッションID、モデルバージョン）とともにログに記録されていることを確認してください。         |  1  | D/V |
| 12.1.2 | ログが適切な保持ポリシーとバックアップ手順を備えた、安全でアクセス制御されたリポジトリに保存されていることを確認してください。                                     |  1  | D/V |
| 12.1.3 | ログストレージシステムが、ログに含まれる機密情報を保護するために、保存時および転送時の暗号化を実装していることを確認してください。                                   |  1  | D/V |
| 12.1.4 | プロンプトおよび出力内の機微なデータがログに記録される前に自動的に抹消またはマスクされることを確認し、PII、認証情報、および独自情報に対する設定可能な抹消ルールを備えていることを確認してください。 |  1  | D/V |
| 12.1.5 | ポリシー決定および安全フィルタリングのアクションが、コンテンツモデレーションシステムの監査およびデバッグを可能にするために十分な詳細でログ記録されていることを確認してください。            |  2  | D/V |
| 12.1.6 | ログの整合性が暗号署名や書き込み専用ストレージなどを通じて保護されていることを検証してください。                                                    |  2  | D/V |

---

## C12.2 不正使用検出とアラート管理

|   #    | 説明                                                                                                | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | システムが既知のジャイルブレイクパターン、プロンプトインジェクションの試み、および敵対的入力をシグネチャベースの検出で検出し警告することを確認してください。                    |  1  | D/V |
| 12.2.2 | システムが標準的なログ形式やプロトコルを使用して、既存のセキュリティ情報およびイベント管理（SIEM）プラットフォームと統合されていることを確認してください。                   |  1  | D/V |
| 12.2.3 | 強化されたセキュリティイベントに、モデル識別子、信頼度スコア、安全フィルターの判定など、AI固有のコンテキストが含まれていることを確認してください。                        |  2  | D/V |
| 12.2.4 | 異常な会話パターン、過剰な再試行回数、または体系的なプロービング行動を識別するために、行動異常検出が機能していることを検証してください。                              |  2  | D/V |
| 12.2.5 | 潜在的なポリシー違反や攻撃試行が検出された際に、リアルタイムのアラート機構がセキュリティチームに通知することを確認してください。                                  |  2  | D/V |
| 12.2.6 | AI固有の脅威パターン、例えば協調的な jailbreak 試行、プロンプトインジェクションキャンペーン、およびモデル抽出攻撃を検出するためのカスタムルールが含まれていることを確認してください。 |  2  | D/V |
| 12.2.7 | 自動化されたインシデント対応ワークフローが、侵害されたモデルを分離し、悪意のあるユーザーをブロックし、重大なセキュリティイベントをエスカレーションできることを検証します。             |  3  | D/V |

---

## C12.3 モデルドリフト検出

|   #    | 説明                                                                                | レベル | 役割  |
| :----: | --------------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | システムがモデルのバージョンや期間にわたって、精度、信頼度スコア、レイテンシ、およびエラー率などの基本的なパフォーマンス指標を追跡していることを確認してください。 |  1  | D/V |
| 12.3.2 | パフォーマンス指標が事前に定義された劣化閾値を超えるか、ベースラインから大幅に逸脱した場合に、自動アラートがトリガーされることを検証してください。         |  2  | D/V |
| 12.3.3 | モデル出力に事実誤認、一貫性の欠如、または捏造された情報が含まれている場合に、幻覚検出モニターがそれを特定しフラグを立てることを確認してください。         |  2  | D/V |

---

## C12.4 パフォーマンスおよび動作テレメトリー

|   #    | 説明                                                                       | レベル | 役割  |
| :----: | ------------------------------------------------------------------------ | :-: | :-: |
| 12.4.1 | リクエストの待ち時間、トークン消費量、メモリ使用量、スループットなどの運用指標が継続的に収集および監視されていることを確認してください。     |  1  | D/V |
| 12.4.2 | 成功率と失敗率が、エラータイプおよびその根本原因の分類とともに追跡されていることを確認してください。                       |  1  | D/V |
| 12.4.3 | リソース利用状況の監視には、GPU/CPU使用率、メモリ消費量、ストレージ要件が含まれ、閾値超過時にはアラートが発生することを確認してください。 |  2  | D/V |

---

## C12.5 AIインシデント対応計画と実行

|   #    | 説明                                                                           | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | インシデント対応計画が、モデルの妥協、データポイズニング、敵対的攻撃など、AIに関連するセキュリティイベントを具体的に扱っていることを確認してください。 |  1  | D/V |
| 12.5.2 | インシデント対応チームが、モデルの挙動や攻撃ベクトルを調査するためのAI専用のフォレンジックツールと専門知識にアクセスできることを確認してください。   |  2  | D/V |
| 12.5.3 | 事後分析にモデルの再トレーニングの検討、安全フィルターの更新、および学んだ教訓のセキュリティ制御への統合が含まれていることを確認してください。      |  3  | D/V |

---

## C12.5 AI パフォーマンス低下検出

時間の経過に伴うAIモデルの性能および品質の劣化を監視および検出する。

|   #    | 説明                                                                      | レベル | 役割  |
| :----: | ----------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | モデルの精度、適合率、再現率、およびF1スコアが継続的に監視され、基準値と比較されていることを確認してください。                |  1  | D/V |
| 12.5.2 | データドリフト検出が、モデルのパフォーマンスに影響を与える可能性のある入力分布の変化を監視していることを確認してください。           |  1  | D/V |
| 12.5.3 | 概念ドリフト検出が、入力と期待される出力の関係の変化を特定することを検証する。                                 |  2  | D/V |
| 12.5.4 | パフォーマンスの劣化が自動アラートを引き起こし、モデルの再訓練または置換ワークフローを開始することを確認してください。             |  2  | D/V |
| 12.5.5 | 劣化の根本原因分析が、パフォーマンスの低下とデータの変化、インフラストラクチャの問題、または外部要因との相関を確認することを検証してください。 |  3  |  V  |

---

## C12.6 DAGの可視化とワークフローのセキュリティ

ワークフロー可視化システムを情報漏洩および改ざん攻撃から保護する。

|   #    | 説明                                                                                   | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------------ | :-: | :-: |
| 12.6.1 | DAGの可視化データが保存または送信される前に、機密情報が除去されていることを検証してください。                                     |  1  | D/V |
| 12.6.2 | ワークフロービジュアライゼーションのアクセス制御が、許可されたユーザーのみがエージェントの意思決定経路および推論トレースを閲覧できることを検証してください。       |  1  | D/V |
| 12.6.3 | DAGデータの整合性が暗号署名および改ざん検知可能なストレージメカニズムによって保護されていることを検証する。                              |  2  | D/V |
| 12.6.4 | ワークフロービジュアライゼーションシステムが、作成されたノードまたはエッジのデータを通じたインジェクション攻撃を防ぐために入力検証を実装していることを確認してください。 |  2  | D/V |
| 12.6.5 | リアルタイムDAGの更新がレート制限されており、可視化システムに対するサービス拒否攻撃を防ぐために検証されていることを確認してください。                 |  3  | D/V |

---

## C12.7 プロアクティブなセキュリティ行動監視

プロアクティブなエージェント行動分析によるセキュリティ脅威の検出と予防。

|   #    | 説明                                                             | レベル | 役割  |
| :----: | -------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | リスク評価統合を用いて、実行前にプロアクティブエージェントの行動がセキュリティ検証されていることを確認してください。     |  1  | D/V |
| 12.7.2 | 自律的なイニシアティブのトリガーには、セキュリティコンテキストの評価と脅威の状況評価が含まれていることを確認してください。  |  2  | D/V |
| 12.7.3 | プロアクティブな行動パターンが潜在的なセキュリティ上の影響および意図しない結果について分析されていることを検証してください。 |  2  | D/V |
| 12.7.4 | セキュリティに重要なプロアクティブな行動には、監査証跡を伴う明示的な承認チェーンが必要であることを確認してください。     |  3  | D/V |
| 12.7.5 | 行動異常検知が、侵害を示す可能性のある能動的エージェントのパターンの逸脱を特定することを検証する。              |  3  | D/V |

---

## 参考文献

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


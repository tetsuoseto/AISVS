# C12 監視、ログ記録、および異常検知

## 管理目標

このセクションでは、モデルやその他のAIコンポーネントが何を見て、何を行い、何を返すかに関してリアルタイムおよびフォレンジックの可視性を提供するための要件を示しており、これにより脅威を検出、トリアージ、学習することが可能になります。

## C12.1 リクエストとレスポンスのログ記録

|   #    | 説明                                                                                              | レベル | 役割  |
| :----: | ----------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | すべてのユーザープロンプトとモデルの応答が、適切なメタデータ（例：タイムスタンプ、ユーザーID、セッションID、モデルバージョン）とともにログに記録されていることを確認する。         |  1  | D/V |
| 12.1.2 | ログが適切な保持ポリシーとバックアップ手順を備えた、安全でアクセス制御されたリポジトリに保存されていることを確認してください。                                 |  1  | D/V |
| 12.1.3 | ログストレージシステムが、ログに含まれる機密情報を保護するために、静止時および転送時の暗号化を実装していることを確認してください。                               |  1  | D/V |
| 12.1.4 | プロンプトおよび出力内の機密データが、ログ記録前に自動的に編集またはマスクされることを検証し、PII、認証情報、および独自情報に対する設定可能な編集ルールを備えていることを確認してください。 |  1  | D/V |
| 12.1.5 | ポリシーの決定および安全フィルタリングのアクションが、コンテンツモデレーションシステムの監査およびデバッグを可能にする十分な詳細で記録されていることを確認してください。            |  2  | D/V |
| 12.1.6 | 例えば、暗号署名や書き込み専用ストレージを通じてログの整合性が保護されていることを確認してください。                                              |  2  | D/V |

---

## C12.2 不正利用検出とアラート発報

|   #    | 説明                                                                                             | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | システムが署名ベースの検出を使用して、既知の脱獄パターン、プロンプトインジェクションの試み、および敵対的入力を検出し、警告を発することを確認してください。                  |  1  | D/V |
| 12.2.2 | システムが標準のログ形式およびプロトコルを使用して、既存のセキュリティ情報およびイベント管理（SIEM）プラットフォームと統合されていることを確認してください。               |  1  | D/V |
| 12.2.3 | 強化されたセキュリティイベントに、モデル識別子、信頼度スコア、安全フィルターの判断など、AI固有のコンテキストが含まれていることを確認してください。                     |  2  | D/V |
| 12.2.4 | 行動異常検出が異常な会話パターン、過剰な再試行回数、または体系的なプロービング行動を特定することを確認してください。                                     |  2  | D/V |
| 12.2.5 | 潜在的なポリシー違反や攻撃の試みが検出された際に、リアルタイムのアラート機構がセキュリティチームに通知することを確認してください。                              |  2  | D/V |
| 12.2.6 | AI特有の脅威パターンを検出するために、協調的なジェイルブレイク試行、プロンプトインジェクションキャンペーン、およびモデル抽出攻撃を含むカスタムルールが含まれていることを確認してください。 |  2  | D/V |
| 12.2.7 | 自動化されたインシデント対応ワークフローが、侵害されたモデルを隔離し、悪意のあるユーザーをブロックし、重要なセキュリティイベントをエスカレートできることを検証する。             |  3  | D/V |

---

## C12.3 モデルドリフト検出

|   #    | 説明                                                                                 | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | システムが精度、信頼度スコア、レイテンシ、およびエラーレートなどの基本的なパフォーマンス指標をモデルのバージョンや期間にわたって追跡していることを検証してください。 |  1  | D/V |
| 12.3.2 | パフォーマンス指標が事前に定義された劣化閾値を超えるか、基準値から大幅に逸脱した場合に、自動アラートがトリガーされることを検証してください。             |  2  | D/V |
| 12.3.3 | モデルの出力に事実誤認、不整合、または捏造された情報が含まれている場合に、その事例を特定して警告する幻覚検出モニターが機能していることを確認してください。      |  2  | D/V |

---

## C12.4 パフォーマンスおよび動作テレメトリ

|   #    | 説明                                                                             | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------ | :-: | :-: |
| 12.4.1 | リクエスト遅延、トークン消費量、メモリ使用量、およびスループットを含む運用指標が継続的に収集および監視されていることを確認してください。           |  1  | D/V |
| 12.4.2 | 成功率と失敗率が、エラータイプおよびその根本原因の分類とともに追跡されていることを確認してください。                             |  1  | D/V |
| 12.4.3 | リソース利用率の監視にGPU/CPU使用率、メモリ消費、およびストレージ要件が含まれ、しきい値を超えた場合のアラートが設定されていることを確認してください。 |  2  | D/V |

---

## C12.5 AIインシデント対応計画と実行

|   #    | 説明                                                                           | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | インシデント対応計画が、モデルの侵害、データポイズニング、敵対的攻撃を含むAI関連のセキュリティイベントに特に対応していることを確認してください。    |  1  | D/V |
| 12.5.2 | インシデント対応チームが、モデルの挙動や攻撃ベクトルを調査するためのAI専用のフォレンジックツールと専門知識にアクセスできることを確認してください。   |  2  | D/V |
| 12.5.3 | 事後分析には、モデルの再訓練に関する考慮、安全フィルターの更新、および教訓をセキュリティコントロールに統合することが含まれていることを確認してください。 |  3  | D/V |

---

## C12.5 AIパフォーマンス低下検出

AIモデルのパフォーマンスと品質の劣化を時間の経過とともに監視および検出する。

|   #    | 説明                                                                     | レベル | 役割  |
| :----: | ---------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | モデルの精度、適合率、再現率、およびF1スコアが継続的に監視され、ベースラインの閾値と比較されていることを確認してください。         |  1  | D/V |
| 12.5.2 | データドリフト検出が、モデルの性能に影響を与える可能性のある入力分布の変化を監視することを検証します。                    |  1  | D/V |
| 12.5.3 | 概念ドリフト検出が、入力と期待される出力との関係の変化を特定することを確認します。                              |  2  | D/V |
| 12.5.4 | パフォーマンスの低下が自動アラートをトリガーし、モデルの再トレーニングまたは置換ワークフローを開始することを検証します。           |  2  | D/V |
| 12.5.5 | 劣化の根本原因分析が、データの変化、インフラストラクチャの問題、または外部要因とパフォーマンスの低下を相関させていることを確認してください。 |  3  |  V  |

---

## C12.6 DAGの可視化とワークフローのセキュリティ

ワークフロー可視化システムを情報漏洩および改ざん攻撃から保護します。

|   #    | 説明                                                                           | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------- | :-: | :-: |
| 12.6.1 | DAGの可視化データが保存または送信される前に、機密情報が除去されていることを検証してください。                             |  1  | D/V |
| 12.6.2 | ワークフローの可視化アクセス制御が、権限のあるユーザーのみがエージェントの意思決定経路と推論の痕跡を閲覧できることを確認してください。          |  1  | D/V |
| 12.6.3 | DAGデータの整合性が暗号署名および改ざん検知可能なストレージ機構を通じて保護されていることを検証します。                        |  2  | D/V |
| 12.6.4 | ワークフロー可視化システムが、加工されたノードまたはエッジのデータを介したインジェクション攻撃を防ぐために入力検証を実装していることを確認してください。 |  2  | D/V |
| 12.6.5 | リアルタイムのDAG更新がレート制限され、検証されていることを確認し、可視化システムに対するサービス拒否攻撃を防止してください。             |  3  | D/V |

---

## C12.7 プロアクティブセキュリティ行動監視

能動的なエージェント行動分析によるセキュリティ脅威の検出と防止。

|   #    | 説明                                                                | レベル | 役割  |
| :----: | ----------------------------------------------------------------- | :-: | :-: |
| 12.7.1 | 実行前にリスク評価統合を用いて、プロアクティブなエージェントの行動がセキュリティ検証されていることを確認してください。       |  1  | D/V |
| 12.7.2 | 自律的なイニシアチブのトリガーには、セキュリティコンテキストの評価と脅威ランドスケープの評価が含まれていることを確認してください。 |  2  | D/V |
| 12.7.3 | 潜在的なセキュリティ影響および意図しない結果について、プロアクティブな行動パターンが分析されていることを検証してください。     |  2  | D/V |
| 12.7.4 | セキュリティに重要なプロアクティブな行動は、明示的な承認チェーンと監査証跡を必要とすることを検証してください。           |  3  | D/V |
| 12.7.5 | 行動異常検知が、侵害を示す可能性のあるプロアクティブエージェントのパターンの逸脱を特定することを検証してください。         |  3  | D/V |

---

## 参考文献

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


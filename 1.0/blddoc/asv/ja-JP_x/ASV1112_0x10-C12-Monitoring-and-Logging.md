# C12 モニタリング, ロギング & 異常検知

## 統制目標

このセクションは、モデルおよび他のAIコンポーネントが何を見て、何をし、何を返すかについて、リアルタイムおよび法医学的な可視性を提供するための要件を示します。これにより、脅威を検知し、トリアージし、そこから学ぶことができるようになります。

## C12.1 リクエストとレスポンスのログ

|   #    | 説明                                                                                                      | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 12.1.1 | すべてのユーザーのプロンプトとモデルの応答が、適切なメタデータ（例：タイムスタンプ、ユーザーID、セッションID、モデルバージョン）とともにログに記録されていることを検証してください。            |  1  | D/V |
| 12.1.2 | ログがセキュアでアクセス制御されたリポジトリに保存されており、適切な保持ポリシーとバックアップ手順を備えていることを確認する。                                         |  1  | D/V |
| 12.1.3 | ログストレージシステムが静止時および転送中の暗号化を実装して、ログに含まれる機密情報を保護していることを検証する。                                               |  1  | D/V |
| 12.1.4 | プロンプトおよび出力内の機微データが、ログに記録される前に自動的に伏字化またはマスキングされることを検証し、PII（個人を特定できる情報）、認証情報、および機密情報に対して設定可能な伏字化ルールを適用する。 |  1  | D/V |
| 12.1.5 | ポリシー決定と安全フィルタリングのアクションが、コンテンツモデレーションシステムの監査およびデバッグを可能にするのに十分な詳細で記録されていることを検証する。                         |  2  | D/V |
| 12.1.6 | ログの完全性が、例えば暗号署名や書き込み専用ストレージなどによって保護されていることを確認する。                                                        |  2  | D/V |

---

## C12.2 乱用検出とアラート通知

|   #    | 説明                                                                                        | レベル | 役割  |
| :----: | ----------------------------------------------------------------------------------------- | :-: | :-: |
| 12.2.1 | システムが既知の脱獄パターン、プロンプトインジェクションの試み、および敵対的入力を検知して警告し、署名ベースの検出を用いていることを検証する。                   |  1  | D/V |
| 12.2.2 | システムが既存のセキュリティ情報イベント管理（SIEM）プラットフォームと、標準的なログ形式およびプロトコルを使用して統合されていることを検証します。               |  1  | D/V |
| 12.2.3 | 強化されたセキュリティイベントに、AI特有の文脈として、モデル識別子、信頼度スコア、および安全フィルターの決定が含まれていることを確認してください。                |  2  | D/V |
| 12.2.4 | 行動異常検知が、異常な会話パターン、過度なリトライ試行、または体系的な探査行動を識別することを検証する。                                      |  2  | D/V |
| 12.2.5 | 潜在的なポリシー違反や攻撃の試みが検出された場合に、リアルタイムのアラート通知機構がセキュリティチームに通知することを検証する。                          |  2  | D/V |
| 12.2.6 | 協調的ジャイルブレイク試行、プロンプトインジェクションキャンペーン、モデル抽出攻撃を含むAI特有の脅威パターンを検出するためのカスタムルールが含まれていることを確認してください。 |  2  | D/V |
| 12.2.7 | 自動化されたインシデント対応ワークフローが、侵害されたモデルを隔離し、悪意のあるユーザーをブロックし、重大なセキュリティイベントをエスカレートできることを確認する。        |  3  | D/V |

---

## C12.3 モデルドリフト検出

|   #    | 説明                                                                                | レベル | 役割  |
| :----: | --------------------------------------------------------------------------------- | :-: | :-: |
| 12.3.1 | システムが、精度、信頼度スコア、レイテンシ、エラーレートといった基本的なパフォーマンス指標を、モデルバージョンおよび時間経過にわたって追跡していることを検証する。 |  1  | D/V |
| 12.3.2 | 性能指標が事前に定義された劣化閾値を超える場合、またはベースラインから大幅に逸脱する場合に、自動アラート通知がトリガーされることを検証する。            |  2  | D/V |
| 12.3.3 | 幻覚検出モニターが、モデルの出力に事実と異なる情報、矛盾する情報、または捏造された情報が含まれる場合を識別してフラグすることを検証する。              |  2  | D/V |

---

## C12.4 パフォーマンス & 挙動のテレメトリ

|   #    | 説明                                                                          | レベル | 役割  |
| :----: | --------------------------------------------------------------------------- | :-: | :-: |
| 12.4.1 | リクエストのレイテンシ、トークン消費量、メモリ使用量、スループットを含む運用指標が継続的に収集・監視されていることを検証する。             |  1  | D/V |
| 12.4.2 | 成功率と失敗率が、エラーの種類と根本原因の分類とともに追跡されていることを確認してください。                              |  1  | D/V |
| 12.4.3 | リソース利用状況の監視には、GPU/CPU使用率、メモリ使用量、およびストレージ要件が含まれており、閾値を超えた場合にアラートを発することを確認する。 |  2  | D/V |

---

## C12.5 AI インシデント対応計画と実行

|   #    | 説明                                                                           | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------- | :-: | :-: |
| 12.5.1 | インシデント対応計画が、AI関連のセキュリティイベントを特に扱い、モデルの侵害、データ汚染、敵対的攻撃を含むことを確認してください。           |  1  | D/V |
| 12.5.2 | インシデント対応チームが、モデルの挙動と攻撃ベクトルを調査するためのAI専用のフォレンジックツールと専門知識にアクセスできることを検証する。       |  2  | D/V |
| 12.5.3 | インシデント後の分析に、モデルの再訓練の検討事項、安全フィルターの更新、および得られた教訓をセキュリティコントロールへ統合することを含むことを確認する。 |  3  | D/V |

---

## C12.5 AI 性能低下検出

時間の経過とともに、AIモデルの性能と品質の低下を監視し、検出する。

|   #    | 説明                                                          | レベル | 役割  |
| :----: | ----------------------------------------------------------- | :-: | :-: |
| 12.5.1 | モデルの正解率、適合率、再現率、および F1スコアが継続的に監視され、ベースライン閾値と比較されていることを検証する。 |  1  | D/V |
| 12.5.2 | データドリフト検出が、モデルの性能に影響を与える可能性のある入力分布の変化を監視していることを検証してください。    |  1  | D/V |
| 12.5.3 | 概念ドリフト検出が、入力と期待出力の関係の変化を識別することを検証する。                        |  2  | D/V |
| 12.5.4 | パフォーマンスの低下が自動アラートをトリガーし、モデルの再学習または置換ワークフローを開始することを検証します。    |  2  | D/V |
| 12.5.5 | パフォーマンス低下とデータの変更、インフラの問題、外部要因との相関を、劣化の根本原因分析が示していることを検証する。  |  3  |  V  |

---

## C12.6 DAG 可視化 & ワークフローのセキュリティ

ワークフローの可視化システムを情報漏洩と改ざん攻撃から保護する。

|   #    | 説明                                                                             | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------ | :-: | :-: |
| 12.6.1 | 有向非巡回グラフ（DAG）の可視化データが、格納または送信前に機密情報を除去するようにサニタイズされていることを検証する。                  |  1  | D/V |
| 12.6.2 | ワークフローの可視化へのアクセス制御が、認可されたユーザーのみがエージェントの意思決定経路と推論の痕跡を閲覧できることを保証していることを確認してください。 |  1  | D/V |
| 12.6.3 | DAGデータの整合性が、暗号署名および改ざん検知可能な保存機構によって保護されていることを検証する。                             |  2  | D/V |
| 12.6.4 | ワークフローの可視化システムが、細工されたノードまたはエッジデータを介して発生するインジェクション攻撃を防ぐための入力検証を実装していることを検証する。   |  2  | D/V |
| 12.6.5 | 可視化システムへのDoS攻撃を防ぐため、リアルタイムのDAG（有向非巡回グラフ）更新がレート制限され、検証されていることを確認する。             |  3  | D/V |

---

## C12.7 積極的なセキュリティ挙動モニタリング

プロアクティブなエージェントの挙動分析を通じたセキュリティ脅威の検出と予防。

|   #    | 説明                                                        | レベル | 役割  |
| :----: | --------------------------------------------------------- | :-: | :-: |
| 12.7.1 | 実行前に、リスク評価の統合を伴い、プロアクティブなエージェントの挙動がセキュリティ検証済みであることを確認する。  |  1  | D/V |
| 12.7.2 | 自律的イニシアティブのトリガーに、セキュリティコンテキスト評価と脅威動向評価が含まれていることを検証する。     |  2  | D/V |
| 12.7.3 | プロアクティブな行動パターンが潜在的なセキュリティへの影響と予期せぬ結果について分析されていることを検証する。   |  2  | D/V |
| 12.7.4 | セキュリティ上重要な予防的アクションが、監査証跡を備えた明示的な承認チェーンを必要とすることを検証する。      |  3  | D/V |
| 12.7.5 | 行動異常検知が、侵害を示す可能性のあるプロアクティブエージェントのパターンの逸脱を検出することを検証してください。 |  3  | D/V |

---

## 参考文献

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


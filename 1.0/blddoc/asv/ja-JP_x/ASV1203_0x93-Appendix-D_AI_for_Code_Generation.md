# 付録 D: AIを活用したセキュアコーディングのガバナンスと検証

## 目的

本章は、ソフトウェア開発におけるAIを活用したコーディングツールの安全かつ効果的な利用のための基本的な組織統制を定義し、SDLC全体にわたりセキュリティと追跡可能性を確保します。

---

## AD.1 AI支援の セキュアコーディング ワークフロー

既存のセキュリティゲートを弱体化させることなく、組織の secure‑software‑development ライフサイクル（SSDLC）に AI ツールを統合する。

|   #    | 説明                                                                           | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------- | :-: | :-: |
| AD.1.1 | 文書化されたワークフローが、AIツールがいつ・どのようにコードを生成・リファクタリング・レビューできるかを説明していることを確認する。          |  1  | D/V |
| AD.1.2 | ワークフローがSSDLCの各フェーズ（設計、実装、コードレビュー、テスト、デプロイ）に対応していることを検証してください。                |  2  |  D  |
| AD.1.3 | AI‑生成コードに対して、脆弱性密度、mean‑time‑to‑detect などの指標が収集され、人間‑のみのベースラインと比較されることを検証する。 |  3  | D/V |

---

## AD.2 AIツールの適格性評価と脅威モデリング

AI コーディングツールは、導入前にセキュリティ機能、リスク、サプライ‑チェーンへの影響を評価されるべきです。

|   #    | 説明                                                                       | レベル | 役割  |
| :----: | ------------------------------------------------------------------------ | :-: | :-: |
| AD.2.1 | 各AIツールの脅威モデルが悪用、モデル反転、データ漏洩、および依存関係チェーンのリスクを特定していることを検証する。               |  1  | D/V |
| AD.2.2 | ツール評価が、ローカルコンポーネントの静的・動的解析とSaaSエンドポイントの評価（TLS、認証/認可、ログ記録）を含むことを確認してください。 |  2  |  D  |
| AD.2.3 | 評価が公認のフレームワークに従っていることを確認し、主要バージョン変更後に再実施されることを確認する。                      |  3  | D/V |

---

## AD.3 セキュア プロンプト & コンテキスト管理

AIモデルのプロンプトやコンテキストを作成する際に、機密情報、独自コード、個人データの流出を防ぐ。

|   #    | 説明                                                                     | レベル | 役割  |
| :----: | ---------------------------------------------------------------------- | :-: | :-: |
| AD.3.1 | 書面による指針が、プロンプト内で秘密情報、認証情報、または機密データを送信することを禁止していることを確認してください。           |  1  | D/V |
| AD.3.2 | 技術的統制（クライアントサイドの伏字化、承認済みのコンテキストフィルター）が機微なアーティファクトを自動的に除去することを検証してください。 |  2  |  D  |
| AD.3.3 | プロンプトとレスポンスがトークン化され、通信中および保存時に暗号化され、保持期間がデータ分類ポリシーに準拠していることを検証します。     |  3  | D/V |

---

## AD.4 AI‑生成コードの検証

コードがマージまたはデプロイされる前に、AIの出力によって導入された脆弱性を検出し、是正してください。

|   #    | 説明                                                                                               | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------------------------ | :-: | :-: |
| AD.4.1 | AIが生成したコードは必ず人間によるコードレビューの対象とされることを検証する。                                                         |  1  | D/V |
| AD.4.2 | AI‑generatedコードを含むすべてのプルリクエストに対して自動スキャナー（SAST/IAST/DAST）が実行され、重大な所見がある場合にはマージをブロックすることを検証してください。 |  2  |  D  |
| AD.4.3 | 差分ファズテストやプロパティベースのテストが、入力検証や認可ロジックなどのセキュリティ上重要な挙動を証明することを確認する。                                   |  3  | D/V |

---

## AD.5 コード提案の説明可能性と追跡可能性

監査人と開発者に、提案がなぜ出されたのか、そしてそれがどのように進化したのかについて洞察を提供する。

|   #    | 説明                                                                        | レベル | 役割  |
| :----: | ------------------------------------------------------------------------- | :-: | :-: |
| AD.5.1 | プロンプト/レスポンスのペアがコミットIDとともにログに記録されていることを確認する。                               |  1  | D/V |
| AD.5.2 | 開発者が提案を裏付けるモデルの出典情報（トレーニングの抜粋、ドキュメント）を提示できることを確認する。                       |  2  |  D  |
| AD.5.3 | 説明可能性レポートが設計成果物とともに保存され、セキュリティレビューで参照されていることを確認し、ISO/IEC 42001の追跡性原則を満たす。 |  3  | D/V |

---

## AD.6 継続的なフィードバックとモデルのファインチューニング

時間の経過とともにモデルのセキュリティ性能を向上させつつ、ネガティブ・ドリフトを防ぐ。

|   #    | 説明                                                                                                | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------------------------- | :-: | :-: |
| AD.6.1 | 開発者が不安全または不適合な提案をフラグ付けできること、そしてフラグが追跡されることを確認します。                                                 |  1  | D/V |
| AD.6.2 | 集約されたフィードバックが、定期的なファインチューニングまたは取得型生成に反映されることを、検証済みのセキュア‑コーディングコーパス（例：OWASP Cheat Sheets）を用いて確認する。 |  2  |  D  |
| AD.6.3 | 各ファインチューニングの後に、クローズドループ評価ハーネスが回帰テストを実行することを確認する。展開前には、セキュリティ指標が以前のベースラインを満たすか、またはそれを上回る必要がある。     |  3  | D/V |

---

### 参考文献

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)


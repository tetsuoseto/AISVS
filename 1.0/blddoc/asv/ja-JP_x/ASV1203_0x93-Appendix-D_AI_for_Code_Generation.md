# 付録D：AI支援セキュアコーディングガバナンスと検証

## 目的

この章では、ソフトウェア開発中にAI支援コーディングツールを安全かつ効果的に使用するための基本的な組織的管理策を定義し、SDLC全体にわたるセキュリティとトレーサビリティを確保します。

---

## AD.1 AI支援セキュアコーディングワークフロー

既存のセキュリティゲートを弱めることなく、組織のセキュアソフトウェア開発ライフサイクル（SSDLC）にAIツールを統合する。

|   #    | 説明                                                                     | レベル | 役割  |
| :----: | ---------------------------------------------------------------------- | :-: | :-: |
| AD.1.1 | AIツールがコードを生成、リファクタリング、またはレビューするタイミングと方法を文書化したワークフローを確認してください。          |  1  | D/V |
| AD.1.2 | ワークフローが各SSDLCフェーズ（設計、実装、コードレビュー、テスト、デプロイメント）に対応していることを確認してください。        |  2  |  D  |
| AD.1.3 | AI生成コードに関して、メトリクス（例：脆弱性密度、平均検出時間）が収集され、人間のみのベースラインと比較されていることを確認してください。 |  3  | D/V |

---

## AD.2 AIツールの適格性評価および脅威モデリング

AIコーディングツールは、導入前にセキュリティ機能、リスク、およびサプライチェーンへの影響について評価を行うことを確実にしてください。

|   #    | 説明                                                                             | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------ | :-: | :-: |
| AD.2.1 | 各AIツールの脅威モデルが、不正使用、モデル反転、データ漏洩、および依存チェーンのリスクを特定していることを確認してください。                |  1  | D/V |
| AD.2.2 | ツール評価に、ローカルコンポーネントの静的/動的解析およびSaaSエンドポイント（TLS、認証/認可、ログ記録）の評価が含まれていることを確認してください。 |  2  |  D  |
| AD.2.3 | 評価が認識されたフレームワークに従っていることを確認し、主要なバージョン変更後に再実施されることを確認してください。                     |  3  | D/V |

---

## AD.3 セキュアプロンプト＆コンテキスト管理

AIモデルのプロンプトやコンテキストを構築する際に、機密情報、専有コード、および個人データの漏洩を防止してください。

|   #    | 説明                                                                            | レベル | 役割  |
| :----: | ----------------------------------------------------------------------------- | :-: | :-: |
| AD.3.1 | 書面による指示が、プロンプト内で秘密情報、認証情報、または機密データを送信することを禁止していることを確認してください。                  |  1  | D/V |
| AD.3.2 | 技術的コントロール（クライアント側の編集、承認済みコンテキストフィルター）が機密情報を自動的に除去することを検証してください。               |  2  |  D  |
| AD.3.3 | プロンプトとレスポンスがトークン化され、転送中および保存時に暗号化されていること、および保持期間がデータ分類ポリシーに準拠していることを検証してください。 |  3  | D/V |

---

## AD.4 AI生成コードの検証

コードがマージまたはデプロイされる前に、AIによって生成された出力に導入された脆弱性を検出し、修復します。

|   #    | 説明                                                                                     | レベル | 役割  |
| :----: | -------------------------------------------------------------------------------------- | :-: | :-: |
| AD.4.1 | AI生成コードは常に人間によるコードレビューを受けることを確認してください。                                                 |  1  | D/V |
| AD.4.2 | すべてのAI生成コードを含むプルリクエストで自動スキャナー（SAST/IAST/DAST）が実行され、重大な検出結果がある場合はマージをブロックすることを確認してください。 |  2  |  D  |
| AD.4.3 | 差分ファズテストやプロパティベーステストが、セキュリティクリティカルな動作（例：入力検証、認可ロジック）を証明することを確認してください。                  |  3  | D/V |

---

## AD.5 コード提案の説明可能性とトレーサビリティ

監査人や開発者に、なぜ提案がなされたのか、そしてその提案がどのように進化したのかについての洞察を提供する。

|   #    | 説明                                                                                 | レベル | 役割  |
| :----: | ---------------------------------------------------------------------------------- | :-: | :-: |
| AD.5.1 | プロンプト／レスポンスのペアがコミットIDとともに記録されていることを確認してください。                                       |  1  | D/V |
| AD.5.2 | 開発者が提案を裏付けるモデルの引用（トレーニングスニペット、ドキュメント）を表示できることを検証してください。                            |  2  |  D  |
| AD.5.3 | 説明可能性レポートが設計成果物と共に保存され、セキュリティレビューで参照され、ISO/IEC 42001のトレーサビリティ原則を満たしていることを確認してください。 |  3  | D/V |

---

## AD.6 継続的フィードバックとモデル微調整

負のドリフトを防ぎながら、時間の経過とともにモデルのセキュリティ性能を向上させる。

|   #    | 説明                                                                                              | レベル | 役割  |
| :----: | ----------------------------------------------------------------------------------------------- | :-: | :-: |
| AD.6.1 | 開発者が安全でない、または非準拠の提案にフラグを立てることができ、そのフラグが追跡されていることを確認してください。                                      |  1  | D/V |
| AD.6.2 | 集約されたフィードバックが、検証済みのセキュアコーディングコーパス（例：OWASPチートシート）を用いた定期的なファインチューニングまたはリトリーバル強化生成に反映されていることを確認する。 |  2  |  D  |
| AD.6.3 | 閉ループ評価ハーネスが各ファインチューン後に回帰テストを実行することを検証してください。セキュリティメトリクスは、展開前に以前のベースラインを満たすか、それを上回らなければなりません。    |  3  | D/V |

---

### 参考文献

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)


# 付録D：AI支援によるセキュアコーディングのガバナンスと検証

## 目的

この章では、ソフトウェア開発中にAI支援コーディングツールを安全かつ効果的に使用するための基礎的な組織的管理策を定義し、SDLC全体でのセキュリティとトレーサビリティを確保します。

---

## AD.1 AI支援セキュアコーディングワークフロー

既存のセキュリティゲートを弱めることなく、組織の安全なソフトウェア開発ライフサイクル（SSDLC）にAIツールを統合する。

|   #    | 説明                                                                       | レベル | 役割  |
| :----: | ------------------------------------------------------------------------ | :-: | :-: |
| AD.1.1 | 文書化されたワークフローが、AIツールがコードを生成、リファクタリング、またはレビューするタイミングと方法を説明していることを確認してください。 |  1  | D/V |
| AD.1.2 | ワークフローが各SSDLCフェーズ（設計、実装、コードレビュー、テスト、展開）に対応していることを確認してください。               |  2  |  D  |
| AD.1.3 | AI生成コードに対してメトリクス（例：脆弱性密度、平均検出時間）が収集され、人間のみの基準値と比較されていることを確認してください。       |  3  | D/V |

---

## AD.2 AIツールの資格評価と脅威モデリング

AIコーディングツールは、採用前にセキュリティ機能、リスク、およびサプライチェーンへの影響について評価を行うことを確実にしてください。

|   #    | 説明                                                                              | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------- | :-: | :-: |
| AD.2.1 | 各AIツールの脅威モデルが、誤用、モデル逆転、データ漏洩、および依存関係チェーンのリスクを特定していることを確認してください。                 |  1  | D/V |
| AD.2.2 | ツール評価には、ローカルコンポーネントの静的/動的解析およびSaaSエンドポイント（TLS、認証/認可、ログ記録）の評価が含まれていることを確認してください。 |  2  |  D  |
| AD.2.3 | 評価が認識されたフレームワークに従っていることを確認し、主要なバージョン変更後に再実施されることを確認してください。                      |  3  | D/V |

---

## AD.3 セキュアプロンプト＆コンテキスト管理

AIモデルのプロンプトやコンテキストを構築する際に、秘密情報、専有コード、および個人データの漏洩を防止してください。

|   #    | 説明                                                                          | レベル | 役割  |
| :----: | --------------------------------------------------------------------------- | :-: | :-: |
| AD.3.1 | 書面による指示に、プロンプト内で秘密情報、認証情報、または機密データを送信することを禁止していることを確認してください。                |  1  | D/V |
| AD.3.2 | 技術的な制御（クライアント側の抹消、承認されたコンテキストフィルター）が自動的に機密情報を除去することを検証してください。               |  2  |  D  |
| AD.3.3 | プロンプトと応答がトークン化され、転送中および保存時に暗号化されていること、ならびに保持期間がデータ分類ポリシーに準拠していることを検証してください。 |  3  | D/V |

---

## AD.4 AI生成コードの検証

コードがマージまたはデプロイされる前に、AI出力によって導入された脆弱性を検出して修復します。

|   #    | 説明                                                                                        | レベル | 役割  |
| :----: | ----------------------------------------------------------------------------------------- | :-: | :-: |
| AD.4.1 | AI生成コードが常に人間のコードレビューを受けるように確認してください。                                                      |  1  | D/V |
| AD.4.2 | AI生成コードを含むすべてのプルリクエストに対して自動スキャナー（SAST/IAST/DAST）が実行され、重大な検出結果がある場合はマージをブロックすることを確認してください。 |  2  |  D  |
| AD.4.3 | 差分ファズテストまたはプロパティベースのテストが、セキュリティクリティカルな動作（例：入力検証、認可ロジック）を証明していることを検証してください。                |  3  | D/V |

---

## AD.5 コード提案の説明性と追跡可能性

監査人や開発者に対して、なぜ提案がされたのか、そしてその提案がどのように進化したのかについての洞察を提供する。

|   #    | 説明                                                                                           | レベル | 役割  |
| :----: | -------------------------------------------------------------------------------------------- | :-: | :-: |
| AD.5.1 | プロンプト/レスポンスのペアがコミットIDと共に記録されていることを確認してください。                                                  |  1  | D/V |
| AD.5.2 | 開発者が提案をサポートするモデルの引用（トレーニングスニペット、ドキュメント）を表示できることを確認してください。                                    |  2  |  D  |
| AD.5.3 | 説明可能性レポートが設計成果物とともに保存され、セキュリティレビューで参照されていることを確認し、ISO/IEC 42001のトレーサビリティ原則を満たしていることを確認してください。 |  3  | D/V |

---

## AD.6 継続的フィードバックとモデルのファインチューニング

モデルのセキュリティ性能を時間経過とともに向上させつつ、負のドリフトを防止する。

|   #    | 説明                                                                                                | レベル | 役割  |
| :----: | ------------------------------------------------------------------------------------------------- | :-: | :-: |
| AD.6.1 | 開発者が安全でない、または非準拠な提案にフラグを立てられること、そしてそのフラグが追跡されることを検証してください。                                        |  1  | D/V |
| AD.6.2 | 集約されたフィードバックが、検証済みのセキュアコーディングコーパス（例：OWASPチートシート）を用いた定期的なファインチューニングやリトリーバル増強生成に反映されていることを確認してください。 |  2  |  D  |
| AD.6.3 | 閉ループ評価ハーネスが各ファインチューニング後に回帰テストを実行することを検証してください。セキュリティメトリクスは、展開前に前のベースラインを満たすかそれを上回っている必要があります。     |  3  | D/V |

---

### 参考文献

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)


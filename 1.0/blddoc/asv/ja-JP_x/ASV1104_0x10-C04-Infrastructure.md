# C4 インフラストラクチャ、構成および展開のセキュリティ

## 制御目標

AIインフラストラクチャは、特権昇格、サプライチェーンの改ざん、および横方向の移動に対して、セキュアな構成、実行時の分離、信頼されたデプロイメントパイプライン、および包括的なモニタリングを通じて強化されなければなりません。検証済みかつ承認されたインフラストラクチャコンポーネントのみが、セキュリティ、整合性、および監査可能性を確保する制御されたプロセスを経て本番環境に到達します。

---

## C4.1 ランタイム環境の分離

OSレベルのアイソレーションプリミティブを通じて、コンテナの逸脱や権限昇格を防止します。

|   #   | 説明                                                                                                                   | レベル | 役割  |
| :---: | -------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.1.1 | すべてのAIワークロードが、例えばコンテナの場合に不必要なLinuxの機能を削除するなど、オペレーティングシステム上で必要最小限の権限で実行されていることを確認してください。                              |  1  | D/V |
| 4.1.2 | サンドボックス、seccompプロファイル、AppArmor、SELinuxまたは類似の技術など、悪用を制限する技術によりワークロードが保護されていること、およびその設定が適切であることを確認してください。              |  1  | D/V |
| 4.1.3 | ワークロードが読み取り専用のルートファイルシステムで実行されていること、および書き込み可能なマウントポイントは明示的に定義され、制限付きオプション（例：noexec、nosuid、nodev）で強化されていることを確認してください。 |  2  | D/V |
| 4.1.4 | ランタイムモニタリングが特権昇格およびコンテナ脱出の動作を検出し、不正なプロセスを自動的に終了することを確認してください。                                                        |  2  | D/V |
| 4.1.5 | 高リスクのAIワークロードがリモート認証に成功した後にのみ、ハードウェア分離環境（例：TEE、信頼されたハイパーバイザー、ベアメタルノード）で実行されることを検証してください。                             |  3  | D/V |

---

## C4.2 セキュアなビルド＆デプロイメントパイプライン

再現可能なビルドと署名付きアーティファクトを通じて、暗号的整合性とサプライチェーンのセキュリティを確保します。

|   #   | 説明                                                                               | レベル | 役割  |
| :---: | -------------------------------------------------------------------------------- | :-: | :-: |
| 4.2.1 | ビルドが再現可能であることを検証し、ビルド成果物に対して適切に署名された出自メタデータを生成し、それが独立して検証可能であることを確認してください。       |  1  | D/V |
| 4.2.2 | ビルドがソフトウェア部品表（SBOM）を生成し、展開が受け入れられる前に署名されていることを確認してください。                          |  2  | D/V |
| 4.2.3 | ビルド成果物（例：コンテナイメージ）の署名および発生元メタデータがデプロイ時に検証されていることを確認し、検証されていない成果物は拒否されるようにしてください。 |  2  | D/V |

---

## C4.3 ネットワークセキュリティとアクセス制御

デフォルト拒否ポリシーと暗号化通信を用いて、ゼロトラストネットワーキングを実装します。

|   #   | 説明                                                                                                                     | レベル | 役割  |
| :---: | ---------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.3.1 | ネットワークポリシーがデフォルトでの拒否（IngressおよびEgress）を強制し、必要なサービスのみが明示的に許可されていることを確認してください。                                           |  1  | D/V |
| 4.3.2 | 管理者アクセスプロトコル（例：SSH、RDP）およびクラウドメタデータサービスへのアクセスが制限されており、強力な認証を必要とすることを確認してください。                                          |  1  | D/V |
| 4.3.3 | 送信トラフィックが承認された宛先に制限され、すべてのリクエストがログ記録されていることを確認してください。                                                                  |  2  | D/V |
| 4.3.4 | インターサービス通信が証明書検証および定期的な自動ローテーションを伴う相互TLSを使用していることを確認してください。                                                            |  2  | D/V |
| 4.3.5 | AIのワークロードおよび環境（開発、テスト、本番）が、直接のインターネットアクセスや共有IAMロール、セキュリティグループ、環境間接続なしで、分離されたネットワークセグメント（VPC/VNet）内で実行されていることを検証してください。 |  2  | D/V |

## C4.4 シークレットおよび暗号鍵管理

シークレットと暗号鍵を、安全なストレージ、自動ローテーション、および強力なアクセス制御で保護します。

|   #   | 説明                                                                                                                        | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.4.1 | シークレットが専用のシークレット管理システムに保存されており、保存時に暗号化され、アプリケーションのワークロードから分離されていることを確認してください。                                             |  1  | D/V |
| 4.4.2 | 暗号鍵がハードウェアベースのモジュール（例：HSM、クラウドKMS）で生成および保存されていることを検証してください。                                                               |  1  | D/V |
| 4.4.3 | 本番環境の機密情報へのアクセスには強固な認証が必要であることを確認してください。                                                                                  |  1  | D/V |
| 4.4.4 | シークレットが専用のシークレット管理システムを通じてランタイムでアプリケーションに展開されていることを確認してください。シークレットは決してソースコード、設定ファイル、ビルド成果物、コンテナイメージ、または環境変数に埋め込まれてはいけません。 |  1  | D/V |
| 4.4.5 | シークレットのローテーションが自動化されていることを確認してください。                                                                                       |  2  | D/V |

---

## C4.5 AI ワークロードのサンドボックス化と検証

信頼できないAIモデルをセキュアなサンドボックス内に隔離し、信頼できる実行環境（TEE）および機密コンピューティング技術を用いて機密性の高いAIワークロードを保護します。

|   #   | 説明                                                                                | レベル | 役割  |
| :---: | --------------------------------------------------------------------------------- | :-: | :-: |
| 4.5.1 | 外部または信頼されていないAIモデルが隔離されたサンドボックスで実行されることを確認してください。                                 |  1  | D/V |
| 4.5.2 | サンドボックス化されたワークロードはデフォルトでアウトバウンドのネットワーク接続がないことを確認し、必要なアクセスは明示的に定義されていることを確認してください。 |  1  | D/V |
| 4.5.3 | モデルまたはワークロードの読み込み前にワークロードの証明が行われ、信頼された実行環境の暗号学的証明が確保されていることを確認してください。             |  2  | D/V |
| 4.5.4 | 機密ワークロードが、ハードウェア強制の分離、メモリ暗号化、および整合性保護を提供する信頼できる実行環境（TEE）内で実行されることを検証します。          |  3  | D/V |
| 4.5.5 | 秘密の推論サービスが、暗号化計算により封印されたモデル重みと保護された実行環境を通じて、モデル抽出を防止していることを検証してください。              |  3  | D/V |
| 4.5.6 | 信頼できる実行環境のオーケストレーションに、ライフサイクル管理、リモート認証、および暗号化通信チャネルが含まれていることを検証します。               |  3  | D/V |
| 4.5.7 | 安全なマルチパーティ計算（SMPC）が、個々のデータセットやモデルパラメータを公開することなく、共同でのAIトレーニングを可能にすることを検証してください。    |  3  | D/V |

---

## C4.6 AIインフラストラクチャリソース管理、バックアップおよびリカバリー

リソース枯渇攻撃を防止し、クォータと監視を通じて公平なリソース配分を確保します。安全なバックアップ、テスト済みの復旧手順、および災害復旧機能を通じてインフラの回復力を維持します。

|   #   | 説明                                                                                                                                  | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.6.1 | Kubernetes ResourceQuotasなどを使用して、ワークロードのリソース消費が適切に制限されていることを確認し、サービス拒否攻撃を軽減します。                                                     |  2  | D/V |
| 4.6.2 | リソース枯渇が発生した際に、自動化保護（例：レート制限やワークロードの分離）が、定義されたCPU、メモリ、またはリクエスト閾値を超えた時点で確実に作動することを検証してください。                                           |  2  | D/V |
| 4.6.3 | バックアップシステムが別個の認証情報を使用した分離されたネットワークで稼働していることを確認し、ストレージシステムがエアギャップネットワークで運用されているか、不正な改ざんを防ぐためにWORM（ワンスライトリードメニー）保護を実装していることを確認してください。 |  2  | D/V |

---

## C4.7 AI ハードウェアセキュリティ

GPU、TPU、および専用のAIアクセラレータを含む、AI専用のハードウェアコンポーネントを保護します。

|   #   | 説明                                                                                                              | レベル | 役割  |
| :---: | --------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.7.1 | ワークロードの実行前に、ハードウェアベースの認証メカニズム（例：TPM、DRTM、または同等のもの）を使用してAIアクセラレータの整合性が検証されていることを確認してください。                        |  2  | D/V |
| 4.7.2 | パーティショニング機構によるアクセラレータ（GPU）メモリのワークロード間の分離と、ジョブ間のメモリサニタイズが行われていることを確認してください。                                      |  2  | D/V |
| 4.7.3 | ハードウェアセキュリティモジュール（HSM）が、AIモデルの重みおよび暗号鍵をFIPS 140-3 レベル3またはCommon Criteria EAL4+の認証で保護していることを検証してください。            |  3  | D/V |
| 4.7.4 | アクセラレーターファームウェア（GPU/TPU/NPUs）がバージョン固定され、署名され、起動時に認証されていることを確認する。署名されていないファームウェアやデバッグ用ファームウェアはブロックされる。           |  2  | D/V |
| 4.7.5 | VRAM とオンパッケージメモリがジョブやテナント間でゼロクリアされていること、そしてデバイスリセットポリシーがテナント間でのデータ残留を防止していることを確認してください。                         |  2  | D/V |
| 4.7.6 | パーティショニング／分離機能（例：MIG／VMパーティショニング）がテナントごとに適用され、パーティション間のピアツーピアメモリアクセスを防止していることを確認してください。                         |  2  | D/V |
| 4.7.7 | アクセラレータインターコネクト（NVLink/PCIe/InfiniBand/RDMA/NCCL）が承認されたトポロジーおよび認証済みエンドポイントに制限されていることを確認する。平文によるテナント間リンクは許可されない。 |  3  | D/V |
| 4.7.8 | アクセラレータのテレメトリ（電力、温度、ECC、パフォーマンスカウンター）がSIEM/OTelにエクスポートされ、サイドチャネルや潜在的な不正通信を示す異常に対してアラートが発生することを確認してください。         |  3  |  D  |

---

## C4.8 エッジおよび分散AIセキュリティ

エッジコンピューティング、連合学習、およびマルチサイトアーキテクチャを含むセキュアな分散型AI展開。

|   #   | 説明                                                                                                                                                 | レベル | 役割  |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.8.1 | エッジAIデバイスが相互TLSを使用して中央インフラストラクチャに認証されることを確認してください。                                                                                                 |  2  | D/V |
| 4.8.2 | エッジデバイスが検証済みの署名を使用したセキュアブートおよびファームウェアのダウングレード攻撃を防ぐためのロールバック保護を実装していることを確認してください。                                                                   |  2  | D/V |
| 4.8.3 | 分散型AIの調整が、参加者の検証および悪意あるノードの検出を伴うビザンチン耐障害性コンセンサスメカニズムを使用していることを検証してください。                                                                            |  3  | D/V |
| 4.8.4 | エッジツークラウド通信が帯域幅制限、データ圧縮、および暗号化されたローカルストレージを用いた安全なオフライン動作をサポートしていることを確認してください。                                                                      |  3  | D/V |
| 4.8.5 | モバイルまたはエッジ推論アプリケーションが、改変されたバイナリ、再パッケージされたアプリ、または取り付けられた計測フレームワークを検出およびブロックするプラットフォームレベルの改ざん防止保護（例：コード署名、検証済みブート、ランタイム自己整合性チェック）を実装していることを確認してください。 |  3  | D/V |
| 4.8.6 | エッジまたはモバイルデバイスにデプロイされるモデルがパッケージ化時に暗号的に署名されていることを確認し、デバイス上のランタイムがロードまたは推論の前にこれらの署名またはチェックサムを検証することを保証してください。検証されていない、または改変されたモデルは拒否されなければなりません。     |  3  | D/V |
| 4.8.7 | オンデバイス推論ランタイムが、モデルのダンプ、デバッグ、中間埋め込みや活性化の抽出を防ぐために、プロセス、メモリ、およびファイルアクセスの分離を強制していることを検証してください。                                                         |  3  | D/V |
| 4.8.8 | モデルの重みやローカルに保存された機密パラメータが、ハードウェア対応のキーストアやセキュアエンクレーブ（例：Android Keystore、iOS Secure Enclave、TPM/TEE）を使用して暗号化されており、キーがユーザースペースからアクセスできないことを検証してください。  |  3  | D/V |
| 4.8.9 | モバイル、IoT、または組み込みアプリケーション内にパッケージ化されたモデルが、保存時に暗号化または難読化されており、信頼できるランタイムまたはセキュアエンクレーブ内でのみ復号されることを確認し、アプリパッケージやファイルシステムからの直接抽出を防止してください。               |  3  | D/V |

---

## 参考文献

* [NIST Cybersecurity Framework 2.0](https://www.nist.gov/cyberframework)
* [CIS Controls v8](https://www.cisecurity.org/controls/v8)
* [Kubernetes Security Best Practices](https://kubernetes.io/docs/concepts/security/)
* [Cloud Security Alliance: Cloud Controls Matrix](https://cloudsecurityalliance.org/research/cloud-controls-matrix/)
* [ENISA: Secure Infrastructure Design](https://www.enisa.europa.eu/topics/critical-information-infrastructures-and-services)
* [NIST AI Risk Management Framework](https://www.nist.gov/itl/ai-risk-management-framework)


# C4インフラストラクチャ、構成および展開セキュリティ

## 制御目標

AIインフラストラクチャは、権限昇格、サプライチェーンの改ざん、および横方向移動に対して、セキュアな構成、ランタイム分離、信頼できるデプロイメントパイプライン、および包括的な監視を通じて強化されなければなりません。検証および認可されたインフラストラクチャコンポーネントのみが、セキュリティ、整合性、および監査可能性を保証する管理されたプロセスを通じて本番環境に到達します。

コアセキュリティ目標：暗号的に署名され、脆弱性スキャンを通過したインフラストラクチャコンポーネントのみが、自動化された検証パイプラインを通じて本番環境に到達し、セキュリティポリシーを強制し、変更不可能な監査証跡を維持します。

---

## C4.1 ランタイム環境の分離

OSレベルの隔離プリミティブを通じて、コンテナの脱出および権限昇格を防止します。

|   #   | 説明                                                                                                                   | レベル | 役割  |
| :---: | -------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.1.1 | コンテナの場合などに不要なLinuxの機能を削減することで、すべてのAIワークロードがオペレーティングシステム上で必要最低限の権限で実行されていることを確認してください。                                |  1  | D/V |
| 4.1.2 | サンドボックス化、seccompプロファイル、AppArmor、SELinuxまたは同様の技術によって悪用が制限されていることを確認し、その設定が適切であることを検証してください。                           |  1  | D/V |
| 4.1.3 | ワークロードが読み取り専用のルートファイルシステムで実行されていること、および書き込み可能なマウントポイントが明示的に定義され、制限付きオプション（例：noexec、nosuid、nodev）で強化されていることを確認してください。 |  2  | D/V |
| 4.1.4 | ランタイムモニタリングが権限昇格およびコンテナ脱出の挙動を検知し、違反プロセスを自動的に終了することを確認してください。                                                         |  2  | D/V |
| 4.1.5 | ハイリスクなAIワークロードが、リモート認証に成功した後にのみ、ハードウェア分離環境（例：TEE、信頼されたハイパーバイザー、またはベアメタルノード）で実行されることを確認してください。                        |  3  | D/V |

---

## C4.2 セキュアなビルドおよびデプロイメントパイプライン

再現可能なビルドと署名付きアーティファクトを通じて、暗号学的整合性とサプライチェーンのセキュリティを確保します。

|  #  | 説明  | レベル | 役割  |
| :-: | --- | :-: | :-: |

| 4.2.1 | ビルドが再現可能であり、ビルド成果物に適した署名付き起源メタデータを生成し、それが独立して検証可能であることを確認する。 | 1 | D/V |
| 4.2.2 | ビルドがソフトウェア部品表（SBOM）を生成し、展開前に署名されていることを検証する。 | 2 | D/V |
| 4.2.3 | ビルド成果物（例：コンテナイメージ）の署名および出所メタデータがデプロイ時に検証され、未検証の成果物が拒否されることを確認する。 | 2 | D/V |

---

## C4.3 ネットワークセキュリティとアクセス制御

デフォルト拒否ポリシーと暗号化通信を用いてゼロトラストネットワーキングを実装してください。

|   #   | 説明                                                                                                                                  | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.3.1 | ネットワークポリシーが、必要なサービスのみを明示的に許可し、デフォルトで受信および送信を拒否することを強制していることを確認してください。                                                               |  1  | D/V |
| 4.3.2 | 管理者アクセスプロトコル（例：SSH、RDP）およびクラウドメタデータサービスへのアクセスが制限されており、強力な認証を必要としていることを確認してください。                                                     |  1  | D/V |
| 4.3.3 | 送信トラフィックが承認された宛先に制限されていること、およびすべてのリクエストが記録されていることを確認してください。                                                                         |  2  | D/V |
| 4.3.4 | インターサービス通信が証明書検証および定期的な自動ローテーションを伴う相互TLSを使用していることを確認してください。                                                                         |  2  | D/V |
| 4.3.5 | AI ワークロードおよび環境（開発、テスト、本番）が、直接のインターネットアクセスがなく、共通の IAM ロール、セキュリティグループ、または環境間の接続を共有しない、分離されたネットワークセグメント（VPC/VNet）内で実行されていることを確認してください。 |  2  | D/V |

## C4.4 シークレットおよび暗号鍵管理

秘密情報や暗号鍵を安全なストレージ、自動ローテーション、および強力なアクセス制御で保護します。

|   #   | 説明                                                                                                                  | レベル | 役割  |
| :---: | ------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.4.1 | シークレットが専用のシークレット管理システムに保存されており、保管時に暗号化され、アプリケーションのワークロードから分離されていることを確認してください。                                       |  1  | D/V |
| 4.4.2 | 暗号鍵がハードウェア対応モジュール（例：HSM、クラウドKMS）で生成および保管されていることを検証してください。                                                           |  1  | D/V |
| 4.4.3 | シークレットのローテーションが自動化されていることを確認してください。                                                                                 |  2  | D/V |
| 4.4.4 | 本番環境のシークレットへのアクセスには強力な認証が必要であることを確認してください。                                                                          |     |     |
| 4.4.5 | シークレットがシークレット管理ソリューションを通じて実行時にアプリケーションに展開されていることを確認してください。シークレットはソースコード、設定ファイル、ビルド成果物、コンテナイメージ、環境変数に決して埋め込んではなりません。 |  2  | D/V |

---

## C4.5 AIワークロードのサンドボックス化と検証

信頼されていないAIモデルを安全なサンドボックス内に隔離し、信頼できる実行環境（TEE）や機密計算技術を使用して機密性の高いAIワークロードを保護します。

|   #   | 説明                                                                           | レベル | 役割  |
| :---: | ---------------------------------------------------------------------------- | :-: | :-: |
| 4.5.1 | 外部または信頼されていないAIモデルが隔離されたサンドボックス内で実行されることを検証してください。                           |  1  | D/V |
| 4.5.2 | サンドボックス化されたワークロードがデフォルトでアウトバウンドのネットワーク接続を持たず、必要なアクセスが明示的に定義されていることを確認してください。 |  1  | D/V |
| 4.5.3 | ワークロードの認証がモデルまたはワークロードのロード前に実行され、信頼された実行環境の暗号学的証明が確保されていることを確認してください。        |  2  | D/V |
| 4.5.4 | 機密ワークロードが、ハードウェアによる分離、メモリ暗号化、および整合性保護を提供する信頼できる実行環境（TEE）内で実行されることを検証してください。  |  3  | D/V |
| 4.5.5 | 機密推論サービスが、シールされたモデル重みと保護された実行により暗号化計算を通じてモデル抽出を防止していることを検証してください。            |  3  | D/V |
| 4.5.6 | 信頼できる実行環境のオーケストレーションには、ライフサイクル管理、リモート認証、および暗号化された通信チャネルが含まれていることを検証してください。   |  3  | D/V |
| 4.5.7 | 安全なマルチパーティ計算（SMPC）が、個々のデータセットやモデルパラメータを公開することなく共同AIトレーニングを可能にすることを検証してください。  |  3  | D/V |

---

## C4.6 AIインフラストラクチャリソース管理、バックアップおよびリカバリー

リソースの枯渇攻撃を防止し、クォータおよび監視を通じて公正なリソース配分を確保します。安全なバックアップ、テスト済みの復旧手順、および災害復旧機能により、インフラのレジリエンスを維持します。

|   #   | 説明                                                                                                                          | レベル | 役割  |
| :---: | --------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.6.1 | DoS攻撃を軽減するために、Kubernetes ResourceQuotasなどを用いてワークロードのリソース消費が適切に制限されていることを確認してください。                                           |  2  | D/V |
| 4.6.2 | リソース枯渇が定義されたCPU、メモリ、またはリクエストの閾値を超えた場合に、自動化された保護（例：レート制限やワークロードの分離）がトリガーされることを確認してください。                                      |  2  | D/V |
| 4.6.3 | バックアップシステムが別の資格情報を用いた分離ネットワークで動作していることを確認し、ストレージシステムがエアギャップネットワークで運用されているか、不正な変更に対してWORM（書き込み一回読み込み多回）保護を実装していることを確認してください。 |  2  | D/V |

---

## C4.7 AIハードウェアセキュリティ

GPU、TPU、および専門のAIアクセラレータを含む、AI専用のハードウェアコンポーネントを保護する。

|   #   | 説明                                                                                                          | レベル | 役割  |
| :---: | ----------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 4.7.1 | ワークロードの実行前に、ハードウェアベースの認証メカニズム（例：TPM、DRTM、または同等のもの）を使用してAIアクセラレータの完全性が検証されていることを確認してください。                    |  2  | D/V |
| 4.7.2 | アクセラレータ（GPU）メモリがワークロード間でパーティショニング機構を通じて分離されており、ジョブ間でメモリのサニタイズが行われていることを検証してください。                            |  2  | D/V |
| 4.7.3 | ハードウェアセキュリティモジュール（HSM）が、FIPS 140-3 レベル 3 または Common Criteria EAL4+ の認証を得て、AIモデルの重みおよび暗号鍵を保護していることを確認してください。 |  3  | D/V |

---

## C4.8 エッジ＆分散型AIセキュリティ

エッジコンピューティング、フェデレーテッドラーニング、およびマルチサイトアーキテクチャを含む安全な分散AI展開。

|   #   | 説明                                                                                | レベル | 役割  |
| :---: | --------------------------------------------------------------------------------- | :-: | :-: |
| 4.8.1 | エッジAIデバイスが相互TLSを使用して中央インフラストラクチャに認証することを確認してください。                                 |  2  | D/V |
| 4.8.2 | エッジデバイスが検証済み署名によるセキュアブートと、ファームウェアのダウングレード攻撃を防止するためのロールバック保護を実装していることを確認してください。    |  2  | D/V |
| 4.8.3 | 分散型AIの調整が、参加者の検証と悪意のあるノードの検出を伴うビザンチン障害耐性コンセンサス機構を使用していることを検証してください。               |  3  | D/V |
| 4.8.4 | エッジからクラウドへの通信が、帯域幅制御、データ圧縮、および暗号化されたローカルストレージを使用した安全なオフライン操作をサポートしていることを確認してください。 |  3  | D/V |

---

## 参考文献

* [NIST Cybersecurity Framework 2.0](https://www.nist.gov/cyberframework)
* [CIS Controls v8](https://www.cisecurity.org/controls/v8)
* [OWASP Container Security Verification Standard](https://github.com/OWASP/Container-Security-Verification-Standard)
* [Kubernetes Security Best Practices](https://kubernetes.io/docs/concepts/security/)
* [SLSA Supply Chain Security Framework](https://slsa.dev/)
* [Cloud Security Alliance: Cloud Controls Matrix](https://cloudsecurityalliance.org/research/cloud-controls-matrix/)
* [ENISA: Secure Infrastructure Design](https://www.enisa.europa.eu/topics/critical-information-infrastructures-and-services)
* [ISO 27001:2022 Information Security Management](https://www.iso.org/standard/27001)
* [NIST AI Risk Management Framework](https://www.nist.gov/itl/ai-risk-management-framework)


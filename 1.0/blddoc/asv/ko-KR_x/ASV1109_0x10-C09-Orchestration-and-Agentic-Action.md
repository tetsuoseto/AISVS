# 9 자율 오케스트레이션 및 에이전트적 행동 보안

## 통제 목표

자율적이거나 다중 에이전트 AI 시스템은 명시적으로 의도된 것, 인증된 것, 감사 가능하며, 한정된 비용 및 위험 임계값 내에서만 행동을 실행하도록 보장합니다. 이는 자율 시스템 침해, 도구 오용, 에이전트 루프 탐지, 통신 가로채기, 신원 스푸핑, 스웜 조작, 의도 조작 등의 위협으로부터 보호합니다.

---

## 9.1 에이전트 태스크 계획 및 재귀 예산

재귀적 계획의 속도를 늦추고 특권 있는 작업에 대해 인간 개입 체크포인트를 강제하라.

|   #   | 설명                                                                                    | 레벨  | 역할  |
| :---: | ------------------------------------------------------------------------------------- | :-: | :-: |
| 9.1.1 | 최대 재귀 깊이, 너비, 실제 시간, 토큰 수, 그리고 에이전트 실행당 금전적 비용이 중앙에서 구성되고 버전 관리되고 있는지 확인하십시오.         |  1  | D/V |
| 9.1.2 | 권한이 있거나 되돌릴 수 없는 조치(예: 코드 커밋, 자금 이체)가 실행되기 전에 감사 가능한 채널을 통해 명시적 인간 승인이 필요하다는 것을 확인한다. |  1  | D/V |
| 9.1.3 | 실시간 자원 모니터가 예산 임계값을 초과했을 때 회로 차단기가 작동하여 더 이상의 작업 확장을 중지하는지 확인한다.                      |  2  |  D  |
| 9.1.4 | 회로 차단기 이벤트가 에이전트 ID, 트리거 조건 및 캡처된 실행 계획 상태와 함께 로그에 남는지 포렌식 검토를 위해 확인하십시오.             |  2  | D/V |
| 9.1.5 | 보안 테스트가 budget-exhaustion 및 runaway-plan 시나리오를 다루고, 데이터 손실 없이 안전하게 중단되는지 확인한다.        |  3  |  V  |
| 9.1.6 | 예산 정책이 정책-코드화로 표현되고 CI/CD에서 강제되어 구성 표류를 차단하는지 확인합니다.                                  |  3  |  D  |

---

## 9.2 도구 플러그인 샌드박스

도구와의 상호작용을 격리하여 무단 시스템 접근이나 코드 실행을 방지합니다.

|   #   | 설명                                                                                            | 레벨  | 역할  |
| :---: | --------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.2.1 | 모든 도구/플러그인이 OS, 컨테이너 또는 WASM-level 샌드박스 내에서 실행되며 최소-권한 파일-시스템, 네트워크 및 시스템-콜 정책을 준수하는지 확인하십시오. |  1  | D/V |
| 9.2.2 | 샌드박스 자원 한도(CPU, 메모리, 디스크, 네트워크 송출 트래픽) 및 실행 시간 제한이 적용되고 기록되는지 확인하십시오.                         |  1  | D/V |
| 9.2.3 | 도구의 바이너리 파일 또는 디스크립터가 디지털 서명되었는지 확인하고, 로드하기 전에 서명을 검증한다.                                      |  2  | D/V |
| 9.2.4 | 샌드박스 텔레메트리가 SIEM으로 전송되는지 확인하고, 이상(예: 시도된 아웃바운드 연결)이 경보를 발생시키는지 확인하십시오.                        |  2  |  V  |
| 9.2.5 | 생산 환경에 배포되기 전에 고위험 플러그인이 보안 검토와 침투 테스트를 거치는지 확인하십시오.                                          |  3  |  V  |
| 9.2.6 | 샌드박스 탈출 시도가 자동으로 차단되고 문제가 되는 플러그인이 조사가 진행 중인 상태로 격리되는지 확인합니다.                                 |  3  | D/V |

---

## 9.3 자율 루프 및 비용 경계

제어되지 않는 에이전트 간 재귀 및 비용 급증을 탐지하고 차단합니다.

|   #   | 설명                                                               | 레벨  | 역할  |
| :---: | ---------------------------------------------------------------- | :-: | :-: |
| 9.3.1 | 에이전트 간 호출에 런타임이 이를 감소시키고 강제하는 홉-제한 또는 TTL이 포함되어 있는지 확인합니다.       |  1  | D/V |
| 9.3.2 | 에이전트가 고유한 invocation-graph ID를 유지하여 자기 호출이나 순환 패턴을 식별하는지 확인하십시오. |  2  |  D  |
| 9.3.3 | 누적 컴퓨트 유닛 및 소비 카운터가 요청 체인별로 추적되는지 확인하십시오; 한도 초과 시 체인이 중단됩니다.     |  2  | D/V |
| 9.3.4 | 에이전트 프로토콜에서 무한 재귀의 부재를 형식적 분석 또는 모델 검증으로 입증하는지 확인합니다.            |  3  |  V  |
| 9.3.5 | 루프 중단(loop-abort) 이벤트가 경보를 생성하고 지속적 개선 지표에 반영되는지 확인합니다.          |  3  |  D  |

---

## 9.4 프로토콜-수준의 남용 방지

에이전트와 외부 시스템 간의 보안 통신 채널을 확보하여 해킹이나 변조를 방지한다.

|   #   | 설명                                                                                     | 레벨  | 역할  |
| :---: | -------------------------------------------------------------------------------------- | :-: | :-: |
| 9.4.1 | 모든 에이전트-도구 간 메시지와 에이전트-에이전트 간 메시지가 인증되었는지(예: 상호 TLS 또는 JWT) 및 종단 간 암호화가 적용되었는지 확인하십시오. |  1  | D/V |
| 9.4.2 | 스키마가 엄격하게 검증되는지 확인하고, 알 수 없는 필드나 잘못된 형식의 메시지는 거부됩니다.                                   |  1  |  D  |
| 9.4.3 | 무결성 검사(MAC 또는 디지털 서명)가 전체 메시지 페이로드(도구 매개변수 포함)를 포함하는지 확인하십시오.                          |  2  | D/V |
| 9.4.4 | 프로토콜 계층에서 재생 공격 방지(일회용 nonce 또는 타임스탬프 윈도우)가 시행되고 있는지 확인합니다.                            |  2  |  D  |
| 9.4.5 | 프로토콜 구현이 주입 취약점이나 역직렬화 취약점에 대해 퍼징과 정적 분석을 받는지 확인합니다.                                   |  3  |  V  |

---

## 9.5 에이전트 신원 및 변조 증거

작업의 책임 소재를 명확히 하고 수정 사항을 탐지 가능하게 하십시오.

|   #   | 설명                                                                  | 레벨  | 역할  |
| :---: | ------------------------------------------------------------------- | :-: | :-: |
| 9.5.1 | 각 에이전트 인스턴스가 고유한 암호학적 신원(키-페어 또는 하드웨어-루트 자격 증명)을 보유하고 있는지 확인하십시오.   |  1  | D/V |
| 9.5.2 | 모든 에이전트 작업이 서명되고 타임스탬프가 기록되었는지 확인하십시오; 로그에 부인 방지를 위한 서명이 포함되어 있습니다. |  2  | D/V |
| 9.5.3 | 변조 방지 로그가 추가 전용 매체 또는 한 번 쓰기 전용 매체에 저장되는지 확인하십시오.                   |  2  |  V  |
| 9.5.4 | 정의된 일정 및 침해 지표에 따라 신원 키가 회전하는지 확인합니다.                               |  3  |  D  |
| 9.5.5 | 스푸핑 또는 키 충돌 시도가 영향을 받는 에이전트를 즉시 격리하도록 확인하십시오.                       |  3  | D/V |

---

## 9.6 다중-에이전트 스웜 위험 감소

격리와 형식적 안전 모델링을 통해 집단 행동으로 인한 위험을 완화한다.

|   #   | 설명                                                                  | 레벨  | 역할  |
| :---: | ------------------------------------------------------------------- | :-: | :-: |
| 9.6.1 | 다른 보안 도메인에서 작동하는 에이전트가 격리된 런타임 샌드박스 또는 네트워크 세그먼트에서 실행되는지 확인하십시오.    |  1  | D/V |
| 9.6.2 | 배포 전에 스웜 행동이 모델링되고 생존성 및 안전성에 대해 형식적으로 검증되었는지 확인한다.                 |  3  |  V  |
| 9.6.3 | 런타임 모니터가 새로 등장하는 안전하지 않은 패턴(예: 진동, 교착 상태)을 감지하고 시정 조치를 시작하는지 확인합니다. |  3  |  D  |

---

## 9.7 사용자 및 도구 인증 / 권한 부여

에이전트가 트리거하는 모든 동작에 대해 강력한 접근 제어를 구현하십시오.

|   #   | 설명                                                                 | 레벨  | 역할  |
| :---: | ------------------------------------------------------------------ | :-: | :-: |
| 9.7.1 | 에이전트가 하류 시스템에 대해 1급 주체로 인증하고, 최종 사용자 자격 증명을 재사용하지 않는지 확인한다.        |  1  | D/V |
| 9.7.2 | 세밀한 권한 부여 정책이 에이전트가 호출할 수 있는 도구와 에이전트가 제공할 수 있는 매개변수를 제한하는지 확인합니다. |  2  |  D  |
| 9.7.3 | 권한 확인이 매 호출마다 재평가되는지(지속적 인가) 확인하십시오. 세션 시작 시점에만 이뤄지지 않도록.          |  2  |  V  |
| 9.7.4 | 위임된 권한이 자동으로 만료되고 타임아웃 또는 범위 변경 후 재동의를 요구하는지 확인합니다.                |  3  |  D  |

---

## 9.8 에이전트-to-에이전트 통신 보안

에이전트 간 모든 메시지를 암호화하고 무결성을 보장하여 도청과 변조를 방지한다.

|   #   | 설명                                                                             | 레벨  | 역할  |
| :---: | ------------------------------------------------------------------------------ | :-: | :-: |
| 9.8.1 | 에이전트 채널에 대해 상호 인증과 Perfect Forward Secrecy(PFS) 암호화(예: TLS 1.3)가 의무적임을 확인하십시오. |  1  | D/V |
| 9.8.2 | 처리하기 전에 메시지의 무결성과 출처가 검증되었는지 확인하십시오; 검증에 실패하면 경고를 발생시키고 메시지를 폐기합니다.            |  1  |  D  |
| 9.8.3 | 법의학적 재구성을 지원하기 위해 통신 메타데이터(타임스탬프, 시퀀스 번호)가 로그에 기록되는지 확인합니다.                    |  2  | D/V |
| 9.8.4 | 형식적 검증 또는 모델 검사를 통해 프로토콜 상태 머신이 안전하지 않은 상태로 전이될 수 없음을 확인한다.                    |  3  |  V  |

---

## 9.9 의도 검증 및 제약 강제

에이전트의 행동이 사용자가 명시한 의도와 시스템 제약에 부합하는지 확인합니다.

|   #   | 설명                                                                              | 레벨  | 역할  |
| :---: | ------------------------------------------------------------------------------- | :-: | :-: |
| 9.9.1 | 사전 실행 제약 해결기가 제안된 행동을 하드코드된 안전 및 정책 규칙에 대해 검사하는지 확인합니다.                         |  1  |  D  |
| 9.9.2 | 고-영향 작업(재무적, 파괴적, 개인정보에 민감한)은 시작하는 사용자로부터 명시적 의도 확인이 필요합니다.                     |  2  | D/V |
| 9.9.3 | 사후 조건 검사가 완료된 조치가 의도한 효과를 부작용 없이 달성했는지 확인하고; 불일치가 발견되면 롤백을 트리거한다.               |  2  |  V  |
| 9.9.4 | 에이전트의 계획이 선언된 모든 제약 조건을 충족함을 형식적 방법(예: 모델 검사, 정리 증명)이나 속성 기반 테스트가 입증하는지 확인하십시오. |  3  |  V  |
| 9.9.5 | 의도-불일치 또는 제약-위반 사건이 지속적-개선 사이클과 위협-인텔리전스 공유를 촉진하는지 확인한다.                        |  3  |  D  |

---

## 9.10 에이전트 추론 전략 보안

ReAct, Chain-of-Thought, 및 Tree-of-Thoughts 접근법을 포함한 다양한 추론 전략의 안전한 선택과 실행.

|   #    | 설명                                                                                                           | 레벨  | 역할  |
| :----: | ------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 9.10.1 | 추론 전략 선택이 결정론적 기준(입력 복잡도, 작업 유형, 보안 맥락)을 사용하고, 동일한 입력이 같은 보안 맥락에서 동일한 전략 선택을 생성하는지 확인하십시오.                   |  1  | D/V |
| 9.10.2 | 각 추론 전략(ReAct, Chain-of-Thought, Tree-of-Thoughts)에 대해 해당 인지적 접근 방식에 고유한 입력 검증, 출력 정제 및 실행 시간 제한이 있는지 확인합니다. |  1  | D/V |
| 9.10.3 | 감사 추적 재구성을 위해 입력 특성, 선택 기준 값, 그리고 실행 메타데이터를 포함한 완전한 맥락과 함께 추론 전략의 전이가 기록되는지 확인합니다.                           |  2  | D/V |
| 9.10.4 | Tree-of-Thoughts 추론에 정책 위반, 자원 한계 또는 안전 경계가 감지될 때 탐색을 종료하도록 가지치기 메커니즘이 포함되어 있는지 확인합니다.                       |  2  | D/V |
| 9.10.5 | ReAct(Reason-Act-Observe) 사이클은 각 단계에 검증 체크포인트를 포함한다: 추론 단계 검증, 행동 인가, 그리고 진행하기 전에 관찰 데이터의 정제.                |  2  | D/V |
| 9.10.6 | 추론 전략의 성능 지표(실행 시간, 자원 사용량, 출력 품질)가 구성된 임계값을 벗어날 때 자동 경보로 모니터링되는지 확인합니다.                                     |  3  | D/V |
| 9.10.7 | 여러 전략을 결합하는 하이브리드 추론 방식이 모든 구성 전략의 입력 유효성 검사 및 출력 제약을 유지하고 어떠한 보안 제어도 우회하지 않는지 확인합니다.                        |  3  | D/V |
| 9.10.8 | 추론 전략 보안 테스트에 잘못된 형식의 입력에 대한 퍼징, 전략 전환을 강제하도록 설계된 적대적 프롬프트, 그리고 각 인지적 접근 방식에 대한 경계 조건 테스트가 포함되어 있는지 확인하십시오.  |  3  | D/V |

---

## 9.11 에이전트 수명주기 상태 관리 및 보안

암호학적 감사 추적 및 정의된 복구 절차를 갖춘 보안 에이전트의 초기화, 상태 전이 및 종료

|   #    | 설명                                                                                                                | 레벨  | 역할  |
| :----: | ----------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.11.1 | 에이전트 초기화에 하드웨어 기반 자격 증명을 통한 암호학적 신원 확립이 포함되며, 에이전트 ID, 타임스탬프, 구성 해시 및 초기화 매개변수를 포함하는 불변의 시작 감사 로그가 존재하는지 확인합니다.   |  1  | D/V |
| 9.11.2 | 에이전트 상태 전이가 암호학적으로 서명되고, 타임스탬프가 부여되며, 발생한 이벤트, 이전 상태 해시, 새로운 상태 해시 및 수행된 보안 검증을 포함한 전체 컨텍스트와 함께 로깅되는지 확인하십시오.     |  2  | D/V |
| 9.11.3 | 에이전트 종료 절차에 암호학적 소거 또는 다중 패스 덮어쓰기 방식의 보안 메모리 소거, 인증 기관에 대한 통지와 함께 자격 증명 폐기, 그리고 변조 방지 종료 인증서의 생성이 포함되는지 확인하십시오.   |  2  | D/V |
| 9.11.4 | 에이전트 복구 메커니즘이 상태 무결성을 암호학적 체크섬(SHA-256 최소)을 사용해 검증하고, 손상이 감지되면 알려진 신뢰 가능한 상태로 롤백하며, 자동 알림과 수동 승인 요건이 적용되도록 확인합니다. |  3  | D/V |
| 9.11.5 | 에이전트 지속성 메커니즘이 민감한 상태 데이터를 에이전트별 AES-256 키로 암호화하고, 구성 가능한 일정(최대 90일)에 따라 무가동 배포로 보안 키 로테이션을 구현하는지 확인하십시오.         |  3  | D/V |

---

## 9.12 도구 통합 보안 프레임워크

정의된 위험 평가 및 승인 프로세스와 함께 동적 도구 로딩, 실행 및 결과 검증에 대한 보안 제어.

|   #    | 설명                                                                                                                            | 레벨  | 역할  |
| :----: | ----------------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 9.12.1 | 도구 설명자에 필요한 권한(읽기/쓰기/실행), 위험 수준(낮음/중간/높음), 자원 한계(CPU, 메모리, 네트워크), 그리고 도구 매니페스트에 문서화된 검증 요구사항을 명시하는 보안 메타데이터가 포함되어 있는지 확인하십시오. |  1  | D/V |
| 9.12.2 | 도구 실행 결과가 예상 스키마(JSON Schema, XML Schema) 및 보안 정책(출력 정제, 데이터 분류)에 대해 검증되었는지 확인하고, 타임아웃 제한 및 오류 처리 절차를 적용하기 전에 이를 보장한다.        |  1  | D/V |
| 9.12.3 | 도구 상호작용 로그에 상세한 보안 맥락이 포함되어 있으며, 권한 사용, 데이터 접근 패턴, 실행 시간, 자원 소비, 반환 코드가 구조화된 로깅으로 기록되어 SIEM 통합에 활용될 수 있는지 확인하십시오.             |  2  | D/V |
| 9.12.4 | 동적 도구 로딩 메커니즘이 PKI 인프라를 사용해 디지털 서명을 검증하는지 확인하고, 실행 전에 샌드박스 격리 및 권한 검증을 포함한 보안 로딩 프로토콜을 구현하라.                                  |  2  | D/V |
| 9.12.5 | 새 버전에 대해 자동으로 트리거되도록 도구 보안 평가를 확인하고, 정적 분석, 동적 테스트, 보안 팀 검토를 포함하는 필수 승인 게이트와 문서화된 승인 기준 및 SLA 요건이 있는지 확인합니다.                  |  3  | D/V |

---

### 참고문헌

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)


# C2 사용자 입력 검증

## 통제 목표

사용자 입력에 대한 강력한 검증은 AI 시스템에 대한 가장 심각한 공격들에 대한 1차 방어선이다. 프롬프트 인젝션 공격은 시스템 지시를 무력화하고, 민감한 데이터를 누설하거나, 모델이 허용되지 않는 방향으로 작동하도록 이끌 수 있다. 전용 필터와 지시 계층이 마련되어 있지 않다면, 연구에 따르면 "multi-shot" jailbreak이 매우 긴 맥락 창을 악용하여 효과적일 것이다. 또한 미묘한 적대적 섭동 공격--such as homoglyph swaps or leetspeak—-모델의 결정을 조용히 바꿀 수 있다.

---

## C2.1 프롬프트 주입 방어

프롬프트 주입은 AI 시스템에서 상위 위험 중 하나입니다. 이 전술에 대한 방어책은 정적 패턴 필터, 동적 분류기 및 지시 계층 구조의 강제화를 조합하여 사용합니다.

|   #   | 설명                                                                                                                     | 레벨  | 역할  |
| :---: | ---------------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 2.1.1 | 사용자 입력이 지속적으로 업데이트되는 알려진 프롬프트 주입 패턴 라이브러리에 대해 스크리닝되는지 확인합니다(jailbreak 키워드, "ignore previous", 역할극 체인, 간접 HTML/URL 공격). |  1  | D/V |
| 2.1.2 | 시스템은 시스템 또는 개발자 메시지가 사용자 지시를 덮어쓰도록 하는 지시 계층을 강제하며, 이는 컨텍스트 윈도우 확장 이후에도 계속 유지된다.                                        |  1  | D/V |
| 2.1.3 | 모델 또는 프롬프트 템플릿의 릴리스마다 모든 적대적 평가 테스트(예: 레드팀의 '다샷' 프롬프트)가 실행되며, 성공률 임계값과 회귀를 차단하는 자동 차단 기능이 적용되는지 확인한다.                  |  2  | D/V |
| 2.1.4 | 제3자 콘텐츠(웹 페이지, PDF, 이메일)에서 유래한 프롬프트가 메인 프롬프트로 결합되기 전에 격리된 파싱 컨텍스트에서 정제되도록 확인하십시오.                                      |  2  |  D  |
| 2.1.5 | 모든 프롬프트-필터 규칙 업데이트, 분류기 모델 버전 및 차단-목록 변경이 버전 관리되고 감사 가능하도록 확인하십시오.                                                     |  3  | D/V |

---

## C2.2 적대적 예제-저항성

자연어 처리(NLP) 모델은 여전히 인간이 종종 놓치는 미묘한 문자 수준의 섭동이나 단어 수준의 섭동에 취약합니다. 인간은 자주 놓치지만 모델은 종종 잘못 분류하는 경향이 있습니다.

|   #   | 설명                                                                                            | 레벨  | 역할  |
| :---: | --------------------------------------------------------------------------------------------- | :-: | :-: |
| 2.2.1 | 토큰화 전에 기본 입력 정규화 단계(유니코드 NFC, 동형문자 매핑, 앞뒤 공백 제거)가 실행되는지 확인하십시오.                               |  1  |  D  |
| 2.2.2 | 통계적 이상 탐지가 언어 규범에 비정상적으로 큰 편집 거리, 과도하게 반복되는 토큰, 또는 비정상적인 임베딩 거리를 가진 입력에 대해 플래그를 설정하는지 확인하십시오. |  2  | D/V |
| 2.2.3 | 추론 파이프라인이 고위험 엔드포인트를 위해 선택적 적대적 학습으로 강화된 모델 변형 또는 방어 계층(예: 무작위화, 방어적 증류)을 지원하는지 확인하십시오.       |  2  |  D  |
| 2.2.4 | 의심되는 적대적 입력이 격리되고 전체 페이로드가 PII 비식별화 후 로깅되는지 확인합니다.                                            |  2  |  V  |
| 2.2.5 | 강건성 지표(알려진 공격 모음의 성공률)가 시간에 따라 추적되고, 회귀가 릴리스 차단기를 트리거하도록 확인합니다.                               |  3  | D/V |

---

## C2.3 스키마, 타입 및 길이 유효성 검사

AI 공격은 잘못 형성되었거나 과도하게 큰 입력을 특징으로 할 수 있으며, 구문 분석 오류, 필드 간 프롬프트 누출, 그리고 자원 고갈을 유발할 수 있습니다.  결정론적 도구 호출을 수행할 때도 엄격한 스키마 적용은 전제 조건입니다.

|   #   | 설명                                                                                                           | 레벨  | 역할  |
| :---: | ------------------------------------------------------------------------------------------------------------ | :-: | :-: |
| 2.3.1 | 모든 API 또는 함수 호출 엔드포인트가 명시적 입력 스키마(JSON Schema, Protobuf 또는 다중 모달에 상응하는 형식)를 정의하고 입력이 프롬프트 구성 전에 검증되는지 확인합니다. |  1  |  D  |
| 2.3.2 | 최대 토큰 수 또는 바이트 한도를 초과하는 입력은 안전한 오류로 거부되어야 하며, 아무런 경고 없이 잘려 나가지 않아야 한다.                                       |  1  | D/V |
| 2.3.3 | 타입 검사(예: 숫자 범위, 열거형 값, 이미지/오디오용 MIME 타입)가 서버 측에서 강제되는지, 클라이언트 코드에만 의존하지 않는지 확인하십시오.                          |  2  | D/V |
| 2.3.4 | 의미론적 유효성 검사기(JSON Schema 등)가 상수 시간에 동작하는지 확인하여 알고리즘적 DoS를 방지합니다.                                             |  2  |  D  |
| 2.3.5 | 유효성 검사 실패가 가려진 페이로드 스니펫과 명확한 오류 코드로 로깅되어 보안 대응 선별을 돕는지 확인한다.                                                 |  3  |  V  |

---

## C2.4 콘텐츠 및 정책 심사

개발자는 구문적으로 유효한 프롬프트 중 금지된 콘텐츠를 요청하는 것을 식별하고(예: 불법적인 지시, 혐오 발언, 저작권이 있는 텍스트 등) 그런 프롬프트가 확산되지 않도록 방지해야 한다.

|   #   | 설명                                                                                          | 레벨  | 역할  |
| :---: | ------------------------------------------------------------------------------------------- | :-: | :-: |
| 2.4.1 | 제로샷 또는 파인 튜닝된 콘텐츠 분류기가 모든 입력에 대해 폭력, 자해, 혐오, 성적 콘텐츠 및 불법 요청을 점수화하고 구성 가능한 임계값으로 작동하는지 확인한다. |  1  |  D  |
| 2.4.2 | 정책을 위반하는 입력이 표준화된 거부 응답이나 안전한 완성으로 처리되어 다운스트림 LLM 호출로 전파되지 않도록 확인한다.                        |  1  | D/V |
| 2.4.3 | 선별 모델이나 규칙 세트가 최소 분기마다 재학습/업데이트되도록 확인하고, 새로 관찰된 jailbreak 또는 정책 우회 패턴을 반영한다.                |  2  |  D  |
| 2.4.4 | 요청 시점에 해석되는 속성 기반 규칙을 통해 심사가 사용자별 정책(나이, 지역 법적 제약)을 준수하는지 확인합니다.                            |  2  |  D  |
| 2.4.5 | 스크리닝 로그에 SOC 상관관계 및 향후 레드팀 재현을 위한 분류기 확신도 점수와 정책 카테고리 태그가 포함되어 있는지 확인하십시오.                  |  3  |  V  |

---

## C2.5 입력 속도 제한 및 남용 방지

개발자는 입력 속도를 제한하고 이상 사용 패턴을 감지하여 AI 시스템에 대한 남용, 자원 고갈 및 자동화된 공격을 방지해야 한다.

|   #   | 설명                                                           | 레벨  | 역할  |
| :---: | ------------------------------------------------------------ | :-: | :-: |
| 2.5.1 | 모든 입력 엔드포인트에서 사용자당, IP당 및 API 키당 속도 제한이 적용되고 있는지 확인합니다.      |  1  | D/V |
| 2.5.2 | 버스트 및 지속 속도 제한이 DoS 및 브루트포스 공격을 방지하도록 조정되어 있는지 확인하십시오.       |  2  | D/V |
| 2.5.3 | 비정상적인 사용 패턴(예: 연속 요청, 입력 폭주)이 자동 차단 또는 에스컬레이션을 트리거하는지 확인합니다. |  2  | D/V |
| 2.5.4 | 남용 방지 로그가 보관되고 새롭게 나타나는 공격 패턴에 대해 검토되는지 확인하십시오.              |  3  |  V  |

---

## C2.6 멀티모달 입력 검증

AI 시스템은 비텍스트 입력(이미지, 오디오, 파일)에 대해 강력한 유효성 검사를 포함해야 하며, 주입 공격, 회피, 또는 자원 남용을 방지해야 한다.

|   #   | 설명                                                            | 레벨  | 역할  |
| :---: | ------------------------------------------------------------- | :-: | :-: |
| 2.6.1 | 처리하기 전에 모든 비텍스트 입력(이미지, 오디오, 파일)의 유형, 크기 및 형식이 검증되었는지 확인하십시오. |  1  |  D  |
| 2.6.2 | 파일이 수집되기 전에 악성 소프트웨어 및 스테가노그래픽 페이로드에 대해 스캔되는지 확인하십시오.         |  2  | D/V |
| 2.6.3 | 이미지/오디오 입력이 적대적 섭동이나 알려진 공격 패턴에 대해 점검되고 있는지 확인하십시오.           |  2  | D/V |
| 2.6.4 | 다중 모달 입력 검증 실패가 로깅되고 조사용 알림이 발생하는지 확인합니다.                     |  3  |  V  |

---

## C2.7 입력 출처 및 귀속

AI 시스템은 모든 사용자 입력의 출처를 모니터링하고 태깅함으로써 감사, 오용 추적 및 규정 준수를 지원해야 한다.

|   #   | 설명                                                                  | 레벨  | 역할  |
| :---: | ------------------------------------------------------------------- | :-: | :-: |
| 2.7.1 | 수집 시 모든 사용자 입력이 메타데이터(사용자 ID, 세션, 소스, 타임스탬프, IP 주소)로 태깅되었는지 확인하십시오. |  1  | D/V |
| 2.7.2 | 처리된 모든 입력에 대해 출처 메타데이터가 보존되고 감사 가능합니다.                              |  2  | D/V |
| 2.7.3 | 의심스럽거나 신뢰할 수 없는 입력 소스가 플래그로 지정되고 강화된 심사 또는 차단의 대상이 되는지 확인하십시오.      |  2  | D/V |

---

## C2.8 실시간 적응형 위협 탐지

개발자는 새로운 공격 패턴에 적응하고 실시간 보호를 제공하는 AI용 고급 위협 탐지 시스템을 도입해야 하며, 컴파일된 패턴 매칭을 사용해야 한다.

|   #   | 설명                                                                                         | 레벨  | 역할  |
| :---: | ------------------------------------------------------------------------------------------ | :-: | :-: |
| 2.8.1 | 위협 탐지 패턴이 고성능 실시간 필터링을 위해 지연을 최소화하도록 최적화된 정규 표현식 엔진으로 컴파일되는지 확인하십시오.                       |  1  | D/V |
| 2.8.2 | 위협 탐지 시스템이 서로 다른 위협 범주에 대해 개별 패턴 라이브러리를 유지하는지 확인합니다(프롬프트 주입, 유해 콘텐츠, 민감한 데이터, 시스템 명령).     |  1  | D/V |
| 2.8.3 | 적응형 위협 탐지가 공격 빈도와 성공률에 따라 위협 민감도를 업데이트하는 기계 학습 모델을 통합하는지 확인하십시오.                           |  2  | D/V |
| 2.8.4 | 실시간 위협 인텔리전스 피드가 새로운 공격 서명과 IOCs(Indicators of Compromise)로 패턴 라이브러리를 자동으로 업데이트하는지 확인하십시오. |  2  | D/V |
| 2.8.5 | 위협 탐지의 거짓 양성 비율은 지속적으로 모니터링되고, 패턴의 특이성은 합법적인 사용 사례 간섭을 최소화하도록 자동으로 조정됩니다.                  |  3  | D/V |
| 2.8.6 | 맥락 기반 위협 분석이 입력 소스, 사용자 행동 패턴 및 세션 이력을 고려하여 탐지 정확도를 높이는지 확인하십시오.                           |  3  | D/V |
| 2.8.7 | 위협 탐지 성능 지표(탐지율, 처리 지연, 자원 활용도)가 실시간으로 모니터링되고 최적화되는지 확인하십시오.                               |  3  | D/V |

---

## C2.9 다중 모달 보안 검증 파이프라인

개발자들은 텍스트, 이미지, 오디오 및 기타 AI 입력 모달리티에 대해 구체적인 유형의 위협 탐지와 리소스 격리를 포함하는 보안 검증을 제공해야 한다.

|   #   | 설명                                                                                                        | 레벨  | 역할  |
| :---: | --------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 2.9.1 | 각 입력 모달리티가 문서화된 위협 패턴과 탐지 임계값을 갖춘 전용 보안 검증기를 보유하고 있는지 확인합니다(텍스트: 프롬프트 인젝션, 이미지: 스테가노그래피, 오디오: 스펙트로그램 공격). |  1  | D/V |
| 2.9.2 | 다중 모달 입력이 각 모달 유형에 대해 정의된 자원 한계(메모리, CPU, 처리 시간)로 격리된 샌드박스에서 처리되며, 이 내용이 보안 정책에 문서화되어 있는지 확인합니다.          |  2  | D/V |
| 2.9.3 | 교차 모달 공격 탐지가 이미지의 스테가노그래픽 페이로드와 텍스트의 프롬프트 주입과 같이 여러 입력 유형에 걸친 협력 공격을 식별하고, 상관 규칙 및 경보 생성을 적용하는지 확인합니다.    |  2  | D/V |
| 2.9.4 | 다중 모달 검증 실패가 모든 입력 모달리티, 검증 결과, 위협 점수 및 SIEM 통합을 위한 구조화된 로그 형식과의 상관 분석을 포함한 상세 로깅을 트리거하는지 확인하십시오.         |  3  | D/V |
| 2.9.5 | 모달리티별 콘텐츠 분류기가 문서화된 일정에 따라 업데이트되도록 확인하고(최소 분기별), 새로운 위협 패턴, 적대적 예제 및 성능 벤치마크를 베이스라인 임계값 이상으로 유지한다.        |  3  | D/V |

---

## 참고문헌

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)


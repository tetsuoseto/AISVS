# C2 사용자 입력 검증

## 통제 목표

사용자 입력에 대한 강력한 검증은 AI 시스템에 대한 가장 치명적인 공격 중 일부에 대한 최우선 방어 수단입니다. 프롬프트 인젝션 공격은 시스템 지침을 무효화하거나 민감한 데이터를 유출시키거나 모델을 허용되지 않은 행동으로 유도할 수 있습니다. 전용 필터와 지침 계층이 마련되어 있지 않으면, 연구에 따르면 매우 긴 컨텍스트 윈도우를 악용하는 "멀티샷" 탈옥 공격이 효과적일 것으로 나타났습니다. 또한, 호모글리프 교체(homoglyph swaps)나 리트스픽(leetspeak)과 같은 미묘한 적대적 교란 공격은 모델의 결정을 조용히 변경할 수 있습니다.

---

## C2.1 프롬프트 인젝션 방어

프롬프트 인젝션은 AI 시스템에 대한 주요 위험 중 하나입니다. 이 전술에 대한 방어는 정적 패턴 필터, 동적 분류기 및 지시 계층 구조 강제를 결합하여 수행됩니다.

|   #   | 설명                                                                                                              | 레벨  | 역할  |
| :---: | --------------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 2.1.1 | 사용자 입력이 지속적으로 업데이트되는 알려진 프롬프트 인젝션 패턴(탈옥 키워드, "이전 무시", 롤플레이 체인, 간접 HTML/URL 공격)에 대해 검증되는지 확인하십시오.                |  1  | D/V |
| 2.1.2 | 시스템 또는 개발자 메시지가 사용자 지침을 무시하고 우선하는 명령 계층 구조를 시스템이 컨텍스트 창 확장 이후에도 준수하는지 확인하십시오.                                   |  1  | D/V |
| 2.1.3 | 모든 모델 또는 프롬프트 템플릿 배포 전에 적대적 평가 테스트(예: 레드 팀 "다중 샷" 프롬프트)가 실행되도록 확인하며, 성공률 임계값과 회귀 방지를 위한 자동 차단기가 설정되어 있는지 검증하세요. |  2  | D/V |
| 2.1.4 | 서드파티 콘텐츠(웹 페이지, PDF, 이메일)에서 발생한 프롬프트가 메인 프롬프트에 연결되기 전에 격리된 파싱 컨텍스트에서 정제되는지 검증하십시오.                              |  2  |  D  |
| 2.1.5 | 모든 프롬프트 필터 규칙 업데이트, 분류기 모델 버전 및 차단 목록 변경 사항이 버전 관리되고 감사 가능하도록 확인하십시오.                                           |  3  | D/V |

---

## C2.2 적대적 예제 저항성

자연어 처리(NLP) 모델은 여전히 사람이 놓치기 쉬운 미묘한 문자 또는 단어 수준의 변형에 취약하며, 이러한 변형을 모델이 잘못 분류하는 경향이 있습니다.

|   #   | 설명                                                                                     | 레벨  | 역할  |
| :---: | -------------------------------------------------------------------------------------- | :-: | :-: |
| 2.2.1 | 기본 입력 정규화 단계(유니코드 NFC, 동형문자 매핑, 공백 제거)가 토큰화 전에 실행되는지 확인하십시오.                           |  1  |  D  |
| 2.2.2 | 통계적 이상 탐지가 언어 표준에 비해 비정상적으로 높은 편집 거리, 과도한 반복 토큰, 또는 비정상적인 임베딩 거리와 함께 입력을 표기하는지 확인하십시오. |  2  | D/V |
| 2.2.3 | 추론 파이프라인이 고위험 엔드포인트를 위해 선택적 적대적 학습 강화 모델 변형 또는 방어 계층(예: 무작위화, 방어적 증류)을 지원하는지 확인하십시오.   |  2  |  D  |
| 2.2.4 | 의심되는 적대적 입력이 격리되고, 전체 페이로드(PII 삭제 후)와 함께 기록되었는지 확인하십시오.                                |  2  |  V  |
| 2.2.5 | 견고성 지표(알려진 공격 스위트의 성공률)가 시간이 지남에 따라 추적되고 회귀가 발생할 경우 릴리스 차단기를 트리거하는지 확인하세요.             |  3  | D/V |

---

## C2.3 스키마, 타입 및 길이 검증

잘못 형성되었거나 과도하게 큰 입력을 특징으로 하는 AI 공격은 구문 분석 오류, 필드 간 프롬프트 누수 및 자원 소모를 초래할 수 있습니다. 결정론적 도구 호출을 수행할 때는 엄격한 스키마 적용도 필수 조건입니다.

|   #   | 설명                                                                                                        | 레벨  | 역할  |
| :---: | --------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 2.3.1 | 모든 API 또는 함수 호출 엔드포인트가 명확한 입력 스키마(JSON 스키마, Protobuf 또는 멀티모달 동등체)를 정의하고 있으며, 프롬프트 조립 전에 입력이 검증되는지 확인하십시오. |  1  |  D  |
| 2.3.2 | 입력이 최대 토큰 또는 바이트 한도를 초과하는 경우 안전한 오류로 거부되고 절대 조용히 잘리지 않는지 확인하십시오.                                          |  1  | D/V |
| 2.3.3 | 유형 검사(예: 숫자 범위, 열거형 값, 이미지/오디오용 MIME 유형)가 클라이언트 코드뿐만 아니라 서버 측에서도 적용되는지 확인하십시오.                            |  2  | D/V |
| 2.3.4 | 의미 검증기(예: JSON Schema)가 알고리즘적 DoS를 방지하기 위해 상수 시간 내에 실행되는지 확인하십시오.                                         |  2  |  D  |
| 2.3.5 | 검증 실패가 보안 대응을 돕기 위해 삭제된 페이로드 스니펫과 명확한 오류 코드와 함께 기록되는지 확인하십시오.                                             |  3  |  V  |

---

## C2.4 콘텐츠 및 정책 심사

개발자는 불법 지시, 증오 발언, 저작권이 있는 텍스트와 같은 허용되지 않은 내용을 요청하는 구문적으로 유효한 프롬프트를 감지한 후 이를 확산하지 못하도록 방지할 수 있어야 합니다.

|   #   | 설명                                                                                           | 레벨  | 역할  |
| :---: | -------------------------------------------------------------------------------------------- | :-: | :-: |
| 2.4.1 | 콘텐츠 분류기(제로샷 또는 파인튜닝된)가 모든 입력에 대해 폭력, 자해, 증오, 성적 콘텐츠 및 불법 요청을 평가하며, 구성 가능한 임계값을 사용하는지 확인하십시오. |  1  |  D  |
| 2.4.2 | 정책을 위반하는 입력이 하위 LLM 호출로 전파되지 않도록 표준화된 거부 또는 안전한 완료를 받는지 확인하십시오.                              |  1  | D/V |
| 2.4.3 | 스크리닝 모델 또는 규칙 집합이 최소 분기별로 재학습/업데이트되어 새로 관찰된 탈출(jailbreak) 또는 정책 우회 패턴이 반영되었는지 확인합니다.         |  2  |  D  |
| 2.4.4 | 요청 시점에 해결되는 속성 기반 규칙을 통해 사용자별 정책(연령, 지역 법적 제한사항 등)이 준수되는지 확인합니다.                             |  2  |  D  |
| 2.4.5 | 스크리닝 로그에 SOC 상관관계 및 향후 레드팀 재연을 위한 분류기 신뢰도 점수와 정책 카테고리 태그가 포함되어 있는지 확인하십시오.                   |  3  |  V  |

---

## C2.5 입력 속도 제한 및 악용 방지

개발자는 입력 속도를 제한하고 이상 사용 패턴을 감지함으로써 AI 시스템에 대한 악용, 자원 고갈 및 자동화된 공격을 방지해야 합니다.

|   #   | 설명                                                           | 레벨  | 역할  |
| :---: | ------------------------------------------------------------ | :-: | :-: |
| 2.5.1 | 모든 입력 엔드포인트에 대해 사용자별, IP별, API 키별 속도 제한이 적용되는지 확인하십시오.       |  1  | D/V |
| 2.5.2 | DoS 및 무차별 대입 공격을 방지하기 위해 버스트 및 지속 속도 제한이 조정되었는지 확인하십시오.      |  2  | D/V |
| 2.5.3 | 비정상적인 사용 패턴(예: 연속 요청, 입력 폭주)이 자동 차단 또는 에스컬레이션을 유발하는지 확인하십시오. |  2  | D/V |
| 2.5.4 | 오남용 방지 로그가 보관되고 새로운 공격 패턴을 위해 검토되는지 확인하십시오.                  |  3  |  V  |

---

## C2.6 다중 모드 입력 검증

AI 시스템은 주입, 회피 또는 자원 남용을 방지하기 위해 비텍스트 입력(이미지, 오디오, 파일)에 대해 강력한 검증을 포함해야 합니다.

|   #   | 설명                                                             | 레벨  | 역할  |
| :---: | -------------------------------------------------------------- | :-: | :-: |
| 2.6.1 | 모든 비텍스트 입력(이미지, 오디오, 파일)이 처리 전에 유형, 크기 및 형식에 대해 검증되었는지 확인하십시오. |  1  |  D  |
| 2.6.2 | 파일이 수집되기 전에 악성코드 및 스테가노그래피 페이로드가 있는지 스캔되는지 확인하십시오.             |  2  | D/V |
| 2.6.3 | 이미지/오디오 입력이 적대적 교란 또는 알려진 공격 패턴에 대해 검사되었는지 확인하십시오.             |  2  | D/V |
| 2.6.4 | 다중 모드 입력 검증 실패가 기록되고 조사를 위한 경고를 발생시키는지 확인하십시오.                 |  3  |  V  |

---

## C2.7 입력 출처 및 귀속

AI 시스템은 모든 사용자 입력의 출처를 모니터링하고 태깅하여 감사, 남용 추적 및 규정 준수를 지원해야 합니다.

|   #   | 설명                                                                    | 레벨  | 역할  |
| :---: | --------------------------------------------------------------------- | :-: | :-: |
| 2.7.1 | 모든 사용자 입력이 수집 시 메타데이터(사용자 ID, 세션, 출처, 타임스탬프, IP 주소)와 함께 태그되는지 확인하십시오. |  1  | D/V |
| 2.7.2 | 모든 처리된 입력에 대해 출처 메타데이터가 유지되고 감사 가능함을 확인합니다.                           |  2  | D/V |
| 2.7.3 | 이상하거나 신뢰할 수 없는 입력 소스가 표시되어 강화된 검사 또는 차단 대상이 되는지 확인하십시오.               |  2  | D/V |

---

## C2.8 실시간 적응형 위협 탐지

개발자는 새로운 공격 패턴에 적응하고 컴파일된 패턴 매칭을 통해 실시간 보호를 제공하는 AI용 고급 위협 탐지 시스템을 사용해야 합니다.

|   #   | 설명                                                                                        | 레벨  | 역할  |
| :---: | ----------------------------------------------------------------------------------------- | :-: | :-: |
| 2.8.1 | 위협 탐지 패턴이 최적화된 정규식 엔진으로 컴파일되어 성능이 뛰어난 실시간 필터링을 최소한의 지연 영향으로 수행하는지 확인하십시오.                 |  1  | D/V |
| 2.8.2 | 위협 탐지 시스템이 서로 다른 위협 범주(프롬프트 인젝션, 유해 콘텐츠, 민감 데이터, 시스템 명령어)에 대해 별도의 패턴 라이브러리를 유지하는지 확인하십시오. |  1  | D/V |
| 2.8.3 | 적응형 위협 탐지가 공격 빈도 및 성공률에 따라 위협 민감도를 업데이트하는 머신러닝 모델을 통합하는지 확인하십시오.                          |  2  | D/V |
| 2.8.4 | 실시간 위협 인텔리전스 피드가 새로운 공격 시그니처와 IOC(침해 지표)로 패턴 라이브러리를 자동으로 업데이트하는지 확인하십시오.                  |  2  | D/V |
| 2.8.5 | 위협 탐지의 오탐률이 지속적으로 모니터링되고 있으며, 합법적인 사용 사례 간섭을 최소화하기 위해 패턴 특이성이 자동으로 조정되는지 확인합니다.           |  3  | D/V |
| 2.8.6 | 맥락 위협 분석이 입력 소스, 사용자 행동 패턴 및 세션 기록을 고려하여 탐지 정확도를 향상시키는지 확인하십시오.                           |  3  | D/V |
| 2.8.7 | 위협 탐지 성능 지표(탐지율, 처리 지연, 자원 사용률)가 실시간으로 모니터링되고 최적화되는지 확인하십시오.                              |  3  | D/V |

---

## C2.9 다중 모달 보안 검증 파이프라인

개발자는 특정 유형의 위협 탐지 및 자원 격리를 통해 텍스트, 이미지, 오디오 및 기타 AI 입력 형태에 대한 보안 검증을 제공해야 합니다.

|   #   | 설명                                                                                                          | 레벨  | 역할  |
| :---: | ----------------------------------------------------------------------------------------------------------- | :-: | :-: |
| 2.9.1 | 각 입력 모달리티에 대해 문서화된 위협 패턴(텍스트: 프롬프트 인젝션, 이미지: 스테가노그래피, 오디오: 스펙트로그램 공격)과 탐지 임계값이 포함된 전용 보안 검증기가 있는지 확인하십시오.   |  1  | D/V |
| 2.9.2 | 다중 모드 입력이 각 모달리티 유형별로 정의된 리소스 제한(메모리, CPU, 처리 시간) 내에서 격리된 샌드박스에서 처리되며, 보안 정책에 문서화되어 있는지 확인하십시오.             |  2  | D/V |
| 2.9.3 | 교차 모달 공격 탐지가 상관 규칙 및 경고 생성을 통해 여러 입력 유형에 걸친 조정된 공격(예: 이미지 내 스테가노그래픽 페이로드와 텍스트 내 프롬프트 인젝션의 결합)을 식별하는지 검증합니다. |  2  | D/V |
| 2.9.4 | 다중 모달 검증 실패가 모든 입력 모달리티, 검증 결과, 위협 점수 및 상관 관계 분석을 포함한 상세 로그 작성을 유발하며, SIEM 통합을 위한 구조화된 로그 형식을 사용하는지 확인하십시오. |  3  | D/V |
| 2.9.5 | 문서화된 일정(최소 분기별)에 따라 모달리티별 콘텐츠 분류기가 새로운 위협 패턴, 적대적 예제 및 성능 벤치마크로 업데이트되어 기준 임계값 이상을 유지하는지 검증하십시오.             |  3  | D/V |

---

## 참고 문헌

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)


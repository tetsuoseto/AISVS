# C5 Контроль доступа & идентификация для компонентов ИИ & пользователей

## Контрольная цель

Эффективный контроль доступа к системам ИИ требует надёжного управления идентификацией, контекстно-зависимой авторизации и обеспечения выполнения во время выполнения в соответствии с принципами нулевого доверия. Эти средства контроля обеспечивают, что люди, сервисы и автономные агенты взаимодействуют только с моделями, данными и вычислительными ресурсами в рамках явно предоставленных областей доступа, с непрерывной верификацией и возможностями аудита.

---

## C5.1 Управление идентификацией и аутентификацией

Установите криптографически подтверждённые идентичности для всех субъектов с многофакторной аутентификацией для привилегированных операций.

|   #   | Описание                                                                                                                                                                                                                                                                                           | Уровень | Роль |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.1.1 | Убедитесь, что все пользователи и служебные принципалы проходят аутентификацию через централизованный корпоративный поставщик идентификации (IdP) с использованием протоколов OIDC/SAML, обеспечивая уникальные соответствия идентичности и токена (без общих учетных записей или учетных данных). |    1    | D/V  |
| 5.1.2 | Убедитесь, что операции высокого риска (развертывание модели, экспорт весов, доступ к данным обучения, изменения производственной конфигурации) требуют многофакторной аутентификации или аутентификации с повышением уровня с повторной проверкой сессии.                                         |    1    | D/V  |
| 5.1.3 | Проверьте, что новые субъекты проходят идентификационную проверку, соответствующую стандартам NIST 800-63-3 IAL-2 или эквивалентным стандартам, до получения доступа к производственной системе.                                                                                                   |    2    |  D   |
| 5.1.4 | Убедитесь, что проверки доступа проводятся ежеквартально с автоматическим обнаружением неактивных учетных записей, обеспечением соблюдения политики ротации учетных записей и процессами отключения учетных записей.                                                                               |    2    |  V   |
| 5.1.5 | Убедитесь, что федеративные ИИ-агенты аутентифицируются через подписанные JWT-утверждения, которые имеют максимальный срок действия 24 часов и включают криптографическое доказательство происхождения.                                                                                            |    3    | D/V  |

---

## C5.2 Авторизация ресурсов и принцип минимальных привилегий

Реализуйте детализированный контроль доступа ко всем ресурсам ИИ с явными моделями разрешений и журналами аудита.

|   #   | Описание                                                                                                                                                                                                                                                                    | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.2.1 | Проверьте, что каждый ресурс ИИ (наборы данных, модели, конечные точки, векторные коллекции, индексы эмбеддингов, вычислительные экземпляры) обеспечивает контроль доступа на основе ролей с явными белыми списками доступа и политиками по умолчанию, запрещающими доступ. |    1    | D/V  |
| 5.2.2 | Проверьте, что принципы минимальных привилегий по умолчанию применяются: учетные записи сервисов начинаются с прав доступа только для чтения, и для доступа на запись требуется документированное обоснование деловой необходимости.                                        |    1    | D/V  |
| 5.2.3 | Проверьте, что все изменения контроля доступа связаны с одобренными запросами на изменение и фиксируются в неизменяемом виде с временными метками, идентификаторами исполнителей, идентификаторами ресурсов и изменениями разрешений.                                       |    1    |  V   |
| 5.2.4 | Убедитесь, что метки классификации данных (PII, PHI, export-controlled, proprietary) автоматически распространяются на производные ресурсы (эмбеддинги, кэши промптов, выходы модели) с последовательным обеспечением соблюдения политики.                                  |    2    |  D   |
| 5.2.5 | Убедитесь, что попытки несанкционированного доступа и события повышения привилегий вызывают оповещения в реальном времени с контекстными метаданными в SIEM-системы в течение 5 минут.                                                                                      |    2    | D/V  |

---

## C5.3 Динамическая оценка политики

Развернуть движки управления доступом на основе атрибутов (ABAC) для контекстно-зависимых решений об авторизации с функциями аудита.

|   #   | Описание                                                                                                                                                                                                                      | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.3.1 | Убедитесь, что решения по авторизации вынесены на внешний движок политики (OPA, Cedar или эквивалент) и доступны через аутентифицированные API с криптографической защитой целостности.                                       |    1    | D/V  |
| 5.3.2 | Убедитесь, что политики оценивают динамические атрибуты во время выполнения, включая уровень допуска пользователя, классификацию чувствительности ресурса, контекст запроса, изоляцию арендаторов и временные ограничения.    |    1    | D/V  |
| 5.3.3 | Убедитесь, что определения политик находятся под контролем версий, проходят рецензирование коллегами и валидируются при помощи автоматизированного тестирования в конвейерах CI/CD перед развёртыванием в продуктивную среду. |    2    |  D   |
| 5.3.4 | Убедитесь, что результаты оценки политики включают структурированные обоснования решений и передаются в системы SIEM для анализа корреляций и формирования отчетности по соблюдению требований.                               |    2    |  V   |
| 5.3.5 | Проверьте, что значения time-to-live (TTL) кэша политики не превышают 5 минут для ресурсов высокой чувствительности и 1 час для стандартных ресурсов с возможностью инвалидации кэша.                                         |    3    | D/V  |

---

## C5.4 Обеспечение безопасности во время выполнения запроса

Реализуйте меры безопасности на уровне базы данных с обязательной фильтрацией и политиками доступа на уровне строк.

|   #   | Описание                                                                                                                                                                                                                                                        | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.4.1 | Убедитесь, что все запросы к векторной базе данных и SQL-запросы включают обязательные фильтры безопасности (идентификатор арендатора, метки чувствительности, область пользователя), которые применяются на уровне движка базы данных, а не в коде приложения. |    1    | D/V  |
| 5.4.2 | Убедитесь, что политики безопасности на уровне строк (RLS) и маскирование на уровне полей включены с наследованием политик для всех векторных баз данных, индексов поиска и обучающих наборов данных.                                                           |    1    | D/V  |
| 5.4.3 | Убедитесь, что неуспешные проверки авторизации предотвращают атаки «запутанного заместителя» путём немедленного прерывания запросов и возврата явных кодов ошибок авторизации, а не возвращения пустых наборов результатов.                                     |    2    |  D   |
| 5.4.4 | Проверьте, что задержка оценки политики непрерывно контролируется с автоматическими оповещениями об условиях тайм-аута, которые могут привести к обходу авторизации.                                                                                            |    2    |  V   |
| 5.4.5 | Убедитесь, что механизмы повторных попыток запросов повторно оценивают политики авторизации с учетом динамических изменений разрешений во время активных сессий пользователей.                                                                                  |    3    | D/V  |

---

## C5.5 Фильтрация вывода и предотвращение утечки данных

Развернуть средства постобработки для предотвращения несанкционированного раскрытия данных в контенте, сгенерированном ИИ.

|   #   | Описание                                                                                                                                                                                                                               | Уровень | Роль |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.5.1 | Проверьте, что механизмы фильтрации после инференса сканируют и редактируют несанкционированную PII (личную идентифицируемую информацию), классифицированную информацию и собственные данные до передачи контента запрашивающим лицам. |    1    | D/V  |
| 5.5.2 | Убедитесь, что цитаты, ссылки и атрибуции источников в выходных данных модели проверяются на соответствие правам доступа вызывающего и удаляются, если обнаружен несанкционированный доступ.                                           |    1    | D/V  |
| 5.5.3 | Проверьте, что ограничения форматов вывода (очищённые PDF-документы, изображения без метаданных, разрешённые типы файлов) применяются в зависимости от уровней разрешений пользователей и классификаций данных.                        |    2    |  D   |
| 5.5.4 | Проверьте, что алгоритмы редактирования данных детерминированы, имеют версионный контроль и ведут журналы аудита, чтобы поддерживать расследования по соблюдению требований и судебно-экспертного анализа.                             |    2    |  V   |
| 5.5.5 | Проверьте, что события редактирования с высоким риском генерируют адаптивные журналы, которые содержат криптографические хэши исходного содержания, предназначенные для судебно-экспертного извлечения без раскрытия данных.           |    3    |  V   |

---

## C5.6 Изоляция многоарендной архитектуры

Обеспечение криптографической и логической изоляции между арендаторами в общей инфраструктуре ИИ.

|   #   | Описание                                                                                                                                                                                                              | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.6.1 | Убедитесь, что пространства памяти, хранилища эмбеддингов, записи кэша и временные файлы изолированы по пространству имен для каждого арендатора с безопасной очисткой при удалении арендатора или завершении сеанса. |    1    | D/V  |
| 5.6.2 | Убедитесь, что каждый API-запрос содержит аутентифицированный идентификатор арендатора, который криптографически валидируется относительно контекста сеанса и прав пользователя.                                      |    1    | D/V  |
| 5.6.3 | Проверьте, что сетевые политики реализуют правила запрета по умолчанию для межарендной связи в рамках сервисных сетей и платформ оркестрации контейнеров.                                                             |    2    |  D   |
| 5.6.4 | Проверьте, что ключи шифрования уникальны для каждого арендатора и поддерживается CMK (ключ, управляемый заказчиком), а также обеспечена криптографическая изоляция между хранилищами данных арендаторов.             |    3    |  D   |

---

## C5.7 Авторизация автономного агента

Контролируйте разрешения для агентов ИИ и автономных систем через токены полномочий с ограниченной областью действия и непрерывную авторизацию.

|   #   | Описание                                                                                                                                                                                                                 | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 5.7.1 | Проверьте, что автономные агенты получают ограниченные по области действия токены полномочий, которые явно перечисляют разрешённые действия, доступные ресурсы, временные рамки и операционные ограничения.              |    1    | D/V  |
| 5.7.2 | Убедитесь, что возможности высокого риска (доступ к файловой системе, выполнение кода, внешние вызовы API, финансовые транзакции) отключены по умолчанию и требуют явных разрешений на активацию с обоснованием бизнеса. |    1    | D/V  |
| 5.7.3 | Убедитесь, что токены возможностей привязаны к сессиям пользователей, обеспечивают криптографическую защиту целостности и не могут сохраняться или повторно использоваться в офлайн‑сценариях.                           |    2    |  D   |
| 5.7.4 | Убедитесь, что агент-инициируемые действия проходят вторичную авторизацию через движок политики ABAC с полной оценкой контекста и ведением журнала аудита.                                                               |    2    |  V   |
| 5.7.5 | Убедитесь, что условия ошибок агента и обработка исключений содержат информацию об области возможностей для поддержки анализа инцидентов и криминалистического расследования.                                            |    3    |  V   |

---

## Список литературы

### Стандарты и фреймворки

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### Руководства по внедрению

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### ИИ-специфическая безопасность

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


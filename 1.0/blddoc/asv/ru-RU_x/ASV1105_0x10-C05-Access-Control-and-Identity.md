# C5 Контроль доступа и идентификация для компонентов ИИ и пользователей

## Цель контроля

Эффективный контроль доступа для систем ИИ требует надежного управления идентификацией, авторизации с учётом контекста и применения правил во время выполнения, исходя из принципов нулевого доверия. Эти меры обеспечивают взаимодействие людей, сервисов и автономных агентов только с моделями, данными и вычислительными ресурсами в рамках явно предоставленных полномочий, с постоянной проверкой и возможностями аудита.

---

## C5.1 Управление идентификацией и аутентификация

Установите криптографически защищённые идентификаторы для всех сущностей с многофакторной аутентификацией для привилегированных операций.

|   #   | Описание                                                                                                                                                                                                                                                                               | Уровень | Роль |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.1.1 | Убедитесь, что все пользователи и сервисные принципы аутентифицируются через централизованного корпоративного провайдера идентификации (IdP) с использованием протоколов OIDC/SAML с уникальным сопоставлением идентификатора и токена (без общих учетных записей или учетных данных). |    1    | D/V  |
| 5.1.2 | Проверьте, что для операций с высоким уровнем риска (развертывание модели, экспорт весов, доступ к учебным данным, изменения конфигурации в производственной среде) требуется многофакторная аутентификация или повышенная аутентификация с повторной валидацией сеанса.               |    1    | D/V  |
| 5.1.3 | Убедитесь, что новые руководители проходят процедуру подтверждения личности, соответствующую стандартам NIST 800-63-3 IAL-2 или эквивалентным, перед получением доступа к производственной системе.                                                                                    |    2    |  D   |
| 5.1.4 | Проверьте, что обзоры доступа проводятся ежеквартально с автоматическим обнаружением неактивных учетных записей, обеспечением ротации учетных данных и рабочими процессами де-провизирования.                                                                                          |    2    |  V   |
| 5.1.5 | Проверьте, что федеративные AI-агенты аутентифицируются с помощью подписанных JWT утверждений, которые имеют максимальный срок действия 24 часа и включают криптографическое доказательство происхождения.                                                                             |    3    | D/V  |

---

## C5.2 Авторизация ресурсов и принцип наименьших привилегий

Реализуйте мелкозернистые механизмы контроля доступа ко всем ресурсам ИИ с использованием явных моделей разрешений и аудиторских следов.

|   #   | Описание                                                                                                                                                                                                                                                      | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.2.1 | Проверьте, что каждый AI-ресурс (наборы данных, модели, конечные точки, векторные коллекции, индексы встраиваний, вычислительные инстансы) применяет ролевой контроль доступа с явными списками разрешений и политиками по умолчанию - отказать.              |    1    | D/V  |
| 5.2.2 | Проверьте, чтобы принципы наименьших привилегий применялись по умолчанию для сервисных аккаунтов, начиная с прав только на чтение, и чтобы для доступа с правами записи требовалось документированное обоснование бизнес-необходимости.                       |    1    | D/V  |
| 5.2.3 | Проверьте, что все изменения в управлении доступом связаны с одобренными запросами на изменения и неизменно зафиксированы с отметками времени, идентификаторами исполнителей, ресурсами и дельтами разрешений.                                                |    1    |  V   |
| 5.2.4 | Убедитесь, что метки классификации данных (PII, PHI, экспортный контроль, конфиденциальная информация) автоматически распространяются на производные ресурсы (векторы признаков, кэши подсказок, результаты моделей) с последовательным применением политики. |    2    |  D   |
| 5.2.5 | Проверьте, что попытки несанкционированного доступа и события повышения привилегий вызывают оповещения в режиме реального времени с контекстными метаданными в SIEM-системы в течение 5 минут.                                                                |    2    | D/V  |

---

## C5.3 Динамическая оценка политики

Развертывайте движки управления доступом на основе атрибутов (ABAC) для принятия контекстно-зависимых решений по авторизации с возможностями аудита.

|   #   | Описание                                                                                                                                                                                                                  | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.3.1 | Убедитесь, что решения об авторизации вынесены во внешний специализированный движок политик (OPA, Cedar или аналогичный), доступный через аутентифицированные API с криптографической защитой целостности.                |    1    | D/V  |
| 5.3.2 | Проверьте, что политики оценивают динамические атрибуты во время выполнения, включая уровень допуска пользователя, классификацию чувствительности ресурса, контекст запроса, изоляцию арендатора и временные ограничения. |    1    | D/V  |
| 5.3.3 | Убедитесь, что определения политик управляются версиями, проходят рецензирование коллегами и проверяются с помощью автоматизированного тестирования в конвейерах CI/CD перед развертыванием в производственной среде.     |    2    |  D   |
| 5.3.4 | Проверьте, что результаты оценки политики включают структурированные обоснования решений и передаются в SIEM-системы для проведения корреляционного анализа и составления отчетов по соблюдению требований.               |    2    |  V   |
| 5.3.5 | Проверьте, что значения времени жизни (TTL) кэша политики не превышают 5 минут для ресурсов с высокой чувствительностью и 1 час для стандартных ресурсов с возможностями инвалидирования кэша.                            |    3    | D/V  |

---

## C5.4 Обеспечение безопасности во время выполнения запросов

Реализуйте меры безопасности на уровне базы данных с обязательной фильтрацией и политиками безопасности на уровне строк.

|   #   | Описание                                                                                                                                                                                                                                          | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.4.1 | Проверьте, что все запросы к векторным базам данных и SQL включают обязательные фильтры безопасности (ID арендатора, метки чувствительности, область действия пользователя), обеспечиваемые на уровне движка базы данных, а не в коде приложения. |    1    | D/V  |
| 5.4.2 | Проверьте, что политики безопасности на уровне строк (RLS) и маскировка на уровне полей включены с наследованием политик для всех векторных баз данных, поисковых индексов и обучающих наборов данных.                                            |    1    | D/V  |
| 5.4.3 | Убедитесь, что неудачные проверки авторизации предотвращают "атаки сбитого с толку заместителя" путем немедленного прекращения запросов и возврата явных кодов ошибок авторизации, а не пустых наборов результатов.                               |    2    |  D   |
| 5.4.4 | Проверьте, что задержка оценки политики постоянно контролируется с помощью автоматических оповещений при условиях тайм-аута, которые могут позволить обход авторизации.                                                                           |    2    |  V   |
| 5.4.5 | Проверьте, что механизмы повторной попытки запросов переоценивают политики авторизации с учётом динамических изменений разрешений в рамках активных пользовательских сессий.                                                                      |    3    | D/V  |

---

## Фильтрация вывода C5.5 и предотвращение потери данных

Внедрите постобработку для предотвращения несанкционированного раскрытия данных в контенте, сгенерированном ИИ.

|   #   | Описание                                                                                                                                                                                                                        | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.5.1 | Проверьте, что механизмы пост-инференционного фильтрования сканируют и редактируют несанкционированные персональные данные (PII), классифицированную информацию и конфиденциальные данные перед передачей контента запросчикам. |    1    | D/V  |
| 5.5.2 | Проверяйте, что цитаты, ссылки и указания источников в выводах модели проверяются на соответствие правам вызывающего и удаляются при обнаружении несанкционированного доступа.                                                  |    1    | D/V  |
| 5.5.3 | Проверьте, что ограничения формата вывода (очищенные PDF-файлы, изображения без метаданных, одобренные типы файлов) применяются в соответствии с уровнями разрешений пользователей и классификацией данных.                     |    2    |  D   |
| 5.5.4 | Убедитесь, что алгоритмы редактирования являются детерминированными, контролируются по версиям и ведут журналы аудита для поддержки расследований на соответствие требованиям и судебного анализа.                              |    2    |  V   |
| 5.5.5 | Проверьте, что события редактирования с высоким уровнем риска генерируют адаптивные журналы, включающие криптографические хэши исходного содержимого для судебного извлечения без раскрытия данных.                             |    3    |  V   |

---

## C5.6 Мультиарендная изоляция

Обеспечьте криптографическую и логическую изоляцию между арендаторами в общей AI-инфраструктуре.

|   #   | Описание                                                                                                                                                                                                      | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 5.6.1 | Убедитесь, что области памяти, хранилища эмбедингов, кэш-записи и временные файлы разделены по пространствам имён для каждого арендатора с безопасной очисткой при удалении арендатора или завершении сессии. |    1    | D/V  |
| 5.6.2 | Проверьте, чтобы каждый API-запрос включал аутентифицированный идентификатор арендатора, который криптографически проверяется с учётом контекста сессии и прав пользователя.                                  |    1    | D/V  |
| 5.6.3 | Проверьте, что сетевые политики реализуют правила по умолчанию с запретом для межарендного взаимодействия в сервисных сетях и платформах оркестрации контейнеров.                                             |    2    |  D   |
| 5.6.4 | Проверьте, что ключи шифрования уникальны для каждого арендатора с поддержкой управления ключами клиентом (CMK) и криптографической изоляцией между хранилищами данных арендаторов.                           |    3    |  D   |

---

## C5.7 Авторизация автономного агента

Управление правами доступа для AI-агентов и автономных систем с помощью ограниченных токенов возможностей и непрерывной авторизации.

|   #   | Описание                                                                                                                                                                                                                                   | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 5.7.1 | Убедитесь, что автономные агенты получают ограниченные токены доступа, которые явно перечисляют разрешённые действия, доступные ресурсы, временные границы и операционные ограничения.                                                     |    1    | D/V  |
| 5.7.2 | Проверьте, что функции с высоким уровнем риска (доступ к файловой системе, выполнение кода, вызовы внешних API, финансовые операции) по умолчанию отключены и требуют явных разрешений на активацию с обоснованием с точки зрения бизнеса. |    1    | D/V  |
| 5.7.3 | Проверьте, что маркеры полномочий привязаны к пользовательским сессиям, включают криптографическую защиту целостности и гарантируют, что они не могут сохраняться или использоваться повторно в автономных сценариях.                      |    2    |  D   |
| 5.7.4 | Убедитесь, что действия, инициированные агентом, проходят вторичную авторизацию через движок политик ABAC с полной оценкой контекста и ведением аудита.                                                                                    |    2    |  V   |
| 5.7.5 | Проверьте, что условия ошибок агента и обработка исключений включают информацию о масштабе возможностей для поддержки анализа инцидентов и судебного расследования.                                                                        |    3    |  V   |

---

## Ссылки

### Стандарты и рамочные структуры

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### Руководства по внедрению

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### Безопасность, специфичная для ИИ

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)


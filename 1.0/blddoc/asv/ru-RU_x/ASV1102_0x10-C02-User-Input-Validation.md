# Проверка вводимых данных пользователя C2

## Цель управления

Надежная проверка пользовательского ввода является первой линией защиты от некоторых из самых разрушительных атак на системы искусственного интеллекта. Атаки внедрения подсказок могут переопределять системные инструкции, раскрывать конфиденциальные данные или направлять модель на нежелательное поведение. Если не использовать специальные фильтры и иерархии инструкций, исследования показывают, что «многошаговые» jailbreak-атаки, эксплуатирующие очень длинные контекстные окна, будут эффективными. Также тонкие атаки с использованием адверсариальных возмущений — такие как замены гомоглифов или «лиспик» — могут незаметно изменять решения модели.

---

## C2.1 Защита от внедрения подсказок

Внедрение подсказок является одним из главных рисков для AI-систем. Защита от этой тактики использует комбинацию статических фильтров по шаблонам, динамических классификаторов и обеспечения иерархии инструкций.

|   #   | Описание                                                                                                                                                                                                                                                           | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 2.1.1 | Проверьте, что пользовательские вводы проверяются на соответствие постоянно обновляемой библиотеке известных шаблонов внедрения запросов (ключевые слова для обхода ограничений, "игнорировать предыдущие", цепочки ролевой игры, косвенные атаки через HTML/URL). |    1    | D/V  |
| 2.1.2 | Проверьте, что система обеспечивает иерархию инструкций, в которой сообщения системы или разработчика имеют приоритет над инструкциями пользователя, даже после расширения окна контекста.                                                                         |    1    | D/V  |
| 2.1.3 | Убедитесь, что тесты враждебной оценки (например, множественные запросы Red Team) проводятся перед каждым выпуском модели или шаблона запроса, с установленными порогами успеха и автоматическими блокировщиками для регрессий.                                    |    2    | D/V  |
| 2.1.4 | Проверьте, что подсказки, исходящие из стороннего контента (веб-страницы, PDF, электронные письма), проходят очистку в изолированном контекстe парсинга перед объединением в основной подсказке.                                                                   |    2    |  D   |
| 2.1.5 | Убедитесь, что все обновления правил фильтрации запросов, версии моделей классификатора и изменения в черных списках находятся под управлением версий и могут быть проверены.                                                                                      |    3    | D/V  |

---

## C2.2 Сопротивляемость к атакам с помощью враждебных примеров

Модели обработки естественного языка (NLP) по-прежнему уязвимы к тонким искажениям на уровне символов или слов, которые люди часто не замечают, но которые модели склонны неправильно классифицировать.

|   #   | Описание                                                                                                                                                                                                                                         | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 2.2.1 | Проверьте, что основные шаги нормализации ввода (Unicode NFC, отображение гомоглифов, обрезка пробелов) выполняются до токенизации.                                                                                                              |    1    |  D   |
| 2.2.2 | Проверьте, что обнаружение статистических аномалий отмечает входные данные с необычно высокой редакционной дистанцией по сравнению с языковыми нормами, чрезмерным количеством повторяющихся токенов или аномальными расстояниями в эмбеддингах. |    2    | D/V  |
| 2.2.3 | Проверьте, что конвейер инференса поддерживает варианты моделей, усиленных с помощью необязательной адверсариальной тренировки, или защитные слои (например, рандомизация, защитная дистилляция) для высокорисковых конечных точек.              |    2    |  D   |
| 2.2.4 | Убедитесь, что подозрительные враждебные входные данные помещены в карантин и зафиксированы с полными полезными нагрузками (после удаления персональных данных).                                                                                 |    2    |  V   |
| 2.2.5 | Убедитесь, что метрики устойчивости (процент успешности известных наборов атак) отслеживаются с течением времени, а регрессии вызывают блокировку выпуска.                                                                                       |    3    | D/V  |

---

## C2.3 Проверка схемы, типа и длины

Атаки на основе ИИ с использованием некорректных или слишком больших входных данных могут вызывать ошибки парсинга, распространение подсказок между полями и истощение ресурсов. Жесткое соблюдение схемы также является необходимым условием при выполнении детерминированных вызовов инструментов.

|   #   | Описание                                                                                                                                                                                                   | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 2.3.1 | Проверьте, что каждая точка вызова API или функции определяет явную схему входных данных (JSON Schema, Protobuf или мультимодальный эквивалент) и что входные данные проходят валидацию до сборки запроса. |    1    |  D   |
| 2.3.2 | Проверьте, что входные данные, превышающие максимальные лимиты токенов или байтов, отклоняются с безопасной ошибкой и никогда не обрезаются без уведомления.                                               |    1    | D/V  |
| 2.3.3 | Убедитесь, что проверки типов (например, числовые диапазоны, значения перечислений, MIME-типы для изображений/аудио) выполняются на стороне сервера, а не только в клиентском коде.                        |    2    | D/V  |
| 2.3.4 | Проверьте, что семантические валидаторы (например, JSON Schema) работают за постоянное время, чтобы предотвратить алгоритмические DoS-атаки.                                                               |    2    |  D   |
| 2.3.5 | Проверьте, что ошибки валидации записываются с отредактированными фрагментами полезной нагрузки и однозначными кодами ошибок для облегчения проведения оценки безопасности.                                |    3    |  V   |

---

## C2.4 Анализ содержания и политики

Разработчики должны уметь обнаруживать синтаксически корректные запросы, содержащие запрещённый контент (например, нелегальные инструкции, речь ненависти и защищённый авторским правом текст), и предотвращать их распространение.

|   #   | Описание                                                                                                                                                                                                                              | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 2.4.1 | Проверьте, что классификатор контента (нулевой выстрел или с дообучением) оценивает каждый ввод по признакам насилия, самоповреждения, ненависти, сексуального контента и незаконных запросов с настраиваемыми пороговыми значениями. |    1    |  D   |
| 2.4.2 | Проверьте, что входные данные, нарушающие политики, будут получать стандартизированные отказы или безопасные завершения, чтобы они не передавались в последующие вызовы языковых моделей.                                             |    1    | D/V  |
| 2.4.3 | Проверьте, что модель скрининга или набор правил переобучаются/обновляются как минимум ежеквартально с учетом недавно обнаруженных паттернов обхода защит или нарушений политики.                                                     |    2    |  D   |
| 2.4.4 | Проверяйте, что скрининг соблюдает пользовательско-специфичные политики (возраст, региональные правовые ограничения) посредством правил на основе атрибутов, разрешаемых во время запроса.                                            |    2    |  D   |
| 2.4.5 | Проверьте, что журналы скрининга включают оценки доверия классификатора и теги категорий политик для корреляции SOC и последующего воспроизведения красной команды.                                                                   |    3    |  V   |

---

## C2.5 Ограничение скорости ввода и предотвращение злоупотреблений

Разработчикам следует предотвращать злоупотребления, истощение ресурсов и автоматизированные атаки на ИИ-системы путем ограничения скорости ввода и обнаружения аномальных моделей использования.

|   #   | Описание                                                                                                                                            | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 2.5.1 | Проверьте, что ограничения по скорости для каждого пользователя, каждого IP и каждого API-ключа применяются ко всем входным конечным точкам.        |    1    | D/V  |
| 2.5.2 | Проверьте, что пиковые и устойчивые ограничения скорости настроены таким образом, чтобы предотвращать DoS- и атаки перебором.                       |    2    | D/V  |
| 2.5.3 | Проверьте, что аномальные шаблоны использования (например, частые запросы, потоковый ввод данных) вызывают автоматические блокировки или эскалации. |    2    | D/V  |
| 2.5.4 | Проверьте, что журналы предотвращения злоупотреблений сохраняются и анализируются для выявления новых моделей атак.                                 |    3    |  V   |

---

## C2.6 Многоформатная проверка входных данных

Системы ИИ должны включать надежную валидацию для нетекстовых входных данных (изображения, аудио, файлы) для предотвращения инъекций, обхода или злоупотребления ресурсами.

|   #   | Описание                                                                                                                          | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 2.6.1 | Убедитесь, что все нетекстовые входные данные (изображения, аудио, файлы) проверяются на тип, размер и формат перед обработкой.   |    1    |  D   |
| 2.6.2 | Убедитесь, что файлы проверяются на наличие вредоносного ПО и стеганографических полезных нагрузок перед загрузкой.               |    2    | D/V  |
| 2.6.3 | Проверьте, что входные данные изображения/аудио проверяются на наличие адверсариальных возмущений или известных схем атак.        |    2    | D/V  |
| 2.6.4 | Проверьте, что ошибки валидации мультимодальных входных данных регистрируются и вызывают оповещения для проведения расследования. |    3    |  V   |

---

## C2.7 Происхождение и атрибуция входных данных

Системы ИИ должны поддерживать аудит, отслеживание злоупотреблений и соблюдение требований путем мониторинга и маркировки источников всех пользовательских вводов.

|   #   | Описание                                                                                                                                        | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 2.7.1 | Проверьте, что все пользовательские вводы помечены метаданными (ID пользователя, сессия, источник, временная метка, IP-адрес) при их получении. |    1    | D/V  |
| 2.7.2 | Убедитесь, что метаданные происхождения сохраняются и доступны для аудита для всех обработанных входных данных.                                 |    2    | D/V  |
| 2.7.3 | Убедитесь, что аномальные или ненадежные источники ввода помечаются и подвергаются усиленному контролю или блокировке.                          |    2    | D/V  |

---

## C2.8 Адаптивное обнаружение угроз в реальном времени

Разработчики должны использовать передовые системы обнаружения угроз для ИИ, которые адаптируются к новым схемам атак и обеспечивают защиту в реальном времени с помощью скомпилированного сопоставления шаблонов.

|   #   | Описание                                                                                                                                                                                                         | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 2.8.1 | Проверьте, что шаблоны обнаружения угроз скомпилированы в оптимизированные движки регулярных выражений для высокопроизводительной фильтрации в режиме реального времени с минимальным влиянием на задержку.      |    1    | D/V  |
| 2.8.2 | Проверьте, что системы обнаружения угроз поддерживают отдельные библиотеки шаблонов для разных категорий угроз (внедрение подсказок, вредоносный контент, конфиденциальные данные, системные команды).           |    1    | D/V  |
| 2.8.3 | Проверьте, что адаптивное обнаружение угроз включает модели машинного обучения, которые обновляют чувствительность к угрозам на основе частоты атак и уровня их успешности.                                      |    2    | D/V  |
| 2.8.4 | Проверьте, что потоки информации об угрозах в режиме реального времени автоматически обновляют библиотеки шаблонов новыми сигнатурами атак и IOC (индикаторами компрометации).                                   |    2    | D/V  |
| 2.8.5 | Убедитесь, что показатели ложных срабатываний системы обнаружения угроз постоянно контролируются, а специфичность шаблонов автоматически настраивается для минимизации помех легитимным сценариям использования. |    3    | D/V  |
| 2.8.6 | Убедитесь, что контекстный анализ угроз учитывает источник ввода, паттерны поведения пользователя и историю сессий для повышения точности обнаружения.                                                           |    3    | D/V  |
| 2.8.7 | Убедитесь, что метрики эффективности обнаружения угроз (коэффициент обнаружения, задержка обработки, использование ресурсов) контролируются и оптимизируются в режиме реального времени.                         |    3    | D/V  |

---

## C2.9 Многоуровневая конвейерная система проверки безопасности

Разработчики должны обеспечивать проверку безопасности для текстовых, визуальных, аудио и других модальностей ввода ИИ с использованием специфических методов обнаружения угроз и изоляции ресурсов.

|   #   | Описание                                                                                                                                                                                                                                                                                  | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 2.9.1 | Проверьте, что у каждой входной модальности есть выделенные валидаторы безопасности с задокументированными шаблонами угроз (текст: инъекция подсказок, изображения: стеганография, аудио: атаки на спектрограмму) и порогами обнаружения.                                                 |    1    | D/V  |
| 2.9.2 | Проверьте, что мультимодальные входные данные обрабатываются в изолированных песочницах с определёнными ограничениями ресурсов (память, CPU, время обработки), специфичными для каждого типа модальности, и документируются в политиках безопасности.                                     |    2    | D/V  |
| 2.9.3 | Проверьте, что обнаружение межмодальных атак выявляет скоординированные атаки, охватывающие несколько типов входных данных (например, стеганографические полезные нагрузки в изображениях в сочетании с инъекцией подсказок в тексте) с помощью правил корреляции и генерации оповещений. |    2    | D/V  |
| 2.9.4 | Проверьте, что ошибки многофункциональной валидации вызывают подробное логирование, включая все входные модальности, результаты валидации, оценки угроз и корреляционный анализ с использованием структурированных форматов логов для интеграции с SIEM.                                  |    3    | D/V  |
| 2.9.5 | Проверяйте, что специализированные классификаторы контента для каждой модальности обновляются в соответствии с задокументированными графиками (минимум раз в квартал) новыми шаблонами угроз, примерами атак и соответствуют показателям производительности выше базовых порогов.         |    3    | D/V  |

---

## Ссылки

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)


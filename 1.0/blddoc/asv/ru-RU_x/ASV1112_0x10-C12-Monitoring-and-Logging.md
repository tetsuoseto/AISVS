# C12 Мониторинг, логирование и обнаружение аномалий

## Контрольная цель

Этот раздел устанавливает требования к обеспечению видимости в реальном времени и судебно-экспертной видимости того, что модель и другие компоненты ИИ видят, что делают и что возвращают, чтобы угрозы можно было обнаруживать, классифицировать по приоритетам и извлекать из этого уроки.

## C12.1 Логирование запросов и ответов

|   #    | Описание                                                                                                                                                                                                                                                     | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 12.1.1 | Убедитесь, что все запросы пользователя и ответы модели регистрируются с соответствующими метаданными (например, временная метка, идентификатор пользователя, идентификатор сеанса, версия модели).                                                          |    1    | D/V  |
| 12.1.2 | Убедитесь, что логи хранятся в безопасных репозиториях с контролем доступа и соответствующими политиками хранения и процедурами резервного копирования.                                                                                                      |    1    | D/V  |
| 12.1.3 | Проверьте, что системы хранения логов реализуют шифрование в состоянии покоя и при передаче, чтобы защитить конфиденциальную информацию, содержащуюся в логах.                                                                                               |    1    | D/V  |
| 12.1.4 | Убедитесь, что чувствительные данные в запросах и выводах автоматически маскируются или скрываются перед логированием, с настраиваемыми правилами маскирования для PII (персональные идентифицируемые данные), учетных данных и конфиденциальной информации. |    1    | D/V  |
| 12.1.5 | Убедитесь, что решения по политике модерации контента и действия по фильтрации с обеспечением безопасности регистрируются с достаточной детализацией для аудита и отладки систем модерации контента.                                                         |    2    | D/V  |
| 12.1.6 | Убедитесь, что целостность журналов защищена, например, с помощью криптографических подписей или хранилища только для записи.                                                                                                                                |    2    | D/V  |

---

## C12.2 Обнаружение злоупотреблений и оповещение

|   #    | Описание                                                                                                                                                                                                             | Уровень | Роль |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.2.1 | Убедитесь, что система обнаруживает и оповещает об известных паттернах джейлбрейка, попытках внедрения подсказок и адверсариальных входных данных с использованием детекции на основе сигнатур.                      |    1    | D/V  |
| 12.2.2 | Проверьте, что система интегрируется с существующими платформами СИЭМ (Security Information and Event Management) с использованием стандартных форматов логов и протоколов.                                          |    1    | D/V  |
| 12.2.3 | Проверьте, что обогащённые события безопасности включают ИИ-специфичный контекст, такой как идентификаторы моделей, оценки доверия и решения фильтра по безопасности.                                                |    2    | D/V  |
| 12.2.4 | Убедитесь, что обнаружение аномалий в поведении выявляет нетипичные образцы разговоров, чрезмерные повторные попытки или систематическое зондирование.                                                               |    2    | D/V  |
| 12.2.5 | Убедитесь, что механизмы оповещения в реальном времени уведомляют команды безопасности, когда обнаруживаются потенциальные нарушения политики или попытки атаки.                                                     |    2    | D/V  |
| 12.2.6 | Убедитесь, что включены пользовательские правила для обнаружения угроз, специфичных для ИИ, включая координированные попытки обхода ограничений, кампании по инъекции подсказок и атаки на извлечение модели.        |    2    | D/V  |
| 12.2.7 | Убедитесь, что автоматизированные процессы реагирования на инциденты могут изолировать скомпрометированные модели, блокировать злоумышленников и эскалировать критически важные события информационной безопасности. |    3    | D/V  |

---

## C12.3 Обнаружение дрейфа модели

|   #    | Описание                                                                                                                                                                                           | Уровень | Роль |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.3.1 | Убедитесь, что система отслеживает базовые показатели эффективности, такие как точность, оценки уверенности, задержка и уровень ошибок для разных версий моделей и за различные временные периоды. |    1    | D/V  |
| 12.3.2 | Проверьте, что автоматизированные оповещения срабатывают, когда показатели производительности превышают заранее определённые пороги деградации или существенно отклоняются от базовых значений.    |    2    | D/V  |
| 12.3.3 | Убедитесь, что мониторы обнаружения галлюцинаций идентифицируют и помечают случаи, когда выходы модели содержат фактически некорректную, противоречивую или вымышленную информацию.                |    2    | D/V  |

---

## C12.4 Телеметрия производительности и поведения

|   #    | Описание                                                                                                                                                                     | Уровень | Роль |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.4.1 | Убедитесь, что операционные метрики, включая задержку запросов, расход токенов, использование памяти и пропускную способность, непрерывно собираются и мониторятся.          |    1    | D/V  |
| 12.4.2 | Убедитесь, что частоты успеха и неудач отслеживаются с категоризацией типов ошибок и их корневых причин.                                                                     |    1    | D/V  |
| 12.4.3 | Убедитесь, что мониторинг использования ресурсов включает использование GPU/CPU, потребление памяти и требования к хранилищу, с оповещением о превышении пороговых значений. |    2    | D/V  |

---

## C12.5 Планирование и выполнение реагирования на инциденты ИИ.

|   #    | Описание                                                                                                                                                                              | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.5.1 | Убедитесь, что планы реагирования на инциденты в частности охватывают события безопасности, связанные с ИИ, включая компрометацию модели, загрязнение данных и адверсариальные атаки. |    1    | D/V  |
| 12.5.2 | Проверьте, что команды реагирования на инциденты имеют доступ к инструментам форензики, специфичным для ИИ, и к экспертизе по расследованию поведения моделей и векторов атак.        |    2    | D/V  |
| 12.5.3 | Убедитесь, что постинцидентный анализ включает соображения по повторному обучению модели, обновления фильтров безопасности и интеграцию извлечённых уроков в контроли безопасности.   |    3    | D/V  |

---

## C12.5 Обнаружение деградации производительности ИИ

Мониторьте и обнаруживайте ухудшение производительности и качества моделей ИИ со временем.

|   #    | Описание                                                                                                                                              | Уровень | Роль |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.5.1 | Убедитесь, что точность модели, прецизионность, полнота и F1-оценки непрерывно контролируются и сравниваются с базовыми порогами.                     |    1    | D/V  |
| 12.5.2 | Убедитесь, что обнаружение дрейфа данных отслеживает изменения входного распределения, которые могут повлиять на производительность модели.           |    1    | D/V  |
| 12.5.3 | Убедитесь, что обнаружение дрейфа концепции выявляет изменения в зависимости между входами и ожидаемыми выходами.                                     |    2    | D/V  |
| 12.5.4 | Проверьте, что ухудшение производительности вызывает автоматические оповещения и инициирует потоки работ по повторному обучению модели или её замене. |    2    | D/V  |
| 12.5.5 | Убедитесь, что анализ причин деградации связывает падения производительности с изменениями данных, проблемами инфраструктуры или внешними факторами.  |    3    |  V   |

---

## C12.6 Визуализация направленного ациклического графа (DAG) и безопасность рабочих процессов

Защитите системы визуализации рабочих процессов от утечек информации и атак на манипулирование.

|   #    | Описание                                                                                                                                                                                     | Уровень | Роль |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.6.1 | Убедитесь, что данные визуализации DAG очищаются от конфиденциальной информации до сохранения или передачи.                                                                                  |    1    | D/V  |
| 12.6.2 | Проверьте, что контроль доступа к визуализации рабочих процессов обеспечивает просмотр путей принятия решений агентов и следов рассуждений только авторизованными пользователями.            |    1    | D/V  |
| 12.6.3 | Проверьте, что целостность данных DAG обеспечена за счет криптографических подписей и механизмов хранения, которые обнаруживают попытки подделки.                                            |    2    | D/V  |
| 12.6.4 | Проверьте, реализуют ли системы визуализации рабочих процессов проверку входных данных с целью предотвращения инъекционных атак через специально сконструированные данные узлов и/или рёбер. |    2    | D/V  |
| 12.6.5 | Проверьте, что обновления DAG в реальном времени ограничены по скорости и проходят валидацию, чтобы предотвратить атаки отказа в обслуживании на системах визуализации.                      |    3    | D/V  |

---

## C12.7 Проактивный мониторинг поведения в области безопасности

Обнаружение и предотвращение угроз безопасности через проактивный анализ поведения агентов.

|   #    | Описание                                                                                                                                                      | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.7.1 | Убедитесь, что проактивное поведение агентов проходит проверку безопасности перед выполнением с интеграцией оценки рисков.                                    |    1    | D/V  |
| 12.7.2 | Убедитесь, что триггеры автономной инициативы включают оценку контекста безопасности и оценку ландшафта угроз.                                                |    2    | D/V  |
| 12.7.3 | Проверьте, что проактивные паттерны поведения анализируются на предмет потенциальных последствий для безопасности и непредвиденных последствий.               |    2    | D/V  |
| 12.7.4 | Убедитесь, что проактивные действия, критичные для безопасности, требуют явных цепочек одобрения с журналами аудита.                                          |    3    | D/V  |
| 12.7.5 | Проверьте, что обнаружение поведенческих аномалий идентифицирует отклонения в паттернах проактивных агентов, которые могут свидетельствовать о компрометации. |    3    | D/V  |

---

## Список литературы

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


# C12 Мониторинг, ведение журналов и обнаружение аномалий

## Цель контроля

Этот раздел содержит требования для обеспечения видимости в реальном времени и криминалистического анализа того, что модель и другие компоненты ИИ видят, делают и возвращают, чтобы угрозы можно было обнаруживать, классифицировать и изучать.

## C12.1 Логирование запросов и ответов

|   #    | Описание                                                                                                                                                                                                                                            | Уровень | Роль |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.1.1 | Убедитесь, что все запросы пользователей и ответы модели фиксируются с соответствующими метаданными (например, временная метка, идентификатор пользователя, идентификатор сессии, версия модели).                                                   |    1    | D/V  |
| 12.1.2 | Убедитесь, что журналы хранятся в защищённых репозиториях с контролируемым доступом, соответствующими политиками хранения и процедурами резервного копирования.                                                                                     |    1    | D/V  |
| 12.1.3 | Убедитесь, что системы хранения логов реализуют шифрование данных в состоянии покоя и при передаче для защиты конфиденциальной информации, содержащейся в логах.                                                                                    |    1    | D/V  |
| 12.1.4 | Убедитесь, что конфиденциальные данные в подсказках и выводах автоматически редактируются или скрываются перед логированием, с настраиваемыми правилами редактирования для персональных данных (PII), учетных данных и конфиденциальной информации. |    1    | D/V  |
| 12.1.5 | Проверьте, что решения по политике и действия по фильтрации безопасности фиксируются с достаточной детализацией, чтобы обеспечить возможность аудита и отладки систем модерации контента.                                                           |    2    | D/V  |
| 12.1.6 | Проверьте, что целостность журнала защищена, например, с помощью криптографических подписей или записи только для записи.                                                                                                                           |    2    | D/V  |

---

## C12.2 Обнаружение злоупотреблений и оповещение

|   #    | Описание                                                                                                                                                                                                                                             | Уровень | Роль |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.2.1 | Проверьте, что система обнаруживает и оповещает о известных шаблонах взлома, попытках внедрения подсказок и враждебных входных данных с использованием сигнатурного обнаружения.                                                                     |    1    | D/V  |
| 12.2.2 | Убедитесь, что система интегрируется с существующими платформами управления информацией и событиями безопасности (SIEM) с использованием стандартных форматов журналов и протоколов.                                                                 |    1    | D/V  |
| 12.2.3 | Проверьте, что обогащенные события безопасности содержат контекст, специфичный для ИИ, такой как идентификаторы моделей, оценки уверенности и решения фильтра безопасности.                                                                          |    2    | D/V  |
| 12.2.4 | Проверьте, что обнаружение поведенческих аномалий выявляет необычные шаблоны общения, чрезмерное количество попыток повторения или систематические попытки зондирования.                                                                             |    2    | D/V  |
| 12.2.5 | Проверьте, что механизмы оповещения в реальном времени уведомляют команды безопасности при обнаружении потенциальных нарушений политики или попыток атаки.                                                                                           |    2    | D/V  |
| 12.2.6 | Убедитесь, что включены пользовательские правила для обнаружения характерных для ИИ моделей угроз, включая скоординированные попытки обхода ограничений (jailbreak), кампании по внедрению запросов (prompt injection) и атаки на извлечение модели. |    2    | D/V  |
| 12.2.7 | Проверьте, что автоматизированные рабочие процессы реагирования на инциденты могут изолировать скомпрометированные модели, блокировать вредоносных пользователей и эскалировать критические события безопасности.                                    |    3    | D/V  |

---

## C12.3 Обнаружение дрейфа модели

|   #    | Описание                                                                                                                                                                                       | Уровень | Роль |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.3.1 | Проверьте, что система отслеживает базовые показатели производительности, такие как точность, показатели уверенности, задержка и уровни ошибок для разных версий моделей и временных периодов. |    1    | D/V  |
| 12.3.2 | Проверьте, что автоматическое оповещение срабатывает, когда показатели производительности превышают заранее определённые пороги деградации или значительно отклоняются от базовых значений.    |    2    | D/V  |
| 12.3.3 | Проверьте, что системы обнаружения галлюцинаций выявляют и помечают случаи, когда выводы модели содержат фактически неверную, несогласованную или вымышленную информацию.                      |    2    | D/V  |

---

## C12.4 Телеметрия производительности и поведения

|   #    | Описание                                                                                                                                                                        | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.4.1 | Убедитесь, что операционные метрики, включая задержку запросов, потребление токенов, использование памяти и пропускную способность, непрерывно собираются и мониторятся.        |    1    | D/V  |
| 12.4.2 | Проверьте, что показатели успеха и неудачи отслеживаются с категоризацией типов ошибок и их основных причин.                                                                    |    1    | D/V  |
| 12.4.3 | Проверьте, что мониторинг использования ресурсов включает использование GPU/CPU, потребление памяти и требования к хранению, с уведомлениями при превышении пороговых значений. |    2    | D/V  |

---

## C12.5 Планирование и выполнение реагирования на инциденты с ИИ

|   #    | Описание                                                                                                                                                                              | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.5.1 | Убедитесь, что планы реагирования на инциденты специально охватывают события безопасности, связанные с ИИ, включая компрометацию моделей, отравление данных и атакующие воздействия.  |    1    | D/V  |
| 12.5.2 | Убедитесь, что команды реагирования на инциденты имеют доступ к специализированным судебным инструментам ИИ и экспертным знаниям для расследования поведения моделей и векторов атак. |    2    | D/V  |
| 12.5.3 | Убедитесь, что постинцидентный анализ включает учет переобучения модели, обновления фильтров безопасности и интеграцию извлеченных уроков в меры безопасности.                        |    3    | D/V  |

---

## C12.5 Обнаружение деградации производительности ИИ

Отслеживать и выявлять ухудшение производительности и качества модели ИИ с течением времени.

|   #    | Описание                                                                                                                                                       | Уровень | Роль |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.5.1 | Убедитесь, что точность модели, точность, полнота и F1-оценки непрерывно отслеживаются и сравниваются с базовыми пороговыми значениями.                        |    1    | D/V  |
| 12.5.2 | Убедитесь, что обнаружение дрейфа данных контролирует изменения распределения входных данных, которые могут повлиять на производительность модели.             |    1    | D/V  |
| 12.5.3 | Проверьте, что обнаружение дрейфа концепции выявляет изменения во взаимосвязи между входными данными и ожидаемыми выходными результатами.                      |    2    | D/V  |
| 12.5.4 | Проверьте, что ухудшение производительности вызывает автоматические оповещения и запускает процессы дообучения или замены модели.                              |    2    | D/V  |
| 12.5.5 | Проверьте, что анализ коренной причины деградации связывает падение производительности с изменениями данных, проблемами инфраструктуры или внешними факторами. |    3    |  V   |

---

## C12.6 Визуализация DAG и безопасность рабочих процессов

Защитите системы визуализации рабочих процессов от утечки информации и атак с целью манипуляции.

|   #    | Описание                                                                                                                                                                                                | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.6.1 | Проверьте, что данные визуализации DAG очищены от конфиденциальной информации перед хранением или передачей.                                                                                            |    1    | D/V  |
| 12.6.2 | Проверьте, что средства контроля доступа к визуализации рабочих процессов обеспечивают возможность просмотра путей принятия решений агентом и следов рассуждений только уполномоченными пользователями. |    1    | D/V  |
| 12.6.3 | Проверьте, что целостность данных DAG защищена с помощью криптографических подписей и механизмов хранения с обнаружением подделок.                                                                      |    2    | D/V  |
| 12.6.4 | Убедитесь, что системы визуализации рабочих процессов реализуют проверку входных данных для предотвращения инъекционных атак через специально сформированные данные узлов или ребер.                    |    2    | D/V  |
| 12.6.5 | Проверьте, что обновления DAG в реальном времени ограничены по частоте и проходят проверку для предотвращения атак типа "отказ в обслуживании" на системы визуализации.                                 |    3    | D/V  |

---

## C12.7 Проактивный мониторинг поведения в области безопасности

Обнаружение и предотвращение угроз безопасности посредством проактивного анализа поведения агентов.

|   #    | Описание                                                                                                                                                  | Уровень | Роль |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.7.1 | Проверьте, что проактивные действия агента проходят проверку безопасности перед выполнением с интеграцией оценки рисков.                                  |    1    | D/V  |
| 12.7.2 | Проверьте, что триггеры автономной инициативы включают оценку контекста безопасности и анализ ландшафта угроз.                                            |    2    | D/V  |
| 12.7.3 | Проверьте, что шаблоны проактивного поведения анализируются на предмет потенциальных последствий для безопасности и непреднамеренных эффектов.            |    2    | D/V  |
| 12.7.4 | Проверьте, что критически важные для безопасности проактивные действия требуют явных цепочек утверждения с аудиторскими следами.                          |    3    | D/V  |
| 12.7.5 | Проверьте, что обнаружение поведенческих аномалий выявляет отклонения в шаблонах поведения проактивных агентов, которые могут указывать на компрометацию. |    3    | D/V  |

---

## Ссылки

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


# C12 Мониторинг, ведение журналов и обнаружение аномалий

## Цель управления

Этот раздел содержит требования для обеспечения реального времени и судебной видимости того, что модель и другие компоненты ИИ видят, делают и возвращают, чтобы угрозы могли быть обнаружены, проанализированы и изучены.

## C12.1 Ведение журналов запросов и ответов

|   #    | Описание                                                                                                                                                                                                                                                | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.1.1 | Проверьте, что все запросы пользователей и ответы модели записываются с соответствующими метаданными (например, временная метка, идентификатор пользователя, идентификатор сессии, версия модели).                                                      |    1    | D/V  |
| 12.1.2 | Проверьте, что журналы хранятся в защищённых репозиториях с контролем доступа, соответствующими политиками хранения и процедурами резервного копирования.                                                                                               |    1    | D/V  |
| 12.1.3 | Убедитесь, что системы хранения журналов реализуют шифрование данных в состоянии покоя и при передаче для защиты конфиденциальной информации, содержащейся в журналах.                                                                                  |    1    | D/V  |
| 12.1.4 | Проверьте, что конфиденциальные данные в подсказках и результатах автоматически редактируются или маскируются перед ведением журналов, с настраиваемыми правилами редактирования для персональных данных, учетных данных и конфиденциальной информации. |    1    | D/V  |
| 12.1.5 | Убедитесь, что решения по политике и действия по фильтрации безопасности записываются с достаточной детализацией для обеспечения аудита и отладки систем модерации контента.                                                                            |    2    | D/V  |
| 12.1.6 | Убедитесь, что целостность журналов защищена, например, с помощью криптографических подписей или записи в режим только для записи.                                                                                                                      |    2    | D/V  |

---

## C12.2 Обнаружение злоупотреблений и оповещение

|   #    | Описание                                                                                                                                                                                                               | Уровень | Роль |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.2.1 | Проверьте, что система обнаруживает и предупреждает о известных паттернах jailbreak, попытках внедрения подсказок (prompt injection) и враждебных входных данных с использованием сигнатурного анализа.                |    1    | D/V  |
| 12.2.2 | Проверьте, что система интегрируется с существующими платформами управления информацией и событиями безопасности (SIEM) с использованием стандартных форматов логов и протоколов.                                      |    1    | D/V  |
| 12.2.3 | Проверьте, что обогащенные события безопасности включают контекст, специфичный для ИИ, такой как идентификаторы моделей, оценки уверенности и решения фильтра безопасности.                                            |    2    | D/V  |
| 12.2.4 | Проверьте, что обнаружение поведенческих аномалий выявляет необычные паттерны общения, чрезмерные попытки повторного запроса или систематические попытки тестирования.                                                 |    2    | D/V  |
| 12.2.5 | Проверьте, что механизмы оповещения в реальном времени уведомляют команды безопасности при обнаружении потенциальных нарушений политики или попыток атаки.                                                             |    2    | D/V  |
| 12.2.6 | Проверьте, что включены пользовательские правила для обнаружения специфичных для ИИ угроз, включая скоординированные попытки взлома, кампании по внедрению подсказок и атаки на извлечение модели.                     |    2    | D/V  |
| 12.2.7 | Проверьте, что автоматизированные рабочие процессы реагирования на инциденты способны изолировать скомпрометированные модели, блокировать злонамеренных пользователей и эскалировать критические события безопасности. |    3    | D/V  |

---

## C12.3 Обнаружение дрейфа модели

|   #    | Описание                                                                                                                                                                                             | Уровень | Роль |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.3.1 | Проверьте, что система отслеживает основные показатели производительности, такие как точность, коэффициенты уверенности, задержку и показатели ошибок для разных версий модели и временных периодов. |    1    | D/V  |
| 12.3.2 | Проверьте, что автоматические оповещения срабатывают, когда показатели производительности превышают заранее определённые пороги деградации или существенно отклоняются от базовых значений.          |    2    | D/V  |
| 12.3.3 | Проверьте, что системы обнаружения галлюцинаций идентифицируют и отмечают случаи, когда выходные данные модели содержат фактические ошибки, несоответствия или вымышленные сведения.                 |    2    | D/V  |

---

## C12.4 Телеметрия производительности и поведения

|   #    | Описание                                                                                                                                                                      | Уровень | Роль |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.4.1 | Убедитесь, что операционные метрики, включая задержку запросов, потребление токенов, использование памяти и пропускную способность, непрерывно собираются и контролируются.   |    1    | D/V  |
| 12.4.2 | Проверьте, что показатели успеха и неудачи отслеживаются с категоризацией типов ошибок и их первопричин.                                                                      |    1    | D/V  |
| 12.4.3 | Проверьте, что мониторинг использования ресурсов включает использование GPU/CPU, потребление памяти и требования к хранению с оповещениями при превышении пороговых значений. |    2    | D/V  |

---

## C12.5 Планирование и выполнение реагирования на инциденты с ИИ

|   #    | Описание                                                                                                                                                                                    | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.5.1 | Проверьте, что планы реагирования на инциденты специально рассматривают события безопасности, связанные с ИИ, включая компрометацию модели, отравление данных и враждебные атаки.           |    1    | D/V  |
| 12.5.2 | Убедитесь, что команды реагирования на инциденты имеют доступ к специализированным форензическим инструментам и экспертизе в области ИИ для исследования поведения моделей и векторов атак. |    2    | D/V  |
| 12.5.3 | Проверьте, что постинцидентный анализ включает рассмотрение переобучения модели, обновление фильтров безопасности и интеграцию извлечённых уроков в меры безопасности.                      |    3    | D/V  |

---

## C12.5 Обнаружение снижения производительности ИИ

Отслеживать и обнаруживать ухудшение производительности и качества модели ИИ со временем.

|   #    | Описание                                                                                                                                                      | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.5.1 | Убедитесь, что точность модели, точность, полнота и F1-метрики постоянно контролируются и сравниваются с базовыми пороговыми значениями.                      |    1    | D/V  |
| 12.5.2 | Проверьте, что обнаружение сдвига данных контролирует изменения распределения входных данных, которые могут повлиять на производительность модели.            |    1    | D/V  |
| 12.5.3 | Проверьте, что обнаружение дрейфа концепции выявляет изменения в взаимосвязи между входными данными и ожидаемыми результатами.                                |    2    | D/V  |
| 12.5.4 | Проверьте, что снижение производительности вызывает автоматические оповещения и запускает процессы повторного обучения модели или её замены.                  |    2    | D/V  |
| 12.5.5 | Проверьте, что анализ коренных причин деградации связывает падение производительности с изменениями данных, проблемами инфраструктуры или внешними факторами. |    3    |  V   |

---

## C12.6 Визуализация DAG и безопасность рабочего процесса

Защищайте системы визуализации рабочих процессов от утечек информации и атак на манипуляцию.

|   #    | Описание                                                                                                                                                                                                    | Уровень | Роль |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.6.1 | Проверьте, что данные визуализации DAG подвергаются очистке для удаления конфиденциальной информации перед сохранением или передачей.                                                                       |    1    | D/V  |
| 12.6.2 | Проверьте, что механизмы контроля доступа к визуализации рабочих процессов гарантируют, что только авторизованные пользователи могут просматривать пути принятия решений агентом и трассировки рассуждений. |    1    | D/V  |
| 12.6.3 | Проверьте, что целостность данных DAG защищена с помощью криптографических подписей и механизмов хранения с обнаружением подделок.                                                                          |    2    | D/V  |
| 12.6.4 | Проверьте, что системы визуализации рабочих процессов реализуют проверку входных данных для предотвращения инъекционных атак через специально сформированные данные узлов или ребер.                        |    2    | D/V  |
| 12.6.5 | Проверьте, что обновления DAG в реальном времени ограничены по скорости и проходят проверку, чтобы предотвратить атаки отказа в обслуживании на системы визуализации.                                       |    3    | D/V  |

---

## C12.7 Проактивный мониторинг поведения безопасности

Обнаружение и предотвращение угроз безопасности через проактивный анализ поведения агентов.

|   #    | Описание                                                                                                                                          | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 12.7.1 | Проверьте, что проактивные действия агента проходят проверку безопасности перед выполнением с интеграцией оценки рисков.                          |    1    | D/V  |
| 12.7.2 | Проверьте, что триггеры автономной инициативы включают оценку контекста безопасности и анализ ландшафта угроз.                                    |    2    | D/V  |
| 12.7.3 | Проверьте, что проактивные модели поведения анализируются на предмет возможных последствий для безопасности и непреднамеренных эффектов.          |    2    | D/V  |
| 12.7.4 | Проверьте, что критически важные для безопасности проактивные действия требуют явных цепочек одобрения с журналами аудита.                        |    3    | D/V  |
| 12.7.5 | Подтвердите, что обнаружение поведенческих аномалий выявляет отклонения в шаблонах проактивного агента, которые могут указывать на компрометацию. |    3    | D/V  |

---

## Ссылки

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)


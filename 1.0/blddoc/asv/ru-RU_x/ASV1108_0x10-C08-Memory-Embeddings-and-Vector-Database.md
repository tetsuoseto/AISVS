# Безопасность памяти C8, эмбеддингов и векторных баз данных

## Цель управления

Встраивания и векторные хранилища выступают в роли «живой памяти» современных систем ИИ, постоянно принимая данные, предоставляемые пользователями, и возвращая их в контексты моделей через Retrieval-Augmented Generation (RAG). Если такая память не контролируется, она может раскрывать персональные данные (PII), нарушать согласие или быть обращена для восстановления исходного текста. Цель этого набора контрольных мер — укрепить каналы памяти и векторные базы данных таким образом, чтобы доступ был минимально привилегированным, встраивания обеспечивали защиту конфиденциальности, хранимые векторы имели срок действия или могли быть отозваны по требованию, а память каждого пользователя никогда не загрязняла подсказки или результаты другого пользователя.

---

## C8.1 Контроль доступа к памяти и индексам RAG

Обеспечьте детализированный контроль доступа к каждой коллекции векторов.

|   #   | Описание                                                                                                                                                                           | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 8.1.1 | Проверьте, что правила контроля доступа на уровне строки/пространства имен ограничивают операции вставки, удаления и запроса для каждого арендатора, коллекции или тега документа. |    1    | D/V  |
| 8.1.2 | Проверьте, что API-ключи или JWT содержат ограниченные права доступа (например, идентификаторы коллекций, глаголы действий) и подвергаются ротации как минимум ежеквартально.      |    1    | D/V  |
| 8.1.3 | Проверьте, что попытки повышения привилегий (например, запросы на схожесть между пространствами имен) обнаруживаются и регистрируются в SIEM в течение 5 минут.                    |    2    | D/V  |
| 8.1.4 | Проверьте, что база данных векторов ведет аудит с указанием идентификатора субъекта, операции, идентификатора вектора/пространства имен, порога сходства и количества результатов. |    2    | D/V  |
| 8.1.5 | Убедитесь, что решения о доступе проверяются на наличие уязвимостей обхода всякий раз, когда обновляются движки или меняются правила шардирования индексов.                        |    3    |  V   |

---

## C8.2 Очистка и проверка встроенных данных

Предварительно проверить текст на наличие персональных данных (PII), выполнить редактирование или псевдонимизацию перед векторизацией, а при необходимости провести постобработку эмбеддингов для удаления остаточных сигналов.

|   #   | Описание                                                                                                                                                                                                                                       | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 8.2.1 | Убедитесь, что персональные идентифицируемые данные (PII) и регулируемые данные обнаружены с помощью автоматических классификаторов и замаскированы, токенизированы или удалены до этапа встраивания.                                          |    1    | D/V  |
| 8.2.2 | Проверьте, что конвейеры встраивания отклоняют или помещают в карантин входные данные, содержащие исполняемый код или артефакты не в формате UTF-8, которые могут загрязнить индекс.                                                           |    1    |  D   |
| 8.2.3 | Проверьте, что к векторным представлениям предложений применяется локальная или метрическая дифференциально-приватная санация, если расстояние до любого известного токена с личной информацией (PII) становится меньше настраиваемого порога. |    2    | D/V  |
| 8.2.4 | Убедитесь, что эффективность очистки (например, полнота редактирования ПДн, семантическое смещение) проверяется как минимум раз в полгода на эталонных корпусах.                                                                               |    2    |  V   |
| 8.2.5 | Убедитесь, что конфигурации очистки находятся под управлением версий и изменения проходят проверку коллегами.                                                                                                                                  |    3    | D/V  |

---

## C8.3 Истечение срока действия, отзыв и удаление памяти

GDPR «право быть забытым» и аналогичные законы требуют своевременного удаления; поэтому векторные хранилища должны поддерживать TTL, жесткие удаления и tomb-stoning, чтобы отозванные векторы не могли быть восстановлены или переиндексированы.

|   #   | Описание                                                                                                                                                                           | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 8.3.1 | Проверьте, что каждый вектор и запись метаданных имеют TTL или явную метку сохранения, соблюдаемую автоматическими задачами очистки.                                               |    1    | D/V  |
| 8.3.2 | Проверьте, что запросы на удаление, инициированные пользователем, удаляют векторы, метаданные, кэш-копии и производные индексы в течение 30 дней.                                  |    1    | D/V  |
| 8.3.3 | Проверьте, что логическое удаление сопровождается криптографическим уничтожением блоков хранилища, если оборудование это поддерживает, или уничтожением ключа из хранилища ключей. |    2    |  D   |
| 8.3.4 | Проверьте, что устаревшие векторы исключаются из результатов поиска ближайших соседей менее чем через 500 мс после их устаревания.                                                 |    3    | D/V  |

---

## C8.4 Предотвращение инверсии и утечки встраивания

Недавние методы защиты — наложение шума, проекционные сети, возмущение нейронов конфиденциальности и шифрование на уровне приложений — могут снизить уровень инверсии на уровне токенов ниже 5%.

|   #   | Описание                                                                                                                                                                    | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 8.4.1 | Проверьте наличие формальной модели угроз, охватывающей атаки на инверсию, определение принадлежности и вывод атрибутов, а также осуществляйте её ежегодный обзор.          |    1    |  V   |
| 8.4.2 | Убедитесь, что шифрование на уровне прикладного слоя или поисковое шифрование защищает векторы от прямого чтения администраторами инфраструктуры или сотрудниками облака.   |    2    | D/V  |
| 8.4.3 | Проверьте, что параметры защиты (ε для DP, шум σ, ранг проекции k) обеспечивают баланс между конфиденциальностью ≥ 99 % защиты токенов и полезностью ≤ 3 % потери точности. |    3    |  V   |
| 8.4.4 | Проверьте, что метрики устойчивости к инверсии являются частью контрольных точек выпуска для обновлений моделей, при этом заданы бюджеты регрессии.                         |    3    | D/V  |

---

## C8.5 Применение ограничений в области памяти, специфичной для пользователя

Перекрестное утечка данных между арендаторами остается одной из основных рисков RAG: неправильно отфильтрованные запросы по схожести могут вывести на поверхность приватные документы другого клиента.

|   #   | Описание                                                                                                                                                                                           | Уровень | Роль |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 8.5.1 | Убедитесь, что каждый запрос на извлечение данных предварительно фильтруется по идентификатору арендатора/пользователя перед передачей в подсказку LLM.                                            |    1    | D/V  |
| 8.5.2 | Проверьте, что имена коллекций или идентификаторы с пространством имён защищены солью для каждого пользователя или арендатора, чтобы векторы не могли конфликтовать между различными областями.    |    1    |  D   |
| 8.5.3 | Проверьте, что результаты сходства, превышающие настраиваемый порог расстояния, но выходящие за пределы области видимости вызывающего, отбрасываются и вызывают срабатывание сигнала безопасности. |    2    | D/V  |
| 8.5.4 | Проверьте, что стресс-тесты для мультиарендной среды имитируют враждебные запросы, пытающиеся получить документы вне разрешенного диапазона, и демонстрируют отсутствие утечки данных.             |    2    |  V   |
| 8.5.5 | Проверьте, что ключи шифрования разделены для каждого арендатора, обеспечивая криптографическую изоляцию даже при общем физическом хранении.                                                       |    3    | D/V  |

---

## C8.6 Продвинутая безопасность системы памяти

Механизмы безопасности для сложных архитектур памяти, включая эпизодическую, семантическую и рабочую память, с конкретными требованиями к изоляции и проверке.

|   #   | Описание                                                                                                                                                                                                                                                        | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 8.6.1 | Проверьте, что разные типы памяти (эпизодическая, семантическая, рабочая) имеют изолированные контексты безопасности с ролевым управлением доступом, отдельными ключами шифрования и задокументированными шаблонами доступа для каждого типа памяти.            |    1    | D/V  |
| 8.6.2 | Убедитесь, что процессы консолидации памяти включают проверку безопасности для предотвращения внедрения вредоносных воспоминаний посредством очистки контента, проверки источника и проверки целостности перед сохранением.                                     |    2    | D/V  |
| 8.6.3 | Проверьте, что запросы на извлечение памяти проходят проверку и очистку для предотвращения извлечения несанкционированной информации путем анализа шаблонов запросов, обеспечения контроля доступа и фильтрации результатов.                                    |    2    | D/V  |
| 8.6.4 | Проверьте, что механизмы забывания памяти надежно удаляют конфиденциальную информацию с криптографическими гарантиями стирания, используя удаление ключей, многоразовое перезаписывание или аппаратное безопасное удаление с сертификатами проверки.            |    3    | D/V  |
| 8.6.5 | Проверяйте, что целостность системы памяти постоянно контролируется на предмет несанкционированных изменений или повреждений с помощью контрольных сумм, журналов аудита и автоматических оповещений при изменениях содержимого памяти вне нормальных операций. |    3    | D/V  |

---

## Ссылки

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)


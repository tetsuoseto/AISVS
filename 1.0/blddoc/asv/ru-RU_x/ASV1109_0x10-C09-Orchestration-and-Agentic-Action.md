# 9 Автономная оркестрация и агентные действия в безопасности

## Цель управления

Обеспечьте, чтобы автономные или многозадачные ИИ-системы могли выполнять только те действия, которые явно предусмотрены, аутентифицированы, подлежат аудиту и находятся в пределах установленных порогов стоимости и риска. Это защищает от угроз, таких как компрометация автономной системы, неправильное использование инструментов, обнаружение петли агента, перехват коммуникаций, подделка идентичности, манипуляция роем и манипуляция намерениями.

---

## 9.1 Задачи планирования агента и бюджеты рекурсии

Ограничьте рекурсивные планы и установите обязательные контрольные точки с участием человека для привилегированных действий.

|   #   | Описание                                                                                                                                                                                                                | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.1.1 | Проверьте, что максимальная глубина рекурсии, ширина, реальное время выполнения, количество токенов и денежные затраты на выполнение агента централизованно настроены и находятся под версионным контролем.             |    1    | D/V  |
| 9.1.2 | Убедитесь, что привилегированные или необратимые действия (например, коммиты кода, финансовые переводы) требуют явного одобрения человеком через проверяемый канал перед выполнением.                                   |    1    | D/V  |
| 9.1.3 | Проверьте, что мониторы ресурсов в режиме реального времени вызывают прерывание срабатывания автоматического выключателя при превышении любого порогового значения бюджета, останавливая дальнейшее расширение задачи.  |    2    |  D   |
| 9.1.4 | Проверьте, что события срабатывания автоматического выключателя (circuit-breaker) регистрируются с идентификатором агента, условием срабатывания и зафиксированным состоянием плана для последующего судебного анализа. |    2    | D/V  |
| 9.1.5 | Проверьте, что тесты безопасности охватывают сценарии исчерпания бюджета и бесконтрольного выполнения плана, подтверждая безопасную остановку без потери данных.                                                        |    3    |  V   |
| 9.1.6 | Убедитесь, что политики бюджета выражены как политика в коде и применяются в CI/CD для предотвращения отклонений в конфигурации.                                                                                        |    3    |  D   |

---

## 9.2 Изоляция плагинов инструментов (sandboxing)

Изолируйте взаимодействия с инструментами, чтобы предотвратить несанкционированный доступ к системе или выполнение кода.

|   #   | Описание                                                                                                                                                                                                                | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.2.1 | Убедитесь, что каждый инструмент/плагин выполняется внутри операционной системы, контейнера или песочницы на уровне WASM с политиками минимально необходимых привилегий для файловой системы, сети и системных вызовов. |    1    | D/V  |
| 9.2.2 | Проверьте, что ограничения ресурсов песочницы (ЦПУ, память, диск, исходящий сетевой трафик) и тайм-ауты выполнения применяются и фиксируются в журнале.                                                                 |    1    | D/V  |
| 9.2.3 | Проверьте, что двоичные файлы или дескрипторы инструментов цифрово подписаны; подписи проверяются перед загрузкой.                                                                                                      |    2    | D/V  |
| 9.2.4 | Проверьте, что телеметрия песочницы передается в SIEM; аномалии (например, попытки исходящих подключений) вызывают тревоги.                                                                                             |    2    |  V   |
| 9.2.5 | Убедитесь, что плагины с высоким риском проходят проверку безопасности и тестирование на проникновение перед развертыванием в производственной среде.                                                                   |    3    |  V   |
| 9.2.6 | Проверьте, что попытки выхода из песочницы автоматически блокируются, а нарушающий плагин помещается в карантин до завершения расследования.                                                                            |    3    | D/V  |

---

## 9.3 Автономная петля и ограничение затрат

Обнаружение и предотвращение неконтролируемой рекурсии между агентами и взрывов затрат.

|   #   | Описание                                                                                                                                              | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.3.1 | Проверьте, что междуагентные вызовы включают ограничение по количеству переходов или TTL, которое среда выполнения уменьшает и контролирует.          |    1    | D/V  |
| 9.3.2 | Проверьте, что агенты поддерживают уникальный идентификатор invocation-graph для обнаружения самовызовов или циклических шаблонов.                    |    2    |  D   |
| 9.3.3 | Проверьте, что кумулятивные счетчики вычислительных единиц и расходов отслеживаются для каждой цепочки запросов; превышение лимита прерывает цепочку. |    2    | D/V  |
| 9.3.4 | Проверьте, что формальный анализ или проверка моделей демонстрируют отсутствие неограниченной рекурсии в протоколах агентов.                          |    3    |  V   |
| 9.3.5 | Проверьте, что события прерывания цикла вызывают оповещения и поступают в метрики непрерывного улучшения.                                             |    3    |  D   |

---

## 9.4 Защита от неправильного использования на уровне протокола

Обеспечьте безопасные каналы связи между агентами и внешними системами, чтобы предотвратить захват или манипуляцию.

|   #   | Описание                                                                                                                                                                                 | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.4.1 | Проверьте, что все сообщения между агентом и инструментом, а также между агентами, аутентифицированы (например, с использованием взаимного TLS или JWT) и зашифрованы от конца до конца. |    1    | D/V  |
| 9.4.2 | Убедитесь, что схемы строго проверяются; неизвестные поля или неправильно сформированные сообщения отклоняются.                                                                          |    1    |  D   |
| 9.4.3 | Проверьте, что проверки целостности (MAC или цифровые подписи) охватывают весь полезный нагрузочный блок сообщения, включая параметры инструмента.                                       |    2    | D/V  |
| 9.4.4 | Проверьте, что защита от повторной передачи (nonce или временные окна) обеспечивается на уровне протокола.                                                                               |    2    |  D   |
| 9.4.5 | Убедитесь, что реализации протоколов проходят проверку с помощью fuzz-тестирования и статического анализа на наличие уязвимостей внедрения или десериализации.                           |    3    |  V   |

---

## 9.5 Идентичность агента и защита от подделки

Обеспечьте возможность установления ответственности за действия и обнаружения изменений.

|   #   | Описание                                                                                                                                                            | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.5.1 | Проверьте, что каждый экземпляр агента обладает уникальной криптографической идентичностью (ключевой парой или учетными данными, основанными на аппаратном уровне). |    1    | D/V  |
| 9.5.2 | Проверьте, что все действия агента подписаны и имеют отметку времени; журналы содержат подпись для недопущения отказа от участия.                                   |    2    | D/V  |
| 9.5.3 | Проверьте, что защищённые от подделки журналы хранятся в среде только для добавления или записи один раз.                                                           |    2    |  V   |
| 9.5.4 | Проверьте, что ключи идентификации меняются согласно определённому графику и при получении индикаторов компрометации.                                               |    3    |  D   |
| 9.5.5 | Проверьте, что попытки подделки или конфликт ключей вызывают немедленное помещение затронутого агента в карантин.                                                   |    3    | D/V  |

---

## 9.6 Снижение рисков с помощью многок-Agentного роя

Снизьте риски коллективного поведения с помощью изоляции и формального моделирования безопасности.

|   #   | Описание                                                                                                                                                                | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.6.1 | Проверьте, что агенты, работающие в разных доменах безопасности, выполняются в изолированных средах выполнения (runtime sandboxes) или сетевых сегментах.               |    1    | D/V  |
| 9.6.2 | Убедитесь, что поведение роя моделируется и формально проверяется на живучесть и безопасность перед развертыванием.                                                     |    3    |  V   |
| 9.6.3 | Проверьте, что мониторинг времени выполнения обнаруживает возникающие опасные паттерны (например, колебания, взаимные блокировки) и инициирует корректирующие действия. |    3    |  D   |

---

## 9.7 Аутентификация / Авторизация пользователя и инструмента

Реализуйте надежные механизмы контроля доступа для каждого действия, инициируемого агентом.

|   #   | Описание                                                                                                                                                                   | Уровень | Роль |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.7.1 | Проверьте, что агенты аутентифицируются в качестве первоклассных субъектов в системах нижнего уровня, никогда не повторно используя учетные данные конечных пользователей. |    1    | D/V  |
| 9.7.2 | Проверьте, что политики тонкой авторизации ограничивают, какие инструменты агент может вызывать и какие параметры он может передавать.                                     |    2    |  D   |
| 9.7.3 | Проверьте, что проверки привилегий переоцениваются при каждом вызове (непрерывная авторизация), а не только при начале сеанса.                                             |    2    |  V   |
| 9.7.4 | Проверьте, что делегированные привилегии автоматически истекают и требуют повторного согласия после тайм-аута или изменения области.                                       |    3    |  D   |

---

## 9.8 Безопасность коммуникации агент-агент

Шифруйте и обеспечьте защиту целостности всех сообщений между агентами, чтобы предотвратить перехват и вмешательство.

|   #   | Описание                                                                                                                                                    | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.8.1 | Проверьте, что взаимная аутентификация и шифрование с совершенной прямой секретностью (например, TLS 1.3) обязательны для каналов агента.                   |    1    | D/V  |
| 9.8.2 | Проверьте, что целостность и источник сообщения подтверждены перед обработкой; при сбоях подаются предупреждения и сообщение отклоняется.                   |    1    |  D   |
| 9.8.3 | Проверьте, что метаданные коммуникации (временные метки, порядковые номера) записываются для поддержки судебного восстановления.                            |    2    | D/V  |
| 9.8.4 | Проверьте, что формальная верификация или проверка моделей подтверждает, что машины состояний протокола не могут привести систему в небезопасные состояния. |    3    |  V   |

---

## 9.9 Проверка намерений и обеспечение соблюдения ограничений

Проверьте, что действия агента соответствуют заявленному намерению пользователя и ограничениям системы.

|   #   | Описание                                                                                                                                                                                      | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.9.1 | Проверьте, что решатели ограничений до выполнения проверяют предлагаемые действия на соответствие жестко заданным правилам безопасности и политики.                                           |    1    |  D   |
| 9.9.2 | Проверьте, что действия с высоким уровнем воздействия (финансовые, разрушительные, чувствительные к конфиденциальности) требуют явного подтверждения намерения от инициирующего пользователя. |    2    | D/V  |
| 9.9.3 | Проверьте, что проверки постусловий подтверждают, что выполненные действия достигли предполагаемых эффектов без побочных действий; несоответствия вызывают откат.                             |    2    |  V   |
| 9.9.4 | Убедитесь, что формальные методы (например, проверка моделей, доказательство теорем) или тесты на основе свойств демонстрируют, что планы агента удовлетворяют всем заявленным ограничениям.  |    3    |  V   |
| 9.9.5 | Убедитесь, что инциденты несоответствия намерений или нарушения ограничений способствуют циклам непрерывного совершенствования и обмену разведданными по угрозам.                             |    3    |  D   |

---

## 9.10 Безопасность стратегии рассуждений агента

Безопасный выбор и выполнение различных стратегий рассуждений, включая подходы ReAct, Chain-of-Thought и Tree-of-Thoughts.

|   #    | Описание                                                                                                                                                                                                                                                                                   | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 9.10.1 | Проверьте, что выбор стратегии рассуждения использует детерминированные критерии (сложность ввода, тип задачи, контекст безопасности), и что одинаковые входные данные дают одинаковый выбор стратегии в рамках одного и того же контекста безопасности.                                   |    1    | D/V  |
| 9.10.2 | Проверьте, что для каждой стратегии рассуждения (ReAct, Chain-of-Thought, Tree-of-Thoughts) предусмотрены специализированные проверка входных данных, очистка выходных данных и ограничения по времени выполнения, соответствующие ее когнитивному подходу.                                |    1    | D/V  |
| 9.10.3 | Подтвердите, что переходы стратегий рассуждения регистрируются с полным контекстом, включая характеристики входных данных, значения критериев выбора и метаданные выполнения для восстановления аудиторского следа.                                                                        |    2    | D/V  |
| 9.10.4 | Проверьте, что рассуждения в модели Tree-of-Thoughts включают механизмы обрезки ветвей, которые прекращают исследование при обнаружении нарушений политики, ограничений ресурсов или границ безопасности.                                                                                  |    2    | D/V  |
| 9.10.5 | Проверьте, что циклы ReAct (Reason-Act-Observe) включают контрольные точки проверки на каждом этапе: верификацию шага рассуждения, авторизацию действия и очистку наблюдений перед продолжением.                                                                                           |    2    | D/V  |
| 9.10.6 | Проверьте, что показатели производительности стратегии рассуждений (время выполнения, использование ресурсов, качество вывода) контролируются с помощью автоматических оповещений при отклонении показателей за пределы настроенных порогов.                                               |    3    | D/V  |
| 9.10.7 | Проверьте, что гибридные методы рассуждения, объединяющие несколько стратегий, соблюдают проверку входных данных и ограничения на выходные данные всех составных стратегий без обхода каких-либо мер безопасности.                                                                         |    3    | D/V  |
| 9.10.8 | Проверьте, что тестирование безопасности стратегии рассуждений включает fuzz-тестирование с использованием некорректных входных данных, враждебных подсказок, предназначенных для принуждения к переключению стратегии, и тестирование граничных условий для каждого когнитивного подхода. |    3    | D/V  |

---

## 9.11 Управление состоянием жизненного цикла агента и безопасность

Безопасная инициализация агента, переходы состояний и завершение работы с криптографическими журналами аудита и определёнными процедурами восстановления.

|   #    | Описание                                                                                                                                                                                                                                                                                      | Уровень | Роль |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.11.1 | Проверьте, что инициализация агента включает установление криптографической идентичности с аппаратно защищенными учетными данными и неизменяемыми журналами аудита запуска, содержащими ID агента, временную метку, хэш конфигурации и параметры инициализации.                               |    1    | D/V  |
| 9.11.2 | Проверьте, что переходы состояний агента криптографически подписаны, имеют отметки времени и регистрируются с полным контекстом, включая запускающие события, хэш предыдущего состояния, хэш нового состояния и выполненные проверки безопасности.                                            |    2    | D/V  |
| 9.11.3 | Проверьте, что процедуры завершения работы агента включают безопасное стирание памяти с использованием криптографического удаления или многократной перезаписи, отзыв учетных данных с уведомлением центра сертификации и генерацию свидетельств о завершении с защитой от подделки.          |    2    | D/V  |
| 9.11.4 | Проверьте, что механизмы восстановления агента проверяют целостность состояния с помощью криптографических контрольных сумм (минимум SHA-256) и выполняют откат к известным исправным состояниям при обнаружении повреждений с автоматическими оповещениями и требованиями ручного одобрения. |    3    | D/V  |
| 9.11.5 | Проверьте, что механизмы сохранения состояния агента шифруют конфиденциальные данные состояния с использованием индивидуальных ключей AES-256 для каждого агента и реализуют надежную ротацию ключей по настраиваемому расписанию (максимум 90 дней) с развертыванием без простоев.           |    3    | D/V  |

---

## 9.12 Рамки безопасности интеграции инструментов

Контроль безопасности для динамической загрузки инструментов, выполнения и проверки результатов с определёнными процессами оценки рисков и утверждения.

|   #    | Описание                                                                                                                                                                                                                                                                                         | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 9.12.1 | Убедитесь, что дескрипторы инструментов включают метаданные безопасности, указывающие необходимые привилегии (чтение/запись/исполнение), уровни риска (низкий/средний/высокий), ограничения ресурсов (ЦПУ, память, сеть) и требования к проверке, задокументированные в манифестах инструментов. |    1    | D/V  |
| 9.12.2 | Проверьте, что результаты выполнения инструмента валидируются согласно ожидаемым схемам (JSON Schema, XML Schema) и политикам безопасности (санитизация вывода, классификация данных) перед интеграцией с учетом ограничений по времени выполнения и процедур обработки ошибок.                  |    1    | D/V  |
| 9.12.3 | Проверьте, что журналы взаимодействия с инструментами включают подробный контекст безопасности, включая использование привилегий, шаблоны доступа к данным, время выполнения, потребление ресурсов и коды возврата с структурированным журналированием для интеграции с SIEM.                    |    2    | D/V  |
| 9.12.4 | Проверьте, что механизмы динамической загрузки инструментов осуществляют проверку цифровых подписей с использованием инфраструктуры PKI и внедряют безопасные протоколы загрузки с изоляцией в песочнице и проверкой разрешений перед выполнением.                                               |    2    | D/V  |
| 9.12.5 | Проверьте, что оценки безопасности инструментов автоматически запускаются для новых версий с обязательными этапами утверждения, включая статический анализ, динамическое тестирование и проверку командой безопасности с документированными критериями одобрения и требованиями к SLA.           |    3    | D/V  |

---

### Ссылки

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)


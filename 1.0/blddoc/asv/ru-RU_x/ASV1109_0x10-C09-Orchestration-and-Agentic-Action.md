# 9 Автономная оркестровка и агентское действие Безопасность

## Цель контроля

Обеспечьте, чтобы автономные или многоагентные ИИ-системы могли выполнять только те действия, которые явно намерены, аутентифицированы, подлежат аудиту и находятся в пределах заданных порогов затрат и рисков. Это защищает от угроз, таких как компрометация автономной системы, неправильное использование инструментов, обнаружение циклов агентов, перехват коммуникаций, подделка идентичности, манипуляция роем и манипуляция намерениями.

---

## 9.1 Планирование задач агента и бюджеты рекурсии

Ограничьте рекурсивные планы и обязательно устанавливайте контрольные точки с участием человека для привилегированных действий.

|   #   | Описание                                                                                                                                                                                                           | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 9.1.1 | Убедитесь, что максимальная глубина рекурсии, ширина, реальное время выполнения, количество токенов и денежная стоимость за выполнение агента настроены централизованно и находятся под версионным контролем.      |    1    | D/V  |
| 9.1.2 | Проверьте, что для выполнения привилегированных или необратимых действий (например, коммиты кода, финансовые переводы) требуется явное одобрение человека через проверяемый канал.                                 |    1    | D/V  |
| 9.1.3 | Убедитесь, что системы мониторинга ресурсов в реальном времени вызывают прерывание срабатывания защитного выключателя при превышении любого порогового значения бюджета, останавливая дальнейшее расширение задач. |    2    |  D   |
| 9.1.4 | Проверьте, что события срабатывания автоматического выключателя регистрируются с указанием ID агента, условия срабатывания и зафиксированного состояния плана для судебно-следственного анализа.                   |    2    | D/V  |
| 9.1.5 | Проверьте, что тесты безопасности охватывают сценарии исчерпания бюджета и бесконтрольного выполнения плана, подтверждая безопасную остановку без потери данных.                                                   |    3    |  V   |
| 9.1.6 | Убедитесь, что бюджетные политики выражены в виде кода политики и применяются в CI/CD для предотвращения отклонений конфигурации.                                                                                  |    3    |  D   |

---

## 9.2 Изоляция плагинов инструментов (Tool Plugin Sandboxing)

Изолируйте взаимодействия с инструментами, чтобы предотвратить несанкционированный доступ к системе или выполнение кода.

|   #   | Описание                                                                                                                                                                                                             | Уровень | Роль |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.2.1 | Убедитесь, что каждый инструмент/плагин выполняется внутри операционной системы, контейнера или песочницы уровня WASM с политиками минимально необходимых привилегий для файловой системы, сети и системных вызовов. |    1    | D/V  |
| 9.2.2 | Убедитесь, что квоты ресурсов песочницы (ЦПУ, память, диск, исходящий сетевой трафик) и ограничения времени выполнения соблюдаются и регистрируются.                                                                 |    1    | D/V  |
| 9.2.3 | Проверяйте, что бинарные файлы или дескрипторы инструментов цифрово подписаны; подписи проверяются перед загрузкой.                                                                                                  |    2    | D/V  |
| 9.2.4 | Проверьте, что телеметрия песочницы передается в SIEM; аномалии (например, попытки исходящих соединений) вызывают оповещения.                                                                                        |    2    |  V   |
| 9.2.5 | Убедитесь, что плагины с высоким уровнем риска проходят проверку безопасности и тестирование на проникновение перед развертыванием в продуктивной среде.                                                             |    3    |  V   |
| 9.2.6 | Проверьте, что попытки выхода из песочницы автоматически блокируются, а нарушающий плагин помещается в карантин до проведения расследования.                                                                         |    3    | D/V  |

---

## 9.3 Автономная петля и ограничение затрат

Обнаружение и предотвращение неконтролируемой рекурсии между агентами и взрывного роста затрат.

|   #   | Описание                                                                                                                                                     | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 9.3.1 | Убедитесь, что межагентные вызовы включают ограничение числа переходов или TTL, которое время выполнения уменьшает и контролирует.                           |    1    | D/V  |
| 9.3.2 | Убедитесь, что агенты сохраняют уникальный идентификатор графа вызовов для обнаружения самовызовов или циклических шаблонов.                                 |    2    |  D   |
| 9.3.3 | Проверьте, что суммарные счётчики вычислительных единиц и затрат отслеживаются для каждой цепочки запросов; превышение лимита приводит к прерыванию цепочки. |    2    | D/V  |
| 9.3.4 | Проверьте, что формальный анализ или проверка моделей демонстрируют отсутствие неограниченной рекурсии в протоколах агента.                                  |    3    |  V   |
| 9.3.5 | Проверьте, что события прерывания цикла вызывают оповещения и передают метрики непрерывного улучшения.                                                       |    3    |  D   |

---

## 9.4 Защита от неправильного использования на уровне протокола

Защищайте каналы связи между агентами и внешними системами, чтобы предотвратить перехват или манипулирование.

|   #   | Описание                                                                                                                                                                | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.4.1 | Убедитесь, что все сообщения от агента к инструменту и от агента к агенту аутентифицированы (например, с помощью взаимной TLS или JWT) и защищены сквозным шифрованием. |    1    | D/V  |
| 9.4.2 | Проверьте, что схемы строго валидируются; неизвестные поля или неправильно сформированные сообщения отклоняются.                                                        |    1    |  D   |
| 9.4.3 | Проверьте, что проверки целостности (MAC или цифровые подписи) охватывают весь полезный нагрузку сообщения, включая параметры инструмента.                              |    2    | D/V  |
| 9.4.4 | Проверьте, что защита от повторного воспроизведения (nonce или окна временных меток) обеспечивается на уровне протокола.                                                |    2    |  D   |
| 9.4.5 | Убедитесь, что реализации протоколов проходят фуззинг и статический анализ на наличие уязвимостей внедрения или десериализации.                                         |    3    |  V   |

---

## 9.5 Идентичность агента и защита от подделки

Обеспечьте возможность идентификации действий и обнаружения изменений.

|   #   | Описание                                                                                                                                                  | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.5.1 | Проверьте, что каждый экземпляр агента обладает уникальной криптографической идентичностью (пара ключей или аппаратно основанный удостоверяющий элемент). |    1    | D/V  |
| 9.5.2 | Проверьте, что все действия агента подписаны и имеют отметку времени; журналы содержат подпись для обеспечения невозможности отказа от участия.           |    2    | D/V  |
| 9.5.3 | Убедитесь, что логи с защитой от подделки хранятся в среде с режимом только добавления или однократной записи.                                            |    2    |  V   |
| 9.5.4 | Проверяйте, что идентификационные ключи вращаются согласно заданному графику и при появлении индикаторов компрометации.                                   |    3    |  D   |
| 9.5.5 | Проверьте, что попытки подделки или конфликта ключей вызывают немедленное помещение затронутого агента в карантин.                                        |    3    | D/V  |

---

## 9.6 Снижение рисков с помощью многоагентного роя

Снижайте риски коллективного поведения посредством изоляции и формального моделирования безопасности.

|   #   | Описание                                                                                                                                                                     | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.6.1 | Проверьте, что агенты, работающие в разных доменах безопасности, выполняются в изолированных средах выполнения или сетевых сегментах.                                        |    1    | D/V  |
| 9.6.2 | Убедитесь, что поведение роя моделируется и формально проверяется на живучесть и безопасность перед развертыванием.                                                          |    3    |  V   |
| 9.6.3 | Проверьте, что мониторинг времени выполнения обнаруживает возникающие небезопасные паттерны (например, колебания, взаимные блокировки) и инициирует корректирующие действия. |    3    |  D   |

---

## 9.7 Аутентификация / Авторизация пользователей и инструментов

Реализуйте надежные средства контроля доступа для каждого действия, инициируемого агентом.

|   #   | Описание                                                                                                                                                        | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.7.1 | Убедитесь, что агенты аутентифицируются как первоклассные субъекты перед системами нижнего уровня, не используя повторно учетные данные конечных пользователей. |    1    | D/V  |
| 9.7.2 | Проверьте, что политики тонкой авторизации ограничивают, какие инструменты агент может вызывать и какие параметры он может передавать.                          |    2    |  D   |
| 9.7.3 | Проверьте, что проверки привилегий переоценяются при каждом вызове (непрерывная авторизация), а не только в начале сессии.                                      |    2    |  V   |
| 9.7.4 | Проверьте, что делегированные полномочия автоматически истекают и требуют повторного согласия после истечения срока или изменения области.                      |    3    |  D   |

---

## 9.8 Безопасность взаимодействия между агентами

Шифруйте и обеспечивайте целостность всех сообщений между агентами для предотвращения перехвата и подделки.

|   #   | Описание                                                                                                                                                   | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.8.1 | Убедитесь, что взаимная аутентификация и шифрование с идеальной прямой секретностью (например, TLS 1.3) являются обязательными для каналов агентов.        |    1    | D/V  |
| 9.8.2 | Проверьте, что целостность и происхождение сообщения проверены перед обработкой; при сбоях вызываются предупреждения и сообщение отбрасывается.            |    1    |  D   |
| 9.8.3 | Проверьте, что метаданные коммуникации (отметки времени, порядковые номера) записываются для поддержки судебной реконструкции.                             |    2    | D/V  |
| 9.8.4 | Проверьте, что формальная верификация или проверка моделей подтверждает, что конечные автоматы протокола не могут быть приведены в небезопасные состояния. |    3    |  V   |

---

## 9.9 Проверка намерений и обеспечение соблюдения ограничений

Проверьте, что действия агента соответствуют заявленному пользователем намерению и системным ограничениям.

|   #   | Описание                                                                                                                                                                                     | Уровень | Роль |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.9.1 | Проверьте, что солверы ограничений предварительного выполнения проверяют предлагаемые действия на соответствие жестко заданным правилам безопасности и политики.                             |    1    |  D   |
| 9.9.2 | Убедитесь, что действия с высоким уровнем воздействия (финансовые, разрушительные, затрагивающие конфиденциальность) требуют явного подтверждения намерения от инициирующего пользователя.   |    2    | D/V  |
| 9.9.3 | Проверьте, что проверки постусловий подтверждают, что выполненные действия достигли предполагаемых результатов без побочных эффектов; несоответствия вызывают откат.                         |    2    |  V   |
| 9.9.4 | Проверьте, что формальные методы (например, проверка моделей, доказательство теорем) или тесты на основе свойств демонстрируют, что планы агента удовлетворяют всем заявленным ограничениям. |    3    |  V   |
| 9.9.5 | Убедитесь, что инциденты с несоответствием намерений или нарушением ограничений питают циклы постоянного улучшения и обмена информацией об угрозах.                                          |    3    |  D   |

---

## 9.10 Стратегия рассуждений агента Безопасность

Безопасный выбор и выполнение различных стратегий рассуждения, включая подходы ReAct, Chain-of-Thought и Tree-of-Thoughts.

|   #    | Описание                                                                                                                                                                                                                                                         | Уровень | Роль |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 9.10.1 | Проверьте, что выбор стратегии рассуждения использует детерминированные критерии (сложность входных данных, тип задачи, контекст безопасности) и что идентичные входные данные приводят к одинаковому выбору стратегии в одном и том же контексте безопасности.  |    1    | D/V  |
| 9.10.2 | Убедитесь, что для каждой стратегии рассуждения (ReAct, Chain-of-Thought, Tree-of-Thoughts) предусмотрена специализированная проверка входных данных, очистка выходных данных и установлены лимиты времени выполнения, соответствующие её когнитивному подходу.  |    1    | D/V  |
| 9.10.3 | Проверьте, что переходы стратегий рассуждения фиксируются с полным контекстом, включая характеристики входных данных, значения критериев выбора и метаданные исполнения для восстановления аудиторского следа.                                                   |    2    | D/V  |
| 9.10.4 | Убедитесь, что рассуждение с использованием дерева мыслей включает механизмы отсечения ветвей, которые прекращают исследование при выявлении нарушений политики, ограничений ресурсов или границ безопасности.                                                   |    2    | D/V  |
| 9.10.5 | Проверьте, что циклы ReAct (Reason-Act-Observe) включают контрольные точки валидации на каждом этапе: проверку шага рассуждения, авторизацию действия и очистку наблюдения перед продолжением.                                                                   |    2    | D/V  |
| 9.10.6 | Убедитесь, что показатели производительности стратегии рассуждений (время выполнения, использование ресурсов, качество вывода) контролируются с помощью автоматических оповещений при отклонениях показателей за пределы настроенных порогов.                    |    3    | D/V  |
| 9.10.7 | Проверьте, что гибридные методы рассуждений, сочетающие несколько стратегий, сохраняют проверку входных данных и ограничения вывода всех составляющих стратегий без обхода каких-либо средств безопасности.                                                      |    3    | D/V  |
| 9.10.8 | Проверьте, что стратегия тестирования безопасности рассуждений включает фуззинг с некорректными входными данными, враждебные подсказки, созданные для принудительного переключения стратегии, и тестирование граничных условий для каждого когнитивного подхода. |    3    | D/V  |

---

## 9.11 Управление состояниями жизненного цикла агента и безопасность

Безопасная инициализация агента, переходы состояний и завершение работы с использованием криптографических аудиторских журналов и определённых процедур восстановления.

|   #    | Описание                                                                                                                                                                                                                                                                                               | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 9.11.1 | Проверьте, что инициализация агента включает установление криптографической идентичности с использованием аппаратно защищённых учетных данных и неизменяемые журналы аудита запуска, содержащие идентификатор агента, отметку времени, хэш конфигурации и параметры инициализации.                     |    1    | D/V  |
| 9.11.2 | Проверьте, что переходы состояний агента криптографически подписаны, содержат отметки времени и записываются с полным контекстом, включая запускающие события, хэш предыдущего состояния, хэш нового состояния и выполненные проверки безопасности.                                                    |    2    | D/V  |
| 9.11.3 | Проверьте, что процедуры завершения работы агента включают безопасное очищение памяти с использованием криптографического стирания или многократного перезаписывания, отзыв учетных данных с уведомлением центра сертификации, а также генерацию сертификатов завершения работы с защитой от подделки. |    2    | D/V  |
| 9.11.4 | Проверяйте, что механизмы восстановления агента подтверждают целостность состояния с помощью криптографических контрольных сумм (минимум SHA-256) и осуществляют откат к известным исправным состояниям при обнаружении повреждений с автоматическими оповещениями и требованиями ручного утверждения. |    3    | D/V  |
| 9.11.5 | Проверьте, что механизмы сохранения состояния агента шифруют конфиденциальные данные с использованием индивидуальных ключей AES-256 для каждого агента и реализуют безопасное обновление ключей по настраиваемому расписанию (максимум 90 дней) с развертыванием без простоя.                          |    3    | D/V  |

---

## 9.12 Рамочная модель безопасности интеграции инструментов

Контроль безопасности для динамической загрузки инструментов, выполнения и проверки результатов с определёнными процессами оценки рисков и утверждения.

|   #    | Описание                                                                                                                                                                                                                                                                                         | Уровень | Роль |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 9.12.1 | Проверьте, что дескрипторы инструментов включают метаданные безопасности, указывающие необходимые привилегии (чтение/запись/исполнение), уровни риска (низкий/средний/высокий), ограничения ресурсов (ЦПУ, память, сеть) и требования к проверке, задокументированные в манифестах инструментов. |    1    | D/V  |
| 9.12.2 | Проверьте, что результаты выполнения инструмента проходят проверку на соответствие ожидаемым схемам (JSON Schema, XML Schema) и политикам безопасности (санитизация вывода, классификация данных) перед интеграцией с соблюдением ограничений по времени и процедур обработки ошибок.            |    1    | D/V  |
| 9.12.3 | Проверьте, что журналы взаимодействия инструментов включают подробный контекст безопасности, включая использование привилегий, шаблоны доступа к данным, время выполнения, потребление ресурсов и коды возврата с использованием структурированного логирования для интеграции с SIEM.           |    2    | D/V  |
| 9.12.4 | Проверьте, что механизмы динамической загрузки инструментов проверяют цифровые подписи с использованием инфраструктуры PKI и реализуют безопасные протоколы загрузки с изоляцией в песочнице и проверкой разрешений перед выполнением.                                                           |    2    | D/V  |
| 9.12.5 | Проверьте, что оценки безопасности инструментов автоматически инициируются для новых версий с обязательными этапами утверждения, включая статический анализ, динамическое тестирование и проверку командой безопасности с документированными критериями утверждения и требованиями по SLA.       |    3    | D/V  |

---

### Ссылки

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)


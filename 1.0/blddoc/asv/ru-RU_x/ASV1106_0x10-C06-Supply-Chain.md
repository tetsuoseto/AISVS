# C6 Безопасность цепочки поставок для моделей, фреймворков и данных

## Контрольная цель

Атаки в цепочке поставок ИИ используют сторонние модели, фреймворки или наборы данных для внедрения бэкдоров, предвзятости или уязвимого кода. Эти средства контроля обеспечивают сквозное отслеживание происхождения, управление уязвимостями и мониторинг для защиты всего жизненного цикла модели.

---

## C6.1 Проверка предобученных моделей и их происхождения

Оценить и проверить происхождение сторонних моделей, их лицензионные условия и скрытое поведение до любой тонкой настройки или развёртывания.

|   #   | Описание                                                                                                                                                            | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.1.1 | Убедитесь, что каждый артефакт модели третьей стороны содержит подписанную запись происхождения, идентифицирующую исходный репозиторий и хэш коммита.               |    1    | D/V  |
| 6.1.2 | Убедитесь, что модели проходят сканирование на наличие вредоносных слоев или троянских триггеров с использованием автоматизированных инструментов перед импортом.   |    1    | D/V  |
| 6.1.3 | Проверьте, что тонкие настройки переноса‑обучения проходят адверсариальную оценку, чтобы обнаружить скрытые поведенческие паттерны.                                 |    2    |  D   |
| 6.1.4 | Убедитесь, что лицензии на модели, теги экспорт‑контроля и заявления об источнике данных зафиксированы в записи ML‑BOM.                                             |    2    |  V   |
| 6.1.5 | Проверьте, что модели высокого‑риска (публично загруженные веса, непроверенные создатели) остаются в карантине до момента человеческого рассмотрения и утверждения. |    3    | D/V  |

---

## C6.2 Сканирование фреймворков и библиотек

Непрерывно сканируйте ML‑фреймворки и библиотеки на наличие CVEs и вредоносного кода, чтобы обеспечить безопасность стека выполнения.

|   #   | Описание                                                                                                                                      | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.2.1 | Проверьте, что CI-пайплайны запускают сканеры зависимостей для фреймворков ИИ и критически важных библиотек.                                  |    1    | D/V  |
| 6.2.2 | Проверьте, что критические уязвимости (CVSS ≥ 7.0) блокируют продвижение образов в продакшн.                                                  |    1    | D/V  |
| 6.2.3 | Убедитесь, что статический анализ кода выполняется на форкнутых или вендорных ML-библиотеках.                                                 |    2    |  D   |
| 6.2.4 | Проверьте, что предложения по обновлению фреймворка включают оценку воздействия на безопасность с ссылками на общедоступные источники CVE.    |    2    |  V   |
| 6.2.5 | Убедитесь, что сенсоры во время выполнения предупреждают об неожиданных загрузках динамических библиотек, отклоняющихся от подписанного SBOM. |    3    |  V   |

---

## C6.3 Фиксация зависимостей и проверка

Зафиксируйте каждую зависимость на неизменяемых дайджестах и воспроизводите сборки, чтобы гарантировать идентичные артефакты без подмены.

|   #   | Описание                                                                                                                          | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.3.1 | Убедитесь, что все менеджеры пакетов обеспечивают фиксацию версий через lock-файлы.                                               |    1    | D/V  |
| 6.3.2 | Проверьте, что в ссылках на контейнеры используются неизменяемые дайджесты вместо изменяемых тегов.                               |    1    | D/V  |
| 6.3.3 | Проверьте, что проверки воспроизводимой сборки сравнивают хэши между запусками CI, чтобы обеспечить идентичность выходных данных. |    2    |  D   |
| 6.3.4 | Убедитесь, что подтверждения сборки хранятся в течение 18 месяцев для обеспечения аудиторской прослеживаемости.                   |    2    |  V   |
| 6.3.5 | Проверьте, что просроченные зависимости инициируют автоматические PR для обновления или форка закреплённых версий.                |    3    |  D   |

---

## C6.4 Обеспечение доверенных источников

Разрешайте загрузку артефактов только из криптографически подтверждённых источников, одобренных организацией, и блокируйте всё остальное.

|   #   | Описание                                                                                                                                      | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.4.1 | Проверьте, что веса модели, наборы данных и контейнеры загружаются только с утверждённых доменов или внутренних реестров.                     |    1    | D/V  |
| 6.4.2 | Убедитесь, что подписи Sigstore/Cosign подтверждают идентичность издателя до того, как артефакты будут локально кэшированы.                   |    1    | D/V  |
| 6.4.3 | Убедитесь, что исходящие прокси-блокируют загрузку артефактов без аутентификации, чтобы обеспечить соблюдение политики доверенного источника. |    2    |  D   |
| 6.4.4 | Убедитесь, что белые списки репозитория пересматриваются ежеквартально с подтверждением деловой обоснованности для каждого элемента.          |    2    |  V   |
| 6.4.5 | Проверьте, что нарушения политики приводят к карантину артефактов и откату зависимых запусков пайплайна.                                      |    3    |  V   |

---

## C6.5 Оценка рисков сторонних наборов данных

Оценивать внешние наборы данных на предмет подмешивания, предвзятости и соответствия правовым требованиям, а также мониторить их на протяжении всего жизненного цикла.

|   #   | Описание                                                                                                                                    | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.5.1 | Убедитесь, что внешние наборы данных проходят оценку риска отравления данных (например, создание отпечатков данных и обнаружение выбросов). |    1    | D/V  |
| 6.5.2 | Проверьте, что метрики смещения (демографический паритет, равные возможности) рассчитываются до утверждения набора данных.                  |    1    |  D   |
| 6.5.3 | Убедитесь, что происхождение данных и условия лицензирования наборов данных зафиксированы в записях ML‑BOM.                                 |    2    |  V   |
| 6.5.4 | Проверьте, что периодический мониторинг обнаруживает дрейф или искажение данных в размещённых наборах данных.                               |    2    |  V   |
| 6.5.5 | Проверьте, что запрещённый контент (авторские права, PII) удалён с помощью автоматизированной очистки перед обучением.                      |    3    |  D   |

---

## C6.6 Мониторинг атак на цепочку поставок

Раннее обнаружение угроз цепочки поставок с помощью потоков CVE, аналитики журналов аудита и симуляций красной команды.

|   #   | Описание                                                                                                                                               | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 6.6.1 | Убедитесь, что журналы аудита CI/CD передаются в SIEM для обнаружения аномальных загрузок пакетов или подменённых шагов сборки.                        |    1    |  V   |
| 6.6.2 | Проверьте, что плейбуки реагирования на инциденты включают процедуры отката для скомпрометированных моделей или библиотек.                             |    2    |  D   |
| 6.6.3 | Проверьте, что обогащение данными об угрозах помечает ML‑специфические индикаторы (например, IoCs, связанных с отравлением модели) при разборе тревог. |    3    |  V   |

---

## C6.7 ML‑BOM для артефактов модели

Генерировать и подписывать детальные ML‑BOM (ML‑BOMs), чтобы потребители на этапе развёртывания могли проверить целостность компонентов.

|   #   | Описание                                                                                                                                          | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.7.1 | Убедитесь, что каждый артефакт модели публикует ML‑BOM, в котором перечислены наборы данных, веса, гиперпараметры и лицензии.                     |    1    | D/V  |
| 6.7.2 | Убедитесь, что генерация ML‑BOM и подпись Cosign автоматизированы в CI и требуются для слияния.                                                   |    1    | D/V  |
| 6.7.3 | Убедитесь, что проверки полноты ML‑BOM приводят к сбою сборки, если отсутствуют какие-либо метаданные компонента (хеш, лицензия).                 |    2    |  D   |
| 6.7.4 | Убедитесь, что downstream-потребители могут выполнять запросы к ML-BOMs через API для проверки импортированных моделей во время развертывания.    |    2    |  V   |
| 6.7.5 | Убедитесь, что ML‑BOMs находятся под версионным контролем и выполняется их сравнение различий (diff) для выявления несанкционированных изменений. |    3    |  V   |

---

## Список литературы

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


# C6 Безопасность цепочки поставок для моделей, фреймворков и данных

## Цель контроля

Атаки на цепочку поставок ИИ используют сторонние модели, фреймворки или наборы данных для внедрения бэкдоров, предвзятости или уязвимого кода. Эти меры обеспечивают полный контроль происхождения, управление уязвимостями и мониторинг для защиты всего жизненного цикла модели.

---

## C6.1 Проверка и происхождение предварительно обученной модели

Оценивайте и подтверждайте происхождение моделей третьих сторон, лицензии и скрытые поведения перед любой дополнительной настройкой или развертыванием.

|   #   | Описание                                                                                                                                                            | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.1.1 | Проверьте, что каждый артефакт сторонней модели включает подписанную запись о происхождении, идентифицирующую исходный репозиторий и хэш коммита.                   |    1    | D/V  |
| 6.1.2 | Убедитесь, что модели проверяются на наличие вредоносных слоев или триггеров Трояна с помощью автоматизированных инструментов перед импортом.                       |    1    | D/V  |
| 6.1.3 | Проверьте, что дообучение с использованием трансферного обучения проходит адверсариальное тестирование для обнаружения скрытых поведений.                           |    2    |  D   |
| 6.1.4 | Проверьте, что лицензии модели, теги экспортного контроля и заявления о происхождении данных записаны в записи ML-BOM.                                              |    2    |  V   |
| 6.1.5 | Проверьте, что высокорискованные модели (с общедоступными весами, от непроверенных создателей) остаются в карантине до проведения проверки и утверждения человеком. |    3    | D/V  |

---

## C6.2 Сканирование фреймворков и библиотек

Постоянно сканируйте ML-фреймворки и библиотеки на наличие CVE и вредоносного кода, чтобы поддерживать безопасность рабочего стека.

|   #   | Описание                                                                                                                                       | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.2.1 | Убедитесь, что конвейеры CI запускают сканеры зависимостей для AI-фреймворков и критически важных библиотек.                                   |    1    | D/V  |
| 6.2.2 | Проверьте, что критические уязвимости (CVSS ≥ 7.0) блокируют продвижение к образам для производства.                                           |    1    | D/V  |
| 6.2.3 | Убедитесь, что статический анализ кода выполняется для форкнутых или поставляемых вместе ML-библиотек.                                         |    2    |  D   |
| 6.2.4 | Убедитесь, что предложения по обновлению фреймворка включают оценку влияния на безопасность с указанием ссылок на общедоступные источники CVE. |    2    |  V   |
| 6.2.5 | Проверьте, что датчики выполнения сигнализируют о неожиданных загрузках динамических библиотек, которые отклоняются от подписанного SBOM.      |    3    |  V   |

---

## C6.3 Фиксация и проверка зависимостей

Закрепляйте каждую зависимость за неизменяемыми дайджестами и воспроизводите сборки для гарантии идентичных, защищённых от подделки артефактов.

|   #   | Описание                                                                                                                                   | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 6.3.1 | Проверьте, что все менеджеры пакетов обеспечивают фиксацию версий с помощью lock-файлов.                                                   |    1    | D/V  |
| 6.3.2 | Проверьте, что в ссылках на контейнеры используются неизменяемые дайджесты вместо изменяемых тегов.                                        |    1    | D/V  |
| 6.3.3 | Проверьте, что проверки воспроизводимых сборок сравнивают хеши между запусками CI для обеспечения идентичности результатов.                |    2    |  D   |
| 6.3.4 | Проверьте, что аттестации сборки хранятся в течение 18 месяцев для обеспечения аудиторской прослеживаемости.                               |    2    |  V   |
| 6.3.5 | Проверьте, что просроченные зависимости вызывают автоматическое создание запросов на слияние для обновления или форка закрепленных версий. |    3    |  D   |

---

## C6.4 Обеспечение доверенного источника

Разрешать загрузку артефактов только из криптографически проверенных источников, одобренных организацией, и блокировать все остальные.

|   #   | Описание                                                                                                                             | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 6.4.1 | Проверяйте, что веса моделей, наборы данных и контейнеры загружаются только с одобренных доменов или внутренних реестров.            |    1    | D/V  |
| 6.4.2 | Проверьте, что подписи Sigstore/Cosign подтверждают личность издателя перед кэшированием артефактов локально.                        |    1    | D/V  |
| 6.4.3 | Проверьте, что исходящие прокси блокируют загрузки артефактов без аутентификации для обеспечения политики доверенного источника.     |    2    |  D   |
| 6.4.4 | Проверьте, что списки разрешённых репозиториев пересматриваются ежеквартально с подтверждением бизнес-обоснования для каждой записи. |    2    |  V   |
| 6.4.5 | Проверьте, что нарушение политики вызывает изоляцию артефактов и откат зависимых запусков конвейера.                                 |    3    |  V   |

---

## C6.5 Оценка рисков использования сторонних наборов данных

Оценивайте внешние наборы данных на предмет отравления, предвзятости и юридической соответствия, а также контролируйте их на протяжении всего жизненного цикла.

|   #   | Описание                                                                                                                           | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.5.1 | Проверьте, что внешние наборы данных проходят оценку риска отравления (например, идентификацию данных, обнаружение выбросов).      |    1    | D/V  |
| 6.5.2 | Убедитесь, что метрики смещения (демографическое равенство, равные возможности) рассчитываются до утверждения набора данных.       |    1    |  D   |
| 6.5.3 | Проверьте, что происхождение и условия лицензии для наборов данных зафиксированы в записях ML‑BOM.                                 |    2    |  V   |
| 6.5.4 | Проверьте, что периодический мониторинг выявляет дрейф или повреждение в размещённых наборах данных.                               |    2    |  V   |
| 6.5.5 | Проверьте, что запрещённый контент (авторские права, персональные данные) удалён с помощью автоматической очистки перед обучением. |    3    |  D   |

---

## C6.6 Мониторинг атак на цепочку поставок

Обнаруживайте угрозы цепочки поставок на ранних этапах с помощью CVE-лент, анализа аудиторских журналов и симуляций красной команды.

|   #   | Описание                                                                                                                                                                             | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 6.6.1 | Проверьте, что журналы аудита CI/CD передаются в SIEM для обнаружения аномальных загрузок пакетов или изменений в шагах сборки.                                                      |    1    |  V   |
| 6.6.2 | Проверьте, что в сценариях реагирования на инциденты включены процедуры отката для скомпрометированных моделей или библиотек.                                                        |    2    |  D   |
| 6.6.3 | Проверьте, что теги обогащения информации об угрозах содержат индикаторы, специфичные для машинного обучения (например, IoC, связанные с отравлением модели), при отборе оповещений. |    3    |  V   |

---

## C6.7 ML‑BOM для артефактов моделей

Генерируйте и подписывайте подробные ML-специфичные SBOM (ML-BOM), чтобы конечные потребители могли проверять целостность компонентов во время развертывания.

|   #   | Описание                                                                                                                                 | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.7.1 | Убедитесь, что каждый артефакт модели публикует ML-BOM, в котором перечислены наборы данных, веса, гиперпараметры и лицензии.            |    1    | D/V  |
| 6.7.2 | Проверьте, что генерация ML‑BOM и подписание Cosign автоматизированы в CI и обязательны для слияния.                                     |    1    | D/V  |
| 6.7.3 | Проверьте, что проверки полноты ML-BOM завершаются сбоем сборки, если отсутствуют какие-либо метаданные компонента (хэш, лицензия).      |    2    |  D   |
| 6.7.4 | Проверьте, что конечные пользователи могут запрашивать ML-BOM через API для проверки импортированных моделей во время развертывания.     |    2    |  V   |
| 6.7.5 | Убедитесь, что ML‑BOMы находятся под версионным контролем и подвергаются сравнению (diff) для обнаружения несанкционированных изменений. |    3    |  V   |

---

## Ссылки

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


# C6 Безопасность цепочки поставок для моделей, фреймворков и данных

## Цель управления

Атаки на цепочку поставок ИИ используют сторонние модели, фреймворки или наборы данных для внедрения «черных ходов», предвзятости или эксплуатируемого кода. Эти средства обеспечивают сквозное отслеживание происхождения, управление уязвимостями и мониторинг для защиты всего жизненного цикла модели.

---

## C6.1 Проверка и происхождение предобученной модели

Оценивайте и проверяйте происхождение моделей третьих сторон, лицензии и скрытые поведения перед любым дообучением или развертыванием.

|   #   | Описание                                                                                                                                                           | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 6.1.1 | Проверьте, что каждый артефакт сторонней модели содержит подписанную запись происхождения, указывающую исходный репозиторий и хэш коммита.                         |    1    | D/V  |
| 6.1.2 | Проверьте, что модели сканируются на наличие вредоносных слоев или триггеров трояна с помощью автоматизированных инструментов перед импортом.                      |    1    | D/V  |
| 6.1.3 | Убедитесь, что дообучение с помощью трансферного обучения проходит проверку на устойчивость к атакам для выявления скрытых поведений.                              |    2    |  D   |
| 6.1.4 | Проверьте, что лицензии моделей, метки экспортного контроля и заявления о происхождении данных зарегистрированы в записи ML-BOM.                                   |    2    |  V   |
| 6.1.5 | Убедитесь, что высокорискованные модели (публично загруженные веса, непроверенные создатели) остаются под карантином до проведения проверки и одобрения человеком. |    3    | D/V  |

---

## C6.2 Сканирование фреймворков и библиотек

Постоянно сканируйте фреймворки и библиотеки машинного обучения на наличие CVE и вредоносного кода, чтобы обеспечить безопасность исполняемого стека.

|   #   | Описание                                                                                                                                           | Уровень | Роль |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.2.1 | Проверьте, что CI-пайплайны запускают сканеры зависимостей для AI-фреймворков и критических библиотек.                                             |    1    | D/V  |
| 6.2.2 | Проверьте, что критические уязвимости (CVSS ≥ 7.0) блокируют продвижение к образам для производства.                                               |    1    | D/V  |
| 6.2.3 | Проверьте, что статический анализ кода выполняется для форкнутых или поставляемых вместе с проектом библиотек машинного обучения.                  |    2    |  D   |
| 6.2.4 | Убедитесь, что предложения по обновлению фреймворка содержат оценку воздействия на безопасность с указанием ссылок на общедоступные источники CVE. |    2    |  V   |
| 6.2.5 | Проверьте, что датчики времени выполнения сигнализируют о неожиданных загрузках динамических библиотек, которые отклоняются от подписанного SBOM.  |    3    |  V   |

---

## C6.3 Фиксация и проверка зависимостей

Закрепляйте каждую зависимость за неизменяемыми дайджестами и воспроизводите сборки, чтобы гарантировать идентичные, защищённые от подделки артефакты.

|   #   | Описание                                                                                                                        | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.3.1 | Проверьте, что все менеджеры пакетов обеспечивают закрепление версий через lock-файлы.                                          |    1    | D/V  |
| 6.3.2 | Проверьте, что в ссылках на контейнеры используются неизменяемые дайджесты вместо изменяемых тегов.                             |    1    | D/V  |
| 6.3.3 | Проверьте, что проверки воспроизводимых сборок сравнивают хэши между запусками CI для обеспечения идентичности выходных данных. |    2    |  D   |
| 6.3.4 | Проверьте, что свидетельства о сборке хранятся в течение 18 месяцев для обеспечения трассируемости аудита.                      |    2    |  V   |
| 6.3.5 | Проверьте, что устаревшие зависимости вызывают автоматические Pull Request для обновления или форка фиксированных версий.       |    3    |  D   |

---

## C6.4 Реализация политики доверенных источников

Разрешать загрузку артефактов только из криптографически проверенных, утвержденных организацией источников и блокировать все остальное.

|   #   | Описание                                                                                                                             | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 6.4.1 | Убедитесь, что веса модели, наборы данных и контейнеры загружаются только с одобренных доменов или внутренних реестров.              |    1    | D/V  |
| 6.4.2 | Проверьте, что подписи Sigstore/Cosign подтверждают личность издателя перед тем, как артефакты кэшируются локально.                  |    1    | D/V  |
| 6.4.3 | Проверьте, что выходные прокси блокируют неавторизованные загрузки артефактов для обеспечения политики доверенного источника.        |    2    |  D   |
| 6.4.4 | Проверьте, что списки разрешенных репозиториев пересматриваются ежеквартально с подтверждением бизнес-обоснования для каждой записи. |    2    |  V   |
| 6.4.5 | Проверьте, что нарушения политики вызывают помещение артефактов в карантин и откат зависимых запусков конвейера.                     |    3    |  V   |

---

## C6.5 Оценка рисков набора данных третьей стороны

Оценивайте внешние наборы данных на наличие отравления, предвзятости и соответствия юридическим требованиям, а также контролируйте их в течение всего жизненного цикла.

|   #   | Описание                                                                                                                                       | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.5.1 | Проверьте, что внешние наборы данных проходят оценку риска отравления (например, отпечатки данных, обнаружение выбросов).                      |    1    | D/V  |
| 6.5.2 | Убедитесь, что метрики предвзятости (демографическое паритет, равные возможности) рассчитываются до утверждения набора данных.                 |    1    |  D   |
| 6.5.3 | Проверьте, что происхождение и условия лицензии для наборов данных зафиксированы в записях ML‑BOM.                                             |    2    |  V   |
| 6.5.4 | Проверьте, что периодический мониторинг обнаруживает дрейф или повреждение размещенных наборов данных.                                         |    2    |  V   |
| 6.5.5 | Проверьте, что запрещённый контент (авторские права, персональные данные) удаляется с помощью автоматического сканирования до начала обучения. |    3    |  D   |

---

## C6.6 Мониторинг атак на цепочку поставок

Раннее обнаружение угроз в цепочке поставок с помощью потоков CVE, анализа журналов аудита и симуляций красной команды.

|   #   | Описание                                                                                                                                                                                             | Уровень | Роль |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.6.1 | Проверьте, что журналы аудита CI/CD передаются в систему SIEM для обнаружения аномальных загрузок пакетов или вмешательства в этапы сборки.                                                          |    1    |  V   |
| 6.6.2 | Проверьте, что в планах реагирования на инциденты предусмотрены процедуры отката для скомпрометированных моделей или библиотек.                                                                      |    2    |  D   |
| 6.6.3 | Убедитесь, что теги обогащения разведданных об угрозах помечают специфические для машинного обучения индикаторы (например, IoC, связанные с отравлением модели) при первичной оценке предупреждений. |    3    |  V   |

---

## C6.7 ML‑BOM для артефактов модели

Генерируйте и подписывайте детализированные ML-специфичные SBOM (ML-BOM), чтобы конечные пользователи могли проверять целостность компонентов во время развертывания.

|   #   | Описание                                                                                                                            | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 6.7.1 | Убедитесь, что каждый артефакт модели публикует ML‑BOM, который перечисляет наборы данных, веса, гиперпараметры и лицензии.         |    1    | D/V  |
| 6.7.2 | Проверьте, что генерация ML‑BOM и подписание Cosign автоматизированы в CI и обязательны для слияния.                                |    1    | D/V  |
| 6.7.3 | Проверьте, что проверки полноты ML‑BOM прерывают сборку, если отсутствуют какие-либо метаданные компонента (хеш, лицензия).         |    2    |  D   |
| 6.7.4 | Проверьте, что конечные потребители могут запрашивать ML-BOM через API для проверки импортированных моделей во время развертывания. |    2    |  V   |
| 6.7.5 | Проверьте, что ML‑BOMы находятся под управлением версий и сравниваются для обнаружения несанкционированных изменений.               |    3    |  V   |

---

## Ссылки

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


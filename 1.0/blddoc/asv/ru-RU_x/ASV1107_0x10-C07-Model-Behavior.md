# Поведение модели C7, контроль выходных данных и обеспечение безопасности

## Цель управления

Результаты модели должны быть структурированными, надежными, безопасными, объяснимыми и постоянно контролироваться в производственной среде. Это снижает вероятность галлюцинаций, утечек конфиденциальной информации, вредоносного контента и неконтролируемых действий, одновременно повышая доверие пользователей и соблюдение нормативных требований.

---

## C7.1 Принудительное соблюдение формата вывода

Строгие схемы, ограниченное декодирование и последующая проверка останавливают некорректный или вредоносный контент до его распространения.

|   #   | Описание                                                                                                                                                                                                        | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 7.1.1 | Проверьте, что схемы ответов (например, JSON Schema) предоставлены в системном запросе, и каждый вывод автоматически проверяется на соответствие; несоответствующие выводы вызывают исправление или отклонение. |    1    | D/V  |
| 7.1.2 | Проверьте, что ограниченное декодирование (стоп-токены, регулярные выражения, макс-токены) включено для предотвращения переполнения или побочных каналов внедрения в запрос.                                    |    1    | D/V  |
| 7.1.3 | Проверьте, что последующие компоненты рассматривают выходные данные как ненадежные и проверяют их в соответствии с схемами или используют безопасные от инъекций десериализаторы.                               |    2    | D/V  |
| 7.1.4 | Проверьте, что события с неправильным выводом регистрируются, ограничиваются по частоте и отображаются в системе мониторинга.                                                                                   |    3    |  V   |

---

## C7.2 Обнаружение и смягчение галлюцинаций

Оценка неопределенности и стратегии возврата ограничивают вымышленные ответы.

|   #   | Описание                                                                                                                                                                                           | Уровень | Роль |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 7.2.1 | Проверьте, что логарифмические вероятности на уровне токенов, ансамблевый метод самосогласованности или специально обученные детекторы галлюцинаций присваивают оценку уверенности каждому ответу. |    1    | D/V  |
| 7.2.2 | Проверьте, что ответы ниже настраиваемого порога достоверности вызывают резервные рабочие процессы (например, генерацию с поддержкой поиска, вторичную модель или проверку человеком).             |    1    | D/V  |
| 7.2.3 | Убедитесь, что случаи галлюцинаций отмечены метаданными с коренной причиной и переданы в процессы посмертного анализа и дообучения.                                                                |    2    | D/V  |
| 7.2.4 | Проверьте, что пороги и детекторы перенастроены после крупных обновлений модели или базы знаний.                                                                                                   |    3    | D/V  |
| 7.2.5 | Проверьте, что визуализации на панели отслеживают уровни галлюцинаций.                                                                                                                             |    3    |  V   |

---

## C7.3 Фильтрация безопасности и конфиденциальности вывода

Фильтры политики и покрытие красной команды защищают пользователей и конфиденциальные данные.

|   #   | Описание                                                                                                                                                                                                        | Уровень | Роль |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 7.3.1 | Проверьте, что классификаторы до и после генерации блокируют контент, связанный с ненавистью, домогательствами, самоповреждением, экстремизмом и сексуально откровенным содержанием в соответствии с политикой. |    1    | D/V  |
| 7.3.2 | Убедитесь, что обнаружение PII/PCI и автоматическое сокрытие выполняются на каждом ответе; нарушения вызывают инцидент по вопросам конфиденциальности.                                                          |    1    | D/V  |
| 7.3.3 | Проверьте, что теги конфиденциальности (например, коммерческая тайна) распространяются на все типы данных, чтобы предотвратить утечку в тексте, изображениях или коде.                                          |    2    |  D   |
| 7.3.4 | Проверьте, что попытки обхода фильтра или классификации с высоким уровнем риска требуют вторичного одобрения или повторной аутентификации пользователя.                                                         |    3    | D/V  |
| 7.3.5 | Проверьте, что пороги фильтрации соответствуют юрисдикциям и контексту возраста/роли пользователя.                                                                                                              |    3    | D/V  |

---

## C7.4 Ограничение вывода и действий

Ограничения по скорости и контрольные точки одобрения предотвращают злоупотребления и чрезмерную автономию.

|   #   | Описание                                                                                                                                                                                                                   | Уровень | Роль |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 7.4.1 | Проверьте, что квоты для каждого пользователя и каждого API-ключа ограничивают запросы, токены и стоимость с экспоненциальным повторным ожиданием при ошибках 429.                                                         |    1    |  D   |
| 7.4.2 | Проверьте, что привилегированные действия (запись файлов, выполнение кода, сетевые вызовы) требуют одобрения на основе политики или участия человека в процессе.                                                           |    1    | D/V  |
| 7.4.3 | Проверьте, что проверки кросс-модальной согласованности гарантируют, что изображения, код и текст, сгенерированные для одного и того же запроса, не могут быть использованы для скрытой передачи вредоносного содержимого. |    2    | D/V  |
| 7.4.4 | Убедитесь, что глубина делегирования агентов, ограничения рекурсии и списки разрешённых инструментов настроены явно.                                                                                                       |    2    |  D   |
| 7.4.5 | Проверьте, что нарушение лимитов генерирует структурированные события безопасности для инкапсуляции в SIEM.                                                                                                                |    3    |  V   |

---

## C7.5 Объяснимость результатов

Прозрачные сигналы повышают доверие пользователей и облегчают внутреннюю отладку.

|   #   | Описание                                                                                                                                                    | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 7.5.1 | Убедитесь, что оценки доверия, ориентированные на пользователя, или краткие резюме рассуждений предоставляются, когда оценка риска считает это необходимым. |    2    | D/V  |
| 7.5.2 | Проверьте, что сгенерированные объяснения не раскрывают конфиденциальные системные подсказки или закрытые данные.                                           |    2    | D/V  |
| 7.5.3 | Проверьте, что система захватывает логарифмы вероятностей на уровне токенов или карты внимания и сохраняет их для авторизованного просмотра.                |    3    |  D   |
| 7.5.4 | Убедитесь, что артефакты объяснимости находятся под версионным контролем вместе с выпусками моделей для обеспечения возможности аудита.                     |    3    |  V   |

---

## C7.6 Интеграция мониторинга

Непрерывная наблюдаемость в режиме реального времени замыкает цикл между разработкой и производством.

|   #   | Описание                                                                                                                                                                      | Уровень | Роль |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :--: |
| 7.6.1 | Проверьте, что метрики (нарушения схемы, уровень галлюцинаций, токсичность, утечки персональных данных, задержка, стоимость) поступают на центральную платформу мониторинга.  |    1    |  D   |
| 7.6.2 | Подтвердите, что для каждого показателя безопасности определены пороги тревог с маршрутами эскалации для дежурного.                                                           |    1    |  V   |
| 7.6.3 | Проверьте, что панели мониторинга связывают аномалии на выходе с моделью/версией, флагом функции и изменениями в исходных данных.                                             |    2    |  V   |
| 7.6.4 | Подтвердите, что данные мониторинга возвращаются в процесс повторного обучения, тонкой настройки или обновления правил в рамках задокументированного рабочего процесса MLOps. |    2    | D/V  |
| 7.6.5 | Убедитесь, что конвейеры мониторинга подверглись тестированию на проникновение и имеют контроль доступа для предотвращения утечки конфиденциальных журналов.                  |    3    |  V   |

---

## 7.7 Меры защиты генеративных медиа

Обеспечьте, чтобы системы искусственного интеллекта не создавали незаконный, вредоносный или несанкционированный медиа контент путем применения ограничений политики, проверки результатов и обеспечения прослеживаемости.

|   #   | Описание                                                                                                                                                                                                                       | Уровень | Роль |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :--: |
| 7.7.1 | Проверьте, что системные подсказки и инструкции пользователя явно запрещают создание незаконных, вредоносных или несанкционированных дипфейковых материалов (например, изображений, видео, аудио).                             |    1    | D/V  |
| 7.7.2 | Проверьте, что запросы фильтруются на предмет попыток создания имитаций, сексуально откровенных дипфейков или материалов с изображением реальных лиц без согласия.                                                             |    2    | D/V  |
| 7.7.3 | Проверьте, что система использует перцептивное хеширование, обнаружение водяных знаков или фингерпринтинг для предотвращения несанкционированного воспроизведения защищённого авторским правом контента.                       |    2    |  V   |
| 7.7.4 | Проверьте, что все сгенерированные мультимедийные материалы криптографически подписаны, имеют водяной знак или содержат встроенные защищённые от подделки метаданные происхождения для обеспечения дальнейшей отслеживаемости. |    3    | D/V  |
| 7.7.5 | Проверьте, что попытки обхода (например, сокрытие подсказок, сленг, враждебные формулировки) обнаруживаются, регистрируются и ограничиваются по частоте; повторяющееся злоупотребление передается в системы мониторинга.       |    3    |  V   |

## Ссылки

* [NIST AI Risk Management Framework](https://www.nist.gov/itl/ai-risk-management-framework)
* [ISO/IEC 42001:2023 – AI Management System](https://www.iso.org/obp/ui/en/)
* [OWASP Top-10 for Large Language Model Applications (2025)](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Improper Output Handling – OWASP LLM05:2025](https://genai.owasp.org/llmrisk/llm052025-improper-output-handling/)
* [Practical Techniques to Constrain LLM Output](https://mychen76.medium.com/practical-techniques-to-constraint-llm-output-in-json-format-e3e72396c670)
* [Dataiku – Structured Text Generation Guide](https://blog.dataiku.com/your-guide-to-structured-text-generation)
* [VL-Uncertainty: Detecting Hallucinations](https://arxiv.org/abs/2411.11919)
* [HaDeMiF: Hallucination Detection & Mitigation](https://openreview.net/forum?id=VwOYxPScxB)
* [Building Confidence in LLM Outputs](https://www.alkymi.io/data-science-room/building-confidence-in-llm-outputs)
* [Explainable AI & LLMs](https://duncsand.medium.com/explainable-ai-140912d31b3b)
* [LLM Red-Teaming Guide](https://www.confident-ai.com/blog/red-teaming-llms-a-step-by-step-guide)
* [Sensitive Information Disclosure in LLMs](https://virtualcyberlabs.com/llm-sensitive-information-disclosure/)
* [LangChain – Chat Model Rate Limiting](https://python.langchain.com/docs/how_to/chat_model_rate_limiting/)
* [OpenAI Rate-Limit & Exponential Back-off](https://hackernoon.com/openais-rate-limit-a-guide-to-exponential-backoff-for-llm-evaluation)
* [Arize AI – LLM Observability Platform](https://arize.com/)


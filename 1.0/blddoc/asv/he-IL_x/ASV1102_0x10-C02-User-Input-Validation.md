# C2 אימות קלט משתמש

## מטרת הבקרה

אימות מוצק של קלט המשתמש הוא הקו הראשון להגנה נגד חלק מההתקפות המזיקות ביותר על מערכות בינה מלאכותית. התקפות הזנת פקודות יכולות לעקוף את הוראות המערכת, לחשוף נתונים רגישים, או להוביל את המודל להתנהגות שאינה מורשית. אלא אם כן מותקנים מסננים ייעודיים והיררכיות הוראות, המחקר מראה שיברונות מסוג 'multi-shot' שמנצלים חלונות הקשר הארוכים מאוד יהיו יעילים. בנוסף, התקפות הפרעה אדוורסריות עדינות—כגון החלפות homoglyph או leetspeak—-יכולות לשנות בשקט את החלטות המודל.

---

## C2.1 הגנה מפני הזרקת פרומפט

הזרקת הנחיה היא אחת מהסיכונים המרכזיים ביותר עבור מערכות בינה מלאכותית. ההגנות כנגד טקטיקה זו כוללות שילוב של מסנני דפוס סטטיים, מסווגים דינמיים ואכיפת היררכיית הנחיות.

|   #   | תיאור                                                                                                                                                                               | רמה | תפקיד |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.1.1 | ודא כי הקלטים של המשתמשים נבדקים מול ספרייה המתעדכנת כל הזמן של תבניות הזרקת הנחיה ידועות (מילות מפתח לשבירת הגנות, "ignore previous", שרשראות תפקיד-משחק, התקפות HTML/URL עקיפות). |  1  |  D/V  |
| 2.1.2 | ודא שהמערכת מאכפת היררכיית הנחיות שבה הודעות מערכת או הודעות של המפתחים מעדיפות על הוראות המשתמש, גם לאחר הרחבת חלון ההקשר.                                                         |  1  |  D/V  |
| 2.1.3 | ודא כי בדיקות הערכה נגדיות (למשל, פרומפטים של Red Team "many-shot") מתבצעות לפני כל שחרור של מודל או תבנית פרומפט, עם ספי הצלחה ומנגנונים אוטומטיים לחסימת רגרסיות.                 |  2  |  D/V  |
| 2.1.4 | ודא כי הנחיות שמקורן בתוכן של צד שלישי (דפי אינטרנט, קבצי PDF, מיילים) מסוננות בהקשר פענוח מבודד לפני שהן יתווספו להנחיה הראשית.                                                    |  2  |   D   |
| 2.1.5 | ודא שכל עדכוני כללי סינון הפרומפט, גרסאות מודלי סיווג ושינויים ברשימת-חסימה נמצאים תחת בקרת גרסאות וניתנים לביקורת.                                                                 |  3  |  D/V  |

---

## C2.2 עמידות בפני דוגמת יריב

מודלי עיבוד שפה טבעית (NLP) עדיין פגיעים לשיבושים עדינים ברמת התו או המילה, שאנשים לעיתים קרובות מפספסים אותם אך המודלים נוטים לסווגם בצורה שגויה.

|   #   | תיאור                                                                                                                                                                        | רמה | תפקיד |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.2.1 | ודא כי צעדי נרמול הקלט הבסיסיים (Unicode NFC, מיפוי הומוגליפים, הסרת רווחים) מבוצעים לפני הטוקניזציה.                                                                        |  1  |   D   |
| 2.2.2 | ודא שזיהוי אנומליות סטטיסטיות מסמן קלטים עם מרחק עריכה גבוה מהנורמות של השפה, עם טוקנים חוזרים באופן מופרז, או עם מרחקי הטמעה חריגים.                                        |  2  |  D/V  |
| 2.2.3 | ודא כי צינור ההסקה תומך בגרסאות מודלים מחוזקות באימון נגד התקפות adversarial-training–hardened או בשכבות הגנה (למשל, רנדומיזציה, הסינון ההגנתי) עבור נקודות קצה בסיכון גבוה. |  2  |   D   |
| 2.2.4 | ודא שהקלטים האדוורסאריים החשודים נמצאים בבידוד ומתועדים עם כל המטענים המלאים (לאחר מחיקת PII).                                                                               |  2  |   V   |
| 2.2.5 | ודא שמדדי העמידות (שיעור ההצלחה של אוספי התקפות ידועים) נעקבים לאורך זמן, ורגרסיות יגרמו למחסום שחרור.                                                                       |  3  |  D/V  |

---

## C2.3 אימות מבנה נתונים, סוג ואורך

מתקפות בינה מלאכותית המכילות קלטים פגומים או גדולים מדי עלולות לגרום לשגיאות ניתוח, פיזור ההנחיה בין שדות, והתרוקנות משאבים.  אכיפה נוקשה של סכמת נתונים היא גם תנאי מוקדם בביצוע קריאות כלים דטרמיניסטיים.

|   #   | תיאור                                                                                                                                             | רמה | תפקיד |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.3.1 | ודא שכל נקודת קצה של API או קריאת פונקציה מגדירה סכמת קלט מפורשת (JSON Schema, Protobuf או המקביל המולטימודלי) ושקלטים מאומתים לפני הרכבת ההנחיה. |  1  |   D   |
| 2.3.2 | ודא כי קלטים החורגים מהמגבלות המקסימליות של אסימונים ובייטים נדחים באמצעות שגיאה בטוחה, ולא ייחתכו בדממה.                                         |  1  |  D/V  |
| 2.3.3 | ודא שבדיקות טיפוס (למשל טווחים מספריים, ערכי enum, סוגי MIME לתמונות/אודיו) נאכפות בצד השרת, ולא רק בקוד הלקוח.                                   |  2  |  D/V  |
| 2.3.4 | ודא שמאמתים סמנטיים (למשל JSON Schema) פועלים בזמן קבוע כדי למנוע התקפת DoS אלגוריתמית.                                                           |  2  |   D   |
| 2.3.5 | ודא שכשלי אימות נתונים נרשמים יחד עם קטעי מטען מוצנזרים וקודי שגיאה ברורים כדי לסייע בטריאז' אבטחתי.                                              |  3  |   V   |

---

## C2.4 סינון תוכן ומדיניות

מפתחים צריכים להיות מסוגלים לזהות בקשות תקינות תחבירית שמבקשות תוכן שאסור (כגון הוראות בלתי חוקיות, דיבור שנאה וטקסט המוגן בזכויות יוצרים) ואז למנוע מהן להפיץ.

|   #   | תיאור                                                                                                                                             | רמה | תפקיד |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.4.1 | ודא כי מסווג תוכן (zero-shot או fine-tuned) מספק ציון לכל קלט עבור אלימות, פגיעה עצמית, שנאה, תוכן מיני ובקשות לא חוקיות, עם ספים הניתנים להגדרה. |  1  |   D   |
| 2.4.2 | ודא כי הקלטים שמפרים מדיניות יקבלו סירובים אחידים או השלמות בטוחות כך שלא יופצו לקריאות LLM בהמשך.                                                |  1  |  D/V  |
| 2.4.3 | ודא כי מודל הסינון או סט הכללים מאומן מחדש/מעודכן לפחות פעם אחת בכל רבעון, תוך שילוב דפוסי jailbreak שנצפו לאחרונה או דפוסי עקיפת מדיניות.        |  2  |   D   |
| 2.4.4 | ודא כי הסינון מכבד את המדיניות המתאימה למשתמש (גיל, מגבלות חוקיות אזוריות) באמצעות כללי תכונות שנקבעים בזמן הבקשה.                                |  2  |   D   |
| 2.4.5 | ודא כי יומני הסינון כוללים ציוני אמון של מסווג ותגי קטגוריית המדיניות לקורלציה עם SOC ולשחזור עתידי של תרגיל צוות אדום.                           |  3  |   V   |

---

## C2.5 הגבלת קצב קלט ומניעת שימוש לרעה

מפתחים צריכים למנוע שימוש לרעה, תשישות משא, והתקפות אוטומטיות נגד מערכות בינה מלאכותית על ידי הגבלת קצב הקלט וזיהוי דפוסי שימוש חריגים.

|   #   | תיאור                                                                                        | רמה | תפקיד |
| :---: | -------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.5.1 | ודא כי מגבלות קצב לפי-משתמש, לפי-IP, ולפי-מפתח-API מוחלות עבור כל נקודות הקלט.               |  1  |  D/V  |
| 2.5.2 | ודא שמגבלות פרץ תנועה ומגבלות קצב מתמשך מכוונות כדי למנוע DoS והתקפות brute force.           |  2  |  D/V  |
| 2.5.3 | ודא שדפוסי שימוש חריגים (למשל בקשות בקצב מהיר, הצפת קלט) מפעילים חסימות אוטומטיות או הסלמות. |  2  |  D/V  |
| 2.5.4 | ודא כי יומני מניעת ניצול לרעה נשמרים ונבדקים לזיהוי תבניות התקפה המתהוות.                    |  3  |   V   |

---

## C2.6 אימות קלט מרובת-מודאליות

מערכות בינה מלאכותית צריכות לכלול אימות חזק לקלטים שאינם טקסט (תמונות, אודיו, קבצים) כדי למנוע הזרקות, התחמקות או שימוש לרעה במשאבים.

|   #   | תיאור                                                                                          | רמה | תפקיד |
| :---: | ---------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.6.1 | ודא שכל הקלטים שאינם טקסט (תמונות, אודיו, קבצים) נבדקים על פי הסוג, הגודל והפורמט לפני העיבוד. |  1  |   D   |
| 2.6.2 | ודא כי הקבצים נבדקים עבור תוכנות זדוניות ועבור מטענים סטגנוגרפיים לפני קליטת הקבצים.           |  2  |  D/V  |
| 2.6.3 | וודא כי הקלטים של תמונות/אודיו נבדקים עבור הפרעות נגדיות או דפוסי התקפה מוכרים.                |  2  |  D/V  |
| 2.6.4 | ודא שכשלי אימות קלט מרובי-מודאליים נרשמים ומפעילים התראות לבירור.                              |  3  |   V   |

---

## C2.7 מקור הקלט והקרדיט

מערכות בינה מלאכותית צריכות לתמוך בביקורת, במעקב אחר ניצול לרעה ובציות על ידי ניטור ותיוג מקורות כל הקלטים של המשתמשים.

|   #   | תיאור                                                                                                     | רמה | תפקיד |
| :---: | --------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.7.1 | ודא שכל הקלטים של המשתמשים מתויגים עם מטא-נתונים (מזהה משתמש, סשן, מקור, חותמת זמן, כתובת IP) בעת הקליטה. |  1  |  D/V  |
| 2.7.2 | ודא שמטא-נתוני המוצא נשמרים וניתנים לביקורת לכל הקלטים המעובדים.                                          |  2  |  D/V  |
| 2.7.3 | ודא כי מקורות קלט חריגים או לא מהימנים מסומנים וכפופים לביקורת מוגברת או לחסימה.                          |  2  |  D/V  |

---

## C2.8 איתור איומים בזמן אמת אדפטיבי

מפתחים צריכים להשתמש במערכות זיהוי איומים מתקדמות עבור בינה מלאכותית שמסוגלות להסתגל לתבניות תקיפה חדשות ולספק הגנה בזמן אמת באמצעות התאמת תבניות מקומפלות.

|   #   | תיאור                                                                                                                                     | רמה | תפקיד |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.8.1 | ודא שהתבניות לזיהוי איומים מומרות למנועי ביטויי רגולריים אופטימליים לסינון בזמן אמת עם פגיעה מזערית בשיהוי.                               |  1  |  D/V  |
| 2.8.2 | ודא שמערכות זיהוי איומים שומרות על ספריות דפוסים נפרדות עבור קטגוריות איומים שונות (הזרקת הנחיה, תוכן מזיק, נתונים רגישים, פקודות מערכת). |  1  |  D/V  |
| 2.8.3 | ודא שזיהוי איומים אדפטיבי כולל מודלים ללמידה מכונה שמעדכנים את רגישות האיומים לפי תדירות ההתקפות ושיעורי ההצלחה.                          |  2  |  D/V  |
| 2.8.4 | ודא שזרמי מודיעין איומים בזמן אמת מעדכנים באופן אוטומטי את ספריות התבניות עם חתימות התקפה חדשות ו-IOCs (מדדי פגיעה).                      |  2  |  D/V  |
| 2.8.5 | ודא ששיעורי החיוב-שווא בזיהוי איומים מנוטרים באופן רציף ושדיוק הדפוסים מכוונן באופן אוטומטי כדי לצמצם את ההפרעה למקרי שימוש לגיטימיים.    |  3  |  D/V  |
| 2.8.6 | ודא שניתוח איומים בהקשר לוקח בחשבון את מקור הקלט, דפוסי התנהגות המשתמש והיסטוריית הסשנים כדי לשפר את דיוק הזיהוי.                         |  3  |  D/V  |
| 2.8.7 | ודא שמדדי הביצועים של זיהוי איומים (שיעור הזיהוי, זמן העיבוד, שימוש במשאבים) מנוטרים ומותאמים בזמן אמת.                                   |  3  |  D/V  |

---

## C2.9 צינור אימות אבטחה מרובת-מדיות

מפתחים צריכים לספק אימות אבטחה עבור טקסט, תמונה, שמע ואמצעי קלט נוספים של בינה מלאכותית, עם זיהוי איומים מסוגים ספציפיים ובידוד משאבים.

|   #   | תיאור                                                                                                                                                                                | רמה | תפקיד |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :---: |
| 2.9.1 | ודא כי לכל צורת קלט קיימים אמצעי אימות אבטחה ייעודיים עם דפוסי איום מתועדים (טקסט: prompt injection, תמונות: steganography, קול: spectrogram attacks) ואערכי זיהוי.                  |  1  |  D/V  |
| 2.9.2 | ודא כי קלטים מרובי-מדיות מעובדים בסביבות מבודדות (סנדבוקס) עם גבולות משאבים מוגדרים (זיכרון, CPU, זמן עיבוד) המתאימים לכל סוג מדיה ומתועדים במדיניות האבטחה.                         |  2  |  D/V  |
| 2.9.3 | וודא שזיהוי מתקפות בין-מדיות מזהה מתקפות מתואמות המתפרשות על פני מספר סוגי קלט (למשל, מטענים סטגנוגרפיים בתמונות המשולבות עם הזרקת הנחיות בטקסט) באמצעות כללי קורלציה ויצירת התראות. |  2  |  D/V  |
| 2.9.4 | ודא שכישלונות אימות מרובי-מדיות מפעילים רישום מפורט הכולל את כל מדיות הקלט, תוצאות האימות, ציוני האיום ואת ניתוח הקורלציה בפורמטים מובנים של יומנים לשילוב ב-SIEM.                   |  3  |  D/V  |
| 2.9.5 | ודא שמסווגי תוכן המותאמים לכל מדיה מעודכנים בהתאם ללוחות הזמנים המתועדים (לפחות כל רבעון), עם דפוסי איום חדשים, דוגמאות תוקפניות, ועם מדדי ביצועים שמעל לספי הבסיס.                  |  3  |  D/V  |

---

## הפניות

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)


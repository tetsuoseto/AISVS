# C2 אימות קלט משתמש

## מטרת בקרה

אימות חזק של קלט המשתמש הוא קו ההגנה הראשון מפני כמה מהתקיפות ההרסניות ביותר על מערכות בינה מלאכותית. התקפות הזרקת פקודות יכולות לבטל הוראות מערכת, לדלוף מידע רגיש, או לכוון את המודל להתנהגות שלא מורשת. אלא אם קיימים סינונים ייעודיים והיררכיות הוראות, מחקר מראה ש"פריצות כלא מרובות יריות" שמשתמשות בחלונות הקשר ארוכים מאוד יהיו יעילות. בנוסף, התקפות הפרעה זדוניות דקיקות—כגון החלפות הומוגליפים או שפה בקוד—יכולות לשנות את החלטות המודל בשקט.

---

## C2.1 הגנה מפני הזרקת פקודות (Prompt Injection)

הזרקת פקודות היא אחת הסיכונים המובילים למערכות בינה מלאכותית. ההגנות נגד טקטיקה זו משתמשות בשילוב של מסנני תבניות סטטיים, מסווגים דינמיים ואכיפת היררכיה של הוראות.

|   #   | תיאור                                                                                                                                                                        | רמה | תפקיד |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.1.1 | וודא שקלטי המשתמש נבדקים מול ספרייה שמתעדכנת באופן רציף של דפוסי הזרקת פרומפט ידועים (מילות מפתח לפריצת מחסום, "התעלם מקודם", שרשראות משחק תפקידים, התקפות HTML/URL עקיפות). |  1  |  D/V  |
| 2.1.2 | אמת שהמערכת מאכפת היררכיית הוראות שבה הודעות מערכת או מפתח עוקפות הוראות משתמש, גם לאחר הרחבת חלון הקשר.                                                                     |  1  |  D/V  |
| 2.1.3 | ודא כי מבחני הערכה עוינת (למשל, הנחיות "many-shot" של צוות אדום) מתבצעים לפני כל שחרור של מודל או תבנית הנחיה, עם סף אחוזי הצלחה וחסימות אוטומטיות למניעת נסיגות.            |  2  |  D/V  |
| 2.1.4 | אמת שהפרומפטים שמקורם בתוכן צד שלישי (דפי אינטרנט, קבצי PDF, אימיילים) מנוקים בהקשר ניתוח מבודד לפני שהם מצורפים לפרומפט הראשי.                                              |  2  |   D   |
| 2.1.5 | אמת כי כל עדכוני כלל מסנן ההנחיות, גרסאות מודל הממיין ושינויים ברשימת החסימה נמצאים תחת בקרת גרסאות וניתנים לבדיקה.                                                          |  3  |  D/V  |

---

## C2.2 עמידות בפני דוגמאות עוינות

מודלים של עיבוד שפה טבעית (NLP) עדיין פגיעים לשינויים עדינים ברמת תווים או מילים שבני אדם לרוב מפספסים אך המודלים נוטים לסווג בצורה שגויה.

|   #   | תיאור                                                                                                                                               | רמה | תפקיד |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.2.1 | אמת כי שלבי נורמליזציה בסיסיים של קלט (Unicode NFC, מיפוי הומוגליפים, חיתוך רווחים) מתבצעים לפני הטוקניזציה.                                        |  1  |   D   |
| 2.2.2 | אמת שזיהוי חריגות סטטיסטיות מסמן קלט עם מרחק עריכה גבוה מן הנורמות השפתיות, חזרות מופרזות של טוקנים, או מרחקי הטמעה לא נורמליים.                    |  2  |  D/V  |
| 2.2.3 | אמת שצנרת ההסקה תומכת בגרסאות מודל מחוזקות באמצעות אימון יריב אופציונלי או בשכבות הגנה (למשל, רנדומיזציה, זיקוק הגנתי) עבור נקודות קצה בסיכון גבוה. |  2  |   D   |
| 2.2.4 | וודא כי קלטים חשודים כמתקפתיים מבודדים, מתועדים עם כל המטען (לאחר הסרת מידע אישי מזהה).                                                             |  2  |   V   |
| 2.2.5 | וודא שמדדי החוסן (שיעור ההצלחה של מערכי התקפה ידועים) מנוטרים לאורך זמן ושחזרות מפעילות חוסמות שחרור.                                               |  3  |  D/V  |

---

## C2.3 אימות סכימה, סוג ואורך

התקפות AI הכוללות קלטים מעוותים או גדולים מדי עלולות לגרום לשגיאות ניתוח, לדליפת פרומפטים בין שדות, ולבזבוז משאבים. אכיפת סכימה קפדנית היא גם תנאי מוקדם כאשר מבצעים קריאות כלים דטרמיניסטיות.

|   #   | תיאור                                                                                                                                                          | רמה | תפקיד |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.3.1 | וודא שכל נקודת קצה של קריאת API או פונקציה מגדירה סכימת קלט מפורשת (JSON Schema, Protobuf או מקבילה מולטימודאלית) ושהקלטים מאומתים לפני הרכבת הפקודה (prompt). |  1  |   D   |
| 2.3.2 | וודא שקלטים החורגים מהמגבלות המקסימליות של טוקנים או בתים נדחים עם שגיאה בטוחה ואינם מקוצרים בשקט.                                                             |  1  |  D/V  |
| 2.3.3 | וודא שדיקות סוג (כגון טווחים מספריים, ערכי enum, סוגי MIME לתמונות/אודיו) נאכפות בצד השרת, לא רק בקוד הלקוח.                                                   |  2  |  D/V  |
| 2.3.4 | אמת שהמאמתים הסמנטיים (למשל, JSON Schema) פועלים בזמן קבוע כדי למנוע התקפות DoS אלגוריתמיות.                                                                   |  2  |   D   |
| 2.3.5 | אמת שהכישלונות באימות מתועדים עם קטעי מטען מוסתרים וקודי שגיאה חד-משמעיים כדי לסייע במיון אבטחה.                                                               |  3  |   V   |

---

## C2.4 סינון תוכן ומדיניות

מפתחים צריכים להיות מסוגלים לזהות פקודות תקניות תחבירית שמבקשות תוכן אסור (כמו הוראות בלתי חוקיות, דברי שנאה וטקסטים המוגנים בזכויות יוצרים) ואז למנוע את הפצתם.

|   #   | תיאור                                                                                                                                          | רמה | תפקיד |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.4.1 | וודא שמסווג תוכן (אפס ירי או מותאם אישית) מעריך כל קלט לאלימות, לפגיעה עצמית, לשנאה, לתכנים מיניים ולבקשות בלתי חוקיות, עם ספים ניתנים להגדרה. |  1  |   D   |
| 2.4.2 | וודא שקלטים המפרים מדיניות יקבלו דחיות סטנדרטיות או השלמות בטוחות כדי שלא יועברו לקריאות LLM הבאות.                                            |  1  |  D/V  |
| 2.4.3 | אשרו כי מודל הסינון או ערכת הכללים מתעדכנים/מאומנים מחדש לפחות כל רבעון, תוך שילוב של דפוסי עקיפת מדיניות או פריצות Jailbreak שזוהו לאחרונה.   |  2  |   D   |
| 2.4.4 | לאמת שסינון מכבד מדיניות ספציפית למשתמש (גיל, הגבלות חוקיות אזוריות) באמצעות כללים מבוססי תכונות המתפתרים בזמן הבקשה.                          |  2  |   D   |
| 2.4.5 | וודא כי יומני הסינון כוללים ציוני ביטחון של הממיין ותוויות קטגוריית מדיניות לצורך קורלציה ב-SOC ולהפעלה חוזרת עתידית של צוות האדום.            |  3  |   V   |

---

## C2.5 הגבלת קצב קלט ומניעת ניצול לרעה

המפתחים צריכים למנוע שימוש לרעה, ת exhaustion המשאבים, ותקיפות אוטומטיות נגד מערכות AI על ידי הגבלת שיעורי קלט וזיהוי דפוסי שימוש חריגים.

|   #   | תיאור                                                                                              | רמה | תפקיד |
| :---: | -------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.5.1 | וודא כי מגבלות קצב per-user, per-IP, ו-per-API-key נאכפות עבור כל נקודות הקצה של הקלט.             |  1  |  D/V  |
| 2.5.2 | אשרו כי מגבלות הקצב הזמני והמתמשך מותאמות למניעת התקפות מניעת שירות (DoS) והתקפות כוח גס.          |  2  |  D/V  |
| 2.5.3 | וודא כי דפוסי שימוש חריגים (למשל, בקשות מהירות ברצף, הצפת קלט) מפעילים חסימות אוטומטיות או הסלמות. |  2  |  D/V  |
| 2.5.4 | אמת כי יומני מניעת התעללות נשמרים ונבדקים לדפוסי התקפה מתהווים.                                    |  3  |   V   |

---

## C2.6 אימות קלט רב-מודאלי

מערכות בינה מלאכותית צריכות לכלול אימות חזק לקלטים שאינם טקסטואליים (תמונות, שמע, קבצים) כדי למנוע הזרקה, התחמקות או ניצול משאבים.

|   #   | תיאור                                                                                       | רמה | תפקיד |
| :---: | ------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.6.1 | וודא שכל הקלטים שאינם טקסט (תמונות, שמע, קבצים) נבדקים לאימות סוג, גודל, ופורמט לפני עיבוד. |  1  |   D   |
| 2.6.2 | וודא שקבצים סרוקים לאיתור תוכנות זדוניות ונושאי סטגנוגרפיה לפני הזנתם.                      |  2  |  D/V  |
| 2.6.3 | אמת כי קלטי תמונה/אודיו נבדקים לשינויים עוינים או תבניות התקפה מוכרות.                      |  2  |  D/V  |
| 2.6.4 | אמת כי כישלונות באימות כניסות רב-מודליות מתועדים ומפעילים התראות לבדיקת מצב.                |  3  |   V   |

---

## C2.7 מקור וקישור של קלט

מערכות בינה מלאכותית צריכות לתמוך בביקורת, מעקב אחרי שימוש לרעה, וציות על ידי מעקב ותיוג מקורות כל הקלטים של המשתמשים.

|   #   | תיאור                                                                                              | רמה | תפקיד |
| :---: | -------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.7.1 | וודא שכל קלטי המשתמש מתויגים עם מטה-דאטה (מזהה משתמש, מושב, מקור, חותמת זמן, כתובת IP) בעת הקליטה. |  1  |  D/V  |
| 2.7.2 | אשר כי מטאנתוני המקור נשמרים וניתנים לבדיקה עבור כל הקלטים המעובדים.                               |  2  |  D/V  |
| 2.7.3 | ודא כי מקורות קלט חריגים או לא מהימנים מסומנים ונמצאים תחת בדיקה מוגברת או חסימה.                  |  2  |  D/V  |

---

## C2.8 זיהוי איומים אדפטיבי בזמן אמת

מפתחים צריכים להשתמש במערכות מתקדמות לגילוי איומים עבור AI אשר מותאמות לדפוסי התקפה חדשים ומספקות הגנה בזמן אמת באמצעות תאימות לדפוסי התנהגות קומפילציים.

|   #   | תיאור                                                                                                                                      | רמה | תפקיד |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------ | :-: | :---: |
| 2.8.1 | אמת שדפוסי זיהוי האיומים מורכבים למנועי ביטוי רגולרי (regex) מותאמים לביצועים גבוהים לסינון בזמן אמת עם השפעה מינימלית על זמן ההמתנה.      |  1  |  D/V  |
| 2.8.2 | אמת כי מערכות זיהוי איומים שומרות ספריות דפוסים נפרדות לקטגוריות איומים שונות (הזרקת פקודות, תוכן מזיק, נתונים רגישים, פקודות מערכת).      |  1  |  D/V  |
| 2.8.3 | אמת כי גילוי איומים אדפטיבי כולל מודלים של למידת מכונה המעודכנים ברגישות לאיום בהתבסס על תדירות ההתקפות ושיעורי ההצלחה.                    |  2  |  D/V  |
| 2.8.4 | אשר שהזנות מודיעין איומים בזמן אמת מעדכנות באופן אוטומטי את ספריות התבניות עם חתימות התקפה חדשות ו-IOC (מדדי חדירה).                       |  2  |  D/V  |
| 2.8.5 | וודא ששיעורי זיהוי שגוי של איומים מפוקחים באופן מתמשך ושהתאמת הייחודיות של הדפוסים מתבצעת אוטומטית כדי למזער הפרעה למקרים חוקיים של שימוש. |  3  |  D/V  |
| 2.8.6 | אמת כי ניתוח איומים קונטקסטואלי מתחשב במקור הקלט, דפוסי התנהגות המשתמש, והיסטוריית הסשן כדי לשפר את דיוק הגילוי.                           |  3  |  D/V  |
| 2.8.7 | אשרו כי מדדי ביצועי זיהוי האיומים (שיעור זיהוי, זמן עיבוד, ניצול משאבים) מנוטרים ומאופטמים בזמן אמת.                                       |  3  |  D/V  |

---

## C2.9 תהליך אימות אבטחה רב-מדי

המפתחים צריכים לספק אימות אבטחה עבור טקסט, תמונה, אודיו ומודאליות קלט נוספות של בינה מלאכותית עם סוגים ספציפיים של זיהוי איומים ובידוד משאבים.

|   #   | תיאור                                                                                                                                                                                    | רמה | תפקיד |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 2.9.1 | אמת שכל מודל קלט כולל וולידטורים אבטחה ייעודיים עם תבניות איומים מתועדות (טקסט: הזרקת פרומפט, תמונות: סטגנווגרפיה, אודיו: התקפות ספקטרוגרמה) וספי גילוי.                                 |  1  |  D/V  |
| 2.9.2 | אמתו כי קלטים מולטי-מודליים מעובדים בכלובים מבודדים עם גבולות משאבים מוגדרים (זיכרון, CPU, זמן עיבוד) הספציפיים לכל סוג מודלול ותועדו במדיניות האבטחה.                                   |  2  |  D/V  |
| 2.9.3 | אמת כי זיהוי התקפות חוצות-מודלים מזהה התקפות מתואמות המשתרעות על פני סוגי קלט מרובים (למשל, מטענים סטגנוגרפיים בתמונות בשילוב עם הזרקת פקודות בטקסט) באמצעות כללי קורלציה ויצירת התרעות. |  2  |  D/V  |
| 2.9.4 | אמת שכשלים באימות רב-מודלי מפעילים רישום מפורט הכולל את כל המודאליות הקלט, תוצאות האימות, ציוני האיום, וניתוח מתאם עם פורמטים מובנים של יומנים לשילוב עם SIEM.                           |  3  |  D/V  |
| 2.9.5 | אמת כי מסווגי תוכן ייחודיים למודאליות מתעדכנים בהתאם ללוחות זמנים מתועדים (מינימום רבעוני) עם דפוסי איומים חדשים, דוגמאות עוינות, ושהמדדים לביצועים נשמרים מעל ספי הבסיס.                |  3  |  D/V  |

---

## ביבליוגרפיה

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)


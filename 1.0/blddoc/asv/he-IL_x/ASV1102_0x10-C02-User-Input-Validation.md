# אימות קלט משתמש ב-C2

## מטרת הבקרה

אימות חזק של קלט המשתמש הוא הגנה ראשונית מפני חלק מהתקפות המזיקות ביותר על מערכות בינה מלאכותית. התקפות הזרקת פקודות יכולות לעקוף הוראות מערכת, לדלוף מידע רגיש או להכווין את המודל להתנהגות שאינה מורשית. אלא אם ישנם מסננים ייעודיים והיררכיות הוראות במקום, מחקרים מראים כי "פריצות" הרב-פעולה הניצלות חלונות הקשר ארוכים מאוד יהיו יעילות. כמו כן, התקפות זעירות ומדויקות מסוג הפרעה עוינת—כגון החלפות הומוגליפים או ליטספיק—יכולות לשנות בשקט את ההחלטות של המודל.

---

## C2.1 הגנה מפני הזרקת פקודות

הזרקת פרומפט היא אחד הסיכונים המרכזיים עבור מערכות בינה מלאכותית. ההגנות נגד טקטיקה זו משתמשות בשילוב של מסנני תבניות סטטיים, מסווגים דינמיים ואכיפת היררכיית הוראות.

|   #   | תיאור                                                                                                                                                                             | רָמָה | תפקיד |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :---: |
| 2.1.1 | אמתו שקלטי המשתמשים מסוננים מול ספרייה שמתעדכנת ברציפות של דפוסי הזרקת פרומפט ידועים (מילות מפתח של פריצת מערכת, "התעלם מהקודם", שרשראות משחק תפקידים, התקפות עקיפות ב-HTML/URL). |   1   |  D/V  |
| 2.1.2 | אמת שהמערכת אוכפת היררכיית הוראות שבה הודעות מערכת או מפתח גוברות על הוראות משתמש, גם לאחר הרחבת חלון ההקשר.                                                                      |   1   |  D/V  |
| 2.1.3 | אמתו כי בדיקות הערכה עוינת (למשל, הנחיות "many-shot" של צוות אדום) מתבצעות לפני כל שחרור של מודל או תבנית הנחיה, עם ספים להערכת שיעור ההצלחה וחסמים אוטומטיים למניעת רגרסיות.     |   2   |  D/V  |
| 2.1.4 | אמתו כי הפקודות הנכנסות מתוכן צד שלישי (דפי אינטרנט, קבצי PDF, אימיילים) מתוקנות בהקשר ניתוח מבודד לפני שמצורפות לפקודה הראשית.                                                   |   2   |   D   |
| 2.1.5 | וודא שכל העדכונים לכללי סינון הפרומפט, גרסאות מודל הסיווג ושינויים ברשימת החסימה נמצאים תחת בקרת גרסאות וניתנים לבדיקה.                                                           |   3   |  D/V  |

---

## C2.2 עמידות בפני דוגמאות עוינות

מודלים של עיבוד שפה טבעית (NLP) עדיין פגיעים להפרעות עדינות ברמת תווים או מילים שבני אדם מתעלמים מהן לעיתים קרובות, אך מודלים נוטים לסווג אותן בצורה שגויה.

|   #   | תיאור                                                                                                                                             | רָמָה | תפקיד |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :---: |
| 2.2.1 | אשר כי שלבי נירמול קלט בסיסיים (Unicode NFC, מיפוי הומוגליפים, חיתוך רווחים) מתבצעים לפני הטוקניזציה.                                             |   1   |   D   |
| 2.2.2 | אמת כי זיהוי חריגות סטטיסטי מסמן קלטים עם מרחק עריכה חריג לגבוה לנורמות שפה, חזרות מיותרות של טוקנים, או מרחקי הטמעה חריגים.                      |   2   |  D/V  |
| 2.2.3 | אמת שהמפעל הסקת המסקנות תומך בגרסאות מודל מחוסנות לאימוני נגד אופציונליים או בשכבות הגנה (למשל, רנדומיזציה, זיקוק הגנתי) לנקודות קצה בסיכון גבוה. |   2   |   D   |
| 2.2.4 | אמת כי קלטים חשודים כנגד מתקפות מבודדים, מתועדים עם המטען המלא (לאחר הסרת מידע מזהה אישי).                                                        |   2   |   V   |
| 2.2.5 | וודא כי מדדי חוסן (שיעור הצלחה של חבילות התקפה ידועות) נרשמים לאורך זמן ושהתדרדרויות גורמות לחסימת שחרור.                                         |   3   |  D/V  |

---

## C2.3 אימות סכימה, סוג ואורך

התקפות AI הכוללות קלטים פגומים או גדולים מדי עלולות לגרום לשגיאות ניתוח, לדליפת פרומפטים בין שדות ולת exhaustion משאבים. אכיפה קפדנית של סכימה היא גם דרישה מוקדמת בעת ביצוע קריאות כלי דטרמיניסטיות.

|   #   | תיאור                                                                                                                                               | רָמָה | תפקיד |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :---: |
| 2.3.1 | וודא שכל נקודת סיום של API או קריאת פונקציה מגדירה סכמת קלט מפורשת (JSON Schema, Protobuf או מקביל מולטימודלי) ושהקלטים מאומתים לפני הרכבת הפרומפט. |   1   |   D   |
| 2.3.2 | אמתו כי קלטים שמעבר למגבלות המרביות של תווים או בתים נדחים עם שגיאה בטוחה ואינם מקוצרים בשקט.                                                       |   1   |  D/V  |
| 2.3.3 | וודא כי בדיקות טיפוס (לדוגמה, טווחים מספריים, ערכי enum, סוגי MIME לתמונות/אודיו) מיושמות בצד השרת, ולא רק בקוד הלקוח.                              |   2   |  D/V  |
| 2.3.4 | אמת שהמאמתים הסמנטיים (למשל, JSON Schema) פועלים בזמן קבוע למניעת DoS אלגוריתמי.                                                                    |   2   |   D   |
| 2.3.5 | אמת כי כשלי אימות מתועד עם קטעי מטען מוסתרים וקודי שגיאה חד-משמעיים כדי לסייע במיון אבטחה.                                                          |   3   |   V   |

---

## C2.4 סינון תוכן ומדיניות

מפתחים צריכים להיות מסוגלים לזהות פקודות תקינות תחבירית שמבקשות תוכן שאינו מורשה (כגון הוראות אסורות, דיבור שנאה, וטקסט המוגן בזכויות יוצרים) ולמנוע את הפצתן.

|   #   | תיאור                                                                                                                                        | רָמָה | תפקיד |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :---: |
| 2.4.1 | וודא שמסווג תוכן (אפס ירי או מכוונן) מדרג כל קלט עבור אלימות, פגיעה עצמית, שנאה, תוכן מיני ובקשות בלתי חוקיות, עם ספי דירוג הניתנים לכוונון. |   1   |   D   |
| 2.4.2 | אמת כי קלטים המפרים מדיניות יקבלו דחיות סטנדרטיות או השלמות בטוחות כדי שלא יועברו לקריאות LLM הבאות.                                         |   1   |  D/V  |
| 2.4.3 | אמתו שמודל הסינון או מערך הכללים מתעדכן/מאומן מחדש לפחות אחת לרבעון, תוך שילוב של דפוסי עקיפת מדיניות או פריצות מערכת חדשים שנצפו.           |   2   |   D   |
| 2.4.4 | אמת כי הסינון מכבד מדיניות ספציפית למשתמש (גיל, מגבלות חוקיות אזוריות) באמצעות כללים מבוססי תכונות הנפתרים בזמן הבקשה.                       |   2   |   D   |
| 2.4.5 | ודא כי יומני הסינון כוללים דירוגי ביטחון של הסווג ומדבקות קטגוריית מדיניות להתאמת SOC ולניגון חוזר עתידי של צוות האדום.                      |   3   |   V   |

---

## C2.5 הגבלת קצב קלט ומניעת שימוש לרעה

מפתחים צריכים למנוע שימוש לרעה, התשה של משאבים, והתקפות אוטומטיות נגד מערכות AI על ידי הגבלת קצב הקלט וזיהוי דפוסי שימוש חריגים.

|   #   | תיאור                                                                                               | רָמָה | תפקיד |
| :---: | --------------------------------------------------------------------------------------------------- | :---: | :---: |
| 2.5.1 | וודא כי מגבלות קצב לפי משתמש, לפי כתובת IP, ולפי מפתח API נאכפות עבור כל נקודות הקצה של הקלט.       |   1   |  D/V  |
| 2.5.2 | אמת כי מגבלות הקצב הזמני והקצב המתמשך מכוונות כדי למנוע התקפות מניעת שירות (DoS) והתקפות כוח גס.    |   2   |  D/V  |
| 2.5.3 | אמת כי דפוסי שימוש חריגים (למשל, בקשות במהירות גבוהה, הצפת קלט) מפעילים חסימות אוטומטיות או הסלמות. |   2   |  D/V  |
| 2.5.4 | וודא כי יומני מניעת ניצול לרעה נשמרים וניתנים לסקירה עבור דפוסי מתקפה מתהווים.                      |   3   |   V   |

---

## C2.6 אימות קלט רב-מודאלי

מערכות AI צריכות לכלול אימות חזק עבור קלטים לא טקסטואליים (תמונות, אודיו, קבצים) למניעת הזרקה, התחמקות או ניצול משאבים.

|   #   | תיאור                                                                                          | רָמָה | תפקיד |
| :---: | ---------------------------------------------------------------------------------------------- | :---: | :---: |
| 2.6.1 | וודא שכל הקלטים שאינם טקסט (תמונות, אודיו, קבצים) מאומתים מבחינת סוג, גודל ופורמט לפני העיבוד. |   1   |   D   |
| 2.6.2 | וודא שקבצים נסרקים לאיתור תוכנות זדוניות ועומסי סטגנו גרפיה לפני הכנסתן למערכת.                |   2   |  D/V  |
| 2.6.3 | אמת שהקלטים של תמונה/אודיו נבדקים להפרעות עוינות או לדפוסי התקפה ידועים.                       |   2   |  D/V  |
| 2.6.4 | אשר כי כשלים באימות קלט רב-מודאלי מתועדים ומפעילים התרעות לצורך חקירה.                         |   3   |   V   |

---

## C2.7 מקור קלט וייחוס

מערכות AI צריכות לתמוך בביקורת, במעקב אחר שימוש לרעה ובהתאמה לרגולציה על ידי ניטור וסימון מקורות כל הקלטים של המשתמש.

|   #   | תיאור                                                                                              | רָמָה | תפקיד |
| :---: | -------------------------------------------------------------------------------------------------- | :---: | :---: |
| 2.7.1 | וודא שכל קלטי המשתמש מתוייגים עם מטא-דאטה (מזהה משתמש, סשן, מקור, חותמת זמן, כתובת IP) בעת הקליטה. |   1   |  D/V  |
| 2.7.2 | אמתו כי מטא-נתוני המקור נשמרים וניתנים לבדיקה עבור כל הקלטים המעובדים.                             |   2   |  D/V  |
| 2.7.3 | לאמת כי מקורות קלט חריגים או לא מהימנים מסומנים ומועמדים לבחינה מוגברת או לחסימה.                  |   2   |  D/V  |

---

## C2.8 זיהוי איומים אדפטיבי בזמן אמת

מפתחים צריכים להשתמש במערכות מתקדמות לזיהוי איומים עבור AI שמתאימות עצמם לתבניות התקפה חדשות ומספקות הגנה בזמן אמת באמצעות התאמת תבניות מקובצות.

|   #   | תיאור                                                                                                                                        | רָמָה | תפקיד |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :---: |
| 2.8.1 | ודא שתבניות זיהוי האיומים מקומפלות למנועי regex מותאמים לביצועים גבוהים לסינון בזמן אמת עם השפעה מזערית על השהייה.                           |   1   |  D/V  |
| 2.8.2 | אשר כי מערכות זיהוי איומים שומרות על ספריות דפוסים נפרדות עבור קטגוריות איומים שונות (הזרקת פקודות, תוכן מזיק, נתונים רגישים, פקודות מערכת). |   1   |  D/V  |
| 2.8.3 | אמת שזיהוי איומים אדפטיבי כולל מודלים של למידת מכונה שמעדכנים את רגישות האיום בהתבסס על תדירות ההתקפות ושיעורי ההצלחה.                       |   2   |  D/V  |
| 2.8.4 | וודא כי זני מודיעין איומים בזמן אמת מעדכנים אוטומטית ספריות דפוסים עם חתימות התקפה חדשות ו-IOC (אינדיקטורים להפרה).                          |   2   |  D/V  |
| 2.8.5 | אשרו כי שיעורי זיהוי איומים שגויים (False Positive) מנוטרים באופן רציף, ושתכונת הדפוס מותאמת אוטומטית במטרה למזער הפרעה לשימושים לגיטימיים.  |   3   |  D/V  |
| 2.8.6 | וודא שניתוח איומים הקשרי מתחשב במקור הקלט, דפוסי התנהגות המשתמש והיסטוריית המפגש כדי לשפר את דיוק הזיהוי.                                    |   3   |  D/V  |
| 2.8.7 | וודא שמדדי ביצוע לזיהוי איומים (שיעור זיהוי, השהיית עיבוד, ניצול משאבים) מפוקחים ומאופטימליים בזמן אמת.                                      |   3   |  D/V  |

---

## C2.9 צינור אימות אבטחה מולטי-מודלי

מפתחים צריכים לספק אימות אבטחה עבור טקסט, תמונה, שמע ומודאליות קלט אחרות של AI עם סיווג ספציפי של זיהוי איומים ובידוד משאבים.

|   #   | תיאור                                                                                                                                                                                                     | רָמָה | תפקיד |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :---: |
| 2.9.1 | אמת שכל מצב קלט כולל מאמתים ייעודיים לאבטחה עם תבניות איומים מתועדות (טקסט: הזרקת פרומפט, תמונות: סטגנווגרפיה, אודיו: התקפות ספקטרוגרם) וספי גילוי.                                                       |   1   |  D/V  |
| 2.9.2 | אמת כי קלטים מולטי-מודאליים מעובדים בסנדבוקסים מבודדים עם הגבלות משאבים מוגדרות (זיכרון, CPU, זמן עיבוד) הספציפיות לכל סוג מודאליות ומתועדות במדיניות אבטחה.                                              |   2   |  D/V  |
| 2.9.3 | לאמת שזיהוי התקפות חוצות-ממשק (cross-modal attack detection) מזהה התקפות מתואמות החוצות מספר סוגי קלט (למשל, מטענים סטגנוגרפיים בתמונות המשולבים בהזרקת פקודות בטקסט) באמצעות חוקי קורלציה ויצירת התראות. |   2   |  D/V  |
| 2.9.4 | אמת שכשלים באימות מרובה-מודלים מפעילים רישום מפורט כולל את כל המודאליות של הקלט, תוצאות האימות, ניקוד האיומים, וניתוח ההתאמה עם פורמטים מובנים של יומן לרמת שילוב ב-SIEM.                                 |   3   |  D/V  |
| 2.9.5 | ודא כי מסנני תוכן ספציפיים לכל מודל מועדים מתעדכנים בהתאם ללוחות הזמנים המתועדים (לפחות רבעוני) עם דפוסי איום חדשים, דוגמאות עוינות ומדדי ביצועים הנשמרים מעל סף הבסיס.                                   |   3   |  D/V  |

---

## ביבליוגרפיה

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)


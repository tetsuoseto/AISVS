# C6 אבטחת שרשרת אספקה עבור מודלים, מסגרות ונתונים

## מטרת בקרה

התקפות על שרשרת האספקה של בינה מלאכותית מנצלות מודלים, מסגרות או מערכי נתונים של צד שלישי כדי להשתיל דלתות אחוריות, הטיות או קוד שניתן לניצול. בקרות אלה מספקות מעקב מקצה לקצה, ניהול פגיעויות, ומעקב להגנה על כל מחזור החיים של המודל.

---

## C6.1 בדיקת דגם מאומן מראש ומקורותיו

העריך ואמת את מקורות הדגמים של צד שלישי, הרישיונות שלהם, וההתנהגויות הנסתרות לפני כל כוונון עדין או פריסה.

|   #   | תיאור                                                                                                       | רמה | תפקיד |
| :---: | ----------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 6.1.1 | אמת שכל ארטיפקט של מודל צד שלישי כולל רשומת מוצא חתומה המזהה את מאגר המקור ואת הקוד המתחייב.                |  1  |  D/V  |
| 6.1.2 | וודא כי המודלים נסרקים לשכבות זדוניות או טריגרים של טרויאניים באמצעות כלים אוטומטיים לפני הייבוא.           |  1  |  D/V  |
| 6.1.3 | אמתו כי למידת-העברה מתאימה מחדש מתמודדת עם הערכת עוינות כדי לאתר התנהגויות נסתרות.                          |  2  |   D   |
| 6.1.4 | וודא שרשיונות המודל, תגיות בקרת הייצוא, והצהרות מקור הנתונים נרשמים ברשומת ML‑BOM.                          |  2  |   V   |
| 6.1.5 | אשר שמודלים בסיכון גבוה (משקלים שהועלו בפומבי, יוצרים שלא אושרו) נשארים בבידוד עד לסקירה ואישור על ידי אדם. |  3  |  D/V  |

---

## סריקת מסגרת וספרייה C6.2

סרוק ברציפות מסגרות ספריות ו-Machine Learning עבור CVEs וקוד זדוני כדי לשמור על אבטחת ערימת ההפעלה.

|   #   | תיאור                                                                                       | רמה | תפקיד |
| :---: | ------------------------------------------------------------------------------------------- | :-: | :---: |
| 6.2.1 | לאמת שצינורות ה-CI מפעילים סורקי תלות על מסגרות AI וספריות קריטיות.                         |  1  |  D/V  |
| 6.2.2 | אמת כי פגיעויות קריטיות (CVSS ≥ 7.0) חוסמות קידום לתמונות הפקה.                             |  1  |  D/V  |
| 6.2.3 | אמת כי ניתוח קוד סטטי מתבצע על ספריות ML משוכפלות או ממומנות.                               |  2  |   D   |
| 6.2.4 | אמתו שהצעות לשדרוג המסגרת כוללות הערכת השפעה על אבטחה המתייחסת למקורות ציבוריים של CVE.     |  2  |   V   |
| 6.2.5 | אמת כי חיישני זמן ריצה מתריעים על טעינות ספריות דינמיות בלתי צפויות שמחרגות מה- SBOM החתום. |  3  |   V   |

---

## C6.3 נעילת תלות ואימות

נעץ כל תלות לתמציות בלתי משתנות ושחזר בניות כדי להבטיח ארטיפקטים זהים וללא זדון.

|   #   | תיאור                                                                                        | רמה | תפקיד |
| :---: | -------------------------------------------------------------------------------------------- | :-: | :---: |
| 6.3.1 | אמת שכל מנהלי החבילות שמים במקומם נעילת גרסאות באמצעות קבצי נעילה.                           |  1  |  D/V  |
| 6.3.2 | אמת כי נעשה שימוש בעיכוליים בלתי-משתנים במקום בתגיות משתנות בהתייחסויות מכולות.              |  1  |  D/V  |
| 6.3.3 | אמת שהבדיקות של בנייה חוזרת משוות ערכי חשיש (hashes) בין הרצות של CI כדי להבטיח תוצאות זהות. |  2  |   D   |
| 6.3.4 | אשרו כי אישורי הבנייה נשמרים במשך 18 חודשים לצורך מעקב ביקורת.                               |  2  |   V   |
| 6.3.5 | אשר שמודולים שפג תוקפם מפעילים בקשות משיכה (PRs) אוטומטיות לעדכון או לפיצול גרסאות נעולות.   |  3  |   D   |

---

## C6.4 אכיפת מקור מהימן

אפשר הורדות של ארטיפקטים רק ממקורות מאושרים על‑ידי הארגון ומאומתים קריפטוגרפית וחסום כל השאר.

|   #   | תיאור                                                                                       | רמה | תפקיד |
| :---: | ------------------------------------------------------------------------------------------- | :-: | :---: |
| 6.4.1 | אמת שמשקלי המודל, מערכי הנתונים והמכולות מורידים אך ורק מתחומים מאושרים או מרשומות פנימיות. |  1  |  D/V  |
| 6.4.2 | לאמת כי חתימות Sigstore/Cosign מאשרות את זהות המפרסם לפני שהארטיפקטים נשמרים במטמון מקומי.  |  1  |  D/V  |
| 6.4.3 | אשר כי פרוקסי יציאה חוסמים הורדות של ארטיפקטים לא מאומתים כדי לאכוף את מדיניות המקור האמין. |  2  |   D   |
| 6.4.4 | אשר כי רשימות ההרשאה של מאגרי הקוד נבדקות רבעונית עם הוכחה להצדקה עסקית עבור כל פריט.       |  2  |   V   |
| 6.4.5 | אמת כי הפרת מדיניות מפעילה הסגר של ארטיפקטים והחזרת ריצות פייפליין תלויות למצב קודם.        |  3  |   V   |

---

## C6.5 הערכת סיכון של מערכי נתונים מצד שלישי

העריך מערכות נתונים חיצוניות לזיהוי הרעלת נתונים, הטיה ועמידה בדרישות חוקיות, ופעל למעקב אחריהם לאורך כל מחזור החיים שלהם.

|   #   | תיאור                                                                                               | רמה | תפקיד |
| :---: | --------------------------------------------------------------------------------------------------- | :-: | :---: |
| 6.5.1 | וודא כי מערכי נתונים חיצוניים עוברים דירוג סיכון לרעלול (למשל, טביעת אצבע של נתונים, זיהוי חריגים). |  1  |  D/V  |
| 6.5.2 | אמת כי מדדי הטיה (שוויון דמוגרפי, הזדמנות שווה) מחושבים לפני אישור מערך הנתונים.                    |  1  |   D   |
| 6.5.3 | אמתו כי מידע על הפרובננס ותנאי הרישיון של מערכי הנתונים נרשמים ברשומות ML‑BOM.                      |  2  |   V   |
| 6.5.4 | אשר כי ניטור תקופתי מזהה סטייה או שיבוש במאגרי הנתונים המתארחים.                                    |  2  |   V   |
| 6.5.5 | אמת כי תוכן אסור (זכויות יוצרים, מידע אישי מזהה) מוסר באמצעות סינון אוטומטי לפני האימון.            |  3  |   D   |

---

## C6.6 ניטור התקפות על שרשרת האספקה

לזהות איומי שרשרת אספקה בשלב מוקדם באמצעות זרמי CVE, ניתוח יומני ביקורת וסימולציות של צוות אדום.

|   #   | תיאור                                                                                                               | רמה | תפקיד |
| :---: | ------------------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 6.6.1 | אמת כי יומני ביקורת של CI/CD משודרים לזיהוי SIEM עבור משיכות חבילות חריגות או שלבי בנייה ששונו.                     |  1  |   V   |
| 6.6.2 | אמתו כי ספרי הפעולה להתמודדות עם תקריות כוללים נהלים להחזרה לאחור עבור מודלים או ספריות נפגעות.                     |  2  |   D   |
| 6.6.3 | אמת שתגי העשרה של מודיעין איומים מסמנים אינדיקטורים ספציפיים ללמידת מכונה (למשל, IoCs של רעילות מודל) במיון התראות. |  3  |   V   |

---

## C6.7 רשימת חומרים למכונות למידה (ML‑BOM) עבור ארטיפקטים של מודל

ייצרו וחתמו על SBOMs מפורטים המיועדים ספציפית ללמידת מכונה (ML-BOMs) כדי שהמשתמשים במורד הזרם יוכלו לאמת את שלמות הרכיבים בזמן הפריסה.

|   #   | תיאור                                                                                                   | רמה | תפקיד |
| :---: | ------------------------------------------------------------------------------------------------------- | :-: | :---: |
| 6.7.1 | וודא שכל ארטיפקט של מודל מפרסם ML-BOM שמפרט מערכי נתונים, משקולות, היפרפרמטרים ורישיונות.               |  1  |  D/V  |
| 6.7.2 | וודא שיצירת ML-BOM וחתימת Cosign מאוטומטיות ב-CI והן דרושות למיזוג.                                     |  1  |  D/V  |
| 6.7.3 | אמת שהבדיקות של ML‑BOM למלואות נכשלות בבנייה אם חסרים מטא-נתונים של רכיבים (קוד גישה, רישיון).          |  2  |   D   |
| 6.7.4 | לאמת שמשתמשים בתחתית הזרם יכולים לשאול ML-BOMs דרך API כדי לאמת דגמים מיובאים בזמן פריסה.               |  2  |   V   |
| 6.7.5 | ודא שרשימות החומרה של למידת מכונה (ML-BOMs) נמצאות תחת בקרת גרסאות ומושוות כדי לזהות שינויים לא מורשים. |  3  |   V   |

---

## ביבליוגרפיה

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)


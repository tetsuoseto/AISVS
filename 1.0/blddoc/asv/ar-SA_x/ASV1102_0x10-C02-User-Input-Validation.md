# التحقق من صحة إدخال المستخدم في C2

## هدف التحكم

التحقق الدقيق من مدخلات المستخدم هو خط الدفاع الأول ضد بعض الهجمات الأكثر ضررًا على أنظمة الذكاء الاصطناعي. يمكن لهجمات حقن التعليمات تجاوز تعليمات النظام، وتسريب البيانات الحساسة، أو توجيه النموذج نحو سلوك غير مسموح به. ما لم تكن هناك فلاتر مخصصة وتسلسلات تعليمات منظمة، تُظهر الأبحاث أن عمليات كسر الحماية "متعددة اللقطات" التي تستغل نوافذ السياق الطويلة جدًا ستكون فعالة. كما أن الهجمات الطفيفة التميتية العدائية—مثل استبدال الحروف المتشابهة بصريًا أو الكتابة باستخدام رموز لييت—يمكن أن تغير قرارات النموذج بصمت.

---

## C2.1 الدفاع ضد حقن الأوامر

حقن التوجيه هو أحد أكبر المخاطر التي تواجه أنظمة الذكاء الاصطناعي. تستخدم الدفاعات ضد هذه التكتيك مزيجًا من مرشحات الأنماط الثابتة، والمصنفات الديناميكية، وإنفاذ تسلسل التعليمات.

|   #   | الوصف                                                                                                                                                                                                   | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.1.1 | تأكد من أن مدخلات المستخدم تتم فحصها مقابل مكتبة محدثة باستمرار لأنماط حقن التعليمات المعروفة (الكلمات المفتاحية لكسر الحماية، "تجاهل السابق"، سلاسل تمثيل الأدوار، الهجمات غير المباشرة على HTML/URL). |    1    |  D/V  |
| 2.1.2 | تحقق من أن النظام يفرض تسلسلًا هرميًا للتعليمات حيث تتجاوز رسائل النظام أو المطور تعليمات المستخدم، حتى بعد توسيع نافذة السياق.                                                                         |    1    |  D/V  |
| 2.1.3 | تحقق من أن اختبارات التقييم العدائية (مثل طلبات "العديد من المحاولات" لفريق الاختراق) تُجرى قبل إصدار كل نموذج أو قالب طلب، مع تحديد حدود لمعدلات النجاح ومنع تلقائي للتراجعات.                         |    2    |  D/V  |
| 2.1.4 | تحقق من أن المطالبات التي تنشأ من محتوى جهات خارجية (صفحات الويب، ملفات PDF، البريد الإلكتروني) يتم تنقيتها في سياق تحليل معزول قبل دمجها في المطلب الرئيسي.                                            |    2    |   D   |
| 2.1.5 | تحقق من أن جميع تحديثات قواعد تصفية الطلبات، وإصدارات نماذج المصنف، وتغييرات قائمة الحظر تحت تحكم بالإصدارات وقابلة للتدقيق.                                                                            |    3    |  D/V  |

---

## C2.2 مقاومة الأمثلة العدائية

نماذج معالجة اللغة الطبيعية (NLP) لا تزال عرضة للتشويشات الدقيقة على مستوى الأحرف أو الكلمات التي يغفلها البشر غالبًا، ولكن تميل النماذج إلى تصنيفها بشكل خاطئ.

|   #   | الوصف                                                                                                                                                                          | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 2.2.1 | تحقق من أن خطوات تطبيع الإدخال الأساسية (Unicode NFC، تخطيط الرموز المتشابهة بصريًا، تقليم الفراغات) تتم قبل عملية التجزئة.                                                    |    1    |   D   |
| 2.2.2 | تحقق من أن الكشف عن الشذوذ الإحصائي يشير إلى المدخلات التي تحتوي على مسافة تحرير غير عادية عالية مقارنة بمعايير اللغة، أو تكرارات زائدة في الرموز، أو مسافات تضمين غير طبيعية. |    2    |  D/V  |
| 2.2.3 | تحقق من أن خط استدلال النموذج يدعم نسخ النماذج المحصنة بالتدريب العدائي الاختياري أو طبقات الدفاع (مثل العشوائية، التقطير الدفاعي) للنقاط النهائية عالية الخطورة.              |    2    |   D   |
| 2.2.4 | تحقق من عزل المدخلات المشبوهة المعادية في الحجر الصحي، وتسجيلها مع الحمولة الكاملة (بعد إزالة المعلومات الشخصية الحساسة).                                                      |    2    |   V   |
| 2.2.5 | تحقق من أن مقاييس المتانة (معدل نجاح مجموعات الهجمات المعروفة) تُتابع على مر الزمن وأن التراجعات تُسبب توقف الإصدار.                                                           |    3    |  D/V  |

---

## C2.3 التحقق من المخطط والنوع والطول

يمكن لهجمات الذكاء الاصطناعي التي تتضمن مدخلات مشوهة أو ضخمة الحجم أن تسبب أخطاء في التحليل، وانسكاب الأوامر عبر الحقول، واستنفاد الموارد. كما أن تطبيق التحقق الصارم من المخطط ضروري عند إجراء استدعاءات الأدوات الحتمية.

|   #   | الوصف                                                                                                                                                                      | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.3.1 | تحقق من أن كل نقطة نهاية لاستدعاء API أو دالة تحدد مخطط إدخال صريح (مخطط JSON، أو Protobuf، أو ما يعادله متعدد الوضعيات) وأنه يتم التحقق من صحة الإدخالات قبل تجميع الطلب. |    1    |   D   |
| 2.3.2 | تأكد من رفض المدخلات التي تتجاوز الحد الأقصى لعدد الرموز أو البايتات برسالة خطأ آمنة وعدم اقتطاعها بصمت أبدًا.                                                             |    1    |  D/V  |
| 2.3.3 | تحقق من أن عمليات التحقق من النوع (مثل النطاقات الرقمية، وقيم التعداد، وأنواع MIME للصور/الصوت) تُفرض على جانب الخادم، وليس فقط في شفرة العميل.                            |    2    |  D/V  |
| 2.3.4 | تحقق من أن المدققات الدلالية (مثل JSON Schema) تعمل في وقت ثابت لمنع هجمات الحرمان من الخدمة القائمة على الخوارزميات.                                                      |    2    |   D   |
| 2.3.5 | تحقق من تسجيل حالات فشل التحقق مع مقتطفات حمولة محجوبة ورموز أخطاء غير غامضة للمساعدة في تصنيف الأمان.                                                                     |    3    |   V   |

---

## C2.4 فحص المحتوى والسياسة

يجب أن يكون المطورون قادرين على اكتشاف التعليمات البرمجية الصحيحة نحويًا التي تطلب محتوى غير مسموح به (مثل التعليمات غير المشروعة، وخطاب الكراهية، والنصوص المحمية بحقوق الطبع والنشر) ثم منع انتشارها.

|   #   | الوصف                                                                                                                                                                  | المستوى | الدور |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.4.1 | تحقق من أن مصنف المحتوى (صفر تدريب أو مدرب بدقة) يقيم كل إدخال من حيث العنف، وإيذاء النفس، والكراهية، والمحتوى الجنسي، والطلبات غير القانونية، مع إمكانية ضبط العتبات. |    1    |   D   |
| 2.4.2 | تحقق من أن المدخلات التي تنتهك السياسات ستتلقى رفضات موحدة أو إكمالات آمنة بحيث لا تنتقل إلى استدعاءات نموذج اللغة الكبير اللاحقة.                                     |    1    |  D/V  |
| 2.4.3 | تحقق من أن نموذج الفرز أو مجموعة القواعد يتم إعادة تدريبه/تحديثه على الأقل ربع سنويًا، مع دمج أنماط الهروب من الحماية أو تجاوز السياسات التي تم ملاحظتها حديثًا.       |    2    |   D   |
| 2.4.4 | التحقق من أن عملية الفحص تحترم السياسات الخاصة بالمستخدمين (العمر، القيود القانونية الإقليمية) من خلال قواعد تعتمد على السمات ويتم حلها في وقت الطلب.                  |    2    |   D   |
| 2.4.5 | تحقق من أن سجلات الفحص تتضمن درجات ثقة المصنف وعلامات فئة السياسة لربط SOC وإعادة تشغيل الفريق الأحمر في المستقبل.                                                     |    3    |   V   |

---

## C2.5 تحديد معدل الإدخال ومنع سوء الاستخدام

يجب على المطورين منع سوء الاستخدام، استنفاد الموارد، والهجمات الآلية على أنظمة الذكاء الاصطناعي من خلال تحديد معدلات الإدخال واكتشاف أنماط الاستخدام الشاذة.

|   #   | الوصف                                                                                                           | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.5.1 | تحقق من تطبيق حدود المعدل لكل مستخدم، لكل عنوان IP، ولكل مفتاح API لجميع نقاط النهاية الخاصة بالإدخال.          |    1    |  D/V  |
| 2.5.2 | تحقق من ضبط حدود معدلات الانفجار والمستمرة لمنع هجمات الحرمان من الخدمة وهجمات القوة الغاشمة.                   |    2    |  D/V  |
| 2.5.3 | تحقق من أن أنماط الاستخدام الشاذة (مثل الطلبات المتكررة بسرعة، فيضان الإدخال) تؤدي إلى حظر آلي أو تصعيد تلقائي. |    2    |  D/V  |
| 2.5.4 | تحقق من احتفاظ سجلات منع الإساءة ومراجعتها لاكتشاف أنماط الهجوم الناشئة.                                        |    3    |   V   |

---

## C2.6 التحقق من صحة الإدخال متعدد الوسائط

يجب أن تتضمن أنظمة الذكاء الاصطناعي تحققًا قويًا للمدخلات غير النصية (الصور، الصوت، الملفات) لمنع الحقن، التهرب، أو إساءة استخدام الموارد.

|   #   | الوصف                                                                                                                      | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.6.1 | تحقق من أن جميع المدخلات غير النصية (الصور، الصوت، الملفات) يتم التحقق من صحتها من حيث النوع والحجم والتنسيق قبل المعالجة. |    1    |   D   |
| 2.6.2 | تحقق من فحص الملفات بحثًا عن البرمجيات الخبيثة والحمولات التشفيرية قبل الاستيعاب.                                          |    2    |  D/V  |
| 2.6.3 | تحقق من أن مدخلات الصورة/الصوت يتم فحصها للكشف عن الاضطرابات العدائية أو أنماط الهجوم المعروفة.                            |    2    |  D/V  |
| 2.6.4 | تحقق من تسجيل حالات فشل التحقق من صحة المدخلات متعددة الأنماط وإثارتها لتنبيهات من أجل التحقيق.                            |    3    |   V   |

---

## C2.7 مصدر الإدخال والنسبة

يجب أن تدعم أنظمة الذكاء الاصطناعي التدقيق، وتتبع الانتهاكات، والامتثال من خلال مراقبة ووضع العلامات على مصادر جميع مدخلات المستخدم.

|   #   | الوصف                                                                                                                               | المستوى | الدور |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.7.1 | تحقق من أن جميع مدخلات المستخدم موسومة بالبيانات الوصفية (معرّف المستخدم، الجلسة، المصدر، الطابع الزمني، عنوان الـ IP) عند الإدخال. |    1    |  D/V  |
| 2.7.2 | تحقق من أن بيانات أصل المعلومات (provenance metadata) محفوظة وقابلة للتدقيق لجميع المدخلات المعالجة.                                |    2    |  D/V  |
| 2.7.3 | تحقق من أن مصادر الإدخال الشاذة أو غير الموثوق بها يتم تمييزها وتخضع لفحص معزز أو للحظر.                                            |    2    |  D/V  |

---

## C2.8 الكشف التهديدي التكيفي في الوقت الحقيقي

يجب على المطورين استخدام أنظمة كشف التهديدات المتقدمة للذكاء الاصطناعي التي تتكيف مع أنماط الهجوم الجديدة وتوفر حماية في الوقت الحقيقي باستخدام مطابقة الأنماط المجمعّة.

|   #   | الوصف                                                                                                                                                       | المستوى | الدور |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.8.1 | تحقق من أن أنماط اكتشاف التهديدات مدمجة في محركات تعبيرات منتظمة مُحسّنة لأداء عالي في التصفية اللحظية مع تأثير تأخير ضئيل.                                 |    1    |  D/V  |
| 2.8.2 | تحقق من أن أنظمة كشف التهديدات تحافظ على مكتبات نماذج منفصلة لفئات التهديد المختلفة (حقن المطالبات، المحتوى الضار، البيانات الحساسة، أوامر النظام).         |    1    |  D/V  |
| 2.8.3 | تحقق من أن الكشف التهديدي التكيفي يدمج نماذج تعلم الآلة التي تقوم بتحديث حساسية التهديد بناءً على تكرار الهجوم ومعدلات النجاح.                              |    2    |  D/V  |
| 2.8.4 | تأكد من أن تدفقات استخبارات التهديدات في الوقت الحقيقي تقوم بتحديث مكتبات الأنماط تلقائيًا بتوقيعات الهجمات الجديدة ومؤشرات الاختراق (IOCs).                |    2    |  D/V  |
| 2.8.5 | تحقق من أن معدلات الإيجابيات الكاذبة في كشف التهديدات تتم مراقبتها باستمرار وأن تخصيص نمط الكشف يتم ضبطه تلقائيًا لتقليل التدخل في حالات الاستخدام الشرعية. |    3    |  D/V  |
| 2.8.6 | تحقق من أن تحليل التهديدات السياقي يأخذ في الاعتبار مصدر الإدخال، وأنماط سلوك المستخدم، وتاريخ الجلسة لتحسين دقة الكشف.                                     |    3    |  D/V  |
| 2.8.7 | تحقق من مراقبة وتحسين مقاييس أداء كشف التهديدات (معدل الكشف، زمن استجابة المعالجة، استغلال الموارد) في الوقت الحقيقي.                                       |    3    |  D/V  |

---

## C2.9 خط أنابيب التحقق الأمني متعدد الوضعيات

يجب على المطورين توفير تحقق أمني للمدخلات النصية والصورية والصوتية وغير ذلك من أنماط مدخلات الذكاء الاصطناعي باستخدام أنواع محددة من كشف التهديدات وعزل الموارد.

|   #   | الوصف                                                                                                                                                                                                         | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.9.1 | تحقق من أن لكل نمط إدخال مدققات أمان مخصصة مع أنماط تهديد موثقة (النص: حقن الأوامر، الصور: الستيجانوغرافيا، الصوت: هجمات الطيف الترددي) وعوائد الكشف.                                                         |    1    |  D/V  |
| 2.9.2 | تحقق من أن المدخلات متعددة الوسائط تتم معالجتها في صناديق رمل معزولة بحدود موارد محددة (الذاكرة، وحدة المعالجة المركزية، وقت المعالجة) خاصة بكل نوع من أنواع الوسائط وموثقة في سياسات الأمان.                 |    2    |  D/V  |
| 2.9.3 | تحقق من أن نظام كشف الهجمات عبر الوسائط يقيم الهجمات المنسقة التي تمتد عبر أنواع إدخال متعددة (مثل الحمولة المخفية في الصور جنبًا إلى جنب مع حقن الموجه في النص) باستخدام قواعد الترابط وتوليد التنبيهات.     |    2    |  D/V  |
| 2.9.4 | تحقق من أن فشل التحقق متعدد الوسائط يُحرّض تسجيلًا تفصيليًا يشمل جميع الوسائط المدخلة، ونتائج التحقق، ودرجات التهديد، وتحليل الترابط بصيغ تسجيل مُهيكلة لدمجها مع أنظمة إدارة معلومات الأحداث الأمنية (SIEM). |    3    |  D/V  |
| 2.9.5 | تحقق من تحديث مصنِّفات المحتوى الخاصة بالنمط modality-specific وفقًا للجدولات الموثقة (بحد أدنى ربع سنوي) بأنماط التهديد الجديدة، والأمثلة العدائية، والمعايير الأداء التي يتم الحفاظ عليها فوق حدود الأساس.  |    3    |  D/V  |

---

## المراجع

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)


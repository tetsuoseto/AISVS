# C2 التحقق من إدخال المستخدم

## هدف الرقابة

التحقق القوي من مدخلات المستخدم هو خط الدفاع الأول ضد بعض أكثر الهجمات تدميراً على أنظمة الذكاء الاصطناعي.
هجمات حقن التعليمات يمكنها تجاوز تعليمات النظام، وتسريب بيانات حساسة، أو توجيه النموذج نحو سلوك غير مسموح.
ما لم تكن هناك فلاتر مخصصة وهرميات التعليمات في مكانها، تشير الأبحاث إلى أن هجمات كسر القيود "multi-shot" التي تستغل نوافذ السياق الطويلة جدًا ستكون فعالة.
أيضًا، يمكن لهجمات تشويش عدائية دقيقة--مثل تبديل الأحرف المتشابهة شكلاً (الهوموغليف) أو leetspeak—-يمكن أن تغيّر قرارات النموذج بشكل صامت.

---

## C2.1 الدفاع ضد حقن المطالب

حقن المحفز هو أحد أبرز المخاطر التي تواجه أنظمة الذكاء الاصطناعي. تعتمد الدفاعات ضد هذه الحيلة على مزيج من مرشحات الأنماط الثابتة، ومصنفات ديناميكية، وفرض هيكلية التعليمات.

|   #   | الوصف                                                                                                                                                                                        | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.1.1 | تحقق من أن مدخلات المستخدم تُفحص مقابل مكتبة محدثة باستمرار من أنماط حقن المطالب المعروفة (كلمات مفتاحية لكسر الحماية، "ignore previous"، سلاسل تمثيل الأدوار، هجمات HTML/URL غير المباشرة). |    1    |  D/V  |
| 2.1.2 | تحقق من أن النظام يفرض هيكلًا هرميًا للتعليمات يجعل رسائل النظام أو المطور تتجاوز تعليمات المستخدم، حتى بعد توسيع نافذة السياق.                                                              |    1    |  D/V  |
| 2.1.3 | تحقق من أن اختبارات التقييم العدائي (على سبيل المثال فريق الاختبار الأحمر مع مطالبات كثيرة-اللقطات) تُجرى قبل إصدار كل نموذج أو قالب استدعاء، مع عتبات معدل النجاح وحواجز آلية ضد التراجعات. |    2    |  D/V  |
| 2.1.4 | تحقق من أن المطالبات التي تأتي من محتوى طرف ثالث (صفحات الويب، ملفات PDF، رسائل البريد الإلكتروني) يتم تطهيرها في سياق تحليل معزول قبل دمجها في الموجه الرئيسي.                              |    2    |   D   |
| 2.1.5 | تحقق من أن جميع تحديثات قواعد فلترة المطالبات وإصدارات نماذج التصنيف وتغييرات قائمة الحظر محكومة بنظام التحكم بالإصدارات وقابلة للتدقيق.                                                     |    3    |  D/V  |

---

## C2.2 مقاومة الأمثلة العدائية

نماذج معالجة اللغة الطبيعية (NLP) لا تزال عرضة لاضطرابات دقيقة على مستوى الأحرف أو الكلمات، والتي غالباً ما يغفل عنها البشر، لكنها تميل إلى التصنيف الخاطئ من قبل النماذج.

|   #   | الوصف                                                                                                                                                                                | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 2.2.1 | تحقق من أن خطوات التطبيع الأساسية للمدخلات (Unicode NFC، تحويل أشكال متجانسة، تقليم الفراغات) تتم قبل عملية التوكننة.                                                                |    1    |   D   |
| 2.2.2 | تحقق من أن الكشف عن الشذوذ الإحصائي يُشير إلى المدخلات التي تمتلك مسافة تحرير عالية بشكل غير عادي مقارنة بمعايير اللغة، وتكراراً مفرطاً للوحدات، أو مسافات تضمين غير طبيعية.         |    2    |  D/V  |
| 2.2.3 | تحقق من أن خط أنابيب الاستدلال يدعم نماذج بديلة مقواة بالتدريب العدائي–المحصّن أو طبقات دفاعية اختيارية للنقاط النهاية عالية المخاطر (على سبيل المثال، التعشوائية، التقطير الدفاعي). |    2    |   D   |
| 2.2.4 | تحقق من أن المدخلات العدائية المشبوهة معزولة، ومسجلة بالحمولات الكاملة (بعد إخفاء البيانات الشخصية).                                                                                 |    2    |   V   |
| 2.2.5 | تحقق من أن معايير المتانة (معدل نجاح مجموعات الهجمات المعروفة) يتم تتبّعها مع مرور الوقت، وأن التراجعات تؤدي إلى تفعيل مانع الإصدار.                                                 |    3    |  D/V  |

---

## C2.3 التحقق من المخطط، النوع والطول

هجمات الذكاء الاصطناعي التي تتضمن مدخلات مشوهة أو كبيرة الحجم يمكن أن تتسبب في حدوث أخطاء في التحليل، وتسرب المدخلات عبر الحقول، واستهلاك الموارد.  كما أن فرض صارم للمخطط يعد شرطًا أساسيًا عند إجراء استدعاءات أدوات حتمية.

|   #   | الوصف                                                                                                                                                               | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.3.1 | تحقق من أن كل نقطة نهاية API أو استدعاء دالة تحدد مخطط إدخال صريح (مخطط JSON، Protobuf أو ما يعادله متعدد الوسائط) وأن يتم التحقق من صحة المدخلات قبل تجميع الموجه. |    1    |   D   |
| 2.3.2 | تحقق من أن المدخلات التي تتجاوز الحد الأقصى لعدد التوكنات أو البايتات تُرفض بخطأ آمن ولا يتم اقتطاعها صمتاً.                                                        |    1    |  D/V  |
| 2.3.3 | تحقق من أن فحوصات النوع تُطبق على جانب الخادم، وليس فقط في كود العميل (على سبيل المثال نطاقات رقمية، قيم التعداد (enum)، وأنواع MIME للصور/الصوت).                  |    2    |  D/V  |
| 2.3.4 | تحقق من أن المدققين الدلاليين (مثل JSON Schema) يعملون في زمن ثابت لمنع هجوم رفض الخدمة الخوارزمي.                                                                  |    2    |   D   |
| 2.3.5 | تحقق من أن فشل التحقق يسجّل مع مقتطفات الحمولة المحجوبة ورموز خطأ غير غامضة للمساعدة في الفرز الأمني.                                                               |    3    |   V   |

---

## C2.4 فحص المحتوى والسياسات

يجب أن يكون بإمكان المطورين اكتشاف المطالبات ذات البنية النحوية الصحيحة التي تطلب محتوى محظورًا، ثم منع انتشارها.

|   #   | الوصف                                                                                                                                                                     | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.4.1 | تحقق من أن مصنف المحتوى (بدون أمثلة أو مُدرب بدقة) يُقيِّم كل إدخال وفق معايير العنف وإيذاء النفس والكراهية والمحتوى الجنسي والطلبات غير القانونية، مع عتبات قابلة للضبط. |    1    |   D   |
| 2.4.2 | تحقق من أن المدخلات التي تنتهك السياسات ستحصل على رفض موحد أو إكمال آمن، حتى لا تنتشر إلى استدعاءات LLM اللاحقة.                                                          |    1    |  D/V  |
| 2.4.3 | تحقق من أن نموذج الفحص أو مجموعة القواعد يتم إعادة تدريبه وتحديثه على الأقل ربع سنويًا، مع إدراج الأنماط الجديدة التي رُصدت لكسر القيود أو تجاوز السياسات.                |    2    |   D   |
| 2.4.4 | تحقق من أن الفحص يراعي السياسات المخصصة للمستخدم (العمر، القيود القانونية الإقليمية) عبر قواعد مبنية على السمات تُحل في وقت الطلب.                                        |    2    |   D   |
| 2.4.5 | تحقق من أن سجلات الفحص تتضمن درجات ثقة المصنف ووسوم فئة السياسة لارتباط مركز عمليات الأمن (SOC) وإعادة تشغيل فريق الاختبار الأحمر في المستقبل.                            |    3    |   V   |

---

## C2.5 تقييد معدل الإدخال ومنع إساءة الاستخدام

يجب على المطورين منع سوء الاستخدام وإرهاق الموارد والهجمات الآلية ضد أنظمة الذكاء الاصطناعي من خلال تقليل معدلات الإدخال واكتشاف أنماط الاستخدام الشاذة.

|   #   | الوصف                                                                                                                            | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.5.1 | تحقق من أن حدود معدل الاستخدام لكل مستخدم، ولكل عنوان IP، ولكل مفتاح واجهة برمجة التطبيقات، تُفرض على جميع نقاط النهاية المدخلة. |    1    |  D/V  |
| 2.5.2 | تحقق من أن حدود معدل الذروة والمعدل المستدام مُضبوطة لمنع هجمات رفض الخدمة (DoS) وهجمات القوة الغاشمة.                           |    2    |  D/V  |
| 2.5.3 | تحقق من أن أنماط الاستخدام الشاذة (على سبيل المثال، الطلبات المتلاحقة بسرعة، وإغراق الإدخالات) تفعِّل الحظر الآلي أو التصعيدات.  |    2    |  D/V  |
| 2.5.4 | تحقق من أن سجلات منع إساءة الاستخدام يتم الاحتفاظ بها ومراجعتها لاكتشاف أنماط هجمات ناشئة.                                       |    3    |   V   |

---

## C2.6 التحقق من صحة المدخلات متعددة الوسائط

يجب أن تتضمن أنظمة الذكاء الاصطناعي تحققاً قوياً من المدخلات غير النصية (الصور، الصوت، الملفات) لمنع حقن تعليمات خبيثة، والتملّص، وإساءة استخدام الموارد.

|   #   | الوصف                                                                                                         | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.6.1 | تأكد من أن جميع المدخلات غير النصية (الصور، الصوت، الملفات) يتم التحقق من نوعها وحجمها وتنسيقها قبل المعالجة. |    1    |   D   |
| 2.6.2 | تأكد من أن الملفات تُفحص بحثًا عن البرمجيات الخبيثة والحمولات التخفيّة قبل الاستيعاب.                         |    2    |  D/V  |
| 2.6.3 | تحقق من أن مدخلات الصور/الصوت تُفحص بحثاً عن تشويهات عدائية أو أنماط هجوم معروفة.                             |    2    |  D/V  |
| 2.6.4 | تحقق من أن فشل التحقق من صحة المدخلات متعددة-الوسائط قد تم تسجيله وتُصدر تنبيهات للتحقيق.                     |    3    |   V   |

---

## C2.7 أصل الإدخال والإسناد

يجب أن تدعم أنظمة الذكاء الاصطناعي التدقيق وتتبع إساءة الاستخدام والامتثال من خلال مراقبة ووضع علامات على أصول جميع مدخلات المستخدم.

|   #   | الوصف                                                                                                                         | المستوى | الدور |
| :---: | ----------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.7.1 | تحقق من أن جميع مدخلات المستخدم موسومة ببيانات وصفية (معرّف المستخدم، الجلسة، المصدر، الطابع الزمني، عنوان IP) عند الاستيعاب. |    1    |  D/V  |
| 2.7.2 | تحقق من أن بيانات النسب محفوظة وقابلة للتدقيق لجميع المدخلات المعالجة.                                                        |    2    |  D/V  |
| 2.7.3 | تحقق من أن مصادر الإدخال الشاذة أو غير الموثوقة يتم وسمها وتخضع لرقابة معزَّزة أو للحظر.                                      |    2    |  D/V  |

---

## C2.8 اكتشاف التهديدات التكيفية في الوقت الحقيقي

ينبغي للمطورين استخدام أنظمة كشف التهديدات المتقدمة للذكاء الاصطناعي التي تتكيف مع أنماط الهجوم الجديدة وتوفر حماية في الوقت الحقيقي مع مطابقة الأنماط المجمّعة.

|   #   | الوصف                                                                                                                                                  | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 2.8.1 | تحقق من أن أنماط الكشف عن التهديدات جرى تجميعها في محركات تعبيرات نمطية مُحسّنة لأداء عالي في الترشيح في الوقت الفعلي مع تأثير تأخير منخفض.            |    1    |  D/V  |
| 2.8.2 | تحقق من أن أنظمة الكشف عن التهديدات تحافظ على مكتبات أنماط منفصلة لفئات التهديد المختلفة (حقن الطلبات، المحتوى الضار، البيانات الحساسة، أوامر النظام). |    1    |  D/V  |
| 2.8.3 | تحقق من أن الكشف التهديدي التكيفي يتضمن نماذج التعلم الآلي التي تقوم بتحديث حساسية التهديد بناءً على معدل الهجمات ونسب النجاح.                         |    2    |  D/V  |
| 2.8.4 | تحقق من أن مغذيات استخبارات التهديدات في الوقت الفعلي تقوم تلقائيًا بتحديث مكتبات الأنماط بتوقيعات هجوم جديدة و IOCs (Indicators of Compromise).       |    2    |  D/V  |
| 2.8.5 | تحقق من أن معدلات الإيجابيات الكاذبة في كشف التهديدات تُرصد باستمرار وأن دقة الأنماط تُضبط تلقائيًا لتقليل التداخل مع حالات الاستخدام المشروعة.        |    3    |  D/V  |
| 2.8.6 | تحقق من أن تحليل التهديد السياقي يأخذ في الاعتبار مصدر الإدخال وأنماط سلوك المستخدم وسجل الجلسة من أجل تحسين دقة الكشف.                                |    3    |  D/V  |
| 2.8.7 | تحقق من أن مقاييس أداء كشف التهديدات (معدل الكشف، زمن الاستجابة، استهلاك الموارد) يتم مراقبتها وتحسينها في الوقت الفعلي.                               |    3    |  D/V  |

---

## C2.9 خط أنابيب التحقق الأمني متعدد الوسائط

يجب على المطورين توفير التحقق الأمني لوسائط الإدخال مثل النص والصورة والصوت وغيرها من مدخلات الذكاء الاصطناعي، مع أنواع محددة من اكتشاف التهديدات وعزل الموارد.

|   #   | الوصف                                                                                                                                                                                                  | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 2.9.1 | تحقق من أن كل نوع إدخال يمتلك مدققات أمان مخصصة مع أنماط التهديد الموثقة (نص: حقن المطالب، الصور: إخفاء البيانات، الصوت: هجمات مخطط طيفي) وعتبات الكشف.                                                |    1    |  D/V  |
| 2.9.2 | تحقق من أن المدخلات متعددة الوسائط تُعالج في بيئات sandbox معزولة بحدود موارد محددة (الذاكرة، وحدة المعالجة المركزية، ووقت المعالجة) مخصصة لكل نمط من الوسائط وموثقة في سياسات الأمن.                  |    2    |  D/V  |
| 2.9.3 | تحقق من أن كشف الهجمات عبر الوسائط المتعددة يحدد هجمات منسقة تمتد عبر عدة أنواع إدخال (على سبيل المثال، حمولات ستيجانوجرافية في الصور مع حقن تعليمات في النص) باستخدام قواعد الترابط وتوليد الإنذارات. |    2    |  D/V  |
| 2.9.4 | تحقق من أن فشل التحقق متعدد الوسائط يؤدي إلى تسجيل تفصيلي يشمل جميع وسائل الإدخال ونتائج التحقق ودرجات التهديد وتحليل الترابط مع صيغ سجلات مُهيكلة للتكامل مع SIEM.                                    |    3    |  D/V  |
| 2.9.5 | تحقق من تحديث مصنفات المحتوى الخاصة بكل نمط وفق جداول زمنية موثقة (على الأقل ربع سنويًا)، مع أنماط تهديد جديدة، وأمثلة عدائية، ومعايير أداء تحافظ على مستوى أعلى من العتبات الأساسية.                  |    3    |  D/V  |

---

## المراجع

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)


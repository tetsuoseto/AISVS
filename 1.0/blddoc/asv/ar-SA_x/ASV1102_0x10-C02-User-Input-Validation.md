# التحقق من صحة إدخال المستخدم في C2

## هدف التحكم

التحقق القوي من مدخلات المستخدم هو خط الدفاع الأول ضد بعض أكثر الهجمات إلحاقًا بالضرر على أنظمة الذكاء الاصطناعي. يمكن لهجمات حقن الطلبات تجاوز تعليمات النظام، وتسريب البيانات الحساسة، أو توجيه النموذج نحو سلوك غير مسموح به. ما لم تكن هناك فلاتر مخصصة وتسلسلات تعليمات منظمة، تظهر الأبحاث أن "الاختراقات متعددة الطلقات" التي تستغل نوافذ السياق الطويلة جدًا ستكون فعالة. أيضًا، يمكن لهجمات التشويش العدائية الدقيقة—مثل تبديل الحروف المتشابهة أو لغة الرموز—تغيير قرارات النموذج بهدوء.

---

## دفاع ضد حقن الموجهات C2.1

حقن التعليمات هو واحد من أعلى المخاطر التي تواجه أنظمة الذكاء الاصطناعي. تعتمد الدفاعات ضد هذه الأسلوب على مزيج من مرشحات الأنماط الثابتة، والمصنفات الديناميكية، وفرض تسلسل التعليمات.

|   #   | الوصف                                                                                                                                                                                              | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.1.1 | تأكد من فحص مدخلات المستخدم مقابل مكتبة محدثة باستمرار لأنماط حقن المطالبات المعروفة (كلمات المرور الخاصة بكسر النظام، "تجاهل السابق"، سلاسل التمثيل الدور، الهجمات غير المباشرة عبر HTML/URL).    |    1    |  D/V  |
| 2.1.2 | تحقق من أن النظام يفرض تسلسلاً هرميًا للتعليمات حيث تتجاوز رسائل النظام أو المطور تعليمات المستخدم، حتى بعد توسيع نافذة السياق.                                                                    |    1    |  D/V  |
| 2.1.3 | التحقق من تنفيذ اختبارات التقييم العدائي (مثل مطالبات "العديد من المحاولات" لفريق الأحمر) قبل إصدار كل نموذج أو قالب مطالبة، مع تحديد حدود لمعدلات النجاح واستخدام حواجز أوتوماتيكية لمنع التراجع. |    2    |  D/V  |
| 2.1.4 | تحقق من أن الطلبات التي تنشأ من محتوى طرف ثالث (صفحات الويب، ملفات PDF، رسائل البريد الإلكتروني) تتم تنقيتها في سياق تحليل معزول قبل دمجها في الطلب الرئيسي.                                       |    2    |   D   |
| 2.1.5 | تحقق من أن جميع تحديثات قواعد فلترة المطالبات، وإصدارات نماذج المصنفات، وتغييرات قائمة الحظر مُراقبة بالإصدار وقابلة للتدقيق.                                                                      |    3    |  D/V  |

---

## C2.2 مقاومة الأمثلة العدائية

نماذج معالجة اللغة الطبيعية (NLP) لا تزال معرضة للتشويش الطفيف على مستوى الحروف أو الكلمات التي غالبًا ما يغفلها البشر ولكن تميل النماذج إلى تصنيفها بشكل خاطئ.

|   #   | الوصف                                                                                                                                                                          | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 2.2.1 | تحقق من أن خطوات تطبيع الإدخال الأساسية (Unicode NFC، تعيين الأشكال المتماثلة، تقليم الفراغات) تتم قبل عملية تقسيم النص إلى رموز.                                              |    1    |   D   |
| 2.2.2 | تحقق من أن اكتشاف الشذوذ الإحصائي يشير إلى المدخلات التي تحتوي على مسافة تحرير مرتفعة بشكل غير عادي عن معايير اللغة، أو وجود تكرار مفرط في الرموز، أو مسافات تضمين غير طبيعية. |    2    |  D/V  |
| 2.2.3 | تأكد من أن خط أنابيب الاستدلال يدعم نماذج محسنة بالتدريب العدائي أو طبقات الدفاع الاختيارية (مثل العشوائية، التقطير الدفاعي) لنقاط النهاية عالية الخطورة.                      |    2    |   D   |
| 2.2.4 | تحقق من وضع المدخلات المشبوهة بعدوها في الحجر الصحي، وتسجيلها مع الحمولة الكاملة (بعد إزالة المعلومات الشخصية الحساسة).                                                        |    2    |   V   |
| 2.2.5 | تأكد من تتبع مقاييس المتانة (معدل نجاح مجموعات الهجوم المعروفة) مع مرور الوقت وأن الانحدارات تؤدي إلى إيقاف الإصدار.                                                           |    3    |  D/V  |

---

## C2.3 التحقق من المخطط والنوع والطول

هجمات الذكاء الاصطناعي التي تتضمن مدخلات مشوهة أو كبيرة الحجم قد تتسبب في أخطاء في التحليل، وتسرب الأوامر عبر الحقول، واستنفاد الموارد. كما أن تطبيق قواعد صارمة للمخططات هو أيضًا شرط أساسي عند إجراء استدعاءات أدوات حتمية.

|   #   | الوصف                                                                                                                                                                      | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.3.1 | تحقق من أن كل نقطة نهاية لاستدعاء API أو وظيفة تحدد مخطط إدخال صريح (مخطط JSON، Protobuf أو ما يعادله متعدد الوسائط) وأن المدخلات يتم التحقق من صحتها قبل تجميع المطالبات. |    1    |   D   |
| 2.3.2 | تحقق من أن الإدخالات التي تتجاوز الحد الأقصى لعدد الرموز أو الحد الأقصى للحجم بالبايت يتم رفضها بخطأ آمن ولا يتم اقتطاعها بهدوء.                                           |    1    |  D/V  |
| 2.3.3 | تأكد من تطبيق فحوصات النوع (مثل نطاقات الأعداد، قيم التعداد، أنواع MIME للصور/الصوت) على جانب الخادم، وليس فقط في كود العميل.                                              |    2    |  D/V  |
| 2.3.4 | تحقق من أن أدوات التحقق الدلالي (على سبيل المثال، JSON Schema) تعمل في زمن ثابت لمنع هجمات الحرمان من الخدمة الخوارزمية (DoS).                                             |    2    |   D   |
| 2.3.5 | تحقق من تسجيل حالات فشل التحقق مع مقتطفات حمولة مخفية الرموز وأكواد خطأ واضحة للمساعدة في تصنيف الأمان.                                                                    |    3    |   V   |

---

## C2.4 فحص المحتوى والسياسة

يجب أن يكون المطورون قادرين على اكتشاف المطالبات الصياغية الصحيحة التي تطلب محتوى غير مسموح به (مثل التعليمات غير المشروعة، خطاب الكراهية، والنصوص المحمية بحقوق الطبع والنشر) ثم منع انتشارها.

|   #   | الوصف                                                                                                                                                                                                      | المستوى | الدور |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.4.1 | تحقق من أن مصنف المحتوى (بدون تدريب مسبق أو مدرب بشكل دقيق) يقوم بتقييم كل إدخال من حيث العنف، وإيذاء النفس، والكراهية، والمحتوى الجنسي، والطلبات غير القانونية، مع إمكانية ضبط العتبات بشكل قابل للتخصيص. |    1    |   D   |
| 2.4.2 | تحقق من أن المدخلات التي تنتهك السياسات ستتلقى رفضات موحدة أو إكمالات آمنة بحيث لا تنتقل إلى استدعاءات نماذج اللغة الكبيرة اللاحقة.                                                                        |    1    |  D/V  |
| 2.4.3 | تحقق من إعادة تدريب/تحديث نموذج الفحص أو مجموعة القواعد على الأقل كل ثلاثة أشهر، مع دمج الأنماط الجديدة المكتشفة للتهكير أو تجاوز السياسات.                                                                |    2    |   D   |
| 2.4.4 | تحقق من أن الفحص يحترم السياسات الخاصة بالمستخدم (العمر، القيود القانونية الإقليمية) من خلال قواعد مستندة إلى السمات يتم حلها عند وقت الطلب.                                                               |    2    |   D   |
| 2.4.5 | تحقق من أن سجلات الفحص تتضمن درجات ثقة المصنف وتسميات فئة السياسة من أجل الترابط SOC وإعادة تشغيل فريق الاختبار الأحمر في المستقبل.                                                                        |    3    |   V   |

---

## C2.5 تحديد معدل الإدخال ومنع الإساءة

يجب على المطورين منع سوء الاستخدام، واستنفاد الموارد، والهجمات الآلية ضد أنظمة الذكاء الاصطناعي من خلال تحديد معدلات الإدخال واكتشاف أنماط الاستخدام الشاذة.

|   #   | الوصف                                                                                                                | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.5.1 | تحقق من فرض حدود معدل الاستخدام لكل مستخدم، لكل عنوان IP، ولكل مفتاح API لجميع نقاط الإدخال.                         |    1    |  D/V  |
| 2.5.2 | تحقق من أن معدلات الحد المفاجئة والمستمرة مضبوطة لمنع هجمات الحرمان من الخدمة (DoS) وهجمات القوة الغاشمة.            |    2    |  D/V  |
| 2.5.3 | تحقق من أن أنماط الاستخدام الشاذة (مثل طلبات متتالية سريعة، فيضان المدخلات) تؤدي إلى تشغيل الحجب الآلي أو التصعيدات. |    2    |  D/V  |
| 2.5.4 | تحقق من الاحتفاظ بسجلات منع الانتهاكات ومراجعتها للكشف عن أنماط الهجوم الناشئة.                                      |    3    |   V   |

---

## C2.6 التحقق من صحة الإدخال متعدد الوسائط

يجب أن تتضمن أنظمة الذكاء الاصطناعي تحققًا قويًا للمدخلات غير النصية (الصور، الصوت، الملفات) لمنع الحقن أو التملص أو إساءة استخدام الموارد.

|   #   | الوصف                                                                                                         | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.6.1 | تأكد من التحقق من جميع المدخلات غير النصية (الصور، الصوت، الملفات) من حيث النوع والحجم والتنسيق قبل المعالجة. |    1    |   D   |
| 2.6.2 | تأكد من فحص الملفات للكشف عن البرامج الضارة والحمولات المستترة قبل الإدخال.                                   |    2    |  D/V  |
| 2.6.3 | تحقق من أن مدخلات الصورة/الصوت تم فحصها للكشف عن الاضطرابات التخريبية أو أنماط الهجوم المعروفة.               |    2    |  D/V  |
| 2.6.4 | تحقق من أن فشل التحقق من صحة الإدخال متعدد الوسائط يتم تسجيله ويؤدي إلى تنبيهات للتحقيق.                      |    3    |   V   |

---

## C2.7 أصل الإدخال والنسبة

يجب أن تدعم أنظمة الذكاء الاصطناعي التدقيق، وتتبع الانتهاكات، والامتثال من خلال مراقبة وتأشير مصادر جميع مدخلات المستخدم.

|   #   | الوصف                                                                                                                        | المستوى | الدور |
| :---: | ---------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.7.1 | تحقق من أن جميع مدخلات المستخدم مرفقة ببيانات وصفية (معرّف المستخدم، الجلسة، المصدر، الطابع الزمني، عنوان IP) عند الاستيراد. |    1    |  D/V  |
| 2.7.2 | تحقق من أن بيانات الأصل (provenance metadata) محفوظة وقابلة للمراجعة لجميع المدخلات المعالجة.                                |    2    |  D/V  |
| 2.7.3 | تحقق من أن مصادر الإدخال الشاذة أو غير الموثوقة يتم الإبلاغ عنها وتخضع لمراجعة معززة أو للحظر.                               |    2    |  D/V  |

---

## C2.8 الكشف التهديدات التكيفية في الوقت الحقيقي

يجب على المطورين استخدام أنظمة كشف التهديدات المتقدمة للذكاء الاصطناعي التي تتكيف مع أنماط الهجوم الجديدة وتوفر الحماية في الوقت الفعلي من خلال مطابقة الأنماط المجمعة.

|   #   | الوصف                                                                                                                                                  | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 2.8.1 | تحقق من أن أنماط اكتشاف التهديدات قد تم تجميعها في محركات تعبيرات نمطية محسنة لأداء عالٍ في التصفية في الوقت الحقيقي مع تأثير زمني ضئيل.               |    1    |  D/V  |
| 2.8.2 | تحقق من أن أنظمة كشف التهديد تحتفظ بمكتبات أنماط منفصلة لفئات التهديد المختلفة (حقن الأوامر البرمجية، المحتوى الضار، البيانات الحساسة، أوامر النظام).  |    1    |  D/V  |
| 2.8.3 | تحقق من أن اكتشاف التهديدات التكيفية يدمج نماذج تعلم الآلة التي تقوم بتحديث حساسية التهديد بناءً على تكرار الهجمات ومعدلات النجاح.                     |    2    |  D/V  |
| 2.8.4 | تحقق من أن تغذيات استخبارات التهديدات في الوقت الفعلي تقوم تلقائيًا بتحديث مكتبات الأنماط بتوقيعات الهجوم الجديدة ومؤشرات الاختراق (IOCs).             |    2    |  D/V  |
| 2.8.5 | تحقق من أن معدلات الإيجابيات الخاطئة في كشف التهديدات تتم مراقبتها بشكل مستمر وأن دقة الأنماط تُضبط تلقائيًا لتقليل التدخل في حالات الاستخدام الشرعية. |    3    |  D/V  |
| 2.8.6 | تحقق من أن تحليل التهديد السياقي يأخذ في الاعتبار مصدر الإدخال، وأنماط سلوك المستخدم، وتاريخ الجلسة لتحسين دقة الكشف.                                  |    3    |  D/V  |
| 2.8.7 | تحقق من أن مؤشرات أداء اكتشاف التهديدات (معدل الكشف، زمن معالجة التأخير، استخدام الموارد) يتم مراقبتها وتحسينها في الوقت الحقيقي.                      |    3    |  D/V  |

---

## C2.9 خط أنابيب التحقق من الأمان متعدد الوسائط

يجب على المطورين توفير التحقق من الأمان للنص والصورة والصوت وأنماط إدخال الذكاء الاصطناعي الأخرى باستخدام أنواع محددة من الكشف عن التهديدات وعزل الموارد.

|   #   | الوصف                                                                                                                                                                                                              | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 2.9.1 | تحقق من أن كل نوع من أنواع الإدخال لديه مدققات أمان مخصصة مع أنماط تهديد موثقة (النص: حقن التعليمات، الصور: التضمين الخفي، الصوت: هجمات مخطط الطيف) وعوامل كشف محددة.                                              |    1    |  D/V  |
| 2.9.2 | تحقق من أن المدخلات متعددة الوسائط تتم معالجتها في بيئات معزولة ذات حدود موارد محددة (ذاكرة، وحدة معالجة مركزية، وقت المعالجة) خاصة بكل نوع من أنواع الوسائط وموثقة في سياسات الأمان.                              |    2    |  D/V  |
| 2.9.3 | تحقق من أن الكشف عن الهجمات متعددة الأنماط يحدد الهجمات المنسقة التي تمتد عبر أنواع إدخال متعددة (مثل الحمولات الستيجانوجرافية في الصور المدمجة مع حقن التعليمات في النص) باستخدام قواعد الترابط وتوليد التنبيهات. |    2    |  D/V  |
| 2.9.4 | تحقق من أن فشل التحقق متعدد الوسائط يُحدث تسجيلًا تفصيليًا يشمل جميع وسائط الإدخال، ونتائج التحقق، ونقاط التهديد، وتحليل الارتباط باستخدام تنسيقات تسجيل منظمة لتكامل SIEM.                                        |    3    |  D/V  |
| 2.9.5 | تحقق من تحديث مصنفي المحتوى الخاصين بالنمط وفقًا للجداول الموثقة (بحد أدنى ربع سنوي) باستخدام أنماط التهديد الجديدة، والأمثلة العدائية، ومعايير الأداء التي تُحافظ على مستوى أعلى من الحدود الأساسية.              |    3    |  D/V  |

---

## المراجع

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)


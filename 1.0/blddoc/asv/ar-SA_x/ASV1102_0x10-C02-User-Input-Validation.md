# التحقق من صحة إدخال المستخدم في C2

## هدف التحكم

التحقق الصارم من صحة مدخلات المستخدم هو الخط الدفاعي الأول ضد بعض أكثر الهجمات التي تضر بأنظمة الذكاء الاصطناعي. يمكن لهجمات حقن الأوامر تجاوز تعليمات النظام، تسريب البيانات الحساسة، أو توجيه النموذج نحو سلوك غير مسموح به. ما لم تكن هناك فلاتر مخصصة وهياكل تعليمات منظمة، تظهر الأبحاث أن هجمات "الهروب متعددة اللقطات" التي تستغل نوافذ السياق الطويلة جداً ستكون فعالة. كذلك، يمكن لهجمات التشويش العدائية الدقيقة—مثل تبديل الحروف المتشابهة أو لغة leetspeak—أن تغير قرارات النموذج بهدوء.

---

## C2.1 الدفاع ضد حقن التعليمات

حقن المطالب هو أحد أعلى المخاطر التي تواجه أنظمة الذكاء الاصطناعي. تستخدم الدفاعات ضد هذه التكتيك مزيجًا من مرشحات الأنماط الثابتة، والمصنفات الديناميكية، وفرض هيكلية التعليمات.

|   #   | الوصف                                                                                                                                                                                                | المستوى | الدور |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.1.1 | التحقق من أن مدخلات المستخدم يتم فحصها مقابل مكتبة محدثة باستمرار لأنماط حقن الأوامر المعروفة (كلمات رئيسية لتجاوز القيود، "تجاهل السابق"، سلاسل التمثيل الدورى، الهجمات غير المباشرة عبر HTML/URL). |    1    |  D/V  |
| 2.1.2 | تحقق من أن النظام يفرض تسلسلًا هرميًا للتعليمات حيث تتجاوز رسائل النظام أو المطور تعليمات المستخدم، حتى بعد توسيع نافذة السياق.                                                                      |    1    |  D/V  |
| 2.1.3 | تحقق من أن اختبارات التقييم العدائي (مثل مطالبات فريق الاختبار "عديدة المحاولات") تُجرى قبل كل إصدار للنموذج أو قالب المطالبة، مع تحديد حدود لمعدلات النجاح واستخدام حواجز تلقائية لمنع التراجع.     |    2    |  D/V  |
| 2.1.4 | تحقق من أن المطالبات التي تنشأ من محتوى طرف ثالث (صفحات الويب، ملفات PDF، البريد الإلكتروني) تتم معالجتها وتنقيحها في سياق تحليل معزول قبل دمجها في الطلب الرئيسي.                                   |    2    |   D   |
| 2.1.5 | تحقق من أن جميع تحديثات قواعد ترشيح التعليمات، إصدارات نماذج المصنفات، وتغييرات قوائم الحظر تتم مراقبتها بواسطة التحكم في الإصدارات وأنها قابلة للتدقيق.                                             |    3    |  D/V  |

---

## C2.2 مقاومة الأمثلة العدائية

نماذج معالجة اللغة الطبيعية (NLP) لا تزال عرضة للتشويشات الطفيفة على مستوى الأحرف أو الكلمات التي غالبًا ما يغفلها البشر، ولكن تميل النماذج إلى تصنيفها بشكل خاطئ.

|   #   | الوصف                                                                                                                                                                            | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.2.1 | تحقق من أن خطوات تطبيع الإدخال الأساسية (Unicode NFC, تعيين الحروف المتشابهة، تقليم الفراغات) تعمل قبل عملية تقسيم النص إلى رموز.                                                |    1    |   D   |
| 2.2.2 | تحقق من أن الكشف عن الشواذ الإحصائية يحدد المدخلات التي تحتوي على مسافات تعديل غير عادية مقارنة بمعايير اللغة، أو تكرارات مفرطة في الرموز، أو مسافات تضمين غير طبيعية.           |    2    |  D/V  |
| 2.2.3 | تحقق من أن خط أنابيب الاستدلال يدعم نسخ النماذج المتينة المدربة ضد الهجمات الاختراقية أو طبقات الدفاع الاختيارية (مثل العشوائية، التقطير الدفاعي) للنقاط النهائية عالية المخاطر. |    2    |   D   |
| 2.2.4 | تحقق من أن المدخلات المشبوهة العدائية محصورة، ومسجلة مع الحمولة الكاملة (بعد إزالة البيانات الشخصية التعريفية).                                                                  |    2    |   V   |
| 2.2.5 | تحقق من تتبع مقاييس المتانة (معدل نجاح مجموعات الهجمات المعروفة) مع مرور الوقت وأن التراجعات تؤدي إلى حظر الإصدار.                                                               |    3    |  D/V  |

---

## C2.3 التحقق من المخطط، النوع والطول

يمكن أن تتسبب هجمات الذكاء الاصطناعي التي تحتوي على مدخلات مشوهة أو كبيرة الحجم في أخطاء في التحليل، وتسرب الأوامر عبر الحقول، واستنزاف الموارد. كما أن فرض الالتزام الصارم بالمخطط هو أيضًا شرط أساسي عند تنفيذ استدعاءات الأدوات الحتمية.

|   #   | الوصف                                                                                                                                                                        | المستوى | الدور |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.3.1 | تحقق من أن كل نقطة نهاية لاستدعاء API أو دالة تحدد مخطط إدخال صريح (JSON Schema أو Protobuf أو ما يعادلها متعدد الوسائط) وأنه يتم التحقق من صحة المدخلات قبل تجميع المطالبة. |    1    |   D   |
| 2.3.2 | تحقق من أن الإدخالات التي تتجاوز الحد الأقصى لعدد الرموز أو البايتات ترفض بخطأ آمن ولا يتم قطعها بصمت أبدًا.                                                                 |    1    |  D/V  |
| 2.3.3 | تحقق من أن فحوصات النوع (مثل النطاقات الرقمية، قيم التعداد، أنواع MIME للصور/الصوت) تُطبق على الجانب الخادمي، وليس فقط في كود العميل.                                        |    2    |  D/V  |
| 2.3.4 | تحقق من أن المصادقين الدلاليين (مثل JSON Schema) يعملون في وقت ثابت لمنع هجمات حجب الخدمة الخوارزمية.                                                                        |    2    |   D   |
| 2.3.5 | تحقق من تسجيل حالات فشل التحقق مع مقاطع بيانات محذوفة ورموز خطأ واضحة لتسهيل تصنيف الأمن.                                                                                    |    3    |   V   |

---

## C2.4 فحص المحتوى والسياسة

يجب أن يتمكن المطورون من اكتشاف المطالبات الصحيحة نحويًا التي تطلب محتوى غير مسموح به (مثل التعليمات غير المشروعة، خطاب الكراهية، والنصوص المحمية بحقوق الطبع والنشر) ثم منعها من الانتشار.

|   #   | الوصف                                                                                                                                                                                   | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.4.1 | تحقق من أن يصنّف مصنف المحتوى (صفر إطلاق أو مُدرب بدقة) كل إدخال من حيث العنف، وإيذاء الذات، والكراهية، والمحتوى الجنسي، والطلبات غير القانونية، مع إمكانية ضبط الحدود القابلة للتكوين. |    1    |   D   |
| 2.4.2 | تحقق من أن المدخلات التي تنتهك السياسات ستتلقى رفضات موحدة أو إتمامات آمنة بحيث لا تنتقل إلى استدعاءات النماذج اللغوية الكبيرة اللاحقة.                                                 |    1    |  D/V  |
| 2.4.3 | تحقق من أن نموذج الفحص أو مجموعة القواعد يتم إعادة تدريبه/تحديثه على الأقل كل ثلاثة أشهر، مع دمج أنماط الاختراق أو تجاوز السياسات الجديدة التي تم ملاحظتها.                             |    2    |   D   |
| 2.4.4 | تحقق من أن الفحص يحترم السياسات الخاصة بالمستخدم (العمر، القيود القانونية الإقليمية) عبر قواعد قائمة على السمات تُحل في وقت الطلب.                                                      |    2    |   D   |
| 2.4.5 | تحقق من أن سجلات الفرز تشمل درجات ثقة المصنف وعلامات فئة السياسة من أجل الترابط مع SOC وإعادة تشغيل فريق الاختبار الأحمر في المستقبل.                                                   |    3    |   V   |

---

## C2.5 تحديد معدل الإدخال ومنع الإساءة

يجب على المطورين منع سوء الاستخدام، واستنزاف الموارد، والهجمات الآلية ضد أنظمة الذكاء الاصطناعي من خلال تحديد معدلات الإدخال واكتشاف أنماط الاستخدام الشاذة.

|   #   | الوصف                                                                                                                     | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.5.1 | تحقق من تطبيق حدود المعدل لكل مستخدم، ولكل عنوان IP، ولكل مفتاح API لجميع نقاط النهاية الخاصة بالإدخال.                   |    1    |  D/V  |
| 2.5.2 | تحقق من ضبط حدود المعدل اللحظي والمستمر لمنع هجمات إنكار الخدمة (DoS) وهجمات القوة العمياء (brute force).                 |    2    |  D/V  |
| 2.5.3 | تحقق من أن أنماط الاستخدام الشاذة (مثل الطلبات السريعة المتتابعة، فيضان الإدخال) تؤدي إلى تفعيل الحظر الآلي أو التصعيدات. |    2    |  D/V  |
| 2.5.4 | تحقق من حفظ سجلات منع الإساءة ومراجعتها للكشف عن أنماط الهجوم الناشئة.                                                    |    3    |   V   |

---

## C2.6 التحقق من صحة المدخلات متعددة الوسائط

يجب أن تتضمن أنظمة الذكاء الاصطناعي تحققاً قوياً للمدخلات غير النصية (كالصور، والصوت، والملفات) لمنع الحقن، والتملص، أو إساءة استخدام الموارد.

|   #   | الوصف                                                                                                                        | المستوى | الدور |
| :---: | ---------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.6.1 | تحقق من أن جميع الإدخالات غير النصية (الصور، الصوت، الملفات) يتم التحقق من صحتها من حيث النوع، والحجم، والصيغة قبل المعالجة. |    1    |   D   |
| 2.6.2 | تحقق من فحص الملفات بحثًا عن البرمجيات الخبيثة والحمولات الإخفائية قبل الإدخال.                                              |    2    |  D/V  |
| 2.6.3 | تحقق من أن مدخلات الصور/الصوت يتم فحصها للتحقق من وجود اضطرابات معادية أو أنماط هجوم معروفة.                                 |    2    |  D/V  |
| 2.6.4 | تحقق من أن فشل التحقق من صحة الإدخال متعدد الوسائط يتم تسجيله ويؤدي إلى إصدار تنبيهات للتحقيق.                               |    3    |   V   |

---

## C2.7 مصدر المدخلات ونسبتها

يجب أن تدعم أنظمة الذكاء الاصطناعي التدقيق، وتتبع الانتهاكات، والامتثال من خلال مراقبة وتوسيم مصادر جميع مدخلات المستخدم.

|   #   | الوصف                                                                                                                               | المستوى | الدور |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.7.1 | تحقق من أن جميع مدخلات المستخدمين مُعلَّمة بالبيانات الوصفية (معرّف المستخدم، الجلسة، المصدر، الطابع الزمني، عنوان IP) عند الإدخال. |    1    |  D/V  |
| 2.7.2 | تحقق من أن بيانات الأصول (provenance metadata) محفوظة وقابلة للتدقيق لجميع المدخلات المعالجة.                                       |    2    |  D/V  |
| 2.7.3 | تحقق من أن مصادر الإدخال الشاذة أو غير الموثوقة يتم تمييزها وتخضع لفحص مشدد أو للحظر.                                               |    2    |  D/V  |

---

## C2.8 الكشف التكيفي في الوقت الحقيقي عن التهديدات

يجب على المطورين استخدام أنظمة كشف التهديدات المتقدمة للذكاء الاصطناعي التي تتكيف مع أنماط الهجوم الجديدة وتوفر حماية في الوقت الحقيقي باستخدام مطابقة الأنماط المجمعة.

|   #   | الوصف                                                                                                                                                           | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.8.1 | تحقق من أن أنماط اكتشاف التهديدات تم تجميعها في محركات تعبيرات نمطية محسنة لتحقيق أداء عالي في التصفية الفورية مع تأثير زمني ضئيل.                              |    1    |  D/V  |
| 2.8.2 | تحقق من أن أنظمة كشف التهديدات تحتفظ بمكتبات نمطية منفصلة لفئات التهديد المختلفة (حقن الأوامر، المحتوى الضار، البيانات الحساسة، أوامر النظام).                  |    1    |  D/V  |
| 2.8.3 | تحقق من أن الكشف التهديدي التكيفي يدمج نماذج تعلم الآلة التي تحدّث حساسية التهديد بناءً على تكرار الهجوم ومعدلات النجاح.                                        |    2    |  D/V  |
| 2.8.4 | تحقق من أن خلاصات استخبارات التهديدات في الوقت الحقيقي تقوم بتحديث مكتبات الأنماط تلقائيًا بتوقيعات الهجوم الجديدة ومؤشرات الاختراق (IOCs).                     |    2    |  D/V  |
| 2.8.5 | تحقق من أن معدلات الإيجابيات الكاذبة في كشف التهديدات تتم مراقبتها باستمرار وأن خصوصية الأنماط يتم تعديلها تلقائيًا لتقليل التداخل مع حالات الاستخدام المشروعة. |    3    |  D/V  |
| 2.8.6 | تحقق من أن تحليل التهديد السياقي يأخذ في الاعتبار مصدر الإدخال، وأنماط سلوك المستخدم، وتاريخ الجلسة لتحسين دقة الكشف.                                           |    3    |  D/V  |
| 2.8.7 | تحقق من أن مقاييس أداء الكشف عن التهديدات (معدل الكشف، زمن استجابة المعالجة، استخدام الموارد) يتم مراقبتها وتحسينها في الوقت الحقيقي.                           |    3    |  D/V  |

---

## C2.9 خط أنابيب التحقق الأمني متعدد الوسائط

يجب على المطورين توفير التحقق الأمني لنصوص، وصور، وصوت، وأنواع أخرى من وسائط الإدخال الخاصة بالذكاء الاصطناعي مع أنواع محددة من كشف التهديدات وعزل الموارد.

|   #   | الوصف                                                                                                                                                                                                    | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 2.9.1 | تحقق من أن كل وسيلة إدخال لها مدققات أمان مخصصة مع أنماط تهديد موثقة (النص: حقن المطالبات، الصور: الإخفاء داخل الصور، الصوت: هجمات الطيف الصوتي) وعتبات اكتشاف.                                          |    1    |  D/V  |
| 2.9.2 | تحقق من معالجة المدخلات متعددة الوسائط في بيئات معزولة (sandboxes) مع حدود موارد محددة (الذاكرة، وحدة المعالجة المركزية، وقت المعالجة) خاصة بكل نوع من أنواع الوسائط وموثقة في سياسات الأمان.            |    2    |  D/V  |
| 2.9.3 | تحقق من أن اكتشاف الهجمات متعددة الوسائط يحدد الهجمات المنسقة التي تمتد عبر أنواع إدخال متعددة (مثل الحمولات الإخفائية في الصور مجتمعة مع حقن الأوامر في النص) باستخدام قواعد الارتباط وتوليد التنبيهات. |    2    |  D/V  |
| 2.9.4 | تأكد من أن إخفاقات التحقق متعددة الوسائط تؤدي إلى تسجيل مفصل يتضمن جميع أنماط الإدخال، نتائج التحقق، درجات التهديد، وتحليل الارتباط باستخدام تنسيقات سجلات منظمة لتكامل SIEM.                            |    3    |  D/V  |
| 2.9.5 | تحقق من تحديث مصنفات المحتوى الخاصة بكل نمط وسائط وفقًا للجداول الموثقة (على الأقل ربع سنويًا) بحيث تحتوي على أنماط تهديد جديدة، وأمثلة عدائية، ومعايير أداء تُحافظ على مستوياتها فوق الحدود الأساسية.   |    3    |  D/V  |

---

## المراجع

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)


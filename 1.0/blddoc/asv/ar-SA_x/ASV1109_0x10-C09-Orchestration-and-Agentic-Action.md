# 9 الأتمتة المستقلة والفعل الوكالي للأمن

## هدف التحكم

تأكد من أن أنظمة الذكاء الاصطناعي المستقلة أو متعددة العوامل يمكنها تنفيذ الإجراءات فقط التي تكون مقصودة صراحة، ومصادق عليها، وقابلة للتدقيق، وضمن حدود التكلفة والمخاطر المحددة. هذا يحمي من التهديدات مثل اختراق النظام المستقل، سوء استخدام الأدوات، اكتشاف حلقة الوكيل، اختطاف الاتصال، انتحال الهوية، تلاعب السرب، وتلاعب النوايا.

---

## 9.1 ميزانيات تخطيط مهام الوكيل والتكرار

قم بتقييد الخطط المتكررة وفرض نقاط تفتيش بشرية للإجراءات المميزة.

|   #   | الوصف                                                                                                                                                                      | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.1.1 | تحقق من أن الحد الأقصى لعمق الاستدعاء التكراري، والعرض، ووقت الساعة الحائطية، وعدد الرموز، والتكلفة المالية لكل تنفيذ وكيل تتم تكوينها مركزيًا وتحت السيطرة على الإصدارات. |    1    |  D/V  |
| 9.1.2 | تحقق من أن الإجراءات المميزة أو التي لا يمكن التراجع عنها (مثل التزامن الرمزي، التحويلات المالية) تتطلب موافقة بشرية صريحة عبر قناة يمكن تدقيقها قبل التنفيذ.              |    1    |  D/V  |
| 9.1.3 | تحقق من أن مراقبات الموارد في الوقت الفعلي تقوم بإيقاف تشغيل الدائرة عند تجاوز أي حد للميزانية، مما يوقف توسيع المهام الإضافية.                                            |    2    |   D   |
| 9.1.4 | تأكد من تسجيل أحداث قاطع الدائرة باستخدام معرف الوكيل، وحالة الإحداث التي تسببت في التشغيل، وحالة الخطة الملتقطة للمراجعة الجنائية.                                        |    2    |  D/V  |
| 9.1.5 | تحقق من أن اختبارات الأمان تغطي سيناريوهات نفاد الميزانية وخروج الخطة عن السيطرة، مع التأكيد على الإيقاف الآمن دون فقدان البيانات.                                         |    3    |   V   |
| 9.1.6 | تأكد من أن سياسات الميزانية معبر عنها كسياسات-كود ومطبقة في CI/CD لمنع انحراف التكوين.                                                                                     |    3    |   D   |

---

## 9.2 عزل الإضافات للأدوات

عزل تفاعلات الأدوات لمنع الوصول غير المصرح به إلى النظام أو تنفيذ الأكواد.

|   #   | الوصف                                                                                                                                                             | المستوى | الدور |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.2.1 | تحقق من أن كل أداة/إضافة تنفيذية تعمل داخل نظام تشغيل، أو حاوية، أو حاوية على مستوى WASM مع سياسات أقل امتيازًا لنظام الملفات، والشبكة، واستدعاءات النظام.        |    1    |  D/V  |
| 9.2.2 | تحقق من أن حصص موارد البيئة المعزولة (وحدة المعالجة المركزية، الذاكرة، القرص، تصريف الشبكة) وحدود وقت التنفيذ مفروضة ومسجلة.                                      |    1    |  D/V  |
| 9.2.3 | تحقق من أن الملفات التنفيذية أو الموصفات الخاصة بالأداة مُوقعة رقمياً؛ يتم التحقق من صحة التوقيعات قبل التحميل.                                                   |    2    |  D/V  |
| 9.2.4 | تحقق من أن بيانات القياس عن بعد لصندوق الحماية تتدفق إلى نظام إدارة معلومات وأحداث الأمن (SIEM)؛ حيث ترفع الحالات الشاذة (مثل محاولات الاتصالات الصادرة) تنبيهات. |    2    |   V   |
| 9.2.5 | تحقق من أن الإضافات عالية الخطورة تخضع لمراجعة أمنية واختبار اختراق قبل النشر في بيئة الإنتاج.                                                                    |    3    |   V   |
| 9.2.6 | تأكد من أن محاولات الهروب من الحماية المعزولة تُمنع تلقائيًا وأن الإضافة المخالفة تُعزل قيد التحقيق.                                                              |    3    |  D/V  |

---

## 9.3 الحلقة الذاتية والحد من التكلفة

اكتشف وأوقف التكرار غير المسيطر عليه بين الوكلاء وتفجر التكاليف.

|   #   | الوصف                                                                                                           | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.3.1 | تحقق من أن مكالمات الوكلاء البينيين تشمل حد انتقال أو زمن حياة (TTL) تقوم بيئة التشغيل بتنقيصه وفرضه.           |    1    |  D/V  |
| 9.3.2 | تحقق من أن الوكلاء يحتفظون بمعرف فريد لمخطط الاستدعاء لاكتشاف الاستدعاء الذاتي أو الأنماط الدورية.              |    2    |   D   |
| 9.3.3 | تحقق من أن عدادات وحدات الحوسبة التراكمية والإنفاق يتم تتبعها لكل سلسلة طلب؛ تجاوز الحد يؤدي إلى إجهاض السلسلة. |    2    |  D/V  |
| 9.3.4 | تحقق من أن التحليل الرسمي أو التحقق من النموذج يبرهنان عدم وجود تكرار غير محدود في بروتوكولات الوكيل.           |    3    |   V   |
| 9.3.5 | تحقق من أن أحداث إيقاف الحلقة تولد تنبيهات وتغذي مقاييس التحسين المستمر.                                        |    3    |   D   |

---

## 9.4 حماية من سوء الاستخدام على مستوى البروتوكول

قنوات الاتصال الآمنة بين الوكلاء والأنظمة الخارجية لمنع الاختراق أو التلاعب.

|   #   | الوصف                                                                                                                                         | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.4.1 | تأكد من أن جميع الرسائل بين الوكيل والأداة وبين الوكلاء يتم التحقق من صحتها (على سبيل المثال، TLS المتبادل أو JWT) ومشفرة من الطرف إلى الطرف. |    1    |  D/V  |
| 9.4.2 | تحقق من أن المخططات مُحققة بدقة؛ يتم رفض الحقول غير المعروفة أو الرسائل المشوهة.                                                              |    1    |   D   |
| 9.4.3 | تحقق من أن فحوصات السلامة (MACs أو التوقيعات الرقمية) تغطي الحمولة الكاملة للرسالة بما في ذلك معلمات الأداة.                                  |    2    |  D/V  |
| 9.4.4 | تحقق من فرض حماية إعادة التشغيل (الأعداد الفردية أو نوافذ الطابع الزمني) على طبقة البروتوكول.                                                 |    2    |   D   |
| 9.4.5 | تحقق من أن تطبيقات البروتوكول تخضع لاختبار الفزعة والتحليل الساكن للكشف عن ثغرات الحقن أو التسلسل العكسي.                                     |    3    |   V   |

---

## 9.5 هوية الوكيل وإثبات التلاعب

تأكد من أن تكون الأفعال قابلة للنسب وأن التعديلات قابلة للكشف.

|   #   | الوصف                                                                                        | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.5.1 | تحقق من أن كل نسخة من الوكيل تمتلك هوية تشفير فريدة (زوج مفاتيح أو اعتماد متجذر في الأجهزة). |    1    |  D/V  |
| 9.5.2 | تحقق من أن جميع إجراءات الوكيل موقعة ومزمنة؛ وأن السجلات تتضمن التوقيع لضمان عدم التنصل.     |    2    |  D/V  |
| 9.5.3 | تحقق من أن السجلات المقاومة للتلاعب مخزنة في وسط قابل للإضافة فقط أو يُكتب مرة واحدة فقط.    |    2    |   V   |
| 9.5.4 | تحقق من أن مفاتيح الهوية تدور وفقًا لجدول محدد وعند وجود مؤشرات اختراق.                      |    3    |   D   |
| 9.5.5 | تحقق من أن محاولات التزييف أو تعارض المفتاح تؤدي إلى وضع الوكيل المتأثر في حجر صحي فوري.     |    3    |  D/V  |

---

## 9.6 تقليل المخاطر في سرب العوامل المتعددة

تخفيف مخاطر السلوك الجماعي من خلال العزل ونمذجة السلامة الرسمية.

|   #   | الوصف                                                                                                                             | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.6.1 | تحقق من أن الوكلاء العاملين في مجالات أمان مختلفة ينفذون داخل صناديق رمل تشغيل معزولة أو مقاطع شبكية منفصلة.                      |    1    |  D/V  |
| 9.6.2 | تحقق من أن سلوكيات السرب تم نمذجتها والتحقق منها رسميًا من حيث الحيوية والسلامة قبل النشر.                                        |    3    |   V   |
| 9.6.3 | تحقق من أن مراقبات وقت التشغيل تكتشف الأنماط غير الآمنة الناشئة (مثل التذبذبات، حالات الجمود) وتبدأ في اتخاذ الإجراءات التصحيحية. |    3    |   D   |

---

## 9.7 المصادقة / التفويض للمستخدم والأداة

قم بتنفيذ ضوابط وصول قوية لكل إجراء يتم تفعيله بواسطة الوكيل.

|   #   | الوصف                                                                                                                                             | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.7.1 | تحقق من أن الوكلاء يقومون بالمصادقة كجهات رئيسية من الدرجة الأولى على الأنظمة التابعة، مع عدم إعادة استخدام بيانات اعتماد المستخدم النهائي أبدًا. |    1    |  D/V  |
| 9.7.2 | تحقق من أن سياسات التفويض الدقيقة تقيد الأدوات التي يمكن للوكيل استدعاؤها والمعلمات التي يمكنه توفيرها.                                           |    2    |   D   |
| 9.7.3 | تحقق من إعادة تقييم فحوصات الامتياز في كل استدعاء (الترخيص المستمر)، وليس فقط عند بدء الجلسة.                                                     |    2    |   V   |
| 9.7.4 | تحقق من أن الامتيازات المفوضة تنتهي صلاحيتها تلقائيًا وتتطلب إعادة الموافقة بعد انتهاء المهلة أو تغيير النطاق.                                    |    3    |   D   |

---

## 9.8 أمان التواصل بين الوكلاء

تشفير وحماية تكامل جميع الرسائل بين الوكلاء لمنع التنصت والتلاعب.

|   #   | الوصف                                                                                                              | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 9.8.1 | تحقق من أن التوثيق المتبادل والتشفير ذي السرية التامة للأمام (مثل TLS 1.3) إلزاميان لقنوات الوكيل.                 |    1    |  D/V  |
| 9.8.2 | تحقق من أن سلامة الرسالة وأصلها تم التحقق منهما قبل المعالجة؛ حيث تؤدي الإخفاقات إلى إطلاق التنبيهات وحذف الرسالة. |    1    |   D   |
| 9.8.3 | تحقق من تسجيل بيانات تعريف الاتصال (الطوابع الزمنية، أرقام التسلسل) لدعم إعادة البناء الجنائي.                     |    2    |  D/V  |
| 9.8.4 | تحقق من أن التحقق الرسمي أو فحص النماذج يؤكد أن آلات حالات البروتوكول لا يمكن أن تدخل في حالات غير آمنة.           |    3    |   V   |

---

## 9.9 التحقق من النية وفرض القيود

تحقق من أن إجراءات الوكيل تتماشى مع نية المستخدم المعلنة وقيود النظام.

|   #   | الوصف                                                                                                                                             | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.9.1 | تحقق من أن محللات القيود قبل التنفيذ تقوم بفحص الإجراءات المقترحة مقابل قواعد السلامة والسياسة المبرمجة مسبقًا.                                   |    1    |   D   |
| 9.9.2 | تحقق من أن الإجراءات ذات التأثير العالي (المالية، التدميرية، الحساسة للخصوصية) تتطلب تأكيد نية صريح من المستخدم المُبادر.                         |    2    |  D/V  |
| 9.9.3 | تحقق من أن فحوصات الحالة بعد التنفيذ تتحقق من أن الإجراءات المكتملة حققت التأثيرات المقصودة دون آثار جانبية؛ أي تباينات تؤدي إلى استدعاء التراجع. |    2    |   V   |
| 9.9.4 | تحقق من أن الطرق الرسمية (مثل التحقق بالنماذج، إثبات النظريات) أو الاختبارات القائمة على الخصائص تُظهر أن خطط الوكيل تفي بجميع القيود المعلنة.    |    3    |   V   |
| 9.9.5 | تحقق من أن حوادث تعارض النية أو انتهاك القيود تغذي دورات التحسين المستمر ومشاركة استخبارات التهديدات.                                             |    3    |   D   |

---

## 9.10 استراتيجية تأمين استدلال العميل

الاختيار الآمن وتنفيذ استراتيجيات التفكير المختلفة بما في ذلك نهج ReAct وChain-of-Thought وTree-of-Thoughts.

|   #    | الوصف                                                                                                                                                                       | المستوى | الدور |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.10.1 | تحقق من أن اختيار استراتيجية الاستدلال يستخدم معايير حتمية (تعقيد الإدخال، نوع المهمة، سياق الأمان) وأن نفس المدخلات تولد اختيارات استراتيجية متطابقة داخل نفس سياق الأمان. |    1    |  D/V  |
| 9.10.2 | تحقق من أن كل استراتيجية استدلال (ReAct، سلسلة الأفكار، شجرة الأفكار) تحتوي على تحقق مخصص من صحة الإدخال، وتنقية مخرجات، وحدود زمن تنفيذ محددة تتناسب مع نهجها المعرفي.     |    1    |  D/V  |
| 9.10.3 | تحقق من أن انتقالات استراتيجية التفكير يتم تسجيلها مع السياق الكامل بما في ذلك خصائص الإدخال، وقيم معايير الاختيار، وبيانات تنفيذ العمليات من أجل إعادة بناء سجل التدقيق.   |    2    |  D/V  |
| 9.10.4 | تحقق من أن استدلال شجرة الأفكار يتضمن آليات تقليم الفروع التي تنهي الاستكشاف عند اكتشاف انتهاكات السياسة أو حدود الموارد أو حدود السلامة.                                   |    2    |  D/V  |
| 9.10.5 | تحقق من أن دورات ReAct (التفكير - التنفيذ - المراقبة) تشمل نقاط تحقق للمعاينة في كل مرحلة: التحقق من خطوة التفكير، تفويض التنفيذ، وتنقية الملاحظة قبل المتابعة.             |    2    |  D/V  |
| 9.10.6 | تحقق من رصد مؤشرات أداء استراتيجية الاستدلال (زمن التنفيذ، استخدام الموارد، جودة المخرجات) مع وجود تنبيهات آلية عند انحراف المؤشرات عن الحدود المُكوّنة.                    |    3    |  D/V  |
| 9.10.7 | تحقق من أننهج الاستدلال الهجينة التي تجمع بين استراتيجيات متعددة تحافظ على التحقق من صحة المدخلات وقيود المخرجات لجميع الاستراتيجيات المكونة دون تجاوز أي من ضوابط الأمان.  |    3    |  D/V  |
| 9.10.8 | تحقق من أن اختبار أمان استراتيجية التفكير يشمل التهريج باستخدام مدخلات مشوهة، والمطالبات المعادية المصممة لإجبار تبديل الاستراتيجية، واختبار حالات الحدود لكل نهج معرفي.    |    3    |  D/V  |

---

## إدارة حالة دورة حياة الوكيل والأمان 9.11

تهيئة الوكيل الآمن، وتحولات الحالة، وإنهاء العمل مع مسارات تدقيق مشفرة وإجراءات استرداد محددة.

|   #    | الوصف                                                                                                                                                                                                            | المستوى | الدور |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.11.1 | تحقق من أن تهيئة الوكيل تشمل إنشاء هوية تشفيرية باستخدام بيانات اعتماد مدعومة بالأجهزة وسجلات تدقيق بدء تشغيل غير قابلة للتغيير تحتوي على معرف الوكيل، والطابع الزمني، وهاش التهيئة، ومعلمات التهيئة.            |    1    |  D/V  |
| 9.11.2 | تحقق من أن تحولات حالة الوكيل موقعة تشفيرياً، ومؤرخة زمنياً، ومسجلة مع السياق الكامل بما في ذلك الأحداث المحفزة، وهاش الحالة السابقة، وهاش الحالة الجديدة، والتحققات الأمنية التي تم تنفيذها.                    |    2    |  D/V  |
| 9.11.3 | تحقق من أن إجراءات إيقاف تشغيل الوكيل تشمل مسح الذاكرة بشكل آمن باستخدام المحو التشفيري أو الكتابة متعددة المرور، وإلغاء صلاحيات الاعتماد مع إشعار سلطة الشهادات، وتوليد شهادات إنهاء مقاومة للتلاعب.            |    2    |  D/V  |
| 9.11.4 | تحقق من أن آليات استعادة الوكيل تقوم بالتحقق من سلامة الحالة باستخدام مجموعات تدقيق تشفيرية (بحد أدنى SHA-256) والتراجع إلى حالات معروفة وجيدة عند اكتشاف الفساد، مع وجود تنبيهات تلقائية ومتطلبات موافقة يدوية. |    3    |  D/V  |
| 9.11.5 | تحقق من أن آليات استمرارية الوكيل تقوم بتشفير بيانات الحالة الحساسة باستخدام مفاتيح AES-256 مخصصة لكل وكيل وتنفذ تدوير مفاتيح آمن وفق جداول قابلة للتهيئة (بحد أقصى 90 يومًا) مع نشر بدون توقف.                  |    3    |  D/V  |

---

## 9.12 إطار عمل أمان تكامل الأدوات

ضوابط الأمان للتحميل الديناميكي للأدوات، والتنفيذ، والتحقق من النتائج مع عمليات تقييم المخاطر والموافقة المعرفة.

|   #    | الوصف                                                                                                                                                                                                                                          | المستوى | الدور |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.12.1 | تحقق من أن أوصاف الأدوات تتضمن بيانات وصفية أمنية تحدد الامتيازات المطلوبة (قراءة/كتابة/تنفيذ)، ومستويات المخاطر (منخفض/متوسط/مرتفع)، وحدود الموارد (وحدة المعالجة المركزية، الذاكرة، الشبكة)، ومتطلبات التحقق الموثقة في ملفات تعريف الأدوات. |    1    |  D/V  |
| 9.12.2 | تحقق من أن نتائج تنفيذ الأداة تم التحقق من صحتها مقابل المخططات المتوقعة (مخطط JSON، مخطط XML) وسياسات الأمان (تنقية المخرجات، تصنيف البيانات) قبل التكامل مع حدود المهلة وإجراءات التعامل مع الأخطاء.                                         |    1    |  D/V  |
| 9.12.3 | تحقق من أن سجلات تفاعلات الأدوات تتضمن سياق أمني مفصل يشمل استخدام الصلاحيات، أنماط الوصول إلى البيانات، وقت التنفيذ، استهلاك الموارد، وأكواد الإرجاع مع تسجيل منظم لدمجها مع أنظمة إدارة أحداث الأمان والمعلومات (SIEM).                      |    2    |  D/V  |
| 9.12.4 | تحقق من أن آليات تحميل الأدوات الديناميكية تقوم بالتحقق من صحة التوقيعات الرقمية باستخدام بنية المفتاح العام (PKI) وتطبق بروتوكولات تحميل آمنة مع عزل الحاوية (sandbox) والتحقق من الأذونات قبل التنفيذ.                                       |    2    |  D/V  |
| 9.12.5 | تحقق من أن تقييمات أمان الأدوات تُفعّل تلقائيًا للإصدارات الجديدة مع بوابات موافقة إلزامية تشمل التحليل الساكن، الاختبار الديناميكي، ومراجعة فريق الأمان مع وجود معايير موافقة موثقة ومتطلبات اتفاقية مستوى الخدمة (SLA).                      |    3    |  D/V  |

---

### المراجع

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)


# 9 الأمن المتعلق بالتنسيق المستقل وتصرفات الوكيل

## هدف الرقابة

تأكد من أن أنظمة الذكاء الاصطناعي المستقلة أو متعددة الوكلاء يمكنها تنفيذ الإجراءات فقط إذا كانت مقصودة صراحة وموثقة وقابلة للمراجعة وتحت حدود التكلفة والمخاطر المحدودة. هذا يحمي من تهديدات مثل اختراق النظام المستقل، سوء استخدام الأدوات، كشف حلقة الوكلاء، اختطاف الاتصالات، انتحال الهوية، التلاعب بسرب الوكلاء، والتلاعب بالنوايا.

---

## 9.1 وكيل-تخطيط المهام وميزانيات الاستدعاء الذاتي

إبطاء التخطيط التكراري وفرض نقاط مراجعة بشرية للإجراءات ذات الامتياز.

|   #   | الوصف                                                                                                                                                             | المستوى | الدور |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.1.1 | تحقق من أن أقصى عمق للتكرار، وعرض البحث، والزمن الحقيقي، والتوكنات، والتكلفة المالية لكل تنفيذ للوكيل، مهيأة مركزيًا وتخضع لإدارة الإصدارات.                      |    1    |  D/V  |
| 9.1.2 | تحقق من أن الإجراءات ذات الامتياز أو غير القابلة للإلغاء تتطلب موافقة بشرية صريحة عبر قناة قابلة للتدقيق قبل التنفيذ، مثل الالتزامات البرمجية والتحويلات المالية. |    1    |  D/V  |
| 9.1.3 | تحقق من أن مراقبات الموارد في الوقت الفعلي تفعّل انقطاع قاطع الدائرة عند تجاوز أي عتبة للميزانية، مما يوقف توسع المهام اللاحقة.                                   |    2    |   D   |
| 9.1.4 | تحقق من تسجيل أحداث قاطع الدائرة مع معرّف الوكيل، والشرط المحفّز، وحالة الخطة الملتقطة للمراجعة الجنائية.                                                         |    2    |  D/V  |
| 9.1.5 | تحقق من أن اختبارات الأمان تغطي سيناريوهات استنزاف الميزانية وخطة خارج السيطرة، مع تأكيد الإيقاف الآمن دون فقدان البيانات.                                        |    3    |   V   |
| 9.1.6 | تحقق من أن سياسات الميزانية مُعبر عنها كسياسة-as-code ومطبقة في CI/CD لمنع انحراف التكوين.                                                                        |    3    |   D   |

---

## 9.2 عزل الإضافة البرمجية للأداة في صندوق الرمل

عزل تفاعلات الأدوات لمنع الوصول غير المصرح به إلى النظام أو تنفيذ الشفرة.

|   #   | الوصف                                                                                                                                       | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.2.1 | تحقق من أن كل أداة أو إضافة تعمل داخل sandbox على مستوى OS أو حاوية أو WASM مع سياسات أقل امتيازاً لنظام الملفات والشبكة واستدعاءات النظام. |    1    |  D/V  |
| 9.2.2 | تحقق من أن حصص موارد صندوق الرمل (CPU، الذاكرة، القرص، حركة مرور الشبكة الصادرة) ومهل انتهاء التنفيذ مطبقة ومسجلة.                          |    1    |  D/V  |
| 9.2.3 | تحقق من أن ثنائيات الأدوات أو أوصافها الرقمية موقَّعة توقيعاً رقمياً؛ يتم التحقق من التوقيعات قبل التحميل.                                  |    2    |  D/V  |
| 9.2.4 | تحقق من أن تدفقات بيانات القياس عن بُعد من صندوق الرمل إلى SIEM؛ شذوذات (على سبيل المثال، محاولات اتصالات صادرة) تثير الإنذارات.            |    2    |   V   |
| 9.2.5 | تحقق من أن الإضافات عالية المخاطر تخضع لمراجعة أمنية واختبار اختراق قبل النشر في بيئة الإنتاج.                                              |    3    |   V   |
| 9.2.6 | تحقق من أن محاولات الهروب من صندوق الرمل تُحجب تلقائياً، وأن الإضافة المخالفة مُعزَلة في انتظار التحقيق.                                    |    3    |  D/V  |

---

## 9.3 حلقة مستقلة وحدود التكلفة

كشف وإيقاف التكرار غير المسيطر عليه بين الوكلاء وانفجارات التكاليف.

|   #   | الوصف                                                                                                                | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.3.1 | تحقق من أن النداءات بين الوكلاء تتضمن حد قفز أو TTL يقوم وقت التشغيل بخفضه وتطبيقه.                                  |    1    |  D/V  |
| 9.3.2 | تحقق من أن الوكلاء يحافظون على معرف فريد لمخطط الاستدعاء لاكتشاف الاستدعاء الذاتي أو أنماط دورية.                    |    2    |   D   |
| 9.3.3 | تحقق من أن وحدات الحوسبة المتراكمة وعدادات الإنفاق تُتبع لكل سلسلة من الطلبات؛ فـ تجاوز الحد يؤدي إلى إيقاف السلسلة. |    2    |  D/V  |
| 9.3.4 | تحقق من أن التحليل الرسمي أو فحص النماذج يُظهر غياب التكرار غير المحدود في بروتوكولات الوكلاء.                       |    3    |   V   |
| 9.3.5 | تحقق من أن أحداث إيقاف الحلقة تولّد تنبيهات وتغذي مقاييس التحسين المستمر.                                            |    3    |   D   |

---

## 9.4 الحماية من إساءة الاستخدام على مستوى البروتوكول

قنوات اتصال آمنة بين الوكلاء والأنظمة الخارجية لمنع الاختطاف أو التلاعب.

|   #   | الوصف                                                                                                                              | المستوى | الدور |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.4.1 | تحقق من أن جميع رسائل الوكيل-إلى-الأداة ورسائل الوكيل-إلى-الوكيل مُوثَّقة (مثلاً TLS المتبادل أو JWT) ومشفَّرة من الطرف إلى الطرف. |    1    |  D/V  |
| 9.4.2 | تحقق من صحة المخططات بشكل صارم، وتُرفض الحقول غير المعروفة والرسائل ذات البنية الخاطئة.                                            |    1    |   D   |
| 9.4.3 | تحقق من أن فحوصات التكامل (MACs أو التوقيعات الرقمية) تغطي الحمولة الكلية للرسالة بما في ذلك معلمات الأداة.                        |    2    |  D/V  |
| 9.4.4 | تحقق من تطبيق حماية ضد إعادة الإرسال في طبقة البروتوكول (أرقام عشوائية أحادية الاستخدام أو نوافذ الطابع الزمني).                   |    2    |   D   |
| 9.4.5 | تحقق من أن تنفيذات البروتوكولات تخضع للاختبار العشوائي والتحليل الثابت للكشف عن ثغرات الحقن أو فك التسلسل.                         |    3    |   V   |

---

## 9.5 هوية الوكيل وإثبات العبث

تأكد من أن الإجراءات منسوبة إلى فاعليها وأن التغييرات قابلة للكشف.

|   #   | الوصف                                                                                                  | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 9.5.1 | تحقق من أن كل مثيل وكيل يمتلك هوية تشفيرية فريدة (زوج مفاتيح أو اعتماد عتادي).                         |    1    |  D/V  |
| 9.5.2 | تحقق من أن جميع إجراءات الوكلاء موقّعة ومؤرّخة بطابع زمني؛ وتتضمن السجلات التوقيعات لضمان عدم الإنكار. |    2    |  D/V  |
| 9.5.3 | تحقق من أن سجلات مقاومة العبث مُخزَّنة على وسيط قابل للإضافة فقط أو وسيط قابل للكتابة مرة واحدة.       |    2    |   V   |
| 9.5.4 | تحقق من أن مفاتيح الهوية تدور وفق جدول زمني محدد وعلى أساس مؤشرات الاختراق.                            |    3    |   D   |
| 9.5.5 | تحقق من أن محاولات انتحال الهوية أو تصادم المفاتيح تؤدي إلى عزل فوري للوكيل المتأثر.                   |    3    |  D/V  |

---

## 9.6 تقليل مخاطر سرب الوكلاء المتعددين

تقليل مخاطر السلوك الجماعي من خلال العزل والنمذجة الرسمية للسلامة.

|   #   | الوصف                                                                                                                         | المستوى | الدور |
| :---: | ----------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.6.1 | تحقق من أن الوكلاء الذين يعملون في مجالات أمان مختلفة ينفذون في بيئات صندوق الرمل المعزولة أثناء التشغيل أو في أقسام الشبكة.  |    1    |  D/V  |
| 9.6.2 | تحقق من أن سلوكيات القطيع مُنمذجة ومتحققة رسميًا للحيوية والسلامة قبل النشر.                                                  |    3    |   V   |
| 9.6.3 | تحقق من أن مراقبات وقت التشغيل تكشف عن أنماط غير آمنة ناشئة (مثلاً التذبذبات، انسدادات التزامنية) وتباشر باتخاذ إجراء تصحيحي. |    3    |   D   |

---

## 9.7 المصادقة للمستخدم والأداة / التفويض

طبق ضوابط وصول صارمة على كل إجراء يتم تشغيله بواسطة الوكيل.

|   #   | الوصف                                                                                                                             | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.7.1 | تحقق من أن الوكلاء يُصدّقون كجهات أصلية من المستوى الأول تجاه الأنظمة التابعة، ولا يعيدون استخدام بيانات اعتماد المستخدم النهائي. |    1    |  D/V  |
| 9.7.2 | تحقق من أن سياسات التفويض الدقيقة تقيد الأدوات التي يجوز للوكيل استدعاؤها والمعلمات التي يجوز له تزويدها.                         |    2    |   D   |
| 9.7.3 | تحقق من أن فحص الامتيازات يُعاد تقييمه في كل استدعاء (التفويض المستمر)، وليس فقط عند بدء الجلسة.                                  |    2    |   V   |
| 9.7.4 | تحقق من أن صلاحية الامتيازات المفوَّضة تنتهي تلقائيًا وتتطلب إعادة الموافقة بعد انتهاء المهلة أو عند تغيير النطاق.                |    3    |   D   |

---

## 9.8 أمن-التواصل بين الوكلاء

تشفير وحماية سلامة جميع رسائل الوكلاء المتبادلة لمنع التنصت والتلاعب.

|   #   | الوصف                                                                                                        | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 9.8.1 | المصادقة المتبادلة والتشفير ذو خصوصية أمامية مثالية (مثلاً TLS 1.3) أمورٌ إِلزامية لقنوات الوكلاء.           |    1    |  D/V  |
| 9.8.2 | تحقق من تكامل الرسالة ومصدرها قبل المعالجة؛ في حال الفشل، يتم إصدار تنبيهات وإسقاط الرسالة.                  |    1    |   D   |
| 9.8.3 | تحقق من أن بيانات تعريف الاتصالات (طوابع زمنية، أرقام تسلسلية) مُسجَّلة لدعم إعادة البناء الجنائي الرقمي.    |    2    |  D/V  |
| 9.8.4 | تحقق من أن التحقق الرسمي أو التحقق من النماذج يؤكد أن آلات حالة البروتوكول لا يمكن دفعها إلى حالات غير آمنة. |    3    |   V   |

---

## 9.9 التحقق من النية وإنفاذ القيود

تحقق من توافق إجراءات الوكيل مع نية المستخدم المعلنة والقيود النظامية.

|   #   | الوصف                                                                                                                                                     | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.9.1 | تحقق من أن محللات القيود قبل التنفيذ تفحص الإجراءات المقترحة ضد قواعد السلامة والسياسة المبرمجة مسبقاً.                                                   |    1    |   D   |
| 9.9.2 | تحقق من أن الإجراءات ذات التأثير العالي (مالية، تدميرية، حساسة للخصوصية) تتطلب تأكيد نية صريحة من المستخدم المبادر.                                       |    2    |  D/V  |
| 9.9.3 | تحقق من أن فحوص ما بعد الشرط تتحقق من أن الإجراءات المكتملة قد حققت التأثيرات المقصودة دون آثار جانبية؛ الاختلافات تؤدي إلى التراجع.                      |    2    |   V   |
| 9.9.4 | تحقق من أن الأساليب الرسمية (على سبيل المثال فحص النماذج، إثبات النظريات) أو الاختبارات القائمة على الخصائص تثبت أن خطط الوكلاء تفي بجميع القيود المعلنة. |    3    |   V   |
| 9.9.5 | تحقق من أن حالات عدم التطابق في النية أو انتهاك القيود تغذي دورات التحسين المستمر وتبادل معلومات استخبارات التهديد.                                       |    3    |   D   |

---

## 9.10 استراتيجية استدلال الوكيل والأمن

الاختيار والتنفيذ الآمن لاستراتيجيات التفكير المختلفة بما في ذلك ReAct و Chain-of-Thought و Tree-of-Thoughts.

|   #    | الوصف                                                                                                                                                                                   | المستوى | الدور |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.10.1 | تحقق من أن اختيار استراتيجية الاستدلال يستخدم معايير حتمية (تعقيد الإدخال، نوع المهمة، سياق الأمان)، وأن الإدخالات المتطابقة تُنتج اختيارات استراتيجية متطابقة ضمن نفس سياق الأمان.     |    1    |  D/V  |
| 9.10.2 | تحقق من أن كل استراتيجية استدلال (ReAct، Chain-of-Thought، Tree-of-Thoughts) لديها تحقق صحة الإدخال المخصص، وتنقية المخرجات المخصصة، وحدود زمن التنفيذ المخصصة تتوافق مع نهجها المعرفي. |    1    |  D/V  |
| 9.10.3 | تحقق من أن انتقالات استراتيجية الاستدلال مُسجَّلة مع سياق كامل بما في ذلك خصائص الإدخال وقيم معايير الاختيار وبيانات التنفيذ من أجل إعادة بناء سجل التدقيق.                             |    2    |  D/V  |
| 9.10.4 | تحقق من أن Tree-of-Thoughts يتضمن آليات تقليم الفروع التي تؤدي إلى إنهاء الاستكشاف عند اكتشاف انتهاكات السياسات أو قيود الموارد أو حدود السلامة.                                        |    2    |  D/V  |
| 9.10.5 | تحقق من أن دورات ReAct (Reason-Act-Observe) تتضمن نقاط فحص عند كل مرحلة: التحقق من خطوة الاستدلال، تصريح الإجراء، وتنقية الملاحظات قبل المتابعة.                                        |    2    |  D/V  |
| 9.10.6 | تحقق من أن مقاييس أداء استراتيجية الاستدلال (زمن التنفيذ، استهلاك الموارد، جودة الناتج) تُرصد تلقائيًا مع وجود تنبيهات آلية عند انحراف المقاييس عن العتبات المعتمدة.                    |    3    |  D/V  |
| 9.10.7 | تحقق من أن أساليب الاستدلال الهجينة التي تدمج عدة استراتيجيات تحافظ على التحقق من صحة المدخلات وقيود الإخراج لجميع الاستراتيجيات المكوّنة دون تجاوز أي ضوابط أمان.                      |    3    |  D/V  |
| 9.10.8 | تحقق من أن اختبار أمان استراتيجيات الاستدلال يتضمن fuzzing باستخدام مدخلات مشوّهة، وأوامر عدائية مصممة لإجبار تحويل الاستراتيجية، واختبار شروط الحد لكل نهج إدراكي.                     |    3    |  D/V  |

---

## 9.11 إدارة حالة دورة حياة الوكيل والأمن

تهيئة وكيل آمن، وانتقالات الحالة، والإنهاء مع سجلات تدقيق تشفيرية وإجراءات استرداد محددة.

|   #    | الوصف                                                                                                                                                                                                           | المستوى | الدور |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.11.1 | تحقق من أن تهيئة الوكيل تشمل إرساء الهوية التشفيرية باستخدام اعتمادات مدعومة من العتاد وسجلات تدقيق بدء التشغيل غير القابلة للتعديل التي تحتوي على معرّف الوكيل، والطابع الزمني، وهاش التكوين، ومعلمات التهيئة. |    1    |  D/V  |
| 9.11.2 | تحقق من أن انتقالات حالة الوكيل موقّعة بتوقيع رقمي، ومؤرخة زمنياً، ومسجَّلة مع السياق الكامل بما في ذلك الأحداث المحفِّزة، وهاش الحالة السابقة، وهاش الحالة الجديدة، والتحققات الأمنية التي تم إجراؤها.         |    2    |  D/V  |
| 9.11.3 | تحقق من أن إجراءات إيقاف تشغيل الوكيل تتضمن محوًا آمنًا للذاكرة باستخدام الإمحاء التشفري أو الكتابة عبر مرورين متعددين، وإلغاء بيانات الاعتماد مع إشعار سلطة الشهادات، وتوليد شهادات إنهاء قابلة للكشف عن العبث |    2    |  D/V  |
| 9.11.4 | تحقق من أن آليات استرداد الوكلاء تتحقق من تكامل الحالة باستخدام تجزئات تشفيرية (SHA-256 كحد أدنى) والعودة إلى حالات سليمة معروفة عند اكتشاف تلف مع إشعارات آلية ومتطلبات موافقة يدوية.                          |    3    |  D/V  |
| 9.11.5 | تحقق من أن آليات حفظ حالة الوكيل تقوم بتشفير البيانات الحساسة للحالة باستخدام مفاتيح AES-256 خاصة بكل وكيل وتنفّذ تدوير مفاتيح آمن وفق جداول قابلة للتكوين (الحد الأقصى 90 يومًا) مع نشر بدون توقف.             |    3    |  D/V  |

---

## 9.12 إطار أمان لتكامل الأدوات

ضوابط أمان لتحميل الأدوات بشكل ديناميكي، وتنفيذها، والتحقق من النتائج مع تقييم مخاطر محدد وعمليات موافقة.

|   #    | الوصف                                                                                                                                                                                                                | المستوى | الدور |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.12.1 | تحقق من أن موصفات الأدوات تتضمن بيانات أمان تحدد الصلاحيات المطلوبة (قراءة/كتابة/تنفيذ)، ومستويات المخاطر (منخفض/متوسط/مرتفع)، وحدود الموارد (CPU، الذاكرة، الشبكة)، ومتطلبات التحقق الموثقة في ملفات تعريف الأدوات. |    1    |  D/V  |
| 9.12.2 | تحقق من أن نتائج تشغيل الأداة مطابقة للمخططات المتوقعة (مخطط JSON، مخطط XML) وسياسات الأمان (تنقية الإخراج، تصنيف البيانات) قبل الدمج مع حدود المهلة الزمنية وإجراءات معالجة الأخطاء.                                |    1    |  D/V  |
| 9.12.3 | تحقق من أن سجلات التفاعل مع الأدوات تتضمن سياقًا أمنيًا تفصيليًا بما في ذلك استخدام الامتيازات وأنماط الوصول إلى البيانات وزمن التنفيذ واستهلاك الموارد ورموز الإرجاع مع تسجيل منسّق لتكامل SIEM.                    |    2    |  D/V  |
| 9.12.4 | تحقق من أن آليات تحميل الأدوات الديناميكية تتحقق من التواقيع الرقمية باستخدام بنية المفاتيح العامة (PKI)، وتطبق بروتوكولات تحميل آمنة مع عزل صندوق الرمل والتحقق من الأذونات قبل التنفيذ.                            |    2    |  D/V  |
| 9.12.5 | تحقق من أن تقييمات أمان الأدوات تُشغَّل تلقائيًا للإصدارات الجديدة مع بوابات الموافقة الإلزامية التي تشمل التحليل الثابت، الاختبار الديناميكي، ومراجعة فريق الأمن مع معايير الموافقة الموثقة ومتطلبات SLA            |    3    |  D/V  |

---

### المراجع

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)


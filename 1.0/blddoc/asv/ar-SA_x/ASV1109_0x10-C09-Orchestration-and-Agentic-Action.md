# 9 التنسيق الذاتي والعمل الوكالي الأمني

## هدف التحكم

تأكد من أن أنظمة الذكاء الاصطناعي الذاتية أو متعددة الوكلاء يمكنها تنفيذ الإجراءات فقط التي تكون مقصودة صراحةً، ومصادق عليها، وقابلة للتدقيق، وضمن حدود التكلفة والمخاطر المسموح بها. هذا يحمي من التهديدات مثل اختراق النظام الذاتي، وسوء استخدام الأدوات، وكشف الحلقة الوكيلية، واختطاف الاتصالات، وانتحال الهوية، والتلاعب بالسرب، والتلاعب بالنية.

---

## 9.1 ميزانيات تخطيط مهام الوكيل والتكرار

تقييد الخطط العودية وفرض نقاط تفتيش بشرية للإجراءات المميزة.

|   #   | الوصف                                                                                                                                                                       | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.1.1 | تحقق من أن أقصى عمق للتكرار، العرض، وقت الساعة الحائطية، الرموز، والتكلفة المالية لكل تنفيذ وكيل مُعدة مركزيًا وتخضع للتحكم بالإصدار.                                       |    1    |  D/V  |
| 9.1.2 | تحقق من أن الإجراءات ذات الامتياز أو التي لا يمكن التراجع عنها (مثل التزامات الشيفرة، والتحويلات المالية) تتطلب موافقة صريحة من الإنسان عبر قناة قابلة للتدقيق قبل التنفيذ. |    1    |  D/V  |
| 9.1.3 | تحقق من أن مراقبي الموارد في الوقت الحقيقي يقومون بتحفيز انقطاع قاطع الدائرة عند تجاوز أي من حدود الميزانية، مما يوقف توسع المهام بشكل إضافي.                               |    2    |   D   |
| 9.1.4 | تحقق من تسجيل أحداث قاطع الدائرة بمعرف الوكيل، وحالة التنشيط، وحالة الخطة الملتقطة للمراجعة الجنائية.                                                                       |    2    |  D/V  |
| 9.1.5 | تحقق من أن اختبارات الأمان تغطي سيناريوهات نفاد الميزانية وهروب الخطة، مع التأكيد على التوقف الآمن دون فقدان البيانات.                                                      |    3    |   V   |
| 9.1.6 | تحقق من أن سياسات الميزانية معبر عنها كسياسة-كود ويتم فرضها في CI/CD لمنع انحراف التهيئة.                                                                                   |    3    |   D   |

---

## 9.2 حجز أدوات الإضافة (Plugin Sandboxing)

عزل تفاعلات الأدوات لمنع الوصول غير المصرح به إلى النظام أو تنفيذ الأكواد.

|   #   | الوصف                                                                                                                                                            | المستوى | الدور |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.2.1 | تحقق من أن كل أداة/مكون إضافي يتم تشغيله داخل نظام تشغيل، أو حاوية، أو بيئة رملية على مستوى WASM مع سياسات أقل امتيازًا لنظام الملفات، والشبكة، ونظام الاستدعاء. |    1    |  D/V  |
| 9.2.2 | تحقق من أن حصص موارد البيئة المعزولة (CPU، الذاكرة، القرص، تصدير الشبكة) وحدود زمن التنفيذ مفروضة ومسجلة.                                                        |    1    |  D/V  |
| 9.2.3 | تحقق من أن الملفات التنفيذية للأدوات أو أوصافها موقعة رقميًا؛ ويتم التحقق من التوقيعات قبل التحميل.                                                              |    2    |  D/V  |
| 9.2.4 | تحقق من أن بيانات القياس عن بعد لـ sandbox تتدفق إلى نظام إدارة معلومات وأحداث الأمان (SIEM)؛ حيث تثير الشذوذات (مثل محاولات الاتصالات الصادرة) التنبيهات.       |    2    |   V   |
| 9.2.5 | تحقق من أن الإضافات عالية الخطورة تخضع لمراجعة أمنية واختبار اختراق قبل نشرها في بيئة الإنتاج.                                                                   |    3    |   V   |
| 9.2.6 | تأكد من أن محاولات الهروب من صندوق الحماية يتم حظرها تلقائيًا وأن الإضافة المخالفة توضع في الحجز المؤقت بانتظار التحقيق.                                         |    3    |  D/V  |

---

## 9.3 الحلقة الذاتية والحد من التكاليف

كشف وإيقاف التكرار غير المنضبط بين الوكلاء والانفجارات التكلفة.

|   #   | الوصف                                                                                                          | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.3.1 | تحقق من أن المكالمات بين الوكلاء تتضمن حد انتقال أو TTL يقوم وقت التشغيل بتقليله وفرضه.                        |    1    |  D/V  |
| 9.3.2 | تحقق من أن الوكلاء يحتفظون بمعرف فريد لمخطط الاستدعاء لرصد الاستدعاء الذاتي أو الأنماط الدورية.                |    2    |   D   |
| 9.3.3 | تحقق من أن عدادات وحدة الحوسبة التراكمية والإنفاق يتم تتبعها لكل سلسلة طلب؛ تجاوز الحد يؤدي إلى إلغاء السلسلة. |    2    |  D/V  |
| 9.3.4 | تحقق من أن التحليل الرسمي أو التحقق من النموذج يثبت غياب التكرار غير المحدود في بروتوكولات الوكيل.             |    3    |   V   |
| 9.3.5 | تحقق من أن أحداث إيقاف الحلقة تولد تنبيهات وتغذي مقاييس التحسين المستمر.                                       |    3    |   D   |

---

## 9.4 حماية من سوء الاستخدام على مستوى البروتوكول

قنوات اتصال آمنة بين الوكلاء والأنظمة الخارجية لمنع الاختطاف أو التلاعب.

|   #   | الوصف                                                                                                          | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.4.1 | تحقق من أن جميع الرسائل بين الوكيل والأداة وبين الوكلاء مصدقة (مثل TLS المتبادل أو JWT) ومشفرة من طرف إلى طرف. |    1    |  D/V  |
| 9.4.2 | تحقق من أن المخططات يتم التحقق منها بدقة؛ يتم رفض الحقول غير المعروفة أو الرسائل ذات التنسيق الخاطئ.           |    1    |   D   |
| 9.4.3 | تحقق من أن فحوصات السلامة (MACs أو التوقيعات الرقمية) تغطي كامل حمولة الرسالة بما في ذلك معلمات الأداة.        |    2    |  D/V  |
| 9.4.4 | تحقق من أن الحماية من إعادة التشغيل (الـ nonces أو نوافذ الطوابع الزمنية) مُطبقة على طبقة البروتوكول.          |    2    |   D   |
| 9.4.5 | تحقق من أن تطبيقات البروتوكول تخضع لاختبار الفازينج والتحليل الساكن للكشف عن عيوب الحقن أو التسلسل العكسي.     |    3    |   V   |

---

## 9.5 هوية الوكيل ودليل العبث

ضمان إمكانية عزو الأفعال واكتشاف التعديلات.

|   #   | الوصف                                                                                        | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.5.1 | تحقق من أن كل نسخة من الوكيل تمتلك هوية تشفير فريدة (زوج مفاتيح أو اعتماد مرتبط بالأجهزة).   |    1    |  D/V  |
| 9.5.2 | تحقق من توقيع جميع إجراءات العميل وتوقيتها؛ يجب أن تتضمن السجلات التوقيع لمنع التنصل.        |    2    |  D/V  |
| 9.5.3 | تحقق من أن السجلات المقاومة للتلاعب مخزنة في وسط يقتصر على الإضافة فقط أو الكتابة مرة واحدة. |    2    |   V   |
| 9.5.4 | تأكد من أن مفاتيح الهوية تتغير وفق جدول زمني محدد وعند وجود مؤشرات على الاختراق.             |    3    |   D   |
| 9.5.5 | تحقق من أن محاولات الانتحال أو تعارض المفاتيح تؤدي إلى حجر صحي فوري للوكيل المتأثر.          |    3    |  D/V  |

---

## 9.6 تقليل مخاطر السرب متعدد الوكلاء

التخفيف من مخاطر السلوك الجماعي من خلال العزل والنمذجة الرسمية للسلامة.

|   #   | الوصف                                                                                                                     | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.6.1 | تحقق من أن الوكلاء الذين يعملون في مجالات أمنية مختلفة يتم تشغيلهم في صناديق أمان تنفيذ معزولة أو في قطاعات شبكية منفصلة. |    1    |  D/V  |
| 9.6.2 | تحقق من أن سلوكيات السرب قد تم نمذجتها والتحقق منها رسميًا من حيث الحيوية والسلامة قبل النشر.                             |    3    |   V   |
| 9.6.3 | تحقق من أن مراقبي وقت التشغيل يكتشفون الأنماط غير الآمنة الناشئة (مثل التذبذبات، والجمود) ويبدؤون بالإجراءات التصحيحية.   |    3    |   D   |

---

## 9.7 المصادقة / التفويض للمستخدم والأداة

نفذ ضوابط وصول قوية لكل إجراء يتم تفعيله بواسطة الوكيل.

|   #   | الوصف                                                                                                                             | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.7.1 | تحقق من أن الوكلاء يقومون بالمصادقة كجهات فاعلة من الدرجة الأولى للنظم التابعة، دون إعادة استخدام بيانات اعتماد المستخدم النهائي. |    1    |  D/V  |
| 9.7.2 | تحقق من أن سياسات التفويض الدقيقة تحد من الأدوات التي يمكن للعميل استدعاؤها والمعلمات التي يمكنه تقديمها.                         |    2    |   D   |
| 9.7.3 | تحقق من إعادة تقييم فحوصات الامتيازات عند كل استدعاء (الترخيص المستمر)، وليس فقط عند بدء الجلسة.                                  |    2    |   V   |
| 9.7.4 | تحقق من أن الامتيازات المفوضة تنتهي تلقائيًا وتتطلب إعادة الموافقة بعد انتهاء المهلة أو تغيير النطاق.                             |    3    |   D   |

---

## 9.8 أمان التواصل بين الوكلاء

تشفير جميع الرسائل بين الوكلاء وحمايتها من العبث لضمان الحماية من التنصت والتلاعب.

|   #   | الوصف                                                                                                  | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 9.8.1 | تحقق من أن المصادقة المتبادلة والتشفير بسريّة تامة للأمام (مثل TLS 1.3) إلزاميان لقنوات الوكيل.        |    1    |  D/V  |
| 9.8.2 | تحقق من صحة سلامة الرسالة وأصلها قبل المعالجة؛ في حال حدوث فشل، يتم رفع تنبيهات وإسقاط الرسالة.        |    1    |   D   |
| 9.8.3 | تحقق من تسجيل بيانات تعريف الاتصال (الطوابع الزمنية، أرقام التسلسل) لدعم إعادة البناء الجنائي.         |    2    |  D/V  |
| 9.8.4 | تحقق من أن التحقق الرسمي أو فحص النموذج يؤكد أن آلات حالة البروتوكول لا يمكن دفعها إلى حالات غير آمنة. |    3    |   V   |

---

## 9.9 التحقق من النية وفرض القيود

تحقق من أن إجراءات الوكيل تتماشى مع نية المستخدم المعلنة وقيود النظام.

|   #   | الوصف                                                                                                                                           | المستوى | الدور |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.9.1 | تحقق من أن محركات حل القيود قبل التنفيذ تتحقق من الإجراءات المقترحة مقابل قواعد السلامة والسياسة المبرمجة مسبقًا.                               |    1    |   D   |
| 9.9.2 | تحقق من أن الإجراءات ذات التأثير العالي (المالية، التدميرية، الحساسة للخصوصية) تتطلب تأكيد نية صريحة من المستخدم الذي بدأها.                    |    2    |  D/V  |
| 9.9.3 | تحقق من أن فحوصات الشروط اللاحقة تؤكد أن الإجراءات المكتملة حققت التأثيرات المرجوة دون آثار جانبية؛ وأي تناقضات تؤدي إلى التراجع.               |    2    |   V   |
| 9.9.4 | تحقق من أن الطرق الرسمية (مثل التحقق من النماذج، إثبات النظريات) أو الاختبارات القائمة على الخصائص تثبت أن خطط الوكيل تفي بجميع القيود المعلنة. |    3    |   V   |
| 9.9.5 | تحقق من أن الحوادث المتعلقة بعدم تطابق النية أو انتهاك القيود تغذي دورات التحسين المستمر ومشاركة معلومات التهديدات.                             |    3    |   D   |

---

## 9.10 أمان استراتيجية استدلال الوكيل

الاختيار والتنفيذ الآمن لاستراتيجيات التفكير المختلفة بما في ذلك طرق ReAct، وسلسلة الأفكار، وشجرة الأفكار.

|   #    | الوصف                                                                                                                                                                           | المستوى | الدور |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.10.1 | تحقق من أن اختيار استراتيجية التفكير يستخدم معايير حتمية (تعقيد الإدخال، نوع المهمة، سياق الأمان) وأن المدخلات المتطابقة تُنتج اختيارات استراتيجية متطابقة ضمن نفس سياق الأمان. |    1    |  D/V  |
| 9.10.2 | تحقق من أن كل استراتيجية استدلال (ReAct، سلسلة الأفكار، شجرة الأفكار) تحتوي على تحقق مخصص من صحة الإدخال، وتنقية مخرجات، وحدود زمن تنفيذ محددة خاصة بنهجها الإدراكي.            |    1    |  D/V  |
| 9.10.3 | تحقق من أن انتقالات استراتيجية التفكير يتم تسجيلها مع السياق الكامل بما في ذلك خصائص الإدخال وقيم معايير الاختيار وبيانات تنفيذ العمليات لاستعادة سجل التدقيق.                  |    2    |  D/V  |
| 9.10.4 | تحقق من أن تفكير شجرة الأفكار يتضمن آليات تقليم الفروع التي تنهي الاستكشاف عند اكتشاف انتهاكات السياسة، أو حدود الموارد، أو حدود السلامة.                                       |    2    |  D/V  |
| 9.10.5 | تحقق من أن دورات ReAct (التفكير-التصرف-الملاحظة) تتضمن نقاط تحقق للتحقق في كل مرحلة: التحقق من خطوة التفكير، تفويض الفعل، وتنقية الملاحظة قبل المتابعة.                         |    2    |  D/V  |
| 9.10.6 | تحقق من أن مؤشرات أداء استراتيجية الاستدلال (وقت التنفيذ، استخدام الموارد، جودة المخرجات) تتم مراقبتها بواسطة تنبيهات آلية عند انحراف المؤشرات عن الحدود المعتمدة.              |    3    |  D/V  |
| 9.10.7 | تحقق من أن النهج الهجين للاستدلال الذي يجمع بين استراتيجيات متعددة يحافظ على التحقق من صحة الإدخال وقيود الإخراج لجميع الاستراتيجيات المكونة دون تجاوز أي ضوابط أمان.           |    3    |  D/V  |
| 9.10.8 | تحقق من أن اختبار أمان استراتيجية الاستدلال يشمل التغطية بمدخلات مشوهة، والمطالبات العدائية المصممة لإجبار التبديل بين الاستراتيجيات، واختبار شروط الحدود لكل نهج معرفي.        |    3    |  D/V  |

---

## 9.11 إدارة حالة دورة حياة الوكيل والأمان

تهيئة الوكيل الآمن، والتحولات الحلقية، وإنهاء العمل مع سجلات تدقيق تشفيرية وإجراءات استرداد محددة.

|   #    | الوصف                                                                                                                                                                                                                 | المستوى | الدور |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.11.1 | تحقق من أن تهيئة الوكيل تتضمن إنشاء هوية تشفيرية باستخدام بيانات اعتماد مدعومة بالأجهزة وسجلات تدقيق بدء تشغيل غير قابلة للتغيير تحتوي على معرف الوكيل والطابع الزمني وتجميع التكوين ومعلمات التهيئة.                 |    1    |  D/V  |
| 9.11.2 | تحقق من أن الانتقالات في حالة الوكيل موقعة تشفيرياً، وموّقتة زمنياً، ومسجلة بسجل يحتوي على السياق الكامل بما في ذلك الأحداث المحفزة، وتجزئة الحالة السابقة، وتجزئة الحالة الجديدة، والتحققات الأمنية التي تم تنفيذها. |    2    |  D/V  |
| 9.11.3 | تحقق من أن إجراءات إيقاف تشغيل الوكيل تتضمن مسحًا آمنًا للذاكرة باستخدام المحو التشفيري أو الكتابة المتعددة المرور، وإلغاء صلاحيات الاعتماد مع إشعار سلطة الشهادات، وإنشاء شهادات إنهاء مقاومة للتلاعب.               |    2    |  D/V  |
| 9.11.4 | تحقق من أن آليات استرداد الوكيل تقوم بالتحقق من سلامة الحالة باستخدام مجموعات تدقيق تشفيرية (SHA-256 كحد أدنى) وتعيد الحالة إلى حالات معروفة وصحيحة عند اكتشاف الفساد مع تنبيهات آلية ومتطلبات الموافقة اليدوية.      |    3    |  D/V  |
| 9.11.5 | تحقق من أن آليات استمرارية الوكيل تقوم بتشفير بيانات الحالة الحساسة باستخدام مفاتيح AES-256 لكل وكيل وتنفذ تدوير المفاتيح الآمن وفق جداول قابلة للتكوين (بحد أقصى 90 يومًا) مع نشر بدون توقف.                         |    3    |  D/V  |

---

## 9.12 إطار أمان دمج الأدوات

ضوابط الأمان لتحميل الأدوات الديناميكي وتنفيذها والتحقق من النتائج مع عمليات تقييم المخاطر والموافقة المحددة.

|   #    | الوصف                                                                                                                                                                                                                                         | المستوى | الدور |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.12.1 | تحقق من أن أوصاف الأدوات تتضمن بيانات أمان وصفية تحدد الامتيازات المطلوبة (قراءة/كتابة/تنفيذ)، مستويات المخاطر (منخفض/متوسط/عالٍ)، حدود الموارد (وحدة المعالجة المركزية، الذاكرة، الشبكة)، ومتطلبات التحقق الموثقة في مَنشورات الأدوات.       |    1    |  D/V  |
| 9.12.2 | تحقق من أن نتائج تنفيذ الأداة يتم التحقق من صحتها مقابل المخططات المتوقعة (مخطط JSON، مخطط XML) وسياسات الأمان (تنقية المخرجات، تصنيف البيانات) قبل التكامل مع حدود المهلة وإجراءات التعامل مع الأخطاء.                                       |    1    |  D/V  |
| 9.12.3 | تحقق من أن سجلات تفاعل الأدوات تتضمن سياق أمني مفصل يشمل استخدام الامتيازات، أنماط الوصول إلى البيانات، وقت التنفيذ، استهلاك الموارد، وأكواد العودة مع تسجيل منظم لتكامل نظم إدارة الأحداث الأمنية (SIEM).                                    |    2    |  D/V  |
| 9.12.4 | تحقق من أن آليات تحميل الأدوات الديناميكية تقوم بالتحقق من صحة التوقيعات الرقمية باستخدام بنية المفتاح العام (PKI) وتنفذ بروتوكولات تحميل آمنة مع عزل في بيئة معزولة (sandbox) والتحقق من الأذونات قبل التنفيذ.                               |    2    |  D/V  |
| 9.12.5 | تحقق من أن تقييمات أمان الأدوات يتم تشغيلها تلقائيًا للإصدارات الجديدة مع وجود بوابات الموافقة الإلزامية والتي تشمل التحليل الثابت، الاختبار الديناميكي، ومراجعة فريق الأمان مع وجود معايير موافقة موثقة ومتطلبات اتفاقية مستوى الخدمة (SLA). |    3    |  D/V  |

---

### المراجع

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)


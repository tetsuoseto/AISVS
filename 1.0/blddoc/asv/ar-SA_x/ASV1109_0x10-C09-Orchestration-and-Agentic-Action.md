# 9 التنسيق المستقل والعمل الوكلي الأمني

## هدف التحكم

ضمان أن أنظمة الذكاء الاصطناعي المستقلة أو متعددة الوكلاء يمكنها تنفيذ الإجراءات فقط التي تكون مقصودة صراحة، ومصادق عليها، وقابلة للتدقيق، وتقع ضمن حدود التكلفة والمخاطر المحددة. هذا يحمي ضد تهديدات مثل اختراق النظام المستقل، سوء استخدام الأدوات، اكتشاف حلقة الوكيل، اختطاف الاتصالات، تزوير الهوية، التلاعب بالسرب، والتلاعب بالنية.

---

## 9.1 تخطيط مهام الوكيل وميزانيات الاستدعاء الذاتي

تحديد سرعة الخطط التكرارية وإجبار نقاط تدقيق بشرية للإجراءات المميزة.

|   #   | الوصف                                                                                                                                                                     | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.1.1 | تحقق من أن الحد الأقصى لعمق الاستدعاء الذاتي، والعرض، ووقت الساعة الحائطية، وعدد الرموز، والتكلفة المالية لكل تنفيذ للوكيل مُعدة مركزيًا وتحت تحكم الإصدار.               |    1    |  D/V  |
| 9.1.2 | تحقق من أن الإجراءات ذات الامتيازات أو التي لا يمكن التراجع عنها (مثل الالتزامات البرمجية، التحويلات المالية) تتطلب موافقة بشرية صريحة عبر قناة يمكن تدقيقها قبل التنفيذ. |    1    |  D/V  |
| 9.1.3 | تحقق من أن مراقبات الموارد في الوقت الحقيقي تُفعّل انقطاع قاطع الدائرة عند تجاوز أي حد للميزانية، مما يوقف توسيع المهام بشكل إضافي.                                       |    2    |   D   |
| 9.1.4 | تحقق من تسجيل أحداث قاطع الدائرة مع معرف الوكيل، شرط التنشيط، وحالة الخطة الملتقطة للمراجعة الجنائية.                                                                     |    2    |  D/V  |
| 9.1.5 | تحقق من أن اختبارات الأمان تغطي سيناريوهات نفاد الميزانية وسيناريوهات تنفيذ الخطط بشكل غير محدود، مع التأكد من التوقف الآمن دون فقدان البيانات.                           |    3    |   V   |
| 9.1.6 | تحقق من أن سياسات الميزانية معبر عنها كسياسات كرمز ويتم فرضها في CI/CD لمنع انحراف التكوين.                                                                               |    3    |   D   |

---

## 9.2 عزل ملحقات الأدوات

عزل تفاعلات الأدوات لمنع الوصول غير المصرح به إلى النظام أو تنفيذ الشيفرة.

|   #   | الوصف                                                                                                                                                                | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.2.1 | تحقق من أن كل أداة/إضافة تعمل داخل نظام تشغيل، حاوية، أو بيئة معزولة على مستوى WASM مع سياسات صلاحيات دنيا لنظام الملفات، الشبكة، ونظام الاستدعاءات.                 |    1    |  D/V  |
| 9.2.2 | تحقق من أنه يتم فرض وتسجيل حصص موارد الحاوية المعزولة (CPU، الذاكرة، القرص، خروج الشبكة) وحدود وقت التنفيذ.                                                          |    1    |  D/V  |
| 9.2.3 | تحقق من توقيع الملفات التنفيذية للأدوات أو المواصفات الرقمية؛ يتم التحقق من صحة التوقيعات قبل التحميل.                                                               |    2    |  D/V  |
| 9.2.4 | تحقق من أن تيارات القياس عن بعد للصندوق الرملية تتدفق إلى نظام إدارة المعلومات الأمنية والأحداث (SIEM)؛ وأن الشذوذات (مثل محاولات الاتصالات الصادرة) تثير التنبيهات. |    2    |   V   |
| 9.2.5 | تحقق من أن الإضافات عالية المخاطر تخضع لمراجعة الأمان واختبار الاختراق قبل نشرها في بيئة الإنتاج.                                                                    |    3    |   V   |
| 9.2.6 | تحقق من أن محاولات الهروب من الصندوق الرمل تُحظر تلقائيًا ويتم حجز الإضافة المخالفة ريثما تُجرى التحقيقات.                                                           |    3    |  D/V  |

---

## 9.3 الحلقة المستقلة وحدود التكلفة

كشف وإيقاف الاستدعاء الذاتي غير المنضبط بين الوكلاء وانفجارات التكلفة.

|   #   | الوصف                                                                                                          | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.3.1 | تحقق من أن مكالمات بين الوكلاء تتضمن حدًا للانتقال أو TTL تقوم بيئة التشغيل بتقليله وفرضه.                     |    1    |  D/V  |
| 9.3.2 | تحقق من أن الوكلاء يحتفظون بمعرف فريد لشجرة الاستدعاء لاكتشاف الاستدعاءات الذاتية أو الأنماط الدورية.          |    2    |   D   |
| 9.3.3 | تحقق من أن عدادات وحدة الحوسبة التراكمية والإنفاق يتم تتبعها لكل سلسلة طلب؛ تجاوز الحد يؤدي إلى إلغاء السلسلة. |    2    |  D/V  |
| 9.3.4 | تحقق من أن التحليل الرسمي أو فحص النماذج يثبت غياب التكرار غير المحدود في بروتوكولات الوكلاء.                  |    3    |   V   |
| 9.3.5 | تحقق من أن أحداث إيقاف الحلقة تُولد تنبيهات وتُغذي مقاييس التحسين المستمر.                                     |    3    |   D   |

---

## 9.4 حماية من سوء الاستخدام على مستوى البروتوكول

تأمين قنوات الاتصال بين الوكلاء والأنظمة الخارجية لمنع الاختراق أو التلاعب.

|   #   | الوصف                                                                                                                      | المستوى | الدور |
| :---: | -------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.4.1 | تحقق من أن جميع الرسائل بين الوكيل والأداة وبين الوكيل والوكيل الأخرى مصدقة (مثل TLS متبادل أو JWT) ومشفرة من طرف إلى طرف. |    1    |  D/V  |
| 9.4.2 | تأكد من أن المخططات يتم التحقق منها بدقة؛ يتم رفض الحقول غير المعروفة أو الرسائل غير الصحيحة الصياغة.                      |    1    |   D   |
| 9.4.3 | تحقق من أن فحوصات السلامة (MACs أو التوقيعات الرقمية) تغطي كامل حمولة الرسالة بما في ذلك معايير الأدوات.                   |    2    |  D/V  |
| 9.4.4 | تحقق من أن حماية إعادة التشغيل (الرموز الأحادية أو نوافذ الطوابع الزمنية) يتم تطبيقها في طبقة البروتوكول.                  |    2    |   D   |
| 9.4.5 | تحقق من أن تنفيذات البروتوكول تخضع للفحص العشوائي والتحليل الثابت للكشف عن عيوب الحقن أو التسلسل العكسي.                   |    3    |   V   |

---

## 9.5 هوية الوكيل ودليل التلاعب

تأكد من أن تكون الإجراءات قابلة للعزو وأن تكون التعديلات قابلة للكشف.

|   #   | الوصف                                                                                         | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.5.1 | تحقق من أن كل نسخة من الوكيل تمتلك هوية تشفير فريدة (زوج مفاتيح أو شهادة معتمدة على الأجهزة). |    1    |  D/V  |
| 9.5.2 | تحقق من توقيع وتاريخ جميع إجراءات الوكيل؛ يجب أن تتضمن السجلات التوقيع لضمان عدم الإنكار.     |    2    |  D/V  |
| 9.5.3 | تحقق من أن السجلات التي تظهر التلاعب مخزنة في وسط يتيح الإضافة فقط أو كتابة لمرة واحدة.       |    2    |   V   |
| 9.5.4 | التحقق من تدوير مفاتيح الهوية وفق جدول محدد وعند وجود مؤشرات اختراق.                          |    3    |   D   |
| 9.5.5 | تحقق من أن محاولات التزييف أو تعارض المفتاح تؤدي إلى حجر صحي فوري للوكيل المتأثر.             |    3    |  D/V  |

---

## 9.6 تقليل المخاطر في جماعات الوكلاء المتعددة

تخفيف مخاطر السلوك الجماعي من خلال العزل والنمذجة الرسمية للسلامة.

|   #   | الوصف                                                                                                                          | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 9.6.1 | تحقق من أن الوكلاء العاملين في مجالات أمان مختلفة يعملون في بيئات تشغيل معزولة أو في قطاعات شبكة منفصلة.                       |    1    |  D/V  |
| 9.6.2 | تحقق من أن سلوكيات الجماعات النموذجية مُصممة ومُتحقق من صحتها رسمياً من حيث الحيوية والسلامة قبل النشر.                        |    3    |   V   |
| 9.6.3 | تحقق من أن مراقبي وقت التشغيل يكتشفون الأنماط الخطرة الناشئة (مثل التذبذبات، وحالات الجمود) ويبدؤون اتخاذ الإجراءات التصحيحية. |    3    |   D   |

---

## 9.7 مصادقة / تفويض المستخدم والأداة

قم بتنفيذ ضوابط وصول قوية لكل إجراء يُفعّل بواسطة الوكيل.

|   #   | الوصف                                                                                                                                   | المستوى | الدور |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.7.1 | تحقق من أن الوكلاء يقومون بالمصادقة كجهات فاعلة من الدرجة الأولى على الأنظمة التابعة، دون إعادة استخدام بيانات اعتماد المستخدم النهائي. |    1    |  D/V  |
| 9.7.2 | تحقق من أن سياسات التفويض الدقيق تقيد الأدوات التي يمكن للوكيل استدعاؤها والمعلمات التي يمكنه تقديمها.                                  |    2    |   D   |
| 9.7.3 | تحقق من إعادة تقييم فحوصات الامتيازات في كل استدعاء (الترخيص المستمر)، وليس فقط عند بداية الجلسة.                                       |    2    |   V   |
| 9.7.4 | تحقق من أن الامتيازات المفوضة تنتهي صلاحيتها تلقائيًا وتتطلب إعادة الموافقة بعد انتهاء المهلة أو تغيير النطاق.                          |    3    |   D   |

---

## 9.8 أمان التواصل بين الوكلاء

قم بتشفير وحماية سلامة جميع الرسائل بين الوكلاء لمنع التنصت والتلاعب.

|   #   | الوصف                                                                                                        | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------ | :-----: | :---: |
| 9.8.1 | تحقق من أن المصادقة المتبادلة والتشفير بسريّة مثالية للأمام (مثل TLS 1.3) إلزاميان لقنوات الوكيل.            |    1    |  D/V  |
| 9.8.2 | تحقق من سلامة الرسالة وأصلها قبل المعالجة؛ الفشل يؤدي إلى إصدار تنبيهات وحذف الرسالة.                        |    1    |   D   |
| 9.8.3 | تحقق من تسجيل بيانات التعريف الخاصة بالاتصالات (الطوابع الزمنية، أرقام التتابع) لدعم إعادة البناء الجنائي.   |    2    |  D/V  |
| 9.8.4 | تحقق من أن التحقق الرسمي أو التحقق من النموذج يؤكد أن آلات حالة البروتوكول لا يمكن دفعها إلى حالات غير آمنة. |    3    |   V   |

---

## 9.9 التحقق من النية وفرض القيود

تحقق من أن أفعال الوكيل تتوافق مع نية المستخدم المعلنة وقيود النظام.

|   #   | الوصف                                                                                                                                             | المستوى | الدور |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.9.1 | تحقق من أن محركات حل القيود قبل التنفيذ تقوم بفحص الإجراءات المقترحة مقابل قواعد السلامة والسياسة المبرمجة مسبقًا.                                |    1    |   D   |
| 9.9.2 | تأكد من أن الإجراءات ذات الأثر العالي (المالية، التدميرية، الحساسة للخصوصية) تتطلب تأكيد نية صريح من المستخدم المبادر.                            |    2    |  D/V  |
| 9.9.3 | تحقق من أن فحوصات الشروط اللاحقة تتحقق من أن الإجراءات المكتملة حققت التأثيرات المقصودة بدون آثار جانبية؛ وأي اختلافات تؤدي إلى التراجع.          |    2    |   V   |
| 9.9.4 | تحقق من أن الأساليب الرسمية (مثل التحقق من النماذج، إثبات النظريات) أو اختبارات القائمة على الخصائص تثبت أن خطط الوكلاء تلبي جميع القيود المعلنة. |    3    |   V   |
| 9.9.5 | تحقق من أن حوادث عدم تطابق النية أو انتهاك القيود تغذي دورات التحسين المستمر ومشاركة معلومات التهديدات.                                           |    3    |   D   |

---

## 9.10 أمان استراتيجية استدلال الوكيل

اختيار وتنفيذ آمن لاستراتيجيات التفكير المختلفة بما في ذلك أساليب ReAct و Chain-of-Thought و Tree-of-Thoughts.

|   #    | الوصف                                                                                                                                                                           | المستوى | الدور |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.10.1 | تحقق من أن اختيار استراتيجية الاستدلال يستخدم معايير حتمية (تعقيد الإدخال، نوع المهمة، سياق الأمان) وأن نفس المدخلات ينتج عنها اختيارات استراتيجية متطابقة ضمن نفس سياق الأمان. |    1    |  D/V  |
| 9.10.2 | تحقق من أن كل استراتيجية تفكير (ReAct، سلسلة الأفكار، شجرة الأفكار) لديها تحقق مخصص للمدخلات، وتنقية مخرجات، وحدود زمن تنفيذ محددة تتناسب مع نهجها الذهني.                      |    1    |  D/V  |
| 9.10.3 | تحقق من تسجيل انتقالات استراتيجية التفكير مع السياق الكامل بما في ذلك خصائص الإدخال، وقيم معايير الاختيار، وبيانات تنفيذ العمليات لأجل إعادة بناء مسار التدقيق.                 |    2    |  D/V  |
| 9.10.4 | تحقق من أن استدلال شجرة الأفكار يتضمن آليات تقليم الفروع التي تنهي الاستكشاف عند اكتشاف انتهاكات السياسات أو حدود الموارد أو حدود الأمان.                                       |    2    |  D/V  |
| 9.10.5 | تحقق من أن دورات ReAct (التفكير-الفعل-الملاحظة) تتضمن نقاط تحقق للتحقق في كل مرحلة: التحقق من خطوة التفكير، تفويض الفعل، وتنقية الملاحظة قبل المتابعة.                          |    2    |  D/V  |
| 9.10.6 | تحقق من مراقبة مقاييس أداء استراتيجية الاستدلال (وقت التنفيذ، استخدام الموارد، جودة المخرجات) مع التنبيهات التلقائية عند انحراف المقاييس عن الحدود المُعدة مسبقًا.              |    3    |  D/V  |
| 9.10.7 | تحقق من أن أساليب الاستدلال الهجينة التي تجمع بين استراتيجيات متعددة تحافظ على التحقق من صحة الإدخال وقيود الإخراج لجميع الاستراتيجيات المكونة دون تجاوز أي ضوابط أمان.         |    3    |  D/V  |
| 9.10.8 | تحقق من أن اختبار أمان استراتيجية التفكير يشمل اختبار التعثر باستخدام مدخلات مشوهة، ونصوص معادية مصممة لإجبار التنقل بين الاستراتيجيات، واختبار شروط الحدود لكل نهج معرفي.      |    3    |  D/V  |

---

## 9.11 إدارة حالة دورة حياة الوكيل والأمان

تهيئة الوكيل الآمن، والتحولات الحالة، والإنهاء مع مسارات تدقيق تشفيرية وإجراءات استرداد محددة.

|   #    | الوصف                                                                                                                                                                                                    | المستوى | الدور |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.11.1 | تحقق من أن تهيئة الوكيل تتضمن إنشاء هوية تشفيرية باستخدام بيانات اعتماد مدعومة بالأجهزة وسجلات تدقيق بدء تشغيل غير قابلة للتغيير تحتوي على معرف الوكيل، والطابع الزمني، وهاش التكوين، ومعلمات التهيئة.   |    1    |  D/V  |
| 9.11.2 | تحقق من أن انتقالات حالة الوكيل موقعة تشفيرياً، ومؤرخة زمنياً، ومسجلة مع السياق الكامل بما في ذلك الأحداث التي أطلقتها، هاش الحالة السابقة، هاش الحالة الجديدة، والتحققات الأمنية التي تم تنفيذها.       |    2    |  D/V  |
| 9.11.3 | تحقق من أن إجراءات إيقاف الوكيل تتضمن مسحًا آمنًا للذاكرة باستخدام المسح التشفيري أو الكتابة المتعددة المتكررة، وإلغاء صلاحيات الاعتماد مع إشعار جهة إصدار الشهادات، وإنشاء شهادات إنهاء مقاومة للتلاعب. |    2    |  D/V  |
| 9.11.4 | تحقق من أن آليات استرداد الوكيل تتحقق من سلامة الحالة باستخدام مجموعات التحقق التشفيرية (SHA-256 كحد أدنى) وتعود إلى حالات معروفة وسليمة عند اكتشاف الفساد مع تنبيهات آلية ومتطلبات موافقة يدوية.        |    3    |  D/V  |
| 9.11.5 | تحقق من أن آليات استمرارية الوكيل تقوم بتشفير بيانات الحالة الحساسة باستخدام مفاتيح AES-256 لكل وكيل وتنفذ تدويرًا آمنًا للمفاتيح على جداول زمنية قابلة للتكوين (بحد أقصى 90 يومًا) مع نشر بدون توقف.    |    3    |  D/V  |

---

## 9.12 إطار أمان تكامل الأدوات

ضوابط الأمان لتحميل الأدوات الديناميكية، والتنفيذ، والتحقق من النتائج مع عمليات تقييم المخاطر والموافقة المحددة.

|   #    | الوصف                                                                                                                                                                                                                                  | المستوى | الدور |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----: | :---: |
| 9.12.1 | تحقق من أن أوصاف الأدوات تتضمن بيانات أمان تحدد الصلاحيات المطلوبة (قراءة/كتابة/تنفيذ)، ومستويات المخاطر (منخفض/متوسط/عالٍ)، وحدود الموارد (وحدة المعالجة المركزية، الذاكرة، الشبكة)، ومتطلبات التحقق الموثقة في بيانات تعريف الأدوات. |    1    |  D/V  |
| 9.12.2 | تحقق من أن نتائج تنفيذ الأدوات يتم التحقق من صحتها مقابل المخططات المتوقعة (مخطط JSON، مخطط XML) وسياسات الأمان (تنقية المخرجات، تصنيف البيانات) قبل الدمج مع حدود زمنية وإجراءات معالجة الأخطاء.                                      |    1    |  D/V  |
| 9.12.3 | تحقق من أن سجلات تفاعل الأدوات تتضمن سياق أمني مفصل يشمل استخدام الامتيازات، وأنماط الوصول إلى البيانات، ووقت التنفيذ، واستهلاك الموارد، وأكواد الإرجاع مع تسجيل منظم للاندماج مع نظام إدارة معلومات الأمن والأحداث (SIEM).            |    2    |  D/V  |
| 9.12.4 | تحقق من أن آليات تحميل الأدوات الديناميكية تتحقق من التوقيعات الرقمية باستخدام بنية المفاتيح العامة (PKI) وتنفذ بروتوكولات تحميل آمنة مع عزل في بيئة معزولة (sandbox) والتحقق من الأذونات قبل التنفيذ.                                 |    2    |  D/V  |
| 9.12.5 | تحقق من أن تقييمات أمان الأدوات يتم تفعيلها تلقائيًا للإصدارات الجديدة مع وجود بوابات موافقة إلزامية تشمل التحليل الثابت، والاختبار الديناميكي، ومراجعة فريق الأمان مع معايير موافقة موثقة ومتطلبات اتفاقية مستوى الخدمة (SLA).        |    3    |  D/V  |

---

### المراجع

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)

